var MiaokitModule=function(a,b){var c=this;c["m_pConfigPath"]=b;c["m_pConfig"]={ENGINE:a};c["Merge"](c);c["Preload"]()};var MiaokitMerge=function(d){var e=[];d["Merge"]=d["Merge"]||function(f){for(var g=0,h=e;g<h.length;g++){var i=h[g];var j=i(f);if(j){for(var k=0,l=j;k<l.length;k++){var m=l[k];f[m._name]=m}}}};return function(n){e.push(n)}}(MiaokitModule.prototype);MiaokitMerge(function(o){var p=undefined;var q=undefined;var r={};var s=function(u,v){if(v===void 0){v=undefined}var w=0;this.length=u(-1);this[Symbol.iterator]=function(){return{next:function(){var x=u(w);if(x){var y=p(x);w=v?w+1:y.m_nObject;return{value:y,done:false}}return{value:undefined,done:true}}}}};r["Transform"]=function(z){Object.defineProperty(z,"position",{get:function(){var A=this["_GetPosition"]()/4;var B=o["WASM"].HEAPF32();return{x:B[A],y:B[A+1],z:B[A+2]}},set:function(C){this["_SetPosition"](C.x,C.y,C.z)}});Object.defineProperty(z,"euler",{get:function(){var D=this["_GetEuler"]()/4;var E=o["WASM"].HEAPF32();return{x:E[D],y:E[D+1],z:E[D+2]}},set:function(F){this["_SetEuler"](F.x,F.y,F.z)}});Object.defineProperty(z,"rotation",{get:function(){var G=this["_GetRotation"]()/4;var H=o["WASM"].HEAPF32();return{x:H[G],y:H[G+1],z:H[G+2],w:H[G+3]}},set:function(I){this["_SetRotation"](I.x,I.y,I.z,I.w)}});Object.defineProperty(z,"scale",{get:function(){var J=this["_GetScale"]()/4;var K=o["WASM"].HEAPF32();return{x:K[J],y:K[J+1],z:K[J+2]}},set:function(L){this["_SetScale"](L.x,L.y,L.z)}});Object.defineProperty(z,"localPosition",{get:function(){var M=this["_GetLocalPosition"]()/4;var N=o["WASM"].HEAPF32();return{x:N[M],y:N[M+1],z:N[M+2]}},set:function(O){this["_SetLocalPosition"](O.x,O.y,O.z)}});Object.defineProperty(z,"localEuler",{get:function(){var P=this["_GetLocalEuler"]()/4;var Q=o["WASM"].HEAPF32();return{x:Q[P],y:Q[P+1],z:Q[P+2]}},set:function(R){this["_SetLocalEuler"](R.x,R.y,R.z)}});Object.defineProperty(z,"localRotation",{get:function(){var S=this["_GetLocalRotation"]()/4;var T=o["WASM"].HEAPF32();return{x:T[S],y:T[S+1],z:T[S+2],w:T[S+3]}},set:function(U){this["_SetLocalRotation"](U.x,U.y,U.z,U.w)}});Object.defineProperty(z,"localScale",{get:function(){var V=this["_GetLocalScale"]()/4;var W=o["WASM"].HEAPF32();return{x:W[V],y:W[V+1],z:W[V+2]}},set:function(X){this["_SetLocalScale"](X.x,X.y,X.z)}});Object.defineProperty(z,"right",{get:function(){var Y=this["_GetRight"]()/4;var Z=o["WASM"].HEAPF32();return{x:Z[Y],y:Z[Y+1],z:Z[Y+2]}},set:function($){this["_SetRight"]($.x,$.y,$.z)}});Object.defineProperty(z,"up",{get:function(){var _=this["_GetUp"]()/4;var aa=o["WASM"].HEAPF32();return{x:aa[_],y:aa[_+1],z:aa[_+2]}},set:function(){var ba=this["_SetUp"]()/4;var ca=o["WASM"].HEAPF32();return{x:ca[ba],y:ca[ba+1],z:ca[ba+2]}}});Object.defineProperty(z,"forward",{get:function(){var da=this["_GetForward"]()/4;var ea=o["WASM"].HEAPF32();return{x:ea[da],y:ea[da+1],z:ea[da+2]}},set:function(){var fa=this["_SetForward"]()/4;var ga=o["WASM"].HEAPF32();return{x:ga[fa],y:ga[fa+1],z:ga[fa+2]}}});z["Rotate"]=function(ha,ia){this["_Rotate"](ha.x,ha.y,ha.z,ia)};z["Rotate2"]=function(ja,ka,la){this["_Rotate2"](ja.x,ja.y,ja.z,ka,la)};z["Translate"]=function(ma,na){this["_Translate"](ma.x,ma.y,ma.z,na)};z["TransformPoint"]=function(oa){var pa=this["_TransformPoint"](oa.x,oa.y,oa.z)/4;var qa=o["WASM"].HEAPF32();return{x:qa[pa],y:qa[pa+1],z:qa[pa+2]}}};r["GameObject"]=function(ra){Object.defineProperty(ra,"name",{get:function(){if(!this._name){var sa=this._GetName(0);var ta=this._GetName(1);this._name=o["WASM"].GetString(ta,sa)}return this._name}});Object.defineProperty(ra,"transform",{get:function(){return p(this["_GetTransform"]())}});Object.defineProperty(ra,"mesh",{get:function(){return p(this["_GetMesh"]())},set:function(ua){this["_SetMesh"](ua.m_nObject)}});Object.defineProperty(ra,"children",{get:function(){var va=this;return new s(function(wa){return va._IterChild(wa)},true)}});Object.defineProperty(ra,"parent",{get:function(){return p(this["_GetParent"]())}});Object.defineProperty(ra,"data",{get:function(){return p(this["_GetUserData"]())},set:function(xa){}});Object.defineProperty(ra,"enableCollider",{set:function(ya){this["_EnableCollider"](ya)}});Object.defineProperty(ra,"active",{set:function(za){this["_Active"](za)}});Object.defineProperty(ra,"highlight",{set:function(Aa){this["_Highlight"](Aa)}});Object.defineProperty(ra,"transparent",{set:function(Ba){this["_Transparent"](Ba)}});ra["Destory"]=function(){this["_Destory"]()};o["GameObject"]=function(){return p(ra._GameObject())}};r["Miaokit"]=function(Ca){Ca["LoadTile"]=function(Da){var Ea=this["_Malloc"](Da.byteLength);if(Ea){o["WASM"]["HEAPU8"](Ea,Da.byteLength).set(new Uint8Array(Da));var Fa=this["_LoadTile"](Ea,Da.byteLength);var Ga=p(Fa);return Ga}return null};Ca["Analyze"]=function(Ha){var Ia=this["_Analyze"]();var Ja=o["WASM"].HEAP32()[Ia/4];var Ka=o["WASM"].GetString(Ia+4,Ja);try{var La=JSON.parse(Ka);var Ma=q(Ha).concat(La);return Ma}catch(Na){console.log(Ka)}return null};Ca["PickEntity"]=function(Oa){return p(this["_PickEntity"](Oa))};Ca["GetScene"]=function(Pa){return p(this["_GetScene"](Pa))};Ca["WorldToScreenPoint"]=function(Qa){var Ra=this["_WorldToScreenPoint"](Qa.x,Qa.y,Qa.z)/4;var Sa=o["WASM"].HEAPF32();return{x:Sa[Ra],y:Sa[Ra+1],z:Sa[Ra+2]}};Ca["ScreenPointToRay"]=function(Ta){var Ua=this["_ScreenPointToRay"](Ta.x,Ta.y,Ta.z)/4;var Va=o["WASM"].HEAPF32();return{m_mOrigin:{x:Va[Ua],y:Va[Ua+1],z:Va[Ua+2]},m_mDirection:{x:Va[Ua+4],y:Va[Ua+5],z:Va[Ua+6]}}};Object.defineProperty(Ca,"camera",{get:function(){return p(this["_GetCamera"]())}});Object.defineProperty(Ca,"cameraMode",{set:function(Wa){this["_SetCameraMode"](Wa)}});Object.defineProperty(Ca,"gis",{get:function(){if(!this._gis){this._gis=r["Gis"]["g_pIns"]}return this._gis}});Object.defineProperty(Ca,"progress",{get:function(){return this["_GetProgress"]()}})};r["Mesh"]=function(Xa){Xa["SetVertices"]=function(Ya,Za){this["m_aVertex"]=this["m_aVertex"]||[];this["m_aVertex"].push({m_pArray:Za,m_nSlot:this["_SlotLut"][Ya],m_nItemSize:this["_SizeLut"][Ya]})};Xa["SetIndices"]=function($a,_a,ab){this["m_aIndex"]=this["m_aIndex"]||[];this["m_aIndex"][$a]={m_pArray:_a,m_nItemSize:ab}};Xa["Apply"]=function(){var bb=this["m_aVertex"];var cb=this["m_aIndex"];if(!bb||!cb){return}var db=2+2*bb.length+3*cb.length;var eb=this._CreateBuffer(db);var fb=o["WASM"]["HEAP32"](eb,db*4);var gb=0;fb[gb++]=bb.length;fb[gb++]=cb.length;for(var hb=0;hb<bb.length;hb++){fb[gb++]=bb[hb].m_nSlot;fb[gb++]=bb[hb].m_pArray.length/bb[hb].m_nItemSize}for(var hb=0;hb<cb.length;hb++){fb[gb++]=0;fb[gb++]=0;fb[gb++]=cb[hb].m_pArray.length}this._CreateBuffer(0);for(var hb=0;hb<bb.length;hb++){var ib=bb[hb].m_pArray;var jb=this._GetVertexBuffer(hb);var kb=o["WASM"]["HEAPF32"](jb,ib.length*4);kb.set(ib)}for(var hb=0;hb<cb.length;hb++){var ib=cb[hb].m_pArray;var jb=this._GetIndexBuffer(hb);var kb=o["WASM"]["HEAP32"](jb,ib.length*4);kb.set(ib)}this._Apply();this["m_aVertex"]=undefined;this["m_aIndex"]=undefined};Xa["_SlotLut"]={position:0,normal:1,uv:2,color:3,tangent:4,uv2:9,uv3:10,uv4:11,uv5:12,uv6:13,uv7:14,uv8:15};Xa["_SizeLut"]={position:3,normal:3,uv:2,color:4,tangent:4,uv2:2,uv3:2,uv4:2,uv5:2,uv6:2,uv7:2,uv8:2};Object.defineProperty(Xa,"position",{set:function(lb){this.SetVertices("position",lb)}});Object.defineProperty(Xa,"normal",{set:function(mb){this.SetVertices("normal",mb)}});Object.defineProperty(Xa,"uv",{set:function(nb){this.SetVertices("uv",nb)}});Object.defineProperty(Xa,"triangles",{set:function(ob){this.SetIndices(0,ob)}});Object.defineProperty(Xa,"material",{set:function(pb){this.SetMaterial(0,pb)}});o["Mesh"]=function(){return p(Xa._Mesh())}};r["Texture2D"]=function(qb){qb["SetImageData"]=function(rb){var sb=this._CreateBuffer(rb.byteLength);if(sb){o["WASM"]["HEAPU8"](sb,rb.byteLength).set(new Uint8Array(rb));this._Apply()}};qb["Load"]=function(tb){var ub=this;o["Fetch"](tb,function(vb){if(vb){ub.SetImageData(vb)}})};o["Texture2D"]=function(wb){var xb=p(qb._Texture2D());if(wb){if("string"===typeof wb){this.Load(wb)}else{this.SetImageData(wb)}}return xb}};r["Material"]=function(yb){if("Sisyphus"===o["m_pConfig"]["ENGINE"]){o["ShaderLab"].ExpandMaterial(yb)}yb["GetTexture"]=function(){return p(this["_GetTexture"]())};yb["SetTexture"]=function(zb){this["_SetTexture"](zb.m_nObject)};o["Material"]=function(Ab){if(Ab===void 0){Ab=undefined}var Bb=null;if(Ab){var Cb=o["ShaderLab"]["Pipeline"]["InternalShader"];var Db=Cb[0];Cb[0]=Ab;Bb=p(yb._Material());Cb[0]=Db}else{Bb=p(yb._Material())}return Bb}};r["Tile"]=function(Eb){Object.defineProperty(Eb,"scenes",{get:function(){var Fb=this;return new s(function(Gb){return Fb._IterWork(Gb)})}})};r["Scene"]=function(Hb){Hb["GetLayer"]=function(Ib){return p(this["_GetLayer"](Ib))};Object.defineProperty(Hb,"id",{get:function(){if(!this._id){var Jb=this._GetID(0);var Kb=this._GetID(1);this._id=o["WASM"].GetString(Kb,Jb)}return this._id}});Object.defineProperty(Hb,"layers",{get:function(){var Lb=this;return new s(function(Mb){return Lb._IterLayer(Mb)})}});Object.defineProperty(Hb,"object3D",{get:function(){if(undefined===this._object3D){var Nb=this._GetObject(this.m_nObject);if(0===Nb){this._object3D=null;return null}this._object3D=p(Nb)}return this._object3D}});Object.defineProperty(Hb,"viewState",{get:function(){return{m_mTarget:{x:0,y:0,z:0},m_nPitch:45,m_nYaw:0,m_nDistance:60,m_mOrthoTarget:{x:0,y:0,z:0},m_nOrthoScaled:0,m_nOrthoRotate:0}}});Object.defineProperty(Hb,"binding",{get:function(){return p(this._GetBinding())}})};r["Layer"]=function(Ob){Object.defineProperty(Ob,"id",{get:function(){if(!this._id){var Pb=this._GetID(0);var Qb=this._GetID(1);this._id=o["WASM"].GetString(Qb,Pb)}return this._id}});Object.defineProperty(Ob,"sites",{get:function(){var Rb=this;return new s(function(Sb){return Rb._IterSite(Sb)})}});Object.defineProperty(Ob,"object3D",{get:function(){if(undefined===this._object3D){var Tb=this._GetObject(this.m_nObject);if(0===Tb){this._object3D=null;return null}this._object3D=p(Tb)}return this._object3D}});Object.defineProperty(Ob,"viewState",{get:function(){var Ub=this["_GetViewState"]();if(0<Ub){var Vb=o["WASM"]["HEAPF32"](Ub,4*11);var Wb=0;return{m_mTarget:{x:Vb[Wb++],y:Vb[Wb++],z:Vb[Wb++]},m_nPitch:Vb[Wb++],m_nYaw:Vb[Wb++],m_nDistance:Vb[Wb++],m_mOrthoTarget:{x:Vb[Wb++],y:Vb[Wb++],z:Vb[Wb++]},m_nOrthoScaled:Vb[Wb++],m_nOrthoRotate:Vb[Wb++]}}return null}})};r["Attachment"]=function(Xb){Object.defineProperty(Xb,"entityType",{get:function(){return this._GetEntityType()}});Object.defineProperty(Xb,"secondType",{get:function(){return this._GetSecondType()}});Object.defineProperty(Xb,"flag",{get:function(){return this._GetFlag()}});Object.defineProperty(Xb,"object3D",{get:function(){return p(this._GetObject())}});Object.defineProperty(Xb,"viewState",{get:function(){var Yb=this["_GetViewState"]();if(0<Yb){var Zb=o["WASM"]["HEAPF32"](Yb,4*11);var $b=0;var _b={m_mTarget:{x:Zb[$b++],y:Zb[$b++],z:Zb[$b++]},m_nPitch:Zb[$b++],m_nYaw:Zb[$b++],m_nDistance:Zb[$b++],m_mOrthoTarget:{x:Zb[$b++],y:Zb[$b++],z:Zb[$b++]},m_nOrthoScaled:Zb[$b++],m_nOrthoRotate:Zb[$b++]};console.log("attachment view:",_b);return _b}else{console.log("attachment view: null")}return null}})};r["Site"]=function(ac){Object.defineProperty(ac,"id",{get:function(){if(!this._id){var bc=this._GetID(0);var cc=this._GetID(1);this._id=o["WASM"].GetString(cc,bc)}return this._id}});Object.defineProperty(ac,"layer",{get:function(){return p(this["_Layer"]())}});Object.defineProperty(ac,"scene",{get:function(){return p(this["_Scene"]())}});Object.defineProperty(ac,"type",{get:function(){return this["_Type"]()}});Object.defineProperty(ac,"number",{get:function(){return this["_Number"]()}});Object.defineProperty(ac,"position",{get:function(){var dc=this["_Position"]()/4;var ec=o["WASM"].HEAPF32();return{x:ec[dc],y:ec[dc+1],z:ec[dc+2]}}})};r["Prefab"]=function(fc){fc["Instantiate"]=function(){return p(this["_Instantiate"]())};o["LoadPrefab"]=function(gc,hc){o["Fetch"](gc,function(ic){var jc=null;if(ic){var kc=fc._Prefab();var lc=p(kc);var mc=lc.CreateBuffer(ic.byteLength);if(mc){o["WASM"]["HEAPU8"](mc,ic.byteLength).set(new Uint8Array(ic));lc.Apply();jc=lc}}hc(jc)})}};r["Gis"]=function(nc){nc["Update"]=function(oc,pc,qc){return this["_Update"](oc,pc,qc)};nc["AddSvetile"]=function(rc){var sc=o["WASM"]["EncodeString"](rc.m_pUrl);var tc=this["_CreateSvetileDesc"](sc.byteLength);var uc=o["WASM"]["HEAPU32"](tc,4*8);uc[0]=rc.m_nID;uc[1]=rc.m_nFlags;o["WASM"]["HEAPU8"](uc[2],sc.byteLength).set(sc,0);uc[3]=0;uc[4]=o["WASM"]["RegisterDelegate"](function(wc,xc){rc.OnActive(p(wc),0<xc)});var vc=o["WASM"]["HEAPF32"](tc+20,16);vc[0]=rc.m_mLngLat.x;vc[1]=rc.m_mLngLat.y;vc[2]=rc.m_mSize.x;vc[3]=rc.m_mSize.y;this["_AddSvetile"](tc)};nc["AddMapbox"]=function(yc){var zc=this["_GetMapboxDesc"]();var Ac=o["WASM"]["HEAPF32"](zc,40);Ac[0]=yc.m_mOffset.x;Ac[1]=yc.m_mOffset.y;Ac[2]=yc.m_mOffset.z;Ac[3]=yc.m_mScale.x;Ac[4]=yc.m_mScale.y;Ac[5]=yc.m_mScale.z;Ac[6]=yc.m_mLngLat.x;Ac[7]=yc.m_mLngLat.y;Ac[8]=yc.m_mSize.x;Ac[9]=yc.m_mSize.y;this["_AddMapbox"](zc)};nc["AddGameObject"]=function(Bc,Cc,Dc){this["_AddGameObject"](Bc.m_nObject,Cc,Dc)};Object.defineProperty(nc,"imageServer",{set:function(Ec){if(!Ec){Ec="http://t%d.tianditu.gov.cn/DataServer?T=vec_c&tk=fb14b0853d59b619e18c259898bd0d4d&x=%d&y=%d&l=%d"}var Fc=this["_GetServer"](0);o["WASM"].SetString(Fc,Ec)}});Object.defineProperty(nc,"terrainServer",{set:function(Gc){if(!Gc){Gc="https://t%d.tianditu.gov.cn/dem_sjk/DataServer?T=ele_c&tk=fb14b0853d59b619e18c259898bd0d4d&x=%d&y=%d&l=%d"}var Hc=this["_GetServer"](1);o["WASM"].SetString(Hc,Gc)}})};r["Dioramas3MX"]=function(Ic){Ic["_Load3MX"]=function(Jc,Kc,Lc){var Mc=this;var Nc=Mc.m_pFileLut[Jc];var Oc=Nc.m_pPath+Nc.m_aFile[Kc];o["Request"]("GET","arraybuffer",Oc,null,null,function(Pc){if(!Pc){return}var Qc=new Uint32Array(Pc,0,2);if(1113083187===Qc[0]){var Rc=Qc[1]>>8;var Sc=9+Rc;var Tc=Pc.byteLength-Sc;var Uc=new Uint8Array(Pc,9,Rc);var Vc=Mc.m_pTextDecoder.decode(Uc);var Wc=JSON.parse(Vc);var Xc={m_pPath:Oc.substring(0,Oc.lastIndexOf("/")+1),m_aFile:[]};var Yc=[];var Zc=[];var $c=Wc.resources;var _c=0;for(var ad=0;ad<$c.length;ad++){Yc.push(ad);if("textureBuffer"===$c[ad].type){Yc.push(0);Zc.push(ad);if("jpg"===$c[ad].format){Yc.push(0)}else if("png"===$c[ad].format){Yc.push(1)}else{Yc.push(1e4)}}else if("geometryBuffer"===$c[ad].type){Yc.push(1);if("ctm"===$c[ad].format){Yc.push(0)}else{Yc.push(1e4)}}else{Yc.push(1e4);Yc.push(1e4)}Yc.push($c[ad].size);Yc.push(_c);_c+=$c[ad].size;Yc.push(1e4);if($c[ad].texture){for(var bd=0;bd<$c.length;bd++){if($c[ad].texture===$c[bd].id){Yc[Yc.length-1]=bd;break}}}}var cd=[];var dd=Wc.nodes;for(var ad=0;ad<dd.length;ad++){var ed=dd[ad];var fd=ed.bbMax[0]-ed.bbMin[0];var gd=ed.bbMax[1]-ed.bbMin[1];var hd=ed.bbMax[2]-ed.bbMin[2];var id=Math.sqrt(fd*fd+gd*gd+hd*hd);cd.push(Math.floor(parseInt(ed.bbMin[0]+ed.bbMax[0])*.5*100));cd.push(Math.floor(parseInt(ed.bbMin[1]+ed.bbMax[1])*.5*100));cd.push(Math.floor(parseInt(ed.bbMin[2]+ed.bbMax[2])*.5*100));cd.push(Math.floor(id*100));cd.push(Math.floor(ed.maxScreenDiameter));var jd=ed.children?ed.children.length:0;if(0<jd){cd.push(Xc.m_aFile.length);for(var bd=0;bd<jd;bd++){Xc.m_aFile.push(ed.children[bd])}cd.push(Xc.m_aFile.length)}else{cd.push(-1);cd.push(-1)}var kd=ed.resources?ed.resources.length:0;if(0<kd){cd.push(Zc.length);for(var bd=0;bd<kd;bd++){for(var ld=0;ld<$c.length;ld++){if(ed.resources[bd]===$c[ld].id){Zc.push(ld);break}}}cd.push(Zc.length)}else{cd.push(-1);cd.push(-1)}}var md=4+9*dd.length+6*Zc.length;var nd=4*md;var od=nd+Tc;var pd=Mc["_CreateBuffer"](od);if(pd){var qd=o["WASM"]["HEAP32"](pd,nd);qd[0]=nd;qd[1]=dd.length;qd[2]=Zc.length;qd[3]=Mc.m_pFileLut.length;qd.set(cd,4);var rd=4+cd.length;for(var ad=0;ad<Zc.length;ad++){var sd=6*Zc[ad];for(var bd=0;bd<6;bd++){qd[rd++]=Yc[sd++]}}var td=o["WASM"]["HEAPU8"](pd+nd,Tc);td.set(new Uint8Array(Pc,Sc,Tc));Mc["_Dispose"](Lc)}Mc.m_pFileLut.push(Xc)}})};Ic["Update"]=function(){return this["_Update"]()};Object.defineProperty(Ic,"object3D",{get:function(){return p(this["_GetObject"]())}});o["Dioramas3MX"]=function(ud,vd){var wd=p(Ic._Dioramas3MX());wd.m_pFileLut=[];wd.m_pTextDecoder=new TextDecoder("utf-8");if(vd){if(vd.m_pGis){vd.m_pGis.AddGameObject(wd.object3D,vd.m_mLngLat.x,vd.m_mLngLat.y);wd.object3D.transform.Translate(vd.m_mOffset,1);wd.object3D.transform.Rotate({x:0,y:0,z:0},1)}}o["Request"]("GET","json",ud,null,null,function(xd){wd["m_pMeta"]=xd;var yd={m_pPath:ud.substring(0,ud.lastIndexOf("/")+1),m_aFile:[]};var zd=[0];for(var Ad=0;Ad<xd.layers.length;Ad++){if("meshPyramid"===xd.layers[Ad].type){zd.push(Ad);zd.push(yd.m_aFile.length);yd.m_aFile.push(xd.layers[Ad].root)}}zd[0]=yd.m_aFile.length;var Bd=wd["_CreateBuffer"](4*zd.length);var Cd=o["WASM"]["HEAP32"](Bd,4*zd.length);Cd.set(zd);wd["_Initialize"](Bd);wd.m_pFileLut.push(yd)});return wd}};function t(Dd,Ed,Fd){p=Ed;q=Fd;for(var Gd=0,Hd=Dd;Gd<Hd.length;Gd++){var Id=Hd[Gd];if(Id){var Jd=Id.prototype;if(r[Jd._type_name]){r[Jd._type_name](Jd)}if("Miaokit"===Jd._type_name){o["Miaokit"]=new Id(0,0)}else if("Gis"===Jd._type_name){r["Gis"]["g_pIns"]=new Id(0,0)}}}}o["WASM"]=o["WASM"]||{};o["WASM"]["LoadClass"]=t;return[]});MiaokitMerge(function(Kd){Kd["m_pLogo"]=null;var Ld=undefined;var Md=false;var Nd=false;function Od(){Kd["Track"]("Preload");Kd["Request"]("GET","json",Kd["m_pConfigPath"],null,null,function(Rd){if(!Rd){Kd["Track"]("�����ļ�����",3);return}Kd["m_pConfig"]=Rd;Kd["Fetch"](Rd.MODULE,function(Ud){if(Ld){Ld(Ud)}else{Ld=Ud}});if(Rd.SVE){var Sd=function(Vd){var Wd=Rd.SVE[Vd];Wd.m_pData=null;Wd.m_pTile=null;if(true===Wd.m_bPreload){Kd["Fetch"](Wd.m_pProject,function(Xd){Wd.m_pData=Xd;if(Nd&&Xd){Wd.m_pTile=Kd["Miaokit"]["LoadTile"](Wd.m_pData);Wd.m_pData=null;Kd["App"]["ActiveTile"](Wd)}})}};for(var Td=0;Td<Rd.SVE.length;Td++){Sd(Td)}}if(Kd["App"]&&Kd["App"].m_pProject){Kd["App"]["Preload"]()}else{Md=true}})}function Pd(Yd,Zd){Kd["Track"]("LoadEngine");if(Md){Kd["App"]["Preload"]();Md=false}Kd["WASM"]["LoadEngine"]({OnEngineLoad:function($d){Kd["Track"]("LoadEngine End");if(Ld){Kd["Track"]("LoadMiaokit");Kd["WASM"]["LoadMiaokit"](Ld,$d,function(){Yd();Nd=true;Qd()})}else{Kd["Track"]("LoadMiaokit Delay");Ld=function(_d){Kd["Track"]("LoadMiaokit");Kd["WASM"]["LoadMiaokit"](_d,$d,function(){Yd();Nd=true;Qd()})}}},OnRenderingEvent:function(ae){if(Nd){Zd(ae)}}})}function Qd(){Kd["Track"]("LoadMiaokit End");var be=Kd["m_pConfig"]["SVE"];if(be){for(var ce=0,de=be;ce<de.length;ce++){var ee=de[ce];if(true===ee.m_bPreload){if(null===ee.m_pTile&&null!==ee.m_pData){ee.m_pTile=Kd["Miaokit"]["LoadTile"](ee.m_pData);ee.m_pData=null;Kd["App"]["ActiveTile"](ee)}}}}}Od["_name"]="Preload";Pd["_name"]="Load";return[Od,Pd]});MiaokitMerge(function(fe){var ge=function(){function ie(){}ie.Clamp=function(je,ke,le){if(je>le){return le}if(je<ke){return ke}return je};return ie}();var he=function(){function me(ne,oe,pe){this.x=0;this.y=0;this.z=0;this.x=ne;this.y=oe;this.z=pe}me.Scale=function(qe,re){return{x:re.x*qe,y:re.y*qe,z:re.z*qe}};return me}();ge["_name"]="Mathf";he["_name"]="Vector3";return[ge,he]});MiaokitMerge(function(se){var te=null;var ue=null;var ve=null;var we=[null];var xe=[null];var ye=[null];var ze=1;var Ae=0;var Be=[undefined];var Ce=null;function De(Oe){Oe["isnanf"]=isNaN;Oe["isinff"]=isFinite;Oe["powf"]=Math.pow;Oe["sqrtf"]=Math.sqrt;Oe["expf"]=Math.exp;Oe["logf"]=Math.log;Oe["floorf"]=Math.floor;Oe["ceilf"]=Math.ceil;Oe["sinf"]=Math.sin;Oe["cosf"]=Math.cos;Oe["tanf"]=Math.tan;Oe["asinf"]=Math.asin;Oe["acosf"]=Math.acos;Oe["atanf"]=Math.atan;Oe["atan2f"]=Math.atan2;Oe["ldexpf"]=function(Pe,Qe){return Pe*Math.pow(2,Qe)}}function Ee(Re){var Se=se["GL"];var Te=Se.Ctx.getParameter(34047);Re["glTexImage2DExt"]=function(Ue,Ve){var We=xe[Ve];if(We){Se.Ctx.texParameterf(Ue,34046,Te);Se.Ctx.texImage2D(Ue,0,Se.Ctx.RGB,Se.Ctx.RGB,Se.Ctx.UNSIGNED_BYTE,We);xe[Ve]=null}};Re["glCreateShader"]=Se._glCreateShader;Re["glDeleteShader"]=Se._glDeleteShader;Re["glShaderSource"]=Se._glShaderSource;Re["glCompileShader"]=Se._glCompileShader;Re["glGetShaderiv"]=Se._glGetShaderiv;Re["glGetShaderInfoLog"]=Se._glGetShaderInfoLog;Re["glCreateProgram"]=Se._glCreateProgram;Re["glDeleteProgram"]=Se._glDeleteProgram;Re["glAttachShader"]=Se._glAttachShader;Re["glLinkProgram"]=Se._glLinkProgram;Re["glUseProgram"]=Se._glUseProgram;Re["glGetProgramiv"]=Se._glGetProgramiv;Re["glGetProgramInfoLog"]=Se._glGetProgramInfoLog;Re["glBindAttribLocation"]=Se._glBindAttribLocation;Re["glGenVertexArrays"]=Se._glGenVertexArrays;Re["glDeleteVertexArrays"]=Se._glDeleteVertexArrays;Re["glBindVertexArray"]=Se._glBindVertexArray;Re["glVertexAttribPointer"]=Se._glVertexAttribPointer;Re["glEnableVertexAttribArray"]=Se._glEnableVertexAttribArray;Re["glGetActiveUniform"]=Se._glGetActiveUniform;Re["glGetUniformLocation"]=Se._glGetUniformLocation;Re["glUniform1i"]=Se._glUniform1i;Re["glUniform1fv"]=Se._glUniform1fv;Re["glUniform2fv"]=Se._glUniform2fv;Re["glUniform3fv"]=Se._glUniform3fv;Re["glUniform4fv"]=Se._glUniform4fv;Re["glUniform1iv"]=Se._glUniform1iv;Re["glUniform2iv"]=Se._glUniform2iv;Re["glUniform3iv"]=Se._glUniform3iv;Re["glUniform4iv"]=Se._glUniform4iv;Re["glUniformMatrix3fv"]=Se._glUniformMatrix3fv;Re["glUniformMatrix4fv"]=Se._glUniformMatrix4fv;Re["glGenTextures"]=Se._glGenTextures;Re["glDeleteTextures"]=Se._glDeleteTextures;Re["glActiveTexture"]=Se._glActiveTexture;Re["glBindTexture"]=Se._glBindTexture;Re["glTexStorage2D"]=Se._glTexStorage2D;Re["glTexParameteri"]=Se._glTexParameteri;Re["glTexImage2D"]=Se._glTexImage2D;Re["glGenerateMipmap"]=Se._glGenerateMipmap;Re["glGenBuffers"]=Se._glGenBuffers;Re["glDeleteBuffers"]=Se._glDeleteBuffers;Re["glBindBuffer"]=Se._glBindBuffer;Re["glBufferData"]=Se._glBufferData;Re["glMapBufferRange"]=Se._glMapBufferRange;Re["glUnmapBuffer"]=Se._glUnmapBuffer;Re["glGenFramebuffers"]=Se._glGenFramebuffers;Re["glDeleteFramebuffers"]=Se._glDeleteFramebuffers;Re["glBindFramebuffer"]=Se._glBindFramebuffer;Re["glFramebufferTexture2D"]=Se._glFramebufferTexture2D;Re["glCheckFramebufferStatus"]=Se._glCheckFramebufferStatus;Re["glClearColor"]=Se._glClearColor;Re["glClear"]=Se._glClear;Re["glBlendFuncSeparate"]=Se._glBlendFuncSeparate;Re["glBlendEquationSeparate"]=Se._glBlendEquationSeparate;Re["glEnable"]=Se._glEnable;Re["glDisable"]=Se._glDisable;Re["glDepthFunc"]=Se._glDepthFunc;Re["glDepthMask"]=Se._glDepthMask;Re["glClearDepthf"]=Se._glClearDepthf;Re["glClearStencil"]=Se._glClearStencil;Re["glCullFace"]=Se._glCullFace;Re["glPolygonOffset"]=Se._glPolygonOffset;Re["glViewport"]=Se._glViewport;Re["glDrawArrays"]=Se._glDrawArrays;Re["glDrawArraysInstanced"]=Se._glDrawArraysInstanced;Re["glDrawElements"]=Se._glDrawElements;Re["glDrawElementsInstanced"]=Se._glDrawElementsInstanced;Re["glFlush"]=Se._glFlush;Re["glFinish"]=Se._glFinish}function Fe(Xe){function Ye(ff){var gf=se["WASM"].GetString(ff);if(!gf.startsWith("http")){gf="./data/projects/sve/"+gf}if(gf.endsWith("assetbundle")){gf+=".bin"}return gf}function Ze(hf,jf,kf,lf){var mf=Ye(hf);var nf=te.get(kf);var of=te.get(lf);se["Fetch"](mf,function(pf){if(pf){var qf=nf(jf,pf.byteLength);if(qf){se["WASM"]["HEAPU8"](qf,pf.byteLength).set(new Uint8Array(pf))}}else{console.error("资源丢失:",mf)}of(jf)})}function $e(rf,sf,tf){var uf=Ye(rf);var vf=te.get(tf);var wf=new Image;wf.crossOrigin="anonymous";wf.src=uf;wf.onload=function(xf){vf(sf,xe.push(wf)-1)}}function _e(yf,zf,Af,Bf){Ze(yf,zf,Af,Bf)}function af(Cf,Df,Ef,Ff){Ce["LoadTerrain"](Cf,Df,Ef,Ff)}function bf(Gf,Hf,If,Jf){var Kf=se["WASM"]["HEAP32"](Gf,16);Ce["LoadBlockbox"](Hf,Kf[0],Kf[1],Kf[2],Kf[3],If,Jf)}function cf(Lf,Mf){var Nf=se["WASM"]["HEAP32"](Lf,12);var Of=Ie(Nf[0]);if(Of){Of["_Load3MX"](Nf[1],Nf[2],Mf)}}function df(Pf,Qf,Rf,Sf){Ze(Pf,Qf,Rf,Sf)}var ef=[undefined,Ze,$e,_e,af,bf,cf,df];Xe["APP_LOAD"]=function(Tf,Uf,Vf,Wf,Xf){ef[Tf](Uf,Vf,Wf,Xf)}}function Ge(Yf){var Zf={NaN:NaN,Infinity:Infinity};De(Yf);Ee(Yf);Fe(Yf);Yf["APP_DYNAMIC_LINK"]=function($f,_f){var ag=se["WASM"]["HEAPU32"]($f,_f);var bg=ag[0];var cg=ag[1];for(var dg=0;dg<bg;dg++){var eg=ag[2+dg]-1;var fg=ag[cg++];var gg=ag[cg++];var hg=se["WASM"].GetString(fg,gg);var ig=JSON.parse(hg);var jg=function(ng,og){this["m_nID"]=ng;this["m_nObject"]=og};var kg=jg.prototype;kg["_type_name"]=ig[0];kg["_type_id"]=dg+1;kg["_ins_count"]=0;Be[dg+1]=jg;var lg=function(pg){var qg=te.get(ag[cg++]);cg++;var rg=function(){var sg=Array.prototype.slice.call(arguments);sg.unshift(this.m_nObject);return qg.apply(this,sg)};if(0===pg){kg["_"+ig[pg]]=rg}else{kg[ig[pg]]=rg}};for(var mg=0;mg<eg;mg++){lg(mg)}}se["WASM"]["LoadClass"](Be,Ie,Le);se["Miaokit"]["ResizeCavans"]=function(tg,ug){if(ve.SE_RESIZE){ve.SE_RESIZE(tg,ug)}}};Yf["APP_PRINT"]=function(vg,wg,xg){var yg=se["WASM"].GetString(vg,wg);se["Track"](yg,xg)};Yf["APP_DO_ACTION"]=function(zg,Ag,Bg,Cg){we[zg](Ag,Bg,Cg)};Yf["APP_CREATE_OBJ"]=function(Dg,Eg){if(0<Dg){var Fg=Je();var Gg=new Be[Dg](Fg,Eg);ye[Fg]=Gg;Be[Dg].prototype._ins_count++;return Fg}else{if(-21==Dg){var Hg=se["WASM"]["HEAP32"](Eg,16);var Ig=Hg[0];var Jg=Hg[1];var Kg=Hg[2];var Lg=Hg[3];var Mg=se["WASM"]["HEAP8"](Kg,Jg);var Ng=new Blob([Mg]);var Og=window.URL.createObjectURL(Ng);var Pg=te.get(Lg);var Qg=new Image;Qg.src=Og;Qg.onload=function(Rg){Pg(Ig,xe.push(Qg)-1);window.URL.revokeObjectURL(Og)}}}return 0};Yf["APP_FREE_OBJ"]=function(Sg){var Tg=ye[Sg];Be[Tg._type_id].prototype._ins_count--;Ke(Sg)};Yf["APP_DO"]=se["ShaderLab"].OperateMaterial;ue=Yf["memory"];se["WASM"]["m_pMemory"]=se["WASM"]["m_pMemory"]||ue;return{env:Yf,global:Zf}}function He(Ug,Vg,Wg){Vg=Ge(Vg);WebAssembly.instantiate(Ug,Vg).then(function(Xg){return Xg.instance}).then(function(Yg){ve=Yg.exports;te=ve.__indirect_function_table;se["WASM"]["Update"]=Yg.exports.SE_UPDATE;se["WASM"]["Malloc"]=Yg.exports.Malloc;se["WASM"]["Free"]=Yg.exports.Free;se["ShaderLab"]["DrawPass_"]=Yg.exports.SE_DRAW_PASS;se["ShaderLab"]["SetSunlight"]=Yg.exports.SE_SUNLIGHT;se["ShaderLab"]["CreateUniformsDesc"]=Yg.exports.SE_CREATE_UNIFORMS_DESC;se["ShaderLab"]["GetTexture"]=function(Zg){return ve.SE_RESOURCE(9,Zg)};se["ShaderLab"]["GetObject"]=function($g){var _g=ve.SE_RESOURCE(13,$g);if(_g){return Ie(_g)}return null};se["Track"]("Start thread");se["WASM"]["Worker"]=Ne(function(){se["Track"]("Start thread succeed")});ve.Start();Wg()})}function Ie(ah){return ye[ah]}function Je(){var bh=ze;if(ye.length>ze){ze=ye[ze]}else{ze++}Ae++;return bh}function Ke(ch){ye[ch]=ze;ze=ch;Ae--}function Le(dh){var eh="'系统运行':{";eh+="'时间':"+(se.Time()/1e3).toFixed(0);eh+=", '帧率':"+dh;eh+=", 'WASM内存':"+se.WASM.m_pMemory.buffer.byteLength/1024/1024;eh+="}";var fh="'JS对象':{";fh+="'工厂':["+ye.length+", "+Ae+", "+(ye.length-Ae)+"]";for(var gh=1;gh<Be.length;gh++){fh+=", '"+Be[gh].prototype._type_name+"':"+Be[gh].prototype._ins_count}fh+="}";return[eh,fh]}function Me(hh){var ih=we.length;we.push(hh);return ih}function Ne(jh){var kh=ve.UTIL_WORKER_CODE();var lh=se["WASM"]["HEAPU32"](kh,16);if(false){Ce=new Worker(window.URL.createObjectURL(new Blob([se["WASM"]["HEAPU8"](lh[2],lh[3])])));var mh=se["WASM"]["HEAPU8"]().slice(lh[0],lh[0]+lh[1]);var nh=mh.buffer;Ce.postMessage({m_nID:1,m_aCode:nh},[nh])}else{var oh=se["m_pConfig"]["MODULE"].replace(".wasm","");Ce=new Worker(oh+"Worker.min.js");fetch(oh+"Worker.wasm").then(function(ph){return ph.arrayBuffer()}).then(function(qh){if(qh){Ce.postMessage({m_nID:1,m_aCode:qh},[qh])}else{console.error("fetch error: ./js/Miaokit/MiaokitWorker.wasm",qh)}}).catch(function(rh){console.error("fetch error: ./js/Miaokit/MiaokitWorker.wasm",rh)})}Ce.onmessage=function(sh){var th=sh.data;switch(th.m_nID){case 1:jh();jh=null;break;case 2:Ce["OnLoadTerrain"](th);break;case 3:Ce["OnLoadBlockbox"](th);break;default:console.error("子线程消息异常:",th);break}};Ce["LoadTerrain"]=function(uh,vh,wh,xh){Ce.postMessage({m_nID:2,m_pPath:se["WASM"].GetString(uh),m_nRequest:vh,m_nAlloc:wh,m_nCallback:xh})};Ce["OnLoadTerrain"]=function(yh){var zh=te.get(yh.m_nAlloc);var Ah=te.get(yh.m_nCallback);var Bh=yh.m_pData;if(Bh){var Ch=zh(yh.m_nRequest,Bh.byteLength);if(Ch){se["WASM"]["HEAPU8"](Ch,Bh.byteLength).set(new Uint8Array(Bh))}}else{console.warn("Terrain miss:",yh.m_pPath)}Ah(yh.m_nRequest)};Ce["LoadBlockbox"]=function Dh(Eh,Fh,Gh,Hh,Ih,Jh,Kh){Ce.postMessage({m_nID:3,m_nRequest:Eh,m_nCol:Fh,m_nRow:Gh,m_nColOffset:Hh,m_nRowOffset:Ih,m_nAlloc:Jh,m_nCallback:Kh})};Ce["OnLoadBlockbox"]=function(Lh){var Mh=te.get(Lh.m_nAlloc);var Nh=te.get(Lh.m_nCallback);var Oh=Lh.m_pData;var Ph=[0,0,0,0];for(var Qh=0;Qh<4;Qh++){var Rh=Oh[Qh];if(0<Rh.m_nVertexCount&&0<Rh.m_nSubmeshCount){var Sh=new se.Mesh;var Th=new Int32Array(Rh.m_aIndex);Sh.position=new Float32Array(Rh.m_aPosition);Sh.normal=new Float32Array(Rh.m_aNormal);Sh.uv=new Float32Array(Rh.m_aUV);for(var Uh=0;Uh<Rh.m_nSubmeshCount;Uh++){var Vh=Th[2*Uh];var Wh=Th[2*Uh+1];var Xh=[];for(var Yh=Vh;Yh<Wh;Yh++){Xh.push(Yh)}Sh.SetIndices(Uh,new Int32Array(Xh),4)}Sh.Apply();Ph[Qh]=Sh.m_nObject}else{Ph[Qh]=0}}var Zh=Mh(Lh.m_nRequest,16);if(Zh){se["WASM"]["HEAPU32"](Zh,16).set(new Uint32Array(Ph));Nh(Lh.m_nRequest)}};return Ce}se["WASM"]=se["WASM"]||{};se["WASM"]["LoadMiaokit"]=He;se["WASM"]["GetObject"]=Ie;se["WASM"]["RegisterDelegate"]=Me;return[]});MiaokitMerge(function($h){var _h=undefined;var ai={};var bi=[];var ci={RGBA32_FLOAT:function(){return[_h.RGBA,_h.RGBA,_h.FLOAT]},RGBA16_FLOAT:function(){return[_h.RGBA,_h.RGBA,36193]},RGBA8:function(){return[_h.RGBA,_h.RGBA,_h.UNSIGNED_BYTE]},D16_UNORM:function(){return[_h.DEPTH_COMPONENT,_h.DEPTH_COMPONENT,_h.UNSIGNED_SHORT]},D24_UNORM:function(){return[_h.DEPTH_COMPONENT,_h.DEPTH_COMPONENT,_h.UNSIGNED_INT]},D24S8_UNORM:function(){return[_h.DEPTH_STENCIL,_h.DEPTH_STENCIL,34042]}};var di={Opaque:1,Transparent:2,Outline:4,CastShadow:8,ReceiveShadow:16};var ei=null;var fi=["u_Object","u_Color","u_EyePos","u_MatW","u_MatVP","u_MatWVP","u_MainTex","u_Sunlight","u_Picker"];var gi=[null];var hi=[null];var ii=[null];var ji=[null];var ki=[new Int32Array([0,0,0,0]),new Float32Array([0,0,0,0]),new Float32Array([1,0,0,0,1,0,0,0,1]),new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),new Int32Array([0,0,0,0]),new Int32Array([0,0,0,0])];var li=[function(Hi,Ii,Ji){_h.uniform4iv(gi[Hi],ji[Ii])},function(Ki,Li,Mi){_h.uniform4fv(gi[Ki],ji[Li])},function(Ni,Oi,Pi){_h.uniformMatrix3fv(gi[Ni],false,ji[Oi])},function(Qi,Ri,Si){_h.uniformMatrix4fv(gi[Qi],false,ji[Ri])},function(Ti,Ui,Vi){var Wi=ji[Ui];var Xi=Wi[1];if(Wi[0]){Xi=Fi.GetTexture(Xi);if(Xi){Wi[0]=0;Wi[1]=Xi}}_h.uniform1i(gi[Ti],Vi);_h.activeTexture(33984+Vi);_h.bindTexture(3553,bi[Xi])},function(Yi,Zi){console.error("Unsupported UniformCubemap!")}];var mi=[null];var ni=[null];var oi=[function($i){var _i=$h["ShaderLab"]["Pipeline"]["InternalShader"][$i];var aj=yi(_i);return aj.id},vi,function(bj,cj,dj,ej){li[bj](cj,dj,ej);return 0},function(fj,gj,hj,ij){var jj=$h["WASM"].GetString(ij);var kj=ji[fj];var lj=ii[kj[19]];var mj=lj[jj];return undefined===mj?0:mj},function(nj,oj){ni[oj][1]();return 0},function(){Fi.Draw()},zi];var pi=1280;var qi=720;var ri=0;var si=null;var ti=new Float32Array(4);var ui=[0,0,0,0];function vi(pj,qj,rj,sj){var tj=null;switch(qj){case 0:tj=new Int32Array(ei,sj,4);tj.set(ki[0]);break;case 1:tj=new Float32Array(ei,sj,4);tj.set(ki[1]);break;case 2:tj=new Float32Array(ei,sj,9);tj.set(ki[2]);break;case 3:tj=new Float32Array(ei,sj,16);tj.set(ki[3]);break;case 4:tj=new Int32Array(ei,sj,4);tj.set(ki[4]);break;case 5:tj=new Int32Array(ei,sj,4);tj.set(ki[5]);break;case 6:tj=new Int32Array(ei,sj,rj);break;default:console.error("Unsupported uniform type:",qj);break}ji[pj]=tj;return pj}function wi(uj,vj){var wj=_h.createShader(uj);if(!wj){console.error("Could not create shader object!");return null}_h.shaderSource(wj,vj);_h.compileShader(wj);if(!_h.getShaderParameter(wj,_h.COMPILE_STATUS)){var xj=_h.getShaderInfoLog(wj);_h.deleteShader(wj);console.error("Could not compile shader! \n\n"+xj);return null}return wj}function xi(yj){var zj=yj.program;var Aj=0;{_h.bindAttribLocation(zj,0,"a_Position");_h.bindAttribLocation(zj,1,"a_Normal");_h.bindAttribLocation(zj,2,"a_UV");_h.bindAttribLocation(zj,3,"a_Color");_h.bindAttribLocation(zj,4,"a_Tangent");_h.bindAttribLocation(zj,5,"a_Binormal");_h.bindAttribLocation(zj,9,"a_UV2")}{_h.linkProgram(zj);if(!_h.getProgramParameter(zj,_h.LINK_STATUS)){var Bj=_h.getProgramInfoLog(zj);console.error("Could not compile program! \n\n"+Bj);return 0}}{var Cj=_h.getProgramParameter(zj,35718);var Dj=Fi.CreateUniformsDesc(Cj);var Ej=ji[Dj];var Fj={};var Gj=0;Ej[19]=ii.push(Fj)-1;mi[Ej[19]]=yj;for(var Hj=0;Hj<2;Hj++){for(var Ij=0;Ij<Cj;Ij++){var Bj=_h.getActiveUniform(zj,Ij);var Jj=Bj.type;if(35678===Jj||35680===Jj){if(0!==Hj){continue}}else{if(1!==Hj){continue}}var Kj=Bj.name;var Lj=_h.getUniformLocation(zj,Kj);var Mj=gi.push(Lj)-1;for(var Nj=0;Nj<fi.length;Nj++){if(Kj===fi[Nj]){Ej[Nj]=Gj;break}}switch(Jj){case 35669:Jj=0;break;case 35666:Jj=1;break;case 35675:Jj=2;break;case 35676:Jj=3;break;case 35678:Jj=4;break;case 35680:Jj=5;break;default:console.error("Unsupported uniform type:",Bj);break}Ej[20+Gj]=Mj;Ej[20+Cj+Gj]=Jj;Fj[Kj]=Gj;hi[Mj]=Kj;Gj++}}Aj=Ej[16]}{var Oj=0;if(yj.mark){for(var Pj=0,Qj=yj.mark;Pj<Qj.length;Pj++){var Rj=Qj[Pj];Oj|=di[Rj]}}yj.mode=Oj}return Aj}function yi(Sj){if(!Sj){return null}var Tj=ai[Sj];if(!Tj){console.error("Could not find shader:",Sj);return null}if(Tj.program){return Tj}Tj.vs=wi(_h.VERTEX_SHADER,ai["Common"]["DeclareVS"]+Tj.vs_src+ai["Common"][Tj.type+"VS"]);if(!Tj.vs){console.error("Could not create vertex shader:",Sj);return null}Tj.fs=wi(_h.FRAGMENT_SHADER,ai["Common"]["DeclareFS"]+Tj.fs_src+ai["Common"][Tj.type+"FS"]);if(!Tj.fs){_h.deleteShader(Tj.vs);Tj.vs=null;console.error("Could not create fragment shader:",Sj);return null}Tj.program=_h.createProgram();if(!Tj.program){_h.deleteShader(Tj.vs);_h.deleteShader(Tj.fs);Tj.vs=null;Tj.fs=null;console.error("Could not create program object!");return null}_h.attachShader(Tj.program,Tj.vs);_h.attachShader(Tj.program,Tj.fs);Tj.id=xi(Tj);if(!Tj.id){_h.deleteProgram(Tj.program);_h.deleteShader(Tj.vs);_h.deleteShader(Tj.fs);Tj.program=null;Tj.vs=null;Tj.fs=null}return Tj}function zi(Uj,Vj){var Wj=undefined;var Xj=undefined;var Yj=undefined;var Zj=undefined;var $j=0;function _j(){var jk=ji[Uj];var kk=ji[Vj];var lk=mi[jk[19]];var mk=jk[20];var nk=20+jk[17];Wj=lk.program;Xj=ii[jk[19]];Yj=jk;Zj=[];$j=jk[17];var ok=function(xk){var yk=xk;var zk=ji[kk[yk]];var Ak=gi[mk+yk];var Bk=jk[nk+yk];var Ck=[function(){return zk},function(Dk){zk.set(Dk)},undefined];switch(Bk){case 0:Ck[2]=function(){_h.uniform4iv(Ak,zk)};break;case 1:Ck[2]=function(){_h.uniform4fv(Ak,zk)};break;case 2:Ck[2]=function(){_h.uniformMatrix3fv(Ak,false,zk)};break;case 3:Ck[2]=function(){_h.uniformMatrix4fv(Ak,false,zk)};break;case 4:Ck[2]=function(){var Ek=zk[1];if(zk[0]){Ek=Fi.GetTexture(Ek);if(Ek){zk[0]=0;zk[1]=Ek}}_h.uniform1i(Ak,yk);_h.activeTexture(33984+yk);_h.bindTexture(3553,bi[Ek])};break;default:console.error("Unsupported uniform type!",Bk);break}Zj[yk]=Ck};for(var pk=0;pk<$j;pk++){ok(pk)}if(lk.uniform_values){for(var qk=0,rk=lk.uniform_values;qk<rk.length;qk++){var sk=rk[qk];var tk=Xj[sk[0]];if(undefined!==tk){var uk=jk[nk+tk];if(4===uk||5===uk){var vk=Fi.Pipeline["Resource"][sk[1]];var wk=[0,vk.Handle,0,0];Zj[tk][1](wk)}}}}return lk.mode}function ak(){if(si){si(ni[Vj],_h)}gk(8,ui);_h.useProgram(Wj);ri=Uj;for(var Fk=0,Gk=Zj;Fk<Gk.length;Fk++){var Hk=Gk[Fk];Hk[2]()}}function bk(Ik){return Xj[Ik]}function ck(Jk){return Zj[Jk][0]()}function dk(Kk){Kk=Yj[Kk];if(-1<Kk){return Zj[Kk][0]()}return null}function ek(Lk){var Mk=Xj[Lk];if(undefined!==Mk){return Zj[Mk][0]()}return null}function fk(Nk,Ok){Zj[Nk][1](Ok);if(ri===Uj){Zj[Nk][2]()}}function gk(Pk,Qk){Pk=Yj[Pk];if(-1<Pk){Zj[Pk][1](Qk);if(ri===Uj){Zj[Pk][2]()}}}function hk(Rk,Sk){var Tk=Xj[Rk];if(undefined!==Tk){Zj[Tk][1](Sk);if(ri===Uj){Zj[Tk][2]()}}}function ik(Uk){Zj[Uk][2]()}ni[Vj]=[_j,ak,bk,ck,dk,ek,fk,gk,hk,ik];return _j()}function Ai(Vk){{Object.defineProperty(Vk,"Attr",{get:function(){if(!this.Attr_){this.Attr_=ni[this._VarList()]}return this.Attr_}})}{var Wk=function(Yk){var Zk=Yk;Object.defineProperty(Vk,fi[Yk],{get:function(){return this.Attr[4](Zk)},set:function($k){if($k){this.Attr[7](Zk,$k)}}})};for(var Xk=0;Xk<fi.length;Xk++){Wk(Xk)}}{}}function Bi(_k,al,bl,cl,dl){return oi[_k](al,bl,cl,dl)}function Ci(el){var fl=_h.createTexture();if(!fl){console.error("Could not create texture object!");return null}_h.bindTexture(_h.TEXTURE_2D,fl);_h.texParameteri(_h.TEXTURE_2D,_h.TEXTURE_MIN_FILTER,_h.LINEAR);_h.texParameteri(_h.TEXTURE_2D,_h.TEXTURE_MAG_FILTER,_h.LINEAR);_h.texParameteri(_h.TEXTURE_2D,_h.TEXTURE_WRAP_S,_h.CLAMP_TO_EDGE);_h.texParameteri(_h.TEXTURE_2D,_h.TEXTURE_WRAP_T,_h.CLAMP_TO_EDGE);var gl=new Image;gl.crossOrigin="anonymous";gl.src=el.URL;gl.onload=function(hl){_h.bindTexture(_h.TEXTURE_2D,fl);_h.texImage2D(_h.TEXTURE_2D,0,_h.RGB,_h.RGB,_h.UNSIGNED_BYTE,gl);_h.bindTexture(_h.TEXTURE_2D,null)};_h.bindTexture(_h.TEXTURE_2D,null);return fl}function Di(il,jl,kl,ll){if(ll===void 0){ll=null}var ml=_h.createTexture();if(!ml){console.error("Could not create texture object!");return null}_h.bindTexture(_h.TEXTURE_2D,ml);_h.texParameteri(_h.TEXTURE_2D,_h.TEXTURE_MIN_FILTER,_h.NEAREST);_h.texParameteri(_h.TEXTURE_2D,_h.TEXTURE_MAG_FILTER,_h.NEAREST);_h.texParameteri(_h.TEXTURE_2D,_h.TEXTURE_WRAP_S,_h.CLAMP_TO_EDGE);_h.texParameteri(_h.TEXTURE_2D,_h.TEXTURE_WRAP_T,_h.CLAMP_TO_EDGE);var nl=ci[il]();_h.texImage2D(_h.TEXTURE_2D,0,nl[0],jl,kl,0,nl[1],nl[2],ll);_h.bindTexture(_h.TEXTURE_2D,null);ml["_Format"]=nl;return ml}function Ei(ol,pl){var ql=_h.createFramebuffer();if(!ql){console.error("Could not create framebuffer object!");return null}_h.bindFramebuffer(_h.FRAMEBUFFER,ql);_h.framebufferTexture2D(_h.FRAMEBUFFER,_h.COLOR_ATTACHMENT0,_h.TEXTURE_2D,ol,0);if(pl&&pl["_Format"][0]===_h.DEPTH_STENCIL){_h.framebufferTexture2D(_h.FRAMEBUFFER,_h.DEPTH_STENCIL_ATTACHMENT,_h.TEXTURE_2D,pl,0)}else{_h.framebufferTexture2D(_h.FRAMEBUFFER,_h.DEPTH_ATTACHMENT,_h.TEXTURE_2D,pl,0)}if(_h.FRAMEBUFFER_COMPLETE!=_h.checkFramebufferStatus(_h.FRAMEBUFFER)){_h.deleteFramebuffer(ql);console.error("Framebuffer check failed!");return null}return ql}var Fi={_name:"ShaderLab",Shader:ai,Pipeline:null,Init:function(rl){_h=$h["GL"]["Ctx"];bi=$h["GL"]["_textures"];pi=_h.canvas.width;qi=_h.canvas.height;for(var sl=0,tl=this.Pipeline.RenderTarget;sl<tl.length;sl++){var ul=tl[sl];if(ul){var vl=ul.Width||pi;var wl=ul.Height||qi;ul.Texture=Di(ul.Format,vl,wl);ul.Handle=$h["GL"]["RegisterTexture"](ul.Texture);ul.Size=[1/vl,1/wl,vl,wl]}}for(var xl=0,yl=this.Pipeline.Resource;xl<yl.length;xl++){var zl=yl[xl];if(zl){if("2D"===zl.TYPE){zl.Texture=Ci(zl);zl.Handle=$h["GL"]["RegisterTexture"](zl.Texture)}}}function Al(Kl){var Ll=Kl.RenderTarget;if(Ll){var Ml=Fi.Pipeline["RenderTarget"][Ll[0]];var Nl=Fi.Pipeline["RenderTarget"][Ll[1]];Kl.Framebuffer=Ei(Ml.Texture,Nl?Nl.Texture:null);Kl.Framebuffer.width=Ml.Size[2];Kl.Framebuffer.height=Ml.Size[3]}else{Kl.Framebuffer=null}}for(var Bl=0,Cl=this.Pipeline.Pass;Bl<Cl.length;Bl++){var Dl=Cl[Bl];if(Dl){if("Clear"===Dl.Type){Dl._Type=2}else{Dl._Type="Render"===Dl.Type?0:1}Dl._Mask=0;for(var El=0,Fl=Dl.Mask;El<Fl.length;El++){var Gl=Fl[El];Dl._Mask+=di[Gl]}Al(Dl);if(Dl.Pingpong){for(var Hl=0,Il=Dl.Pingpong;Hl<Il.length;Hl++){var Jl=Il[Hl];Al(Jl)}}}}},Draw:function(){var Ol=0;var Pl=this.Pipeline.Picker;if(Pl){ui[0]=Pl.x;ui[1]=_h.canvas.height-Pl.y}else{ui[0]=-10;ui[1]=-10}for(var Ql=0,Rl=this.Pipeline.Pass;Ql<Rl.length;Ql++){var Sl=Rl[Ql];Gi.BeginDrawPass();if(Sl.Pingpong){for(var Tl=0;Tl<Sl.PingpongCount;Tl++){for(var Ul=0;Ul<Sl.Pingpong.length;Ul++){Sl.Framebuffer=Sl.Pingpong[Ul].Framebuffer;Sl.SetUniforms=Sl.Pingpong[Ul].SetUniforms;this.DrawPass(Sl,Fi.DrawPass_)}}}else{this.DrawPass(Sl,Fi.DrawPass_)}Gi.EndDrawPass(Ol++)}},DrawPass:function(Vl,Wl){_h.bindFramebuffer(_h.FRAMEBUFFER,Vl.Framebuffer);if(Vl.Framebuffer){_h.viewport(0,0,Vl.Framebuffer.width,Vl.Framebuffer.height)}else{_h.viewport(0,0,pi,qi)}var Xl=Vl.Depth;if(Xl){_h.enable(_h.DEPTH_TEST);_h.depthMask(Xl.Write);_h.depthFunc(_h[Xl.Func])}else{_h.disable(_h.DEPTH_TEST)}var Yl=Vl.Blend;if(Yl){_h.enable(_h.BLEND);_h.blendEquationSeparate(_h[Yl.ColorFunc],_h[Yl.AlphaFunc]);_h.blendFuncSeparate(_h[Yl.ColorSrc],_h[Yl.ColorDest],_h[Yl.AlphaSrc],_h[Yl.AlphaDest])}else{_h.disable(_h.BLEND)}var Zl=Vl.Stencil;if(Zl){_h.enable(_h.STENCIL_TEST);_h.stencilFunc(_h[Zl.Func],Zl.Value,Zl.Mask);_h.stencilOp(_h[Zl.Faild],_h[Zl.ZFaild],_h[Zl.Pass])}else{_h.disable(_h.STENCIL_TEST)}var $l=Vl.ClearTarget;if($l){var _l=0;if($l.Color){_h.clearColor($l.Color.r,$l.Color.g,$l.Color.b,$l.Color.a);_l+=_h.COLOR_BUFFER_BIT}if(undefined!==$l.Depth){_h.clearDepth($l.Depth);_l+=_h.DEPTH_BUFFER_BIT}if(undefined!==$l.Stencil){_h.clearStencil($l.Stencil);_l+=_h.STENCIL_BUFFER_BIT}_h.clear(_l)}si=Vl.SetUniforms;if(Vl.Shader){if(!Vl._Material){Vl._Material=new $h["Material"](Vl.Shader)}Vl._Material._Bind()}Wl(Vl._Type,Vl._Mask);if(Vl.Postprocess){Vl.Postprocess(_h)}},PreflushBuffer:function(){var am=ji.length;var bm=new Array(am);for(var cm=0;cm<am;cm++){var dm=ji[cm];if(dm){if("Float32Array"===dm.constructor.name){bm[cm]=dm.length}else{bm[cm]=-dm.length}ji[cm]=dm.byteOffset}}return bm},FlushBuffer:function(em,fm){ei=em;var gm=ji.length;for(var hm=0;hm<gm;hm++){var im=ji[hm];if(im){var jm=fm[hm];if(0<jm){ji[hm]=new Float32Array(ei,im,jm)}else{ji[hm]=new Int32Array(ei,im,-jm)}}}for(var hm=0;hm<gm;hm++){var km=ni[hm];if(km){km[0]()}}$h["GL"]["FlushHeap"]()},ResizeCanvas:function(lm,mm){},PickObject:function(){var nm=this.Pipeline.Picker;if(nm){_h.readPixels(nm.x,_h.canvas.height-nm.y,1,1,_h.RGBA,_h.FLOAT,ti);if(0>ti[3]){var om=Math.ceil(ti[0]*1e4)*8192+Math.ceil(ti[1]*1e4);var pm=Math.ceil(ti[2]*1e4);var qm=this["GetObject"](om);nm.Feedback(qm,pm)}else{nm.Feedback(null,0)}this.Pipeline.Picker=null}},ExpandMaterial:Ai,OperateMaterial:Bi,CreateUniformsDesc:undefined,GetTexture:undefined,DrawPass_:undefined,SetSunlight:undefined};var Gi={_name:"Profiler",m_pMsg:"",m_nCycleStart:0,m_nCycleTick:0,m_nBeginCycle:0,m_nTotalCycle:0,m_nBeginScript:0,m_nTotalScript:0,m_nBeginUpdate:0,m_nTotalUpdate:0,m_nBeginDraw:0,m_nTotalDraw:0,m_nBeginMaterial:0,m_nTotalMaterial:0,m_nBeginDrawPass:0,m_nTotalDrawPass:[],BeginCycle:function(){if(0===Gi.m_nCycleTick){Gi.m_nCycleStart=$h["Time"]();Gi.m_nCycleTick=0;Gi.m_nBeginCycle=0;Gi.m_nTotalCycle=0;Gi.m_nBeginScript=0;Gi.m_nTotalScript=0;Gi.m_nBeginUpdate=0;Gi.m_nTotalUpdate=0;Gi.m_nBeginDraw=0;Gi.m_nTotalDraw=0;Gi.m_nBeginMaterial=0;Gi.m_nTotalMaterial=0;Gi.m_nBeginDrawPass=0;Gi.m_nTotalDrawPass=[]}Gi.m_nBeginCycle=$h["Time"]()},EndCycle:function(){Gi.m_nTotalCycle+=$h["Time"]()-Gi.m_nBeginCycle;if(60===++Gi.m_nCycleTick){var rm={"总耗时":$h["Time"]()-Gi.m_nCycleStart,"应用循环":Gi.m_nTotalCycle,"脚本逻辑":Gi.m_nTotalScript,"场景更新":Gi.m_nTotalUpdate,"场景绘制":Gi.m_nTotalDraw,"通道绘制":Gi.m_nTotalDrawPass};Gi.m_pMsg="'开销统计':"+JSON.stringify(rm);Gi.m_nCycleTick=0}},BeginScript:function(){Gi.m_nBeginScript=$h["Time"]()},EndScript:function(){Gi.m_nTotalScript+=$h["Time"]()-Gi.m_nBeginScript},BeginUpdate:function(){Gi.m_nBeginUpdate=$h["Time"]()},EndUpdate:function(){Gi.m_nTotalUpdate+=$h["Time"]()-Gi.m_nBeginUpdate},BeginDraw:function(){Gi.m_nBeginDraw=$h["Time"]()},EndDraw:function(){Gi.m_nTotalDraw+=$h["Time"]()-Gi.m_nBeginDraw},BeginMaterial:function(){Gi.m_nBeginMaterial=$h["Time"]()},EndMaterial:function(){Gi.m_nTotalMaterial+=$h["Time"]()-Gi.m_nBeginMaterial},BeginDrawPass:function(){Gi.m_nBeginDrawPass=$h["Time"]()},EndDrawPass:function(sm){Gi.m_nTotalDrawPass[sm]=(Gi.m_nTotalDrawPass[sm]?Gi.m_nTotalDrawPass[sm]:0)+$h["Time"]()-Gi.m_nBeginDrawPass}};Fi.Shader["Common"]={DeclareVS:"\nprecision highp float;\n\nattribute vec3 a_Position;\nattribute vec3 a_Normal;\nattribute vec2 a_UV;\nattribute vec4 a_Color;\nattribute vec4 a_Tangent;\nattribute vec4 a_Binormal;\nattribute vec2 a_UV2;\n\n/// ID1、ID2、子网格、高亮标记\nuniform vec4 u_Object;\n/// 拾取坐标X、拾取坐标Y\nuniform vec4 u_Picker;\nuniform vec4 u_EyePos;\nuniform vec4 u_Sunlight;\n\nuniform mat4 u_MatW;\nuniform mat4 u_MatVP;\nuniform mat4 u_MatWVP;\n\n/// 对象空间坐标转世界空间坐标\nvec3 ObjectToWorldPos(vec3 i_Position)\n{\n    return (u_MatW * vec4(i_Position, 1.0)).xyz;\n}\n\n/// 对象空间坐标转裁剪空间坐标\nvec4 ObjectToClipPos(vec3 i_Position)\n{\n    return u_MatWVP * vec4(i_Position, 1.0);\n}\n\n/// 对象空间法线转世界空间法线\nvec3 ObjectToWorldNormal(vec3 i_Normal)\n{\n    return normalize((u_MatW * vec4(i_Normal, 0.0)).xyz);\n}\n       ",DeclareFS:"\nprecision highp float;\n\n/// ID1、ID2、子网格、高亮标记\nuniform vec4 u_Object;\n/// 拾取坐标X、拾取坐标Y\nuniform vec4 u_Picker;\nuniform vec4 u_EyePos;\nuniform vec4 u_Sunlight;\n\nuniform mat4 u_MatW;\nuniform mat4 u_MatVP;\nuniform mat4 u_MatWVP;\nuniform sampler2D u_MainTex;\n\n/// 对象空间坐标转世界空间坐标\nvec3 ObjectToWorldPos(vec3 i_Position)\n{\n    return (u_MatW * vec4(i_Position, 1.0)).xyz;\n}\n\n/// 对象空间坐标转裁剪空间坐标\nvec4 ObjectToClipPos(vec3 i_Position)\n{\n    return u_MatWVP * vec4(i_Position, 1.0);\n}\n\n/// 采样2D纹理\nvec4 Tex2D(sampler2D i_Tex, vec2 i_UV)\n{\n    i_UV.x = fract(i_UV.x);\n    i_UV.y = fract(1.0 - i_UV.y);\n\n    return texture2D(i_Tex, i_UV);\n}\n\n/// 默认光照函数\nfloat DefaultLight(vec3 i_Normal)\n{\n    vec3 _Normal = normalize(i_Normal);\n    vec3 _Light = normalize(vec3(2.0, 3.0, 1.0));\n\n    return clamp(dot(_Normal, _Light), 0.0, 1.0) + 0.2;\n}\n        ",ClearVS:"\nvoid main()\n{\n    gl_Position = vs();\n}\n        ",ClearFS:"\nvoid main()\n{\n    gl_FragColor = fs();\n}\n        ",RenderVS:"\nvoid main()\n{\n    gl_Position = vs();\n}\n        ",RenderFS:"\nvoid main()\n{\n    gl_FragColor = fs();\n\n    float nLength = length(gl_FragCoord.xy - u_Picker.xy);\n    nLength = clamp((ceil(nLength) - 1.0), 0.0, 1.0);    \n    gl_FragColor = (gl_FragColor * nLength) + (u_Object * (1.0 - nLength));\n    gl_FragColor.a = u_Object.a + (-2.0 * (1.0 - nLength));\n}\n        ",PostprocessVS:"\nvoid main()\n{\n    gl_Position = vs();\n}\n        ",PostprocessFS:"\nvoid main()\n{\n    gl_FragColor = fs();\n}\n        ",BRDF:'\nconst float PI = 3.14159265358979323846;\n\nconst vec3 baseColor = vec3(0.5, 0.5, 0.5);\nconst float metallic = 0.0;\nconst float subsurface = 0.5; // 0.0\nconst float specular = 0.2;\nconst float roughness = 0.7;//0.5;\nconst float specularTint = 0.0;\nconst float anisotropic = 0.0;\nconst float sheen = 0.0;\nconst float sheenTint = 0.5;\nconst float clearcoat = 0.0;\nconst float clearcoatGloss = 1.0;\n\nfloat sqr(float x) { return x * x; }\n\nfloat SchlickFresnel(float u)\n{\n\tfloat m = clamp(1.0 - u, 0.0, 1.0);\n\tfloat m2 = m * m;\n\treturn m2 * m2 * m; // pow(m,5)\n}\n\nfloat GTR1(float NdotH, float a)\n{\n\tif (a >= 1.0) return 1.0 / PI;\n\tfloat a2 = a * a;\n\tfloat t = 1.0 + (a2 - 1.0) * NdotH * NdotH;\n\treturn (a2 - 1.0) / (PI * log(a2) * t);\n}\n\nfloat GTR2(float NdotH, float a)\n{\n\tfloat a2 = a * a;\n\tfloat t = 1.0 + (a2 - 1.0) * NdotH * NdotH;\n\treturn a2 / (PI * t * t);\n}\n\nfloat GTR2_aniso(float NdotH, float HdotX, float HdotY, float ax, float ay)\n{\n\treturn 1.0 / (PI * ax * ay * sqr(sqr(HdotX / ax) + sqr(HdotY / ay) + NdotH * NdotH));\n}\n\nfloat smithG_GGX(float NdotV, float alphaG)\n{\n\tfloat a = alphaG * alphaG;\n\tfloat b = NdotV * NdotV;\n\treturn 1.0 / (NdotV + sqrt(a + b - a * b));\n}\n\nfloat smithG_GGX_aniso(float NdotV, float VdotX, float VdotY, float ax, float ay)\n{\n\treturn 1.0 / (NdotV + sqrt(sqr(VdotX * ax) + sqr(VdotY * ay) + sqr(NdotV)));\n}\n\nvec3 mon2lin(vec3 x)\n{\n\treturn vec3(pow(x[0], 2.2), pow(x[1], 2.2), pow(x[2], 2.2));\n}\n\nvec3 BRDF(vec3 L, vec3 V, vec3 N, vec3 X, vec3 Y)\n{\n    //x和y方向分别表示了表面的切向量和副法线向量方向\n    //https://www.cnblogs.com/starfallen/p/3572352.html\n\n\tfloat NdotL = dot(N, L);\n\tfloat NdotV = dot(N, V);\n\tif (NdotL < 0.0 || NdotV < 0.0) return vec3(0.0);\n\n\tvec3 H = normalize(L + V);\n\tfloat NdotH = dot(N, H);\n\tfloat LdotH = dot(L, H);\n\n\tvec3 Cdlin = mon2lin(baseColor);\n\tfloat Cdlum = 0.3 * Cdlin[0] + 0.6 * Cdlin[1] + 0.1 * Cdlin[2]; // luminance approx.\n\n\tvec3 Ctint = Cdlum > 0.0 ? Cdlin / Cdlum : vec3(1.0); // normalize lum. to isolate hue+sat\n\tvec3 Cspec0 = mix(specular * 0.08 * mix(vec3(1.0), Ctint, specularTint), Cdlin, metallic);\n\tvec3 Csheen = mix(vec3(1.0), Ctint, sheenTint);\n\n\t// Diffuse fresnel - go from 1 at normal incidence to .5 at grazing\n\t// and mix in diffuse retro-reflection based on roughness\n\tfloat FL = SchlickFresnel(NdotL), FV = SchlickFresnel(NdotV);\n\tfloat Fd90 = 0.5 + 2.0 * LdotH * LdotH * roughness;\n\tfloat Fd = mix(1.0, Fd90, FL) * mix(1.0, Fd90, FV);\n\n\t// Based on Hanrahan-Krueger brdf approximation of isotropic bssrdf\n\t// 1.25 scale is used to (roughly) preserve albedo\n\t// Fss90 used to "flatten" retroreflection based on roughness\n\tfloat Fss90 = LdotH * LdotH * roughness;\n\tfloat Fss = mix(1.0, Fss90, FL) * mix(1.0, Fss90, FV);\n\tfloat ss = 1.25 * (Fss * (1.0 / (NdotL + NdotV) - 0.5) + 0.5);\n\n\t// specular\n\tfloat aspect = sqrt(1.0 - anisotropic * 0.9);\n\tfloat ax = max(0.001, sqr(roughness) / aspect);\n\tfloat ay = max(0.001, sqr(roughness) * aspect);\n\tfloat Ds = GTR2_aniso(NdotH, dot(H, X), dot(H, Y), ax, ay);\n\tfloat FH = SchlickFresnel(LdotH);\n\tvec3 Fs = mix(Cspec0, vec3(1.0), FH);\n\tfloat Gs;\n\tGs = smithG_GGX_aniso(NdotL, dot(L, X), dot(L, Y), ax, ay);\n\tGs *= smithG_GGX_aniso(NdotV, dot(V, X), dot(V, Y), ax, ay);\n\n\t// sheen\n\tvec3 Fsheen = FH * sheen * Csheen;\n\n\t// clearcoat (ior = 1.5 -> F0 = 0.04)\n\tfloat Dr = GTR1(NdotH, mix(0.1, 0.001, clearcoatGloss));\n\tfloat Fr = mix(0.04, 1.0, FH);\n\tfloat Gr = smithG_GGX(NdotL, 0.25) * smithG_GGX(NdotV, 0.25);\n\n\treturn ((1.0 / PI) * mix(Fd, ss, subsurface) * Cdlin + Fsheen) * (1.0 - metallic) + Gs * Fs * Ds + 0.25 * clearcoat * Gr * Fr * Dr;\n}\n        ',AtmosphereVS:"\nvarying vec4 v_ViewDir;\nvarying vec4 v_Scattering;\nvarying vec4 v_Attenuate;\n\n//P and ray define the line; O is the sphere's center point\nvec3 CalculateIntersection(vec3 P, vec3 ray, vec3 O, float r)\n{\n\tvec3 PO = O - P;\n\tfloat lPO = length(PO);\n\tfloat B = 2.0 * dot(PO, ray);\n\n\tfloat C = B * B - 4.0 * (lPO * lPO - r * r);\n\tfloat det = sqrt(max(0.0, C));\n\n\tfloat d = 0.5*(B-det);\n\tvec3 intersect = P + d * ray;\n\n\treturn intersect;\n}\n\nvoid Atmosphere(vec3 mLightDir, vec3 mWorldPos)\n{\n    // 大气散射，天空应分两层，摄像机应该在内层之外，大气层厚度为外层半径减内层半径，外层半径应远大于内层半径\n    //650 nm for red; 570 nm for green; 475 nm for blue\n    vec3 _Wave = vec3(5.602046, 9.473285, 20.49314);\n    vec3 _ESun = vec3(20.0, 20.0, 20.0);\n    vec3 _PlanetPos = vec3(0.0, -6378137.0, 0.0);\n    float _Sealevel = 6378137.0;\n    float _OuterRadius = 6478137.0;\n    float _SampleNum = 5.0;\n    //Rayleigh scattering constant\n    float _Kr = 0.0025;\n    //Mie scattering constant\n    float _Km = 0.001;\n    //the altitude at which the atmosphere's average density is found\n    float _H0 = 0.25;\n\n    vec3 mRay = mWorldPos - u_EyePos.xyz;\n    float nDepth = length(mRay); mRay = mRay / nDepth;\n\n    float nSampleLength = nDepth / _SampleNum;\n    vec3 mSampleRay = mRay * nSampleLength;\n    vec3 mSamplePoint = u_EyePos.xyz + mSampleRay * 0.5;\n    vec3 mInScattering = vec3(0.0, 0.0, 0.0);\n    vec3 mOutScatteringAB = vec3(0.0, 0.0, 0.0);\n    vec3 mOutGroundScatteringAB = vec3(0.0, 0.0, 0.0);\n    float nInvOuterH = 1.0 / (_OuterRadius-_Sealevel);\n\n    for(int i=0; i</*_SampleNum*/5; i++)\n    {\n\t    vec3 mCrossPoint = CalculateIntersection(mSamplePoint, -mLightDir, _PlanetPos, _OuterRadius);\n\t    //AP out scattering\n\t    vec3 mAPRay = (mSamplePoint - u_EyePos.xyz) / _SampleNum;\n\t    float nAPRayLength = length(mAPRay);\n\t    vec3 mSampleAP = u_EyePos.xyz + mAPRay * 0.5;\n\t    vec3 mOutScatteringAP = vec3(0.0, 0.0, 0.0);\n\n\t    for(int m=0; m</*_SampleNum*/5; m++)\n\t    {\n\t\t    mOutScatteringAP += exp(-(length(mSampleAP - _PlanetPos) - _Sealevel) * nInvOuterH / _H0) * nAPRayLength * nInvOuterH;\n\t\t    mSampleAP += mAPRay;\n\t    }\n\t    mOutScatteringAP = 4.0 * 3.14 * (_Km + _Kr * _Wave) * mOutScatteringAP;\n\n\t    //PC out scattering\n\t    vec3 mPCRay = (mCrossPoint - mSamplePoint) / _SampleNum;\n\t    float nPCRayLength = length(mPCRay);\n\t    vec3 mSamplePC = mSamplePoint + mPCRay*0.5;\n\t    vec3 mOutScatteringPC = vec3(0.0, 0.0, 0.0);\n\n\t    for(int n=0; n</*_SampleNum*/5; n++)\n\t    {\n\t\t    mOutScatteringPC += exp(-(length(mSamplePC - _PlanetPos) - _Sealevel) * nInvOuterH / _H0) * nPCRayLength * nInvOuterH;\n\t\t    mSamplePC += mPCRay;\n\t    }\n\t    mOutScatteringPC = 4.0 * 3.14 * (_Km + _Kr * _Wave) * mOutScatteringPC;\n\n\t    mInScattering += exp(-(length(mSamplePoint - _PlanetPos) - _Sealevel) * nInvOuterH / _H0) * nSampleLength * nInvOuterH * exp(-mOutScatteringAP - mOutScatteringPC);\n\t    mSamplePoint+=mSampleRay;\n\t    mOutScatteringAB = mCrossPoint;\n        mOutGroundScatteringAB = mOutScatteringAP + mOutScatteringPC;\n    }\n\n    vec3 mAttenuateGround = exp(-mOutGroundScatteringAB);\n\n    v_ViewDir.xyz = u_EyePos.xyz - mWorldPos;\n    v_Scattering.xyz = mInScattering * _ESun * _Kr * _Wave;\n    v_Attenuate.xyz = mInScattering * _ESun * _Km;\n\n    v_ViewDir.w = mAttenuateGround.x;\n    v_Scattering.w = mAttenuateGround.y;\n    v_Attenuate.w = mAttenuateGround.z;\n\n    //Ground : v_ScatteringR = v_Scattering; v_ScatteringM = v_Attenuate; v_Attenuate = v_AttenuateGround;\n    //v_ViewDir = u_EyePos.xyz - mWorldPos;\n    //v_ScatteringR = mInScattering * _ESun * _Kr * _Wave;\n    //v_ScatteringM = mInScattering * _ESun * _Km;\n    //v_Attenuate = exp(-mOutGroundScatteringAB);\n}\n        ",AtmosphereFS:"\nvarying vec4 v_ViewDir;\nvarying vec4 v_Scattering;\nvarying vec4 v_Attenuate;\n\nfloat PhaseRayleigh(float nCostheta)\n{\n\treturn 0.75 * (1.0 + nCostheta * nCostheta);\n}\n\nfloat PhaseMie(float nCostheta, float g, float g2)\n{\n\treturn 1.5 * ((1.0 - g2) / (2.0 + g2)) * (1.0 + nCostheta * nCostheta) / pow(1.0 + g2 - 2.0 * g * nCostheta, 1.5);\n}\n\nvec4 AtmosphereColor(vec4 mColor, vec3 mLightDir)\n{\n    float _G = -0.990;\n    float _G2 = _G * _G;\n    \n    float nCostheta = dot(normalize(v_ViewDir.xyz), mLightDir);\n    float nPhaseMie = PhaseMie(nCostheta, _G, _G2);\n    float nPhaseRayleigh = PhaseRayleigh(nCostheta);\n\t\t\t\t\n    mColor.rgb = v_Scattering.xyz * nPhaseRayleigh + v_Attenuate.xyz * nPhaseMie;\n    mColor.a = mColor.b + 0.2;\n    mColor = clamp(mColor, 0.0, 0.9);\n\n    return mColor;\n}\n\nvec4 AtmosphereLight(vec4 mColor, vec3 mLightDir)\n{\n    // Ground : v_ScatteringR = v_Scattering.xyz; v_ScatteringM = v_Attenuate.xyz; v_Attenuate = v_AttenuateGround;\n    \n    float _G = -0.980;\n    float _G2 = _G * _G;\n    \n    float nCostheta = dot(normalize(v_ViewDir.xyz), mLightDir);\n    float nPhaseMie = PhaseMie(nCostheta, _G, _G2);\n    float nPhaseRayleigh = PhaseRayleigh(nCostheta);\n    \n    mColor.rgb = v_Scattering.xyz * nPhaseRayleigh + v_Attenuate.xyz * nPhaseMie + mColor.rgb * vec3(v_ViewDir.w, v_Scattering.w, v_Attenuate.w)/*v_AttenuateGround*/;\n    \n    return mColor;\n}\n        "};return[Fi,Gi]});MiaokitMerge(function(tm){if("Sisyphus"!==tm["m_pConfig"]["ENGINE"]){return[]}var um=undefined;var vm=true;function wm(Bm){xm();um=Bm.OnRenderingEvent;ym();var Cm={memory:new WebAssembly.Memory({initial:64*16,maximum:32768}),APP_PLUGIN_TYPE:function(){return 2},APP_MEM_TYPE:function(){return 2},APP_MEM_RESERVE:function(){return 1024},APP_MEM_MALLOC:function(Dm){alert("SISYPHUS��չ��֧��ʹ�÷������ڴ�!");return 0},APP_MEM_FREE:function(Em){alert("SISYPHUS��չ��֧��ʹ�÷������ڴ�!")},APP_MEM_BASE:function(){return 64*1024*1024},APP_MEM_GROW:function(Fm){if(tm["ShaderLab"]){var Gm=tm["ShaderLab"]["PreflushBuffer"]();Cm["memory"].grow(Fm/64/1024);var Hm=Cm["memory"].buffer;tm["ShaderLab"]["FlushBuffer"](Hm,Gm)}else{Cm["memory"].grow(Fm/64/1024)}},APP_MEM_RECYCLE:function(Im){alert("WAMSģ�鲻֧�ֻ����ڴ�!")},UNITY_CREATE_OBJ:function(){alert("δװ��UNITY��չ!");return 0},UNITY_FREE_OBJ:function(){alert("δװ��UNITY��չ!");return 0},UNITY_GET:function(){alert("δװ��UNITY��չ!");return 0},UNITY_DO:function(){alert("δװ��UNITY��չ!");return 0}};Bm.OnEngineLoad(Cm)}function xm(){var Jm=document.getElementById("unityContainer");var Km=document.createElement("canvas");Km.id="3d";Km.width=Jm.offsetWidth;Km.height=Jm.offsetHeight;Km.style.width="100%";Km.style.height="100%";Km.style.top="0rem";Km.style.bottom="0rem";Km.style.left="0rem";Km.style.right="0rem";Km.style.position="absolute";Km.style.zIndex="1";Jm.appendChild(Km);tm["GL"]["CreateContext"](Km);tm["ShaderLab"]["Init"](tm["GL"])}function ym(){if(vm){vm=false;Am()}}function zm(){vm=true}function Am(){if(vm){return}tm.Profiler.BeginCycle();tm.Profiler.BeginScript();um(0);tm.Profiler.EndScript();if(tm["WASM"]["Update"]){tm.Profiler.BeginUpdate();tm["WASM"]["Update"](0);tm.Profiler.EndUpdate();tm.Profiler.BeginDraw();tm["WASM"]["Update"](1);tm.Profiler.EndDraw()}tm.Profiler.EndCycle();requestAnimationFrame(Am)}tm["WASM"]=tm["WASM"]||{};tm["WASM"]["LoadEngine"]=wm;ym["_name"]="Start";zm["_name"]="Stop";return[ym,zm]});MiaokitMerge(function(Lm){var Mm=Date.now();function Nm(){return Date.now()-Mm}function Om(Rm,Sm){if(Sm===void 0){Sm=0}if(2===Sm){console.warn("Track:",Nm(),Rm)}else if(2<Sm){console.error("Track:",Nm(),Rm)}else{console.info("Track:",Nm(),Rm)}}function Pm(Tm,Um,Vm){if(Vm===void 0){Vm=undefined}var Wm=new XMLHttpRequest;Wm.open("GET",Tm,true);Wm.responseType="arraybuffer";Wm.onprogress=function(Xm){if(0<Xm.total&&Vm){Vm(Xm.loaded/Xm.total)}};Wm.onload=function(Ym){if(Wm.status==200){Um(Wm.response)}else{Um(null)}};Wm.onerror=function(Zm){Om(Zm,2);Um(null)};Wm.send(null)}function Qm($m,_m,an,bn,cn,dn){var en=new XMLHttpRequest;en.onprogress=function(fn){if(0<fn.total&&cn){cn(fn.loaded/fn.total)}};en.onload=function(gn){if(en.status==200){dn(en.response)}else{dn(null)}en=null};en.onerror=function(hn){Om(hn,2);dn(null)};en.responseType=_m;en.open($m,an,true);en.send(bn)}Nm["_name"]="Time";Om["_name"]="Track";Pm["_name"]="Fetch";Qm["_name"]="Request";return[Nm,Om,Pm,Qm]});MiaokitMerge(function(jn){if("Unity"!==jn["m_pConfig"]["ENGINE"]){return[]}if(!UnityLoader){return[]}var kn=jn["m_pLogo"]||"data:image/png;base64,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";UnityLoader.Progress.Styles.Dark.progressLogoUrl=kn;UnityLoader.Progress.Styles.Light.progressLogoUrl=kn;if(UnityLoader.SystemInfo.mobile){UnityLoader.SystemInfo.mobile=false;UnityLoader.downloadJob=function(sn,tn){var un=new XMLHttpRequest;un.open("GET",tn.parameters.url);un.responseType="arraybuffer";un.onload=function(){UnityLoader.Compression.decompress(new Uint8Array(un.response),function(vn){tn.complete(vn)})};if(tn.parameters.onprogress)un.addEventListener("progress",tn.parameters.onprogress);if(tn.parameters.onload)un.addEventListener("load",tn.parameters.onload);un.send()}}UnityLoader.processWasmFrameworkJob=function(wn,xn){var yn=UnityLoader.Job.result(wn,"downloadWasmFramework");UnityLoader.loadCode(wn,yn,function(zn,An){wn["mainScriptUrlOrBlob"]=An;if(wn.isModularized){UnityLoader[zn]=UnityModule}wn["instantiateWasm"]=function(Bn,Cn){on(wn,Bn["env"]);if(wn["wasmBinary"]){WebAssembly.instantiate(wn["wasmBinary"],Bn).then(function(Dn){Cn(Dn.instance,Dn.module)})}else{console.info("MiaokitLoader.InitUnity.instantiateWasm error!")}return{}};UnityLoader[zn](wn);xn.complete()},{Module:wn,url:wn["wasmFrameworkUrl"],isModularized:wn.isModularized})};var ln=null;var mn=null;var nn={};function on(En,Fn){Object["assign"](Fn,{_Init:function(Gn,Hn){jn["WASM"]["m_pMemory"]=jn["WASM"]["m_pMemory"]||mn.Module.wasmMemory;pn(En,nn,Gn,Hn);qn(mn,nn);ln.OnEngineLoad(nn)},_RenderingEvent:function(In){ln.OnRenderingEvent(In)}});jn["GL"]=Fn}function pn(Jn,Kn,Ln,Mn){var Nn=jn.WASM.GetString(Ln,Mn);var On=JSON.parse(Nn);var Pn=function(Tn){var Un=function(){var Vn=Array.prototype.slice.call(arguments);Vn.unshift(Un["m_nAddr"]);return Un["m_pFunc"].apply(this,Vn)};Un["m_pFunc"]=Jn[Tn.Call];Un["m_nAddr"]=Tn.Addr;Kn[Tn.Name]=Un};for(var Qn=0,Rn=On.List;Qn<Rn.length;Qn++){var Sn=Rn[Qn];Pn(Sn)}}function qn(Wn,Xn){Xn["APP_PLUGIN_TYPE"]=function(){return 1};Xn["APP_MEM_TYPE"]=function(){return 1};Xn["memory"]=function(Yn){var Zn=32*1024*1024;var $n=Yn._memalign(16,Zn);var _n=Zn-$n;Yn._free($n);var ao=Yn._memalign(16,_n+Zn);if(ao!==$n){console.error("miaokit.prememory: addr error",$n,ao);return}if(ao+_n+Zn!==67108864){console.error("miaokit.prememory: addr end error",ao+_n+Zn);return}Xn["APP_MEM_RESERVE"]=function(){return ao};return Yn.wasmMemory}(mn.Module);Xn["APP_MEM_MALLOC"]=function(bo){return mn.Module._memalign(16,bo)};Xn["APP_MEM_FREE"]=function(co){mn.Module._free(co)};Xn["APP_MEM_BASE"]=function(){alert("UNITY��չ��֧��ʹ�������ڴ�!");return 0};Xn["APP_MEM_GROW"]=function(eo){alert("UNITY��չ��֧��ʹ�������ڴ�!");return 0};Xn["APP_MEM_RECYCLE"]=function(fo){alert("UNITY��չ��֧��ʹ�������ڴ�!");return 0}}function rn(go){ln=go;mn=UnityLoader.instantiate("unityContainer",jn["m_pConfig"]["UNITY"])}jn["WASM"]=jn["WASM"]||{};jn["WASM"]["LoadEngine"]=rn;return[]});MiaokitMerge(function(ho){var io=undefined;var jo=new TextDecoder("utf-8");var ko=new TextEncoder;function lo(mo){if(!io||ho["WASM"].m_pMemory.buffer.byteLength!==io[0].byteLength){if(!io){io=[]}io[0]=new Int8Array(ho["WASM"].m_pMemory.buffer);io[1]=new Uint8Array(ho["WASM"].m_pMemory.buffer);io[2]=new Int16Array(ho["WASM"].m_pMemory.buffer);io[3]=new Uint16Array(ho["WASM"].m_pMemory.buffer);io[4]=new Int32Array(ho["WASM"].m_pMemory.buffer);io[5]=new Uint32Array(ho["WASM"].m_pMemory.buffer);io[6]=new Float32Array(ho["WASM"].m_pMemory.buffer);io[7]=new Float64Array(ho["WASM"].m_pMemory.buffer)}return io[mo]}ho["WASM"]=ho["WASM"]||{};ho["WASM"]["HEAP8"]=function(no,oo){if(no===void 0){no=0}if(oo===void 0){oo=0}var po=lo(0);if(no&&oo){return po.subarray(no,no+oo)}else{return po}};ho["WASM"]["HEAPU8"]=function(qo,ro){if(qo===void 0){qo=0}if(ro===void 0){ro=0}var so=lo(1);if(qo&&ro){return so.subarray(qo,qo+ro)}else{return so}};ho["WASM"]["HEAP16"]=function(to,uo){if(to===void 0){to=0}if(uo===void 0){uo=0}var vo=lo(2);if(to&&uo){return vo.subarray(to/2,(to+uo)/2)}else{return vo}};ho["WASM"]["HEAPU16"]=function(wo,xo){if(wo===void 0){wo=0}if(xo===void 0){xo=0}var yo=lo(3);if(wo&&xo){return yo.subarray(wo/2,(wo+xo)/2)}else{return yo}};ho["WASM"]["HEAP32"]=function(zo,Ao,Bo){if(zo===void 0){zo=0}if(Ao===void 0){Ao=0}var Co=lo(4);if(zo&&Ao){if(Bo){return Co.slice(zo/4,(zo+Ao)/4)}else{return Co.subarray(zo/4,(zo+Ao)/4)}}else{return Co}};ho["WASM"]["HEAPU32"]=function(Do,Eo){if(Do===void 0){Do=0}if(Eo===void 0){Eo=0}var Fo=lo(5);if(Do&&Eo){return Fo.subarray(Do/4,(Do+Eo)/4)}else{return Fo}};ho["WASM"]["HEAPF32"]=function(Go,Ho,Io){if(Go===void 0){Go=0}if(Ho===void 0){Ho=0}var Jo=lo(6);if(Go&&Ho){if(Io){return Jo.slice(Go/4,(Go+Ho)/4)}else{return Jo.subarray(Go/4,(Go+Ho)/4)}}else{return Jo}};ho["WASM"]["HEAPF64"]=function(Ko,Lo){if(Ko===void 0){Ko=0}if(Lo===void 0){Lo=0}var Mo=lo(7);if(Ko&&Lo){return Mo.subarray(Ko/8,(Ko+Lo)/8)}else{return Mo}};ho["WASM"]["GetString"]=function(No,Oo){if(!Oo){var Po=ho["WASM"].HEAPU8();var Qo=No;while(0!==Po[Qo++]);Oo=Qo-No-1}var Ro=ho["WASM"].HEAPU8(No,Oo);var So=jo.decode(Ro);return So};ho["WASM"]["SetString"]=function(To,Uo){var Vo=ko.encode(Uo);var Wo=ho["WASM"].HEAPU8(To,Vo.byteLength);Wo.set(Vo)};ho["WASM"]["EncodeString"]=function(Xo){return ko.encode(Xo)};ho["WASM"]["m_pMemory"]=null;return[]});MiaokitMerge(function(Yo){if("Sisyphus"!==Yo["m_pConfig"]["ENGINE"]){return[]}var Zo={instance:undefined,counter:1,lastError:0,buffers:[],mappedBuffers:{},programs:[],framebuffers:[],renderbuffers:[],textures:[],uniforms:[],shaders:[],vaos:[],contexts:[],currentContext:null,currArrayBuffer:0,currElementArrayBuffer:0,offscreenCanvases:{},timerQueriesEXT:[],queries:[],samplers:[],transformFeedbacks:[],syncs:[],byteSizeByTypeRoot:5120,byteSizeByType:[1,1,2,2,4,4,4,2,3,4,8],programInfos:{},stringCache:{},stringiCache:{},tempFixedLengthArray:[],packAlignment:4,unpackAlignment:4,init:function(){Zo.miniTempBuffer=new Float32Array(Zo.MINI_TEMP_BUFFER_SIZE);for(var xp=0;xp<Zo.MINI_TEMP_BUFFER_SIZE;xp++){Zo.miniTempBufferViews[xp]=Zo.miniTempBuffer.subarray(0,xp+1)}for(var xp=0;xp<32;xp++){Zo.tempFixedLengthArray.push(new Array(xp))}},recordError:function yp(zp){if(!Zo.lastError){Zo.lastError=zp}},getNewId:function(Ap){var Bp=Zo.counter++;for(var Cp=Ap.length;Cp<Bp;Cp++){Ap[Cp]=null}return Bp},MINI_TEMP_BUFFER_SIZE:256,miniTempBuffer:null,miniTempBufferViews:[0],getSource:function(Dp,Ep,Fp,Gp){var Hp="";for(var Ip=0;Ip<Ep;++Ip){var Jp;if(Gp){var Kp=gp[Gp+Ip*4>>2];if(Kp<0){Jp=ap(gp[Fp+Ip*4>>2])}else{Jp=ap(gp[Fp+Ip*4>>2],Kp)}}else{Jp=ap(gp[Fp+Ip*4>>2])}Hp+=Jp}return Hp},createContext:function(Lp,Mp){if(typeof Mp["majorVersion"]==="undefined"&&typeof Mp["minorVersion"]==="undefined"){if(typeof WebGL2RenderingContext!=="undefined")Mp["majorVersion"]=2;else Mp["majorVersion"]=1;Mp["minorVersion"]=0}var Np;var Op="?";function Pp(Rp){Op=Rp.statusMessage||Op}try{Lp.addEventListener("webglcontextcreationerror",Pp,false);try{if(Mp["majorVersion"]==1&&Mp["minorVersion"]==0){Np=Lp.getContext("webgl",Mp)||Lp.getContext("experimental-webgl",Mp)}else if(Mp["majorVersion"]==2&&Mp["minorVersion"]==0){Np=Lp.getContext("webgl2",Mp)}else{throw"Unsupported WebGL context version "+Mp["majorVersion"]+"."+Mp["minorVersion"]+"!"}}finally{Lp.removeEventListener("webglcontextcreationerror",Pp,false)}if(!Np)throw":("}catch(Sp){_o("Could not create canvas: "+[Op,Sp,JSON.stringify(Mp)]);return 0}if(!Np)return 0;var Qp=Zo.registerContext(Np,Mp);return Qp},registerContext:function(Tp,Up){var Vp=1;var Wp={handle:Vp,attributes:Up,version:Up["majorVersion"],GLctx:Tp};function Xp(){var Yp=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);return Yp?parseInt(Yp[2],10):false}Wp["supportsWebGL2EntryPoints"]=Wp.version>=2&&(Xp()===false||Xp()>=58);if(Tp.canvas)Tp.canvas.GLctxObject=Wp;Zo.contexts[Vp]=Wp;if(typeof Up["enableExtensionsByDefault"]==="undefined"||Up["enableExtensionsByDefault"]){Zo.initExtensions(Wp)}if(Up["renderViaOffscreenBackBuffer"]){return 0}return Vp},makeContextCurrent:function(Zp){if(!Zp){$o=Zo.currentContext=null;return true}var $p=Zo.contexts[Zp];if(!$p){return false}$o=$p.GLctx;Zo.currentContext=$p;return true},getContext:function(_p){return Zo.contexts[_p]},deleteContext:function(aq){if(!aq)return;if(Zo.currentContext===Zo.contexts[aq])Zo.currentContext=null;if(typeof JSEvents==="object")JSEvents.removeAllHandlersOnTarget(Zo.contexts[aq].GLctx.canvas);if(Zo.contexts[aq]&&Zo.contexts[aq].GLctx.canvas)Zo.contexts[aq].GLctx.canvas.GLctxObject=undefined;kp(Zo.contexts[aq]);Zo.contexts[aq]=null},initExtensions:function(bq){if(!bq)bq=Zo.currentContext;if(bq.initExtensionsDone)return;bq.initExtensionsDone=true;$o=bq.GLctx;bq.maxVertexAttribs=$o.getParameter($o.MAX_VERTEX_ATTRIBS);if(bq.version<2){var cq=$o.getExtension("ANGLE_instanced_arrays");if(cq){$o["vertexAttribDivisor"]=function(hq,iq){cq["vertexAttribDivisorANGLE"](hq,iq)};$o["drawArraysInstanced"]=function(jq,kq,lq,mq){cq["drawArraysInstancedANGLE"](jq,kq,lq,mq)};$o["drawElementsInstanced"]=function(nq,oq,pq,qq,rq){cq["drawElementsInstancedANGLE"](nq,oq,pq,qq,rq)}}var dq=$o.getExtension("OES_vertex_array_object");if(dq){$o["createVertexArray"]=function(){return dq["createVertexArrayOES"]()};$o["deleteVertexArray"]=function(sq){dq["deleteVertexArrayOES"](sq)};$o["bindVertexArray"]=function(tq){dq["bindVertexArrayOES"](tq)};$o["isVertexArray"]=function(uq){return dq["isVertexArrayOES"](uq)}}var eq=$o.getExtension("WEBGL_draw_buffers");if(eq){$o["drawBuffers"]=function(vq,wq){eq["drawBuffersWEBGL"](vq,wq)}}}$o.disjointTimerQueryExt=$o.getExtension("EXT_disjoint_timer_query");var fq=["OES_texture_float","OES_texture_half_float","OES_standard_derivatives","OES_vertex_array_object","WEBGL_compressed_texture_s3tc","WEBGL_depth_texture","OES_element_index_uint","EXT_texture_filter_anisotropic","EXT_frag_depth","WEBGL_draw_buffers","ANGLE_instanced_arrays","OES_texture_float_linear","OES_texture_half_float_linear","EXT_blend_minmax","EXT_shader_texture_lod","WEBGL_compressed_texture_pvrtc","EXT_color_buffer_half_float","WEBGL_color_buffer_float","EXT_sRGB","WEBGL_compressed_texture_etc1","EXT_disjoint_timer_query","WEBGL_compressed_texture_etc","WEBGL_compressed_texture_astc","EXT_color_buffer_float","WEBGL_compressed_texture_s3tc_srgb","EXT_disjoint_timer_query_webgl2"];var gq=$o.getSupportedExtensions();if(gq&&gq.length>0){$o.getSupportedExtensions().forEach(function(xq){if(fq.indexOf(xq)!=-1){$o.getExtension(xq)}})}},populateUniformTable:function(yq){var zq=Zo.programs[yq];Zo.programInfos[yq]={uniforms:{},maxUniformLength:0,maxAttributeLength:-1,maxUniformBlockNameLength:-1};var Aq=Zo.programInfos[yq];var Bq=Aq.uniforms;var Cq=$o.getProgramParameter(zq,$o.ACTIVE_UNIFORMS);for(var Dq=0;Dq<Cq;++Dq){var Eq=$o.getActiveUniform(zq,Dq);var Fq=Eq.name;Aq.maxUniformLength=Math.max(Aq.maxUniformLength,Fq.length+1);if(Fq.indexOf("]",Fq.length-1)!==-1){var Gq=Fq.lastIndexOf("[");Fq=Fq.slice(0,Gq)}var Hq=$o.getUniformLocation(zq,Fq);if(Hq!=null){var Iq=Zo.getNewId(Zo.uniforms);Bq[Fq]=[Eq.size,Iq];Zo.uniforms[Iq]=Hq;for(var Jq=1;Jq<Eq.size;++Jq){var Kq=Fq+"["+Jq+"]";Hq=$o.getUniformLocation(zq,Kq);Iq=Zo.getNewId(Zo.uniforms);Zo.uniforms[Iq]=Hq}}}}};var $o=undefined;var _o=console.error;var ap=Yo["WASM"]["GetString"];var bp=function(Lq,Mq,Nq){Yo["WASM"]["SetString"](Mq,Lq)};var cp=undefined;var dp=undefined;var ep=undefined;var fp=undefined;var gp=undefined;var hp=undefined;var ip=undefined;function jp(Oq){return Yo["WASM"]["Malloc"](Oq)}function kp(Pq){Yo["WASM"]["Free"](Pq)}function lp(Qq,Rq,Sq){return Sq?+(Qq>>>0)+ +(Rq>>>0)*4294967296:+(Qq>>>0)+ +(Rq|0)*4294967296}function mp(Tq){switch(Tq){case 34962:Tq=34964;break;case 34963:Tq=34965;break;case 35051:Tq=35053;break;case 35052:Tq=35055;break;case 35982:Tq=35983;break;case 36662:Tq=36662;break;case 36663:Tq=36663;break;case 35345:Tq=35368;break}var Uq=$o.getParameter(Tq);if(Uq)return Uq.name|0;else return 0}function np(Vq){switch(Vq){case 34962:case 34963:case 36662:case 36663:case 35051:case 35052:case 35882:case 35982:case 35345:return true;default:return false}}function op(Wq,Xq,Yq,Zq){if(!Yq){Zo.recordError(1281);return}var $q=$o["getIndexedParameter"](Wq,Xq);var _q;switch(typeof $q){case"boolean":_q=$q?1:0;break;case"number":_q=$q;break;case"object":if($q===null){switch(Wq){case 35983:case 35368:_q=0;break;default:{Zo.recordError(1280);return}}}else if($q instanceof WebGLBuffer){_q=$q["name"]|0}else{Zo.recordError(1280);return}break;default:Zo.recordError(1280);return}switch(Zq){case"Integer64":var ar=0;var br=[_q>>>0,(ar=_q,+Math.abs(ar)>=1?ar>0?(Math.min(+Math.floor(ar/4294967296),4294967295)|0)>>>0:~~+Math.ceil((ar-+(~~ar>>>0))/4294967296)>>>0:0)];gp[Yq>>2]=br[0];gp[Yq+4>>2]=br[1];break;case"Integer":gp[Yq>>2]=_q;break;case"Float":ip[Yq>>2]=_q;break;case"Boolean":cp[Yq>>0]=_q?1:0;break;default:throw"internal emscriptenWebGLGetIndexed() error, bad type: "+Zq}}function pp(cr,dr,er){if(!dr){Zo.recordError(1281);return}var fr=undefined;switch(cr){case 36346:fr=1;break;case 36344:if(er!=="Integer"&&er!=="Integer64"){Zo.recordError(1280)}return;case 34814:case 36345:fr=0;break;case 34466:var gr=$o.getParameter(34467);fr=gr.length;break;case 33309:if($o.canvas.GLctxObject.version<2){Zo.recordError(1282);return}var hr=$o.getSupportedExtensions();fr=2*hr.length;break;case 33307:case 33308:if($o.canvas.GLctxObject.version<2){Zo.recordError(1280);return}fr=cr==33307?3:0;break}if(fr===undefined){var ir=$o.getParameter(cr);switch(typeof ir){case"number":fr=ir;break;case"boolean":fr=ir?1:0;break;case"string":Zo.recordError(1280);return;case"object":if(ir===null){switch(cr){case 34964:case 35725:case 34965:case 36006:case 36007:case 32873:case 34229:case 35097:case 36389:case 34068:{fr=0;break};default:{Zo.recordError(1280);return}}}else if(ir instanceof Float32Array||ir instanceof Uint32Array||ir instanceof Int32Array||ir instanceof Array){for(var jr=0;jr<ir.length;++jr){switch(er){case"Integer":gp[dr+jr*4>>2]=ir[jr];break;case"Float":ip[dr+jr*4>>2]=ir[jr];break;case"Boolean":cp[dr+jr>>0]=ir[jr]?1:0;break;default:throw"internal glGet error, bad type: "+er}}return}else if(ir instanceof WebGLBuffer||ir instanceof WebGLProgram||ir instanceof WebGLFramebuffer||ir instanceof WebGLRenderbuffer||ir instanceof WebGLQuery||ir instanceof WebGLSampler||ir instanceof WebGLSync||ir instanceof WebGLTransformFeedback||ir instanceof WebGLVertexArrayObject||ir instanceof WebGLTexture){fr=ir["name"]|0}else{Zo.recordError(1280);return}break;default:Zo.recordError(1280);return}}switch(er){case"Integer64":var kr=0;var lr=[fr>>>0,(kr=fr,+Math.abs(kr)>=1?kr>0?(Math.min(+Math.floor(kr/4294967296),4294967295)|0)>>>0:~~+Math.ceil((kr-+(~~kr>>>0))/4294967296)>>>0:0)];gp[dr>>2]=lr[0];gp[dr+4>>2]=lr[1];break;case"Integer":gp[dr>>2]=fr;break;case"Float":ip[dr>>2]=fr;break;case"Boolean":cp[dr>>0]=fr?1:0;break;default:throw"internal glGet error, bad type: "+er}}function qp(mr,nr,or,pr){if(!or){Zo.recordError(1281);return}var qr=$o.getUniform(Zo.programs[mr],Zo.uniforms[nr]);if(typeof qr=="number"||typeof qr=="boolean"){switch(pr){case"Integer":gp[or>>2]=qr;break;case"Float":ip[or>>2]=qr;break;default:throw"internal emscriptenWebGLGetUniform() error, bad type: "+pr}}else{for(var rr=0;rr<qr.length;rr++){switch(pr){case"Integer":gp[or+rr*4>>2]=qr[rr];break;case"Float":ip[or+rr*4>>2]=qr[rr];break;default:throw"internal emscriptenWebGLGetUniform() error, bad type: "+pr}}}}function rp(sr,tr,ur,vr){if(!ur){Zo.recordError(1281);return}var wr=$o.getVertexAttrib(sr,tr);if(tr==34975){gp[ur>>2]=wr["name"]}else if(typeof wr=="number"||typeof wr=="boolean"){switch(vr){case"Integer":gp[ur>>2]=wr;break;case"Float":ip[ur>>2]=wr;break;case"FloatToInteger":gp[ur>>2]=Math["fround"](wr);break;default:throw"internal emscriptenWebGLGetVertexAttrib() error, bad type: "+vr}}else{for(var xr=0;xr<wr.length;xr++){switch(vr){case"Integer":gp[ur+xr*4>>2]=wr[xr];break;case"Float":ip[ur+xr*4>>2]=wr[xr];break;case"FloatToInteger":gp[ur+xr*4>>2]=Math["fround"](wr[xr]);break;default:throw"internal emscriptenWebGLGetVertexAttrib() error, bad type: "+vr}}}}function sp(yr,zr,Ar,Br){function Cr(Fr,Gr){return Math.floor((Fr+Gr-1)/Gr)*Gr}var Dr=yr*Ar;var Er=Cr(Dr,Br);return zr<=0?0:(zr-1)*Er+Dr}function tp(Hr,Ir,Jr,Kr,Lr,Mr){var Nr;var Or;switch(Ir){case 6406:case 6409:case 6402:case 6403:case 36244:Or=1;break;case 6410:case 33319:case 33320:Or=2;break;case 6407:case 35904:case 36248:Or=3;break;case 6408:case 35906:case 36249:Or=4;break;default:Zo.recordError(1280);return null}switch(Hr){case 5121:case 5120:Nr=Or*1;break;case 5123:case 36193:case 5131:case 5122:Nr=Or*2;break;case 5125:case 5126:case 5124:Nr=Or*4;break;case 34042:case 35902:case 33640:case 35899:case 34042:Nr=4;break;case 33635:case 32819:case 32820:Nr=2;break;default:Zo.recordError(1280);return null}var Pr=sp(Jr,Kr,Nr,Zo.unpackAlignment);switch(Hr){case 5120:return cp.subarray(Lr,Lr+Pr);case 5121:return dp.subarray(Lr,Lr+Pr);case 5122:return ep.subarray(Lr>>1,Lr+Pr>>1);case 5124:return gp.subarray(Lr>>2,Lr+Pr>>2);case 5126:return ip.subarray(Lr>>2,Lr+Pr>>2);case 5125:case 34042:case 35902:case 33640:case 35899:case 34042:return hp.subarray(Lr>>2,Lr+Pr>>2);case 5123:case 33635:case 32819:case 32820:case 36193:case 5131:return fp.subarray(Lr>>1,Lr+Pr>>1);default:Zo.recordError(1280);return null}}function up(Qr){switch(Qr){case 5120:return cp;case 5121:return dp;case 5122:return ep;case 5123:case 33635:case 32819:case 32820:case 36193:case 5131:return fp;case 5124:return gp;case 5125:case 34042:case 35902:case 33640:case 35899:case 34042:return hp;case 5126:return ip;default:return null}}function vp(Rr){switch(Rr){case 5120:case 5121:return 0;case 5122:case 5123:case 33635:case 32819:case 32820:case 36193:case 5131:return 1;case 5124:case 5126:case 5125:case 34042:case 35902:case 33640:case 35899:case 34042:return 2;default:return 0}}var wp=function(){function Sr(){this.Ctx=undefined}Sr.prototype.FlushHeap=function(){cp=Yo["WASM"]["HEAP8"]();dp=Yo["WASM"]["HEAPU8"]();ep=Yo["WASM"]["HEAP16"]();fp=Yo["WASM"]["HEAPU16"]();gp=Yo["WASM"]["HEAP32"]();hp=Yo["WASM"]["HEAPU32"]();ip=Yo["WASM"]["HEAPF32"]()};Sr.prototype.CreateContext=function(Tr,Ur){Ur=Ur||{majorVersion:1,minorVersion:0,alpha:0,depth:1,stencil:0,antialias:1,premultipliedAlpha:0,preserveDrawingBuffer:0,preferLowPowerToHighPerformance:0,failIfMajorPerformanceCaveat:0,enableExtensionsByDefault:1,explicitSwapControl:0,proxyContextToMainThread:0,renderViaOffscreenBackBuffer:0};if(Ur["explicitSwapControl"]){return 0}Zo.init();var Vr=Zo.createContext(Tr,Ur);var Wr=Zo.makeContextCurrent(Vr);this.Ctx=$o;return Wr?0:-5};Sr.prototype.DestroyContext=function(){Zo.deleteContext(Zo.currentContext?Zo.currentContext.handle:0)};Sr.prototype.GetTextureByHandle=function(Xr){return Xr?Zo.textures[Xr]:null};Sr.prototype.RegisterTexture=function(Yr){var Zr=Zo.getNewId(Zo.textures);Yr.name=Zr;Zo.textures[Zr]=Yr;return Zr};Sr.prototype._glActiveTexture=function($r){$o["activeTexture"]($r)};Sr.prototype._glAttachShader=function(_r,as){$o.attachShader(Zo.programs[_r],Zo.shaders[as])};Sr.prototype._glBeginQuery=function(bs,cs){$o["beginQuery"](bs,cs?Zo.queries[cs]:null)};Sr.prototype._glBeginTransformFeedback=function(ds){$o["beginTransformFeedback"](ds)};Sr.prototype._glBindAttribLocation=function(es,fs,gs){gs=ap(gs);$o.bindAttribLocation(Zo.programs[es],fs,gs)};Sr.prototype._glBindBuffer=function(hs,is){var js=is?Zo.buffers[is]:null;if(hs==35051){$o.currentPixelPackBufferBinding=is}else if(hs==35052){$o.currentPixelUnpackBufferBinding=is}$o.bindBuffer(hs,js)};Sr.prototype._glBindBufferBase=function(ks,ls,ms){var ns=ms?Zo.buffers[ms]:null;$o["bindBufferBase"](ks,ls,ns)};Sr.prototype._glBindBufferRange=function(os,ps,qs,rs,ss){var ts=qs?Zo.buffers[qs]:null;$o["bindBufferRange"](os,ps,ts,rs,ss)};Sr.prototype._glBindFramebuffer=function(us,vs){$o.bindFramebuffer(us,vs?Zo.framebuffers[vs]:null)};Sr.prototype._glBindRenderbuffer=function(ws,xs){$o.bindRenderbuffer(ws,xs?Zo.renderbuffers[xs]:null)};Sr.prototype._glBindSampler=function(ys,zs){$o["bindSampler"](ys,zs?Zo.samplers[zs]:null)};Sr.prototype._glBindTexture=function(As,Bs){$o.bindTexture(As,Bs?Zo.textures[Bs]:null)};Sr.prototype._glBindTransformFeedback=function(Cs,Ds){var Es=Ds?Zo.transformFeedbacks[Ds]:null;if(Ds&&!Es){Zo.recordError(1282);return}$o["bindTransformFeedback"](Cs,Es)};Sr.prototype._glBindVertexArray=function(Fs){$o["bindVertexArray"](Zo.vaos[Fs])};Sr.prototype._glBlendEquation=function(Gs){$o["blendEquation"](Gs)};Sr.prototype._glBlendEquationSeparate=function(Hs,Is){$o["blendEquationSeparate"](Hs,Is)};Sr.prototype._glBlendFuncSeparate=function(Js,Ks,Ls,Ms){$o["blendFuncSeparate"](Js,Ks,Ls,Ms)};Sr.prototype._glBlitFramebuffer=function(Ns,Os,Ps,Qs,Rs,Ss,Ts,Us,Vs,Ws){$o["blitFramebuffer"](Ns,Os,Ps,Qs,Rs,Ss,Ts,Us,Vs,Ws)};Sr.prototype._glBufferData=function(Xs,Ys,Zs,$s){if(!Zs){$o.bufferData(Xs,Ys,$s)}else{if(Zo.currentContext.supportsWebGL2EntryPoints){$o.bufferData(Xs,dp,$s,Zs,Ys);return}$o.bufferData(Xs,dp.subarray(Zs,Zs+Ys),$s)}};Sr.prototype._glBufferSubData=function(_s,at,bt,ct){if(Zo.currentContext.supportsWebGL2EntryPoints){$o.bufferSubData(_s,at,dp,ct,bt);return}$o.bufferSubData(_s,at,dp.subarray(ct,ct+bt))};Sr.prototype._glCheckFramebufferStatus=function(dt){return $o["checkFramebufferStatus"](dt)};Sr.prototype._glClear=function(et){$o["clear"](et)};Sr.prototype._glClearColor=function(ft,gt,ht,it){$o["clearColor"](ft,gt,ht,it)};Sr.prototype._glClearDepthf=function(jt){$o["clearDepth"](jt)};Sr.prototype._glClearStencil=function(kt){$o["clearStencil"](kt)};Sr.prototype._glClientWaitSync=function(lt,mt,nt,ot){nt=nt>>>0;ot=ot>>>0;var pt=nt==4294967295&&ot==4294967295?-1:lp(nt,ot,true);return $o.clientWaitSync(Zo.syncs[lt],mt,pt)};Sr.prototype._glColorMask=function(qt,rt,st,tt){$o.colorMask(!!qt,!!rt,!!st,!!tt)};Sr.prototype._glCompileShader=function(ut){$o.compileShader(Zo.shaders[ut])};Sr.prototype._glCompressedTexImage2D=function(vt,wt,xt,yt,zt,At,Bt,Ct){if(Zo.currentContext.supportsWebGL2EntryPoints){$o["compressedTexImage2D"](vt,wt,xt,yt,zt,At,dp,Ct,Bt);return}$o["compressedTexImage2D"](vt,wt,xt,yt,zt,At,Ct?dp.subarray(Ct,Ct+Bt):null)};Sr.prototype._glCompressedTexSubImage2D=function(Dt,Et,Ft,Gt,Ht,It,Jt,Kt,Lt){if(Zo.currentContext.supportsWebGL2EntryPoints){$o["compressedTexSubImage2D"](Dt,Et,Ft,Gt,Ht,It,Jt,dp,Lt,Kt);return}$o["compressedTexSubImage2D"](Dt,Et,Ft,Gt,Ht,It,Jt,Lt?dp.subarray(Lt,Lt+Kt):null)};Sr.prototype._glCompressedTexSubImage3D=function(Mt,Nt,Ot,Pt,Qt,Rt,St,Tt,Ut,Vt,Wt){if(Zo.currentContext.supportsWebGL2EntryPoints){$o["compressedTexSubImage3D"](Mt,Nt,Ot,Pt,Qt,Rt,St,Tt,Ut,dp,Wt,Vt)}else{$o["compressedTexSubImage3D"](Mt,Nt,Ot,Pt,Qt,Rt,St,Tt,Ut,Wt?dp.subarray(Wt,Wt+Vt):null)}};Sr.prototype._glCopyBufferSubData=function(Xt,Yt,Zt,$t,_t){$o["copyBufferSubData"](Xt,Yt,Zt,$t,_t)};Sr.prototype._glCopyTexImage2D=function(au,bu,cu,du,eu,fu,gu,hu){$o["copyTexImage2D"](au,bu,cu,du,eu,fu,gu,hu)};Sr.prototype._glCopyTexSubImage2D=function(iu,ju,ku,lu,mu,nu,ou,pu){$o["copyTexSubImage2D"](iu,ju,ku,lu,mu,nu,ou,pu)};Sr.prototype._glCreateProgram=function(){var qu=Zo.getNewId(Zo.programs);var ru=$o.createProgram();ru.name=qu;Zo.programs[qu]=ru;return qu};Sr.prototype._glCreateShader=function(su){var tu=Zo.getNewId(Zo.shaders);Zo.shaders[tu]=$o.createShader(su);return tu};Sr.prototype._glCullFace=function(uu){$o["cullFace"](uu)};Sr.prototype._glDeleteBuffers=function(vu,wu){for(var xu=0;xu<vu;xu++){var yu=gp[wu+xu*4>>2];var zu=Zo.buffers[yu];if(!zu)continue;$o.deleteBuffer(zu);zu.name=0;Zo.buffers[yu]=null;if(yu==Zo.currArrayBuffer)Zo.currArrayBuffer=0;if(yu==Zo.currElementArrayBuffer)Zo.currElementArrayBuffer=0}};Sr.prototype._glDeleteFramebuffers=function(Au,Bu){for(var Cu=0;Cu<Au;++Cu){var Du=gp[Bu+Cu*4>>2];var Eu=Zo.framebuffers[Du];if(!Eu)continue;$o.deleteFramebuffer(Eu);Eu.name=0;Zo.framebuffers[Du]=null}};Sr.prototype._glDeleteProgram=function(Fu){if(!Fu)return;var Gu=Zo.programs[Fu];if(!Gu){Zo.recordError(1281);return}$o.deleteProgram(Gu);Gu.name=0;Zo.programs[Fu]=null;Zo.programInfos[Fu]=null};Sr.prototype._glDeleteQueries=function(Hu,Iu){for(var Ju=0;Ju<Hu;Ju++){var Ku=gp[Iu+Ju*4>>2];var Lu=Zo.queries[Ku];if(!Lu)continue;$o["deleteQuery"](Lu);Zo.queries[Ku]=null}};Sr.prototype._glDeleteRenderbuffers=function(Mu,Nu){for(var Ou=0;Ou<Mu;Ou++){var Pu=gp[Nu+Ou*4>>2];var Qu=Zo.renderbuffers[Pu];if(!Qu)continue;$o.deleteRenderbuffer(Qu);Qu.name=0;Zo.renderbuffers[Pu]=null}};Sr.prototype._glDeleteSamplers=function(Ru,Su){for(var Tu=0;Tu<Ru;Tu++){var Uu=gp[Su+Tu*4>>2];var Vu=Zo.samplers[Uu];if(!Vu)continue;$o["deleteSampler"](Vu);Vu.name=0;Zo.samplers[Uu]=null}};Sr.prototype._glDeleteShader=function(Wu){if(!Wu)return;var Xu=Zo.shaders[Wu];if(!Xu){Zo.recordError(1281);return}$o.deleteShader(Xu);Zo.shaders[Wu]=null};Sr.prototype._glDeleteSync=function(Yu){if(!Yu)return;var Zu=Zo.syncs[Yu];if(!Zu){Zo.recordError(1281);return}$o.deleteSync(Zu);Zu.name=0;Zo.syncs[Yu]=null};Sr.prototype._glDeleteTextures=function($u,_u){for(var av=0;av<$u;av++){var bv=gp[_u+av*4>>2];var cv=Zo.textures[bv];if(!cv)continue;$o.deleteTexture(cv);cv.name=0;Zo.textures[bv]=null}};Sr.prototype._glDeleteTransformFeedbacks=function(dv,ev){for(var fv=0;fv<dv;fv++){var gv=gp[ev+fv*4>>2];var hv=Zo.transformFeedbacks[gv];if(!hv)continue;$o["deleteTransformFeedback"](hv);hv.name=0;Zo.transformFeedbacks[gv]=null}};Sr.prototype._glDeleteVertexArrays=function(iv,jv){for(var kv=0;kv<iv;kv++){var lv=gp[jv+kv*4>>2];$o["deleteVertexArray"](Zo.vaos[lv]);Zo.vaos[lv]=null}};Sr.prototype._glDepthFunc=function(mv){$o["depthFunc"](mv)};Sr.prototype._glDepthMask=function(nv){$o.depthMask(!!nv)};Sr.prototype._glDetachShader=function(ov,pv){$o.detachShader(Zo.programs[ov],Zo.shaders[pv])};Sr.prototype._glDisable=function(qv){$o["disable"](qv)};Sr.prototype._glDisableVertexAttribArray=function(rv){$o.disableVertexAttribArray(rv)};Sr.prototype._glDrawArrays=function(sv,tv,uv){$o.drawArrays(sv,tv,uv)};Sr.prototype._glDrawArraysInstanced=function(vv,wv,xv,yv){$o["drawArraysInstanced"](vv,wv,xv,yv)};Sr.prototype._glDrawBuffers=function(zv,Av){var Bv=Zo.tempFixedLengthArray[zv];for(var Cv=0;Cv<zv;Cv++){Bv[Cv]=gp[Av+Cv*4>>2]}$o["drawBuffers"](Bv)};Sr.prototype._glDrawElements=function(Dv,Ev,Fv,Gv){$o.drawElements(Dv,Ev,Fv,Gv)};Sr.prototype._glDrawElementsInstanced=function(Hv,Iv,Jv,Kv,Lv){$o["drawElementsInstanced"](Hv,Iv,Jv,Kv,Lv)};Sr.prototype._glEnable=function(Mv){$o["enable"](Mv)};Sr.prototype._glEnableVertexAttribArray=function(Nv){$o.enableVertexAttribArray(Nv)};Sr.prototype._glEndQuery=function(Ov){$o["endQuery"](Ov)};Sr.prototype._glEndTransformFeedback=function(){$o["endTransformFeedback"]()};Sr.prototype._glFenceSync=function(Pv,Qv){var Rv=$o.fenceSync(Pv,Qv);if(Rv){var Sv=Zo.getNewId(Zo.syncs);Rv.name=Sv;Zo.syncs[Sv]=Rv;return Sv}else{return 0}};Sr.prototype._glFinish=function(){$o["finish"]()};Sr.prototype._glFlush=function(){$o["flush"]()};Sr.prototype._glFlushMappedBufferRange=function(Tv,Uv,Vv){if(!np(Tv)){Zo.recordError(1280);_o("GL_INVALID_ENUM in glFlushMappedBufferRange");return}var Wv=Zo.mappedBuffers[mp(Tv)];if(!Wv){Zo.recordError(1282);_o("buffer was never mapped in glFlushMappedBufferRange");return}if(!(Wv.access&16)){Zo.recordError(1282);_o("buffer was not mapped with GL_MAP_FLUSH_EXPLICIT_BIT in glFlushMappedBufferRange");return}if(Uv<0||Vv<0||Uv+Vv>Wv.length){Zo.recordError(1281);_o("invalid range in glFlushMappedBufferRange");return}$o.bufferSubData(Tv,Wv.offset,dp.subarray(Wv.mem+Uv,Wv.mem+Uv+Vv))};Sr.prototype._glFramebufferRenderbuffer=function(Xv,Yv,Zv,$v){$o.framebufferRenderbuffer(Xv,Yv,Zv,Zo.renderbuffers[$v])};Sr.prototype._glFramebufferTexture2D=function(_v,aw,bw,cw,dw){$o.framebufferTexture2D(_v,aw,bw,Zo.textures[cw],dw)};Sr.prototype._glFramebufferTextureLayer=function(ew,fw,gw,hw,iw){$o.framebufferTextureLayer(ew,fw,Zo.textures[gw],hw,iw)};Sr.prototype._glFrontFace=function(jw){$o["frontFace"](jw)};Sr.prototype._glGenBuffers=function(kw,lw){for(var mw=0;mw<kw;mw++){var nw=$o.createBuffer();if(!nw){Zo.recordError(1282);while(mw<kw)gp[lw+mw++*4>>2]=0;return}var ow=Zo.getNewId(Zo.buffers);nw.name=ow;Zo.buffers[ow]=nw;gp[lw+mw*4>>2]=ow}};Sr.prototype._glGenFramebuffers=function(pw,qw){for(var rw=0;rw<pw;++rw){var sw=$o.createFramebuffer();if(!sw){Zo.recordError(1282);while(rw<pw)gp[qw+rw++*4>>2]=0;return}var tw=Zo.getNewId(Zo.framebuffers);sw.name=tw;Zo.framebuffers[tw]=sw;gp[qw+rw*4>>2]=tw}};Sr.prototype._glGenQueries=function(uw,vw){for(var ww=0;ww<uw;ww++){var xw=$o["createQuery"]();if(!xw){Zo.recordError(1282);while(ww<uw)gp[vw+ww++*4>>2]=0;return}var yw=Zo.getNewId(Zo.queries);xw.name=yw;Zo.queries[yw]=xw;gp[vw+ww*4>>2]=yw}};Sr.prototype._glGenRenderbuffers=function(zw,Aw){for(var Bw=0;Bw<zw;Bw++){var Cw=$o.createRenderbuffer();if(!Cw){Zo.recordError(1282);while(Bw<zw)gp[Aw+Bw++*4>>2]=0;return}var Dw=Zo.getNewId(Zo.renderbuffers);Cw.name=Dw;Zo.renderbuffers[Dw]=Cw;gp[Aw+Bw*4>>2]=Dw}};Sr.prototype._glGenSamplers=function(Ew,Fw){for(var Gw=0;Gw<Ew;Gw++){var Hw=$o["createSampler"]();if(!Hw){Zo.recordError(1282);while(Gw<Ew)gp[Fw+Gw++*4>>2]=0;return}var Iw=Zo.getNewId(Zo.samplers);Hw.name=Iw;Zo.samplers[Iw]=Hw;gp[Fw+Gw*4>>2]=Iw}};Sr.prototype._glGenTextures=function(Jw,Kw){for(var Lw=0;Lw<Jw;Lw++){var Mw=$o.createTexture();if(!Mw){Zo.recordError(1282);while(Lw<Jw)gp[Kw+Lw++*4>>2]=0;return}var Nw=Zo.getNewId(Zo.textures);Mw.name=Nw;Zo.textures[Nw]=Mw;gp[Kw+Lw*4>>2]=Nw}};Sr.prototype._glGenTransformFeedbacks=function(Ow,Pw){for(var Qw=0;Qw<Ow;Qw++){var Rw=$o["createTransformFeedback"]();if(!Rw){Zo.recordError(1282);while(Qw<Ow)gp[Pw+Qw++*4>>2]=0;return}var Sw=Zo.getNewId(Zo.transformFeedbacks);Rw.name=Sw;Zo.transformFeedbacks[Sw]=Rw;gp[Pw+Qw*4>>2]=Sw}};Sr.prototype._glGenVertexArrays=function(Tw,Uw){for(var Vw=0;Vw<Tw;Vw++){var Ww=$o["createVertexArray"]();if(!Ww){Zo.recordError(1282);while(Vw<Tw)gp[Uw+Vw++*4>>2]=0;return}var Xw=Zo.getNewId(Zo.vaos);Ww.name=Xw;Zo.vaos[Xw]=Ww;gp[Uw+Vw*4>>2]=Xw}};Sr.prototype._glGenerateMipmap=function(Yw){$o["generateMipmap"](Yw)};Sr.prototype._glGetActiveAttrib=function(Zw,$w,_w,ax,bx,cx,dx){Zw=Zo.programs[Zw];var ex=$o.getActiveAttrib(Zw,$w);if(!ex)return;if(_w>0&&dx){var fx=bp(ex.name,dx,_w);if(ax)gp[ax>>2]=fx}else{if(ax)gp[ax>>2]=0}if(bx)gp[bx>>2]=ex.size;if(cx)gp[cx>>2]=ex.type};Sr.prototype._glGetActiveUniform=function(gx,hx,ix,jx,kx,lx,mx){gx=Zo.programs[gx];var nx=$o.getActiveUniform(gx,hx);if(!nx)return;if(ix>0&&mx){var ox=bp(nx.name,mx,ix);if(jx)gp[jx>>2]=ox}else{if(jx)gp[jx>>2]=0}if(kx)gp[kx>>2]=nx.size;if(lx)gp[lx>>2]=nx.type};Sr.prototype._glGetActiveUniformBlockName=function(px,qx,rx,sx,tx){px=Zo.programs[px];var ux=$o["getActiveUniformBlockName"](px,qx);if(!ux)return;if(tx&&rx>0){var vx=bp(ux,tx,rx);if(sx)gp[sx>>2]=vx}else{if(sx)gp[sx>>2]=0}};Sr.prototype._glGetActiveUniformBlockiv=function(wx,xx,yx,zx){if(!zx){Zo.recordError(1281);return}wx=Zo.programs[wx];switch(yx){case 35393:var Ax=$o["getActiveUniformBlockName"](wx,xx);gp[zx>>2]=Ax.length+1;return;default:var Bx=$o["getActiveUniformBlockParameter"](wx,xx,yx);if(!Bx)return;if(typeof Bx=="number"){gp[zx>>2]=Bx}else{for(var Cx=0;Cx<Bx.length;Cx++){gp[zx+Cx*4>>2]=Bx[Cx]}}}};Sr.prototype._glGetActiveUniformsiv=function(Dx,Ex,Fx,Gx,Hx){if(!Hx){Zo.recordError(1281);return}if(Ex>0&&Fx==0){Zo.recordError(1281);return}Dx=Zo.programs[Dx];var Ix=[];for(var Jx=0;Jx<Ex;Jx++){Ix.push(gp[Fx+Jx*4>>2])}var Kx=$o["getActiveUniforms"](Dx,Ix,Gx);if(!Kx)return;var Lx=Kx.length;for(var Jx=0;Jx<Lx;Jx++){gp[Hx+Jx*4>>2]=Kx[Jx]}};Sr.prototype._glGetAttribLocation=function(Mx,Nx){return $o.getAttribLocation(Zo.programs[Mx],ap(Nx))};Sr.prototype._glGetError=function(){if(Zo.lastError){var Ox=Zo.lastError;Zo.lastError=0;return Ox}else{return $o.getError()}};Sr.prototype._glGetFramebufferAttachmentParameteriv=function(Px,Qx,Rx,Sx){var Tx=$o.getFramebufferAttachmentParameter(Px,Qx,Rx);if(Tx instanceof WebGLRenderbuffer||Tx instanceof WebGLTexture){Tx=Tx["name"]|0}gp[Sx>>2]=Tx};Sr.prototype._glGetIntegeri_v=function(Ux,Vx,Wx){op(Ux,Vx,Wx,"Integer")};Sr.prototype._glGetIntegerv=function(Xx,Yx){pp(Xx,Yx,"Integer")};Sr.prototype._glGetInternalformativ=function(Zx,$x,_x,ay,by){if(ay<0){Zo.recordError(1281);return}var cy=$o["getInternalformatParameter"](Zx,$x,32937);if(!cy){Zo.recordError(1280);return}switch(_x){case 32937:var dy=Math.min(ay,cy.length);for(var ey=0;ey<dy;ey++){var fy=cy[ey];gp[by+ey*4>>2]=fy}break;case 37760:if(ay>1){var fy=cy.length;gp[by>>2]=fy}break;default:Zo.recordError(1280)}};Sr.prototype._glGetProgramBinary=function(gy,hy,iy,jy,ky){Zo.recordError(1282)};Sr.prototype._glGetProgramInfoLog=function(ly,my,ny,oy){var py=$o.getProgramInfoLog(Zo.programs[ly]);if(py===null)py="(unknown error)";if(my>0&&oy){var qy=bp(py,oy,my);if(ny)gp[ny>>2]=qy}else{if(ny)gp[ny>>2]=0}};Sr.prototype._glGetProgramiv=function(ry,sy,ty){if(!ty){Zo.recordError(1281);return}if(ry>=Zo.counter){Zo.recordError(1281);return}var uy=Zo.programInfos[ry];if(!uy){Zo.recordError(1282);return}if(sy==35716){var vy=$o.getProgramInfoLog(Zo.programs[ry]);if(vy===null)vy="(unknown error)";gp[ty>>2]=vy.length+1}else if(sy==35719){gp[ty>>2]=uy.maxUniformLength}else if(sy==35722){if(uy.maxAttributeLength==-1){ry=Zo.programs[ry];var wy=$o.getProgramParameter(ry,$o.ACTIVE_ATTRIBUTES);uy.maxAttributeLength=0;for(var xy=0;xy<wy;++xy){var yy=$o.getActiveAttrib(ry,xy);uy.maxAttributeLength=Math.max(uy.maxAttributeLength,yy.name.length+1)}}gp[ty>>2]=uy.maxAttributeLength}else if(sy==35381){if(uy.maxUniformBlockNameLength==-1){ry=Zo.programs[ry];var zy=$o.getProgramParameter(ry,$o.ACTIVE_UNIFORM_BLOCKS);uy.maxUniformBlockNameLength=0;for(var xy=0;xy<zy;++xy){var Ay=$o.getActiveUniformBlockName(ry,xy);uy.maxUniformBlockNameLength=Math.max(uy.maxUniformBlockNameLength,Ay.length+1)}}gp[ty>>2]=uy.maxUniformBlockNameLength}else{gp[ty>>2]=$o.getProgramParameter(Zo.programs[ry],sy)}};Sr.prototype._glGetRenderbufferParameteriv=function(By,Cy,Dy){if(!Dy){Zo.recordError(1281);return}gp[Dy>>2]=$o.getRenderbufferParameter(By,Cy)};Sr.prototype._glGetShaderInfoLog=function(Ey,Fy,Gy,Hy){var Iy=$o.getShaderInfoLog(Zo.shaders[Ey]);if(Iy===null)Iy="(unknown error)";if(Fy>0&&Hy){var Jy=bp(Iy,Hy,Fy);if(Gy)gp[Gy>>2]=Jy}else{if(Gy)gp[Gy>>2]=0}};Sr.prototype._glGetShaderPrecisionFormat=function(Ky,Ly,My,Ny){var Oy=$o.getShaderPrecisionFormat(Ky,Ly);gp[My>>2]=Oy.rangeMin;gp[My+4>>2]=Oy.rangeMax;gp[Ny>>2]=Oy.precision};Sr.prototype._glGetShaderSource=function(Py,Qy,Ry,Sy){var Ty=$o.getShaderSource(Zo.shaders[Py]);if(!Ty)return;if(Qy>0&&Sy){var Uy=bp(Ty,Sy,Qy);if(Ry)gp[Ry>>2]=Uy}else{if(Ry)gp[Ry>>2]=0}};Sr.prototype._glGetShaderiv=function(Vy,Wy,Xy){if(!Xy){Zo.recordError(1281);return}if(Wy==35716){var Yy=$o.getShaderInfoLog(Zo.shaders[Vy]);if(Yy===null)Yy="(unknown error)";gp[Xy>>2]=Yy.length+1}else if(Wy==35720){var Zy=$o.getShaderSource(Zo.shaders[Vy]);var $y=Zy===null||Zy.length==0?0:Zy.length+1;gp[Xy>>2]=$y}else{gp[Xy>>2]=$o.getShaderParameter(Zo.shaders[Vy],Wy)}};Sr.prototype._glGetString=function(_y){_o("unsupported glGetString");return 0};Sr.prototype._glGetStringi=function(az,bz){_o("unsupported glGetStringi");return 0};Sr.prototype._glGetTexParameteriv=function(cz,dz,ez){if(!ez){Zo.recordError(1281);return}gp[ez>>2]=$o.getTexParameter(cz,dz)};Sr.prototype._glGetUniformBlockIndex=function(fz,gz){fz=Zo.programs[fz];gz=ap(gz);return $o["getUniformBlockIndex"](fz,gz)};Sr.prototype._glGetUniformIndices=function(hz,iz,jz,kz){if(!kz){Zo.recordError(1281);return}if(iz>0&&(jz==0||kz==0)){Zo.recordError(1281);return}hz=Zo.programs[hz];var lz=[];for(var mz=0;mz<iz;mz++)lz.push(ap(gp[jz+mz*4>>2]));var nz=$o["getUniformIndices"](hz,lz);if(!nz)return;var oz=nz.length;for(var mz=0;mz<oz;mz++){gp[kz+mz*4>>2]=nz[mz]}};Sr.prototype._glGetUniformLocation=function(pz,qz){qz=ap(qz);var rz=0;if(qz.indexOf("]",qz.length-1)!==-1){var sz=qz.lastIndexOf("[");var tz=qz.slice(sz+1,-1);if(tz.length>0){rz=parseInt(tz);if(rz<0){return-1}}qz=qz.slice(0,sz)}var uz=Zo.programInfos[pz];if(!uz){return-1}var vz=uz.uniforms;var wz=vz[qz];if(wz&&rz<wz[0]){return wz[1]+rz}else{return-1}};Sr.prototype._glGetUniformiv=function(xz,yz,zz){qp(xz,yz,zz,"Integer")};Sr.prototype._glGetVertexAttribiv=function(Az,Bz,Cz){rp(Az,Bz,Cz,"FloatToInteger")};Sr.prototype._glInvalidateFramebuffer=function(Dz,Ez,Fz){var Gz=Zo.tempFixedLengthArray[Ez];for(var Hz=0;Hz<Ez;Hz++){Gz[Hz]=gp[Fz+Hz*4>>2]}$o["invalidateFramebuffer"](Dz,Gz)};Sr.prototype._glIsEnabled=function(Iz){return $o["isEnabled"](Iz)};Sr.prototype._glIsVertexArray=function(Jz){var Kz=Zo.vaos[Jz];if(!Kz)return 0;return $o["isVertexArray"](Kz)};Sr.prototype._glLinkProgram=function(Lz){$o.linkProgram(Zo.programs[Lz]);Zo.programInfos[Lz]=null;Zo.populateUniformTable(Lz)};Sr.prototype._glMapBufferRange=function(Mz,Nz,Oz,Pz){if(Pz!=26&&Pz!=10){_o("glMapBufferRange is only supported when access is MAP_WRITE|INVALIDATE_BUFFER");return 0}if(!np(Mz)){Zo.recordError(1280);_o("GL_INVALID_ENUM in glMapBufferRange");return 0}var Qz=jp(Oz);if(!Qz)return 0;Zo.mappedBuffers[mp(Mz)]={offset:Nz,length:Oz,mem:Qz,access:Pz};return Qz};Sr.prototype._glPixelStorei=function(Rz,Sz){if(Rz==3333){Zo.packAlignment=Sz}else if(Rz==3317){Zo.unpackAlignment=Sz}$o.pixelStorei(Rz,Sz)};Sr.prototype._glPolygonOffset=function(Tz,Uz){$o["polygonOffset"](Tz,Uz)};Sr.prototype._glProgramBinary=function(Vz,Wz,Xz,Yz){Zo.recordError(1280)};Sr.prototype._glProgramParameteri=function(Zz,$z,_z){Zo.recordError(1280)};Sr.prototype._glReadBuffer=function(aA){$o["readBuffer"](aA)};Sr.prototype._glReadPixels=function(bA,cA,dA,eA,fA,gA,hA){if(Zo.currentContext.supportsWebGL2EntryPoints){if($o.currentPixelPackBufferBinding){$o.readPixels(bA,cA,dA,eA,fA,gA,hA)}else{$o.readPixels(bA,cA,dA,eA,fA,gA,up(gA),hA>>vp(gA))}return}var iA=tp(gA,fA,dA,eA,hA,fA);if(!iA){Zo.recordError(1280);return}$o.readPixels(bA,cA,dA,eA,fA,gA,iA)};Sr.prototype._glRenderbufferStorage=function(jA,kA,lA,mA){$o["renderbufferStorage"](jA,kA,lA,mA)};Sr.prototype._glRenderbufferStorageMultisample=function(nA,oA,pA,qA,rA){$o["renderbufferStorageMultisample"](nA,oA,pA,qA,rA)};Sr.prototype._glSamplerParameteri=function(sA,tA,uA){$o["samplerParameteri"](sA?Zo.samplers[sA]:null,tA,uA)};Sr.prototype._glScissor=function(vA,wA,xA,yA){$o["scissor"](vA,wA,xA,yA)};Sr.prototype._glShaderSource=function(zA,AA,BA,CA){var DA=Zo.getSource(zA,AA,BA,CA);$o.shaderSource(Zo.shaders[zA],DA)};Sr.prototype._glStencilFuncSeparate=function(EA,FA,GA,HA){$o["stencilFuncSeparate"](EA,FA,GA,HA)};Sr.prototype._glStencilMask=function(IA){$o["stencilMask"](IA)};Sr.prototype._glStencilOpSeparate=function(JA,KA,LA,MA){$o["stencilOpSeparate"](JA,KA,LA,MA)};Sr.prototype._glTexImage2D=function(NA,OA,PA,QA,RA,SA,TA,UA,VA){if(Zo.currentContext.supportsWebGL2EntryPoints){if($o.currentPixelUnpackBufferBinding){$o.texImage2D(NA,OA,PA,QA,RA,SA,TA,UA,VA)}else if(VA!=0){$o.texImage2D(NA,OA,PA,QA,RA,SA,TA,UA,up(UA),VA>>vp(UA))}else{$o.texImage2D(NA,OA,PA,QA,RA,SA,TA,UA,null)}return}var WA=null;if(VA)WA=tp(UA,TA,QA,RA,VA,PA);$o.texImage2D(NA,OA,PA,QA,RA,SA,TA,UA,WA)};Sr.prototype._glTexImage3D=function(XA,YA,ZA,$A,_A,aB,bB,cB,dB,eB){if($o.currentPixelUnpackBufferBinding){$o["texImage3D"](XA,YA,ZA,$A,_A,aB,bB,cB,dB,eB)}else if(eB!=0){$o["texImage3D"](XA,YA,ZA,$A,_A,aB,bB,cB,dB,up(dB),eB>>vp(dB))}else{$o["texImage3D"](XA,YA,ZA,$A,_A,aB,bB,cB,dB,null)}};Sr.prototype._glTexParameterf=function(fB,gB,hB){$o["texParameterf"](fB,gB,hB)};Sr.prototype._glTexParameteri=function(iB,jB,kB){$o["texParameteri"](iB,jB,kB)};Sr.prototype._glTexParameteriv=function(lB,mB,nB){var oB=gp[nB>>2];$o.texParameteri(lB,mB,oB)};Sr.prototype._glTexStorage2D=function(pB,qB,rB,sB,tB){$o["texStorage2D"](pB,qB,rB,sB,tB)};Sr.prototype._glTexStorage3D=function(uB,vB,wB,xB,yB,zB){$o["texStorage3D"](uB,vB,wB,xB,yB,zB)};Sr.prototype._glTexSubImage2D=function(AB,BB,CB,DB,EB,FB,GB,HB,IB){if(Zo.currentContext.supportsWebGL2EntryPoints){if($o.currentPixelUnpackBufferBinding){$o.texSubImage2D(AB,BB,CB,DB,EB,FB,GB,HB,IB)}else if(IB!=0){$o.texSubImage2D(AB,BB,CB,DB,EB,FB,GB,HB,up(HB),IB>>vp(HB))}else{$o.texSubImage2D(AB,BB,CB,DB,EB,FB,GB,HB,null)}return}var JB=null;if(IB)JB=tp(HB,GB,EB,FB,IB,0);$o.texSubImage2D(AB,BB,CB,DB,EB,FB,GB,HB,JB)};Sr.prototype._glTexSubImage3D=function(KB,LB,MB,NB,OB,PB,QB,RB,SB,TB,UB){if($o.currentPixelUnpackBufferBinding){$o["texSubImage3D"](KB,LB,MB,NB,OB,PB,QB,RB,SB,TB,UB)}else if(UB!=0){$o["texSubImage3D"](KB,LB,MB,NB,OB,PB,QB,RB,SB,TB,up(TB),UB>>vp(TB))}else{$o["texSubImage3D"](KB,LB,MB,NB,OB,PB,QB,RB,SB,TB,null)}};Sr.prototype._glTransformFeedbackVaryings=function(VB,WB,XB,YB){VB=Zo.programs[VB];var ZB=[];for(var $B=0;$B<WB;$B++)ZB.push(ap(gp[XB+$B*4>>2]));$o["transformFeedbackVaryings"](VB,ZB,YB)};Sr.prototype._glUniform1fv=function(_B,aC,bC){if(Zo.currentContext.supportsWebGL2EntryPoints){$o.uniform1fv(Zo.uniforms[_B],ip,bC>>2,aC);return}var cC;if(aC<=Zo.MINI_TEMP_BUFFER_SIZE){cC=Zo.miniTempBufferViews[aC-1];for(var dC=0;dC<aC;++dC){cC[dC]=ip[bC+4*dC>>2]}}else{cC=ip.subarray(bC>>2,bC+aC*4>>2)}$o.uniform1fv(Zo.uniforms[_B],cC)};Sr.prototype._glUniform1i=function(eC,fC){$o.uniform1i(Zo.uniforms[eC],fC)};Sr.prototype._glUniform1iv=function(gC,hC,iC){if(Zo.currentContext.supportsWebGL2EntryPoints){$o.uniform1iv(Zo.uniforms[gC],gp,iC>>2,hC);return}$o.uniform1iv(Zo.uniforms[gC],gp.subarray(iC>>2,iC+hC*4>>2))};Sr.prototype._glUniform1uiv=function(jC,kC,lC){if(Zo.currentContext.supportsWebGL2EntryPoints){$o.uniform1uiv(Zo.uniforms[jC],hp,lC>>2,kC)}else{$o.uniform1uiv(Zo.uniforms[jC],hp.subarray(lC>>2,lC+kC*4>>2))}};Sr.prototype._glUniform2fv=function(mC,nC,oC){if(Zo.currentContext.supportsWebGL2EntryPoints){$o.uniform2fv(Zo.uniforms[mC],ip,oC>>2,nC*2);return}var pC;if(2*nC<=Zo.MINI_TEMP_BUFFER_SIZE){pC=Zo.miniTempBufferViews[2*nC-1];for(var qC=0;qC<2*nC;qC+=2){pC[qC]=ip[oC+4*qC>>2];pC[qC+1]=ip[oC+(4*qC+4)>>2]}}else{pC=ip.subarray(oC>>2,oC+nC*8>>2)}$o.uniform2fv(Zo.uniforms[mC],pC)};Sr.prototype._glUniform2iv=function(rC,sC,tC){if(Zo.currentContext.supportsWebGL2EntryPoints){$o.uniform2iv(Zo.uniforms[rC],gp,tC>>2,sC*2);return}$o.uniform2iv(Zo.uniforms[rC],gp.subarray(tC>>2,tC+sC*8>>2))};Sr.prototype._glUniform2uiv=function(uC,vC,wC){if(Zo.currentContext.supportsWebGL2EntryPoints){$o.uniform2uiv(Zo.uniforms[uC],hp,wC>>2,vC*2)}else{$o.uniform2uiv(Zo.uniforms[uC],hp.subarray(wC>>2,wC+vC*8>>2))}};Sr.prototype._glUniform3fv=function(xC,yC,zC){if(Zo.currentContext.supportsWebGL2EntryPoints){$o.uniform3fv(Zo.uniforms[xC],ip,zC>>2,yC*3);return}var AC;if(3*yC<=Zo.MINI_TEMP_BUFFER_SIZE){AC=Zo.miniTempBufferViews[3*yC-1];for(var BC=0;BC<3*yC;BC+=3){AC[BC]=ip[zC+4*BC>>2];AC[BC+1]=ip[zC+(4*BC+4)>>2];AC[BC+2]=ip[zC+(4*BC+8)>>2]}}else{AC=ip.subarray(zC>>2,zC+yC*12>>2)}$o.uniform3fv(Zo.uniforms[xC],AC)};Sr.prototype._glUniform3iv=function(CC,DC,EC){if(Zo.currentContext.supportsWebGL2EntryPoints){$o.uniform3iv(Zo.uniforms[CC],gp,EC>>2,DC*3);return}$o.uniform3iv(Zo.uniforms[CC],gp.subarray(EC>>2,EC+DC*12>>2))};Sr.prototype._glUniform3uiv=function(FC,GC,HC){if(Zo.currentContext.supportsWebGL2EntryPoints){$o.uniform3uiv(Zo.uniforms[FC],hp,HC>>2,GC*3)}else{$o.uniform3uiv(Zo.uniforms[FC],hp.subarray(HC>>2,HC+GC*12>>2))}};Sr.prototype._glUniform4fv=function(IC,JC,KC){if(Zo.currentContext.supportsWebGL2EntryPoints){$o.uniform4fv(Zo.uniforms[IC],ip,KC>>2,JC*4);return}var LC;if(4*JC<=Zo.MINI_TEMP_BUFFER_SIZE){LC=Zo.miniTempBufferViews[4*JC-1];for(var MC=0;MC<4*JC;MC+=4){LC[MC]=ip[KC+4*MC>>2];LC[MC+1]=ip[KC+(4*MC+4)>>2];LC[MC+2]=ip[KC+(4*MC+8)>>2];LC[MC+3]=ip[KC+(4*MC+12)>>2]}}else{LC=ip.subarray(KC>>2,KC+JC*16>>2)}$o.uniform4fv(Zo.uniforms[IC],LC)};Sr.prototype._glUniform4iv=function(NC,OC,PC){if(Zo.currentContext.supportsWebGL2EntryPoints){$o.uniform4iv(Zo.uniforms[NC],gp,PC>>2,OC*4);return}$o.uniform4iv(Zo.uniforms[NC],gp.subarray(PC>>2,PC+OC*16>>2))};Sr.prototype._glUniform4uiv=function(QC,RC,SC){if(Zo.currentContext.supportsWebGL2EntryPoints){$o.uniform4uiv(Zo.uniforms[QC],hp,SC>>2,RC*4)}else{$o.uniform4uiv(Zo.uniforms[QC],hp.subarray(SC>>2,SC+RC*16>>2))}};Sr.prototype._glUniformBlockBinding=function(TC,UC,VC){TC=Zo.programs[TC];$o["uniformBlockBinding"](TC,UC,VC)};Sr.prototype._glUniformMatrix3fv=function(WC,XC,YC,ZC){if(Zo.currentContext.supportsWebGL2EntryPoints){$o.uniformMatrix3fv(Zo.uniforms[WC],!!YC,ip,ZC>>2,XC*9);return}var $C;if(9*XC<=Zo.MINI_TEMP_BUFFER_SIZE){$C=Zo.miniTempBufferViews[9*XC-1];for(var _C=0;_C<9*XC;_C+=9){$C[_C]=ip[ZC+4*_C>>2];$C[_C+1]=ip[ZC+(4*_C+4)>>2];$C[_C+2]=ip[ZC+(4*_C+8)>>2];$C[_C+3]=ip[ZC+(4*_C+12)>>2];$C[_C+4]=ip[ZC+(4*_C+16)>>2];$C[_C+5]=ip[ZC+(4*_C+20)>>2];$C[_C+6]=ip[ZC+(4*_C+24)>>2];$C[_C+7]=ip[ZC+(4*_C+28)>>2];$C[_C+8]=ip[ZC+(4*_C+32)>>2]}}else{$C=ip.subarray(ZC>>2,ZC+XC*36>>2)}$o.uniformMatrix3fv(Zo.uniforms[WC],!!YC,$C)};Sr.prototype._glUniformMatrix4fv=function(aD,bD,cD,dD){if(Zo.currentContext.supportsWebGL2EntryPoints){$o.uniformMatrix4fv(Zo.uniforms[aD],!!cD,ip,dD>>2,bD*16);return}var eD;if(16*bD<=Zo.MINI_TEMP_BUFFER_SIZE){eD=Zo.miniTempBufferViews[16*bD-1];for(var fD=0;fD<16*bD;fD+=16){eD[fD]=ip[dD+4*fD>>2];eD[fD+1]=ip[dD+(4*fD+4)>>2];eD[fD+2]=ip[dD+(4*fD+8)>>2];eD[fD+3]=ip[dD+(4*fD+12)>>2];eD[fD+4]=ip[dD+(4*fD+16)>>2];eD[fD+5]=ip[dD+(4*fD+20)>>2];eD[fD+6]=ip[dD+(4*fD+24)>>2];eD[fD+7]=ip[dD+(4*fD+28)>>2];eD[fD+8]=ip[dD+(4*fD+32)>>2];eD[fD+9]=ip[dD+(4*fD+36)>>2];eD[fD+10]=ip[dD+(4*fD+40)>>2];eD[fD+11]=ip[dD+(4*fD+44)>>2];eD[fD+12]=ip[dD+(4*fD+48)>>2];eD[fD+13]=ip[dD+(4*fD+52)>>2];eD[fD+14]=ip[dD+(4*fD+56)>>2];eD[fD+15]=ip[dD+(4*fD+60)>>2]}}else{eD=ip.subarray(dD>>2,dD+bD*64>>2)}$o.uniformMatrix4fv(Zo.uniforms[aD],!!cD,eD)};Sr.prototype._glUnmapBuffer=function(gD){if(!np(gD)){Zo.recordError(1280);_o("GL_INVALID_ENUM in glUnmapBuffer");return 0}var hD=mp(gD);var iD=Zo.mappedBuffers[hD];if(!iD){Zo.recordError(1282);_o("buffer was never mapped in glUnmapBuffer");return 0}Zo.mappedBuffers[hD]=null;if(!(iD.access&16))if(Zo.currentContext.supportsWebGL2EntryPoints){$o.bufferSubData(gD,iD.offset,dp,iD.mem,iD.length)}else{$o.bufferSubData(gD,iD.offset,dp.subarray(iD.mem,iD.mem+iD.length))}kp(iD.mem);return 1};Sr.prototype._glUseProgram=function(jD){$o.useProgram(jD?Zo.programs[jD]:null)};Sr.prototype._glValidateProgram=function(kD){$o.validateProgram(Zo.programs[kD])};Sr.prototype._glVertexAttrib4f=function(lD,mD,nD,oD,pD){$o["vertexAttrib4f"](lD,mD,nD,oD,pD)};Sr.prototype._glVertexAttrib4fv=function(qD,rD){$o.vertexAttrib4f(qD,ip[rD>>2],ip[rD+4>>2],ip[rD+8>>2],ip[rD+12>>2])};Sr.prototype._glVertexAttribIPointer=function(sD,tD,uD,vD,wD){var xD=Zo.currentContext.clientBuffers[sD];if(!Zo.currArrayBuffer){xD.size=tD;xD.type=uD;xD.normalized=false;xD.stride=vD;xD.ptr=wD;xD.clientside=true;return}xD.clientside=false;$o.vertexAttribIPointer(sD,tD,uD,vD,wD)};Sr.prototype._glVertexAttribPointer=function(yD,zD,AD,BD,CD,DD){$o.vertexAttribPointer(yD,zD,AD,!!BD,CD,DD)};Sr.prototype._glViewport=function(ED,FD,GD,HD){$o["viewport"](ED,FD,GD,HD)};return Sr}();Zo.instance=new wp;Zo.instance["_name"]="GL";Zo.instance["_textures"]=Zo.textures;return[Zo.instance]});