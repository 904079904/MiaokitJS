var MiaokitModule=function(a,b){var c=this;c["m_pConfigPath"]=b;c["m_pConfig"]={ENGINE:a};c["Merge"](c);c["Preload"]()};var MiaokitMerge=function(d){var e=[];d["Merge"]=d["Merge"]||function(f){for(var g=0,h=e;g<h.length;g++){var i=h[g];var j=i(f);if(j){for(var k=0,l=j;k<l.length;k++){var m=l[k];f[m._name]=m}}}};return function(n){e.push(n)}}(MiaokitModule.prototype);MiaokitMerge(function(o){var p=undefined;var q=undefined;var r={};var s=function(u,v){if(v===void 0){v=undefined}var w=0;this.length=u(-1);this[Symbol.iterator]=function(){return{next:function(){var x=u(w);if(x){var y=p(x);w=v?w+1:y.m_nObject;return{value:y,done:false}}return{value:undefined,done:true}}}}};r["Transform"]=function(z){Object.defineProperty(z,"position",{get:function(){var A=this["_GetPosition"]()/4;var B=o["WASM"].HEAPF32();return{x:B[A],y:B[A+1],z:B[A+2]}},set:function(C){this["_SetPosition"](C.x,C.y,C.z)}});Object.defineProperty(z,"euler",{get:function(){var D=this["_GetEuler"]()/4;var E=o["WASM"].HEAPF32();return{x:E[D],y:E[D+1],z:E[D+2]}},set:function(F){this["_SetEuler"](F.x,F.y,F.z)}});Object.defineProperty(z,"rotation",{get:function(){var G=this["_GetRotation"]()/4;var H=o["WASM"].HEAPF32();return{x:H[G],y:H[G+1],z:H[G+2],w:H[G+3]}},set:function(I){this["_SetRotation"](I.x,I.y,I.z,I.w)}});Object.defineProperty(z,"scale",{get:function(){var J=this["_GetScale"]()/4;var K=o["WASM"].HEAPF32();return{x:K[J],y:K[J+1],z:K[J+2]}},set:function(L){this["_SetScale"](L.x,L.y,L.z)}});Object.defineProperty(z,"localPosition",{get:function(){var M=this["_GetLocalPosition"]()/4;var N=o["WASM"].HEAPF32();return{x:N[M],y:N[M+1],z:N[M+2]}},set:function(O){this["_SetLocalPosition"](O.x,O.y,O.z)}});Object.defineProperty(z,"localEuler",{get:function(){var P=this["_GetLocalEuler"]()/4;var Q=o["WASM"].HEAPF32();return{x:Q[P],y:Q[P+1],z:Q[P+2]}},set:function(R){this["_SetLocalEuler"](R.x,R.y,R.z)}});Object.defineProperty(z,"localRotation",{get:function(){var S=this["_GetLocalRotation"]()/4;var T=o["WASM"].HEAPF32();return{x:T[S],y:T[S+1],z:T[S+2],w:T[S+3]}},set:function(U){this["_SetLocalRotation"](U.x,U.y,U.z,U.w)}});Object.defineProperty(z,"localScale",{get:function(){var V=this["_GetLocalScale"]()/4;var W=o["WASM"].HEAPF32();return{x:W[V],y:W[V+1],z:W[V+2]}},set:function(X){this["_SetLocalScale"](X.x,X.y,X.z)}});Object.defineProperty(z,"right",{get:function(){var Y=this["_GetRight"]()/4;var Z=o["WASM"].HEAPF32();return{x:Z[Y],y:Z[Y+1],z:Z[Y+2]}},set:function($){this["_SetRight"]($.x,$.y,$.z)}});Object.defineProperty(z,"up",{get:function(){var _=this["_GetUp"]()/4;var aa=o["WASM"].HEAPF32();return{x:aa[_],y:aa[_+1],z:aa[_+2]}},set:function(){var ba=this["_SetUp"]()/4;var ca=o["WASM"].HEAPF32();return{x:ca[ba],y:ca[ba+1],z:ca[ba+2]}}});Object.defineProperty(z,"forward",{get:function(){var da=this["_GetForward"]()/4;var ea=o["WASM"].HEAPF32();return{x:ea[da],y:ea[da+1],z:ea[da+2]}},set:function(){var fa=this["_SetForward"]()/4;var ga=o["WASM"].HEAPF32();return{x:ga[fa],y:ga[fa+1],z:ga[fa+2]}}});Object.defineProperty(z,"regionPosition",{get:function(){var ha=this["_GisToWorld"]()/4;var ia=o["WASM"].HEAPF32();return{x:ia[ha],y:ia[ha+1],z:ia[ha+2]}}});z["Rotate"]=function(ja,ka){this["_Rotate"](ja.x,ja.y,ja.z,ka)};z["Rotate2"]=function(la,ma,na){this["_Rotate2"](la.x,la.y,la.z,ma,na)};z["Translate"]=function(oa,pa){this["_Translate"](oa.x,oa.y,oa.z,pa)};z["TransformPoint"]=function(qa){var ra=this["_TransformPoint"](qa.x,qa.y,qa.z)/4;var sa=o["WASM"].HEAPF32();return{x:sa[ra],y:sa[ra+1],z:sa[ra+2]}}};r["GameObject"]=function(ta){Object.defineProperty(ta,"name",{get:function(){if(!this._name){var ua=this._GetName(0);var va=this._GetName(1);this._name=o["WASM"].GetString(va,ua)}return this._name}});Object.defineProperty(ta,"transform",{get:function(){return p(this["_GetTransform"]())}});Object.defineProperty(ta,"mesh",{get:function(){return p(this["_GetMesh"]())},set:function(wa){this["_SetMesh"](wa.m_nObject)}});Object.defineProperty(ta,"children",{get:function(){var xa=this;return new s(function(ya){return xa._IterChild(ya)},true)}});Object.defineProperty(ta,"parent",{get:function(){return p(this["_GetParent"]())}});Object.defineProperty(ta,"data",{get:function(){return p(this["_GetUserData"]())},set:function(za){}});Object.defineProperty(ta,"enableCollider",{set:function(Aa){this["_EnableCollider"](Aa)}});Object.defineProperty(ta,"active",{set:function(Ba){this["_Active"](Ba)}});Object.defineProperty(ta,"highlight",{set:function(Ca){this["_Highlight"](Ca)}});Object.defineProperty(ta,"transparent",{set:function(Da){console.warn("transparent discard!")}});Object.defineProperty(ta,"opacity",{set:function(Ea){this["_Transparent"](Ea)}});ta["Destory"]=function(){this["_Destory"]()};o["GameObject"]=function(){return p(ta._GameObject())}};r["Miaokit"]=function(Fa){Fa["LoadTile"]=function(Ga){var Ha=this["_Malloc"](Ga.byteLength);if(Ha){o["WASM"]["HEAPU8"](Ha,Ga.byteLength).set(new Uint8Array(Ga));var Ia=this["_LoadTile"](Ha,Ga.byteLength);var Ja=p(Ia);return Ja}return null};Fa["Analyze"]=function(Ka){var La=this["_Analyze"]();var Ma=o["WASM"].HEAP32()[La/4];var Na=o["WASM"].GetString(La+4,Ma);try{var Oa=JSON.parse(Na);var Pa=q(Ka).concat(Oa);return Pa}catch(Qa){console.log(Na)}return null};Fa["PickEntity"]=function(Ra){return p(this["_PickEntity"](Ra))};Fa["GetScene"]=function(Sa){return p(this["_GetScene"](Sa))};Fa["WorldToScreenPoint"]=function(Ta){var Ua=this["_WorldToScreenPoint"](Ta.x,Ta.y,Ta.z)/4;var Va=o["WASM"].HEAPF32();return{x:Va[Ua],y:Va[Ua+1],z:Va[Ua+2]}};Fa["ScreenPointToRay"]=function(Wa){var Xa=this["_ScreenPointToRay"](Wa.x,Wa.y,Wa.z)/4;var Ya=o["WASM"].HEAPF32();return{m_mOrigin:{x:Ya[Xa],y:Ya[Xa+1],z:Ya[Xa+2]},m_mDirection:{x:Ya[Xa+4],y:Ya[Xa+5],z:Ya[Xa+6]}}};Object.defineProperty(Fa,"camera",{get:function(){return p(this["_GetCamera"]())}});Object.defineProperty(Fa,"cameraMode",{set:function(Za){this["_SetCameraMode"](Za)}});Object.defineProperty(Fa,"gis",{get:function(){if(!this._gis){this._gis=r["Gis"]["g_pIns"]}return this._gis}});Object.defineProperty(Fa,"panoramas",{get:function(){if(!this._panoramas){this._panoramas=r["Panoramas"]["g_pIns"]}return this._panoramas}});Object.defineProperty(Fa,"progress",{get:function(){return this["_GetProgress"]()}})};r["Mesh"]=function($a){$a["SetVertices"]=function(_a,ab){this["m_aVertex"]=this["m_aVertex"]||[];this["m_aVertex"].push({m_pArray:ab,m_nSlot:this["_SlotLut"][_a],m_nItemSize:this["_SizeLut"][_a]})};$a["SetIndices"]=function(bb,cb,db){this["m_aIndex"]=this["m_aIndex"]||[];this["m_aIndex"][bb]={m_pArray:cb,m_nItemSize:db}};$a["Apply"]=function(){var eb=this["m_aVertex"];var fb=this["m_aIndex"];if(!eb||!fb){return}var gb=2+2*eb.length+3*fb.length;var hb=this._CreateBuffer(gb);var ib=o["WASM"]["HEAP32"](hb,gb*4);var jb=0;ib[jb++]=eb.length;ib[jb++]=fb.length;for(var kb=0;kb<eb.length;kb++){ib[jb++]=eb[kb].m_nSlot;ib[jb++]=eb[kb].m_pArray.length/eb[kb].m_nItemSize}for(var kb=0;kb<fb.length;kb++){ib[jb++]=0;ib[jb++]=0;ib[jb++]=fb[kb].m_pArray.length}this._CreateBuffer(0);for(var kb=0;kb<eb.length;kb++){var lb=eb[kb].m_pArray;var mb=this._GetVertexBuffer(kb);var nb=o["WASM"]["HEAPF32"](mb,lb.length*4);nb.set(lb)}for(var kb=0;kb<fb.length;kb++){var lb=fb[kb].m_pArray;var mb=this._GetIndexBuffer(kb);var nb=o["WASM"]["HEAP32"](mb,lb.length*4);nb.set(lb)}this._Apply();this["m_aVertex"]=undefined;this["m_aIndex"]=undefined};$a["_SlotLut"]={position:0,normal:1,uv:2,color:3,tangent:4,uv2:9,uv3:10,uv4:11,uv5:12,uv6:13,uv7:14,uv8:15};$a["_SizeLut"]={position:3,normal:3,uv:2,color:4,tangent:4,uv2:2,uv3:2,uv4:2,uv5:2,uv6:2,uv7:2,uv8:2};Object.defineProperty($a,"position",{set:function(ob){this.SetVertices("position",ob)}});Object.defineProperty($a,"normal",{set:function(pb){this.SetVertices("normal",pb)}});Object.defineProperty($a,"uv",{set:function(qb){this.SetVertices("uv",qb)}});Object.defineProperty($a,"triangles",{set:function(rb){this.SetIndices(0,rb)}});Object.defineProperty($a,"material",{set:function(sb){this.SetMaterial(0,sb)}});o["Mesh"]=function(){return p($a._Mesh())}};r["Texture2D"]=function(tb){tb["SetImageData"]=function(ub){var vb=this._CreateBuffer(ub.byteLength);if(vb){o["WASM"]["HEAPU8"](vb,ub.byteLength).set(new Uint8Array(ub));this._Apply()}};tb["Load"]=function(wb){var xb=this;o["Fetch"](wb,function(yb){if(yb){xb.SetImageData(yb)}})};o["Texture2D"]=function(zb){var Ab=p(tb._Texture2D());if(zb){if("string"===typeof zb){this.Load(zb)}else{this.SetImageData(zb)}}return Ab}};r["Material"]=function(Bb){if("Sisyphus"===o["m_pConfig"]["ENGINE"]){o["ShaderLab"].ExpandMaterial(Bb)}Bb["GetTexture"]=function(){return p(this["_GetTexture"]())};Bb["SetTexture"]=function(Cb){this["_SetTexture"](Cb.m_nObject)};o["Material"]=function(Db){if(Db===void 0){Db=undefined}var Eb=null;if(Db){var Fb=o["ShaderLab"]["Pipeline"]["InternalShader"];var Gb=Fb[0];Fb[0]=Db;Eb=p(Bb._Material());Fb[0]=Gb}else{Eb=p(Bb._Material())}return Eb}};r["Tile"]=function(Hb){Object.defineProperty(Hb,"scenes",{get:function(){var Ib=this;return new s(function(Jb){return Ib._IterWork(Jb)})}});Object.defineProperty(Hb,"object3D",{get:function(){if(undefined===this._object3D){var Kb=this._GetObject(this.m_nObject);if(0===Kb){this._object3D=null;return null}this._object3D=p(Kb)}return this._object3D}})};r["Scene"]=function(Lb){Lb["GetLayer"]=function(Mb){return p(this["_GetLayer"](Mb))};Object.defineProperty(Lb,"id",{get:function(){if(!this._id){var Nb=this._GetID(0);var Ob=this._GetID(1);this._id=o["WASM"].GetString(Ob,Nb)}return this._id}});Object.defineProperty(Lb,"layers",{get:function(){var Pb=this;return new s(function(Qb){return Pb._IterLayer(Qb)})}});Object.defineProperty(Lb,"object3D",{get:function(){if(undefined===this._object3D){var Rb=this._GetObject(this.m_nObject);if(0===Rb){this._object3D=null;return null}this._object3D=p(Rb)}return this._object3D}});Object.defineProperty(Lb,"viewState",{get:function(){return{m_mTarget:{x:0,y:0,z:0},m_nPitch:45,m_nYaw:0,m_nDistance:60,m_mOrthoTarget:{x:0,y:0,z:0},m_nOrthoScaled:0,m_nOrthoRotate:0}}});Object.defineProperty(Lb,"binding",{get:function(){return p(this._GetBinding())}})};r["Layer"]=function(Sb){Object.defineProperty(Sb,"id",{get:function(){if(!this._id){var Tb=this._GetID(0);var Ub=this._GetID(1);this._id=o["WASM"].GetString(Ub,Tb)}return this._id}});Object.defineProperty(Sb,"sites",{get:function(){var Vb=this;return new s(function(Wb){return Vb._IterSite(Wb)})}});Object.defineProperty(Sb,"object3D",{get:function(){if(undefined===this._object3D){var Xb=this._GetObject(this.m_nObject);if(0===Xb){this._object3D=null;return null}this._object3D=p(Xb)}return this._object3D}});Object.defineProperty(Sb,"viewState",{get:function(){var Yb=this["_GetViewState"]();if(0<Yb){var Zb=o["WASM"]["HEAPF32"](Yb,4*11);var $b=0;return{m_mTarget:{x:Zb[$b++],y:Zb[$b++],z:Zb[$b++]},m_nPitch:Zb[$b++],m_nYaw:Zb[$b++],m_nDistance:Zb[$b++],m_mOrthoTarget:{x:Zb[$b++],y:Zb[$b++],z:Zb[$b++]},m_nOrthoScaled:Zb[$b++],m_nOrthoRotate:Zb[$b++]}}return null}})};r["Attachment"]=function(_b){Object.defineProperty(_b,"entityType",{get:function(){return this._GetEntityType()}});Object.defineProperty(_b,"secondType",{get:function(){return this._GetSecondType()}});Object.defineProperty(_b,"flag",{get:function(){return this._GetFlag()}});Object.defineProperty(_b,"object3D",{get:function(){return p(this._GetObject())}});Object.defineProperty(_b,"viewState",{get:function(){var ac=this["_GetViewState"]();if(0<ac){var bc=o["WASM"]["HEAPF32"](ac,4*11);var cc=0;var dc={m_mTarget:{x:bc[cc++],y:bc[cc++],z:bc[cc++]},m_nPitch:bc[cc++],m_nYaw:bc[cc++],m_nDistance:bc[cc++],m_mOrthoTarget:{x:bc[cc++],y:bc[cc++],z:bc[cc++]},m_nOrthoScaled:bc[cc++],m_nOrthoRotate:bc[cc++]};console.log("attachment view:",dc);return dc}else{console.log("attachment view: null")}return null}})};r["Site"]=function(ec){Object.defineProperty(ec,"id",{get:function(){if(!this._id){var fc=this._GetID(0);var gc=this._GetID(1);this._id=o["WASM"].GetString(gc,fc)}return this._id}});Object.defineProperty(ec,"layer",{get:function(){return p(this["_Layer"]())}});Object.defineProperty(ec,"scene",{get:function(){return p(this["_Scene"]())}});Object.defineProperty(ec,"type",{get:function(){return this["_Type"]()}});Object.defineProperty(ec,"number",{get:function(){return this["_Number"]()}});Object.defineProperty(ec,"position",{get:function(){var hc=this["_Position"]()/4;var ic=o["WASM"].HEAPF32();return{x:ic[hc],y:ic[hc+1],z:ic[hc+2]}}})};r["Prefab"]=function(jc){jc["Instantiate"]=function(){return p(this["_Instantiate"]())};o["LoadPrefab"]=function(kc,lc){o["Fetch"](kc,function(mc){var nc=null;if(mc){var oc=jc._Prefab();var pc=p(oc);var qc=pc.CreateBuffer(mc.byteLength);if(qc){o["WASM"]["HEAPU8"](qc,mc.byteLength).set(new Uint8Array(mc));pc.Apply();nc=pc}}lc(nc)})}};r["Gis"]=function(rc){rc["Update"]=function(sc,tc,uc){return this["_Update"](sc,tc,uc)};rc["AddSvetile"]=function(vc){var wc=o["WASM"]["EncodeString"](vc.m_pUrl);var xc=this["_CreateSvetileDesc"](wc.byteLength);var yc=o["WASM"]["HEAPU32"](xc,4*8);yc[0]=vc.m_nID;yc[1]=vc.m_nFlags;o["WASM"]["HEAPU8"](yc[2],wc.byteLength).set(wc,0);yc[3]=0;yc[4]=o["WASM"]["RegisterDelegate"](function(Ac,Bc){vc.OnActive(p(Ac),0<Bc)});var zc=o["WASM"]["HEAPF32"](xc+20,16);zc[0]=vc.m_mLngLat.x;zc[1]=vc.m_mLngLat.y;zc[2]=vc.m_mSize.x;zc[3]=vc.m_mSize.y;this["_AddSvetile"](xc)};rc["AddMapbox"]=function(Cc){var Dc=this["_GetMapboxDesc"]();var Ec=o["WASM"]["HEAPF32"](Dc,40);Ec[0]=Cc.m_mOffset.x;Ec[1]=Cc.m_mOffset.y;Ec[2]=Cc.m_mOffset.z;Ec[3]=Cc.m_mScale.x;Ec[4]=Cc.m_mScale.y;Ec[5]=Cc.m_mScale.z;Ec[6]=Cc.m_mLngLat.x;Ec[7]=Cc.m_mLngLat.y;Ec[8]=Cc.m_mSize.x;Ec[9]=Cc.m_mSize.y;this["_AddMapbox"](Dc)};rc["AddGameObject"]=function(Fc,Gc,Hc,Ic){this["_AddGameObject"](Fc.m_nObject,Gc,Hc,Ic)};Object.defineProperty(rc,"terrainServer",{set:function(Jc){if(!Jc){Jc="https://t%d.tianditu.gov.cn/DEM/DataServer?T=ele_c&tk=3d26628c3a0e2694fecfbbb983ff7d87&x=%d&y=%d&l=%d"}var Kc=this["_GetServer"](0);o["WASM"].SetString(Kc,Jc)}});Object.defineProperty(rc,"imageServer",{set:function(Lc){if(!Lc){Lc="http://t%d.tianditu.gov.cn/DataServer?T=img_c&tk=3d26628c3a0e2694fecfbbb983ff7d87&x=%d&y=%d&l=%d"}var Mc=this["_GetServer"](1);o["WASM"].SetString(Mc,Lc)}});Object.defineProperty(rc,"labelServer",{set:function(Nc){if(!Nc){Nc="http://t%d.tianditu.gov.cn/DataServer?T=cia_c&tk=3d26628c3a0e2694fecfbbb983ff7d87&x=%d&y=%d&l=%d"}var Oc=this["_GetServer"](2);o["WASM"].SetString(Oc,Nc)}})};r["Panoramas"]=function(Pc){Pc["Open"]=function(Qc){var Rc=["r","f","l","b","d","u"];for(var Sc=0;Sc<6;Sc++){for(var Tc=0;Tc<2;Tc++){var Uc=function(Zc){var $c=Vc;var _c=Sc;var ad=1;var bd=Tc;var cd=Zc;var dd=o["GL"]["ImageCache"].CreateImage();var ed=o["GL"]["ImageCache"].Get(dd);var fd=Qc+"l"+ad+"_"+Rc[_c]+"_0"+(1+bd)+"_0"+(2-cd)+".jpg";console.log(_c,ad,bd,cd,fd);ed.crossOrigin="anonymous";ed.src=fd;ed.onload=function(gd){console.log(_c,ad,bd,cd,99);$c["_SetImage"](_c,ad,bd,cd,dd)}};var Vc=this;for(var Wc=0;Wc<2;Wc++){Uc(Wc)}}if(4==Sc){for(var Tc=0;Tc<4;Tc++){var Xc=function(hd){var id=Yc;var jd=Sc;var kd=2;var ld=Tc;var md=hd;var nd=o["GL"]["ImageCache"].CreateImage();var od=o["GL"]["ImageCache"].Get(nd);var pd=Qc+"l"+kd+"_"+Rc[jd]+"_0"+(1+ld)+"_0"+(4-md)+".jpg";console.log(jd,kd,ld,md,pd);od.crossOrigin="anonymous";od.src=pd;od.onload=function(qd){console.log(jd,kd,ld,md,99);id["_SetImage"](jd,kd,ld,md,nd)}};var Yc=this;for(var Wc=0;Wc<4;Wc++){Xc(Wc)}}}}}};r["Dioramas3MX"]=function(rd){rd["_Load3MX"]=function(sd,td,ud){var vd=this;var wd=vd.m_pFileLut[sd];var xd=wd.m_pPath+wd.m_aFile[td];o["Request"]("GET","arraybuffer",xd,null,null,function(yd){if(!yd){return}var zd=new Uint32Array(yd,0,2);if(1113083187===zd[0]){var Ad=zd[1]>>8;var Bd=9+Ad;var Cd=yd.byteLength-Bd;var Dd=new Uint8Array(yd,9,Ad);var Ed=vd.m_pTextDecoder.decode(Dd);var Fd=JSON.parse(Ed);var Gd={m_pPath:xd.substring(0,xd.lastIndexOf("/")+1),m_aFile:[]};var Hd=[];var Id=[];var Jd=Fd.resources;var Kd=0;for(var Ld=0;Ld<Jd.length;Ld++){Hd.push(Ld);if("textureBuffer"===Jd[Ld].type){Hd.push(0);Id.push(Ld);if("jpg"===Jd[Ld].format){Hd.push(0)}else if("png"===Jd[Ld].format){Hd.push(1)}else{Hd.push(1e4)}}else if("geometryBuffer"===Jd[Ld].type){Hd.push(1);if("ctm"===Jd[Ld].format){Hd.push(0)}else{Hd.push(1e4)}}else{Hd.push(1e4);Hd.push(1e4)}Hd.push(Jd[Ld].size);Hd.push(Kd);Kd+=Jd[Ld].size;Hd.push(1e4);if(Jd[Ld].texture){for(var Md=0;Md<Jd.length;Md++){if(Jd[Ld].texture===Jd[Md].id){Hd[Hd.length-1]=Md;break}}}}var Nd=[];var Od=Fd.nodes;for(var Ld=0;Ld<Od.length;Ld++){var Pd=Od[Ld];var Qd=Pd.bbMax[0]-Pd.bbMin[0];var Rd=Pd.bbMax[1]-Pd.bbMin[1];var Sd=Pd.bbMax[2]-Pd.bbMin[2];var Td=Math.sqrt(Qd*Qd+Rd*Rd+Sd*Sd);Nd.push(Math.floor(parseInt(Pd.bbMin[0]+Pd.bbMax[0])*.5*100));Nd.push(Math.floor(parseInt(Pd.bbMin[1]+Pd.bbMax[1])*.5*100));Nd.push(Math.floor(parseInt(Pd.bbMin[2]+Pd.bbMax[2])*.5*100));Nd.push(Math.floor(Td*100));Nd.push(Math.floor(Pd.maxScreenDiameter));var Ud=Pd.children?Pd.children.length:0;if(0<Ud){Nd.push(Gd.m_aFile.length);for(var Md=0;Md<Ud;Md++){Gd.m_aFile.push(Pd.children[Md])}Nd.push(Gd.m_aFile.length)}else{Nd.push(-1);Nd.push(-1)}var Vd=Pd.resources?Pd.resources.length:0;if(0<Vd){Nd.push(Id.length);for(var Md=0;Md<Vd;Md++){for(var Wd=0;Wd<Jd.length;Wd++){if(Pd.resources[Md]===Jd[Wd].id){Id.push(Wd);break}}}Nd.push(Id.length)}else{Nd.push(-1);Nd.push(-1)}}var Xd=4+9*Od.length+6*Id.length;var Yd=4*Xd;var Zd=Yd+Cd;var $d=vd["_CreateBuffer"](Zd);if($d){var _d=o["WASM"]["HEAP32"]($d,Yd);_d[0]=Yd;_d[1]=Od.length;_d[2]=Id.length;_d[3]=vd.m_pFileLut.length;_d.set(Nd,4);var ae=4+Nd.length;for(var Ld=0;Ld<Id.length;Ld++){var be=6*Id[Ld];for(var Md=0;Md<6;Md++){_d[ae++]=Hd[be++]}}var ce=o["WASM"]["HEAPU8"]($d+Yd,Cd);ce.set(new Uint8Array(yd,Bd,Cd));vd["_Dispose"](ud)}vd.m_pFileLut.push(Gd)}})};rd["Update"]=function(){return this["_Update"]()};Object.defineProperty(rd,"object3D",{get:function(){return p(this["_GetObject"]())}});o["Dioramas3MX"]=function(de,ee){var fe=p(rd._Dioramas3MX());fe.m_pFileLut=[];fe.m_pTextDecoder=new TextDecoder("utf-8");if(ee){if(ee.m_pGis){ee.m_pGis.AddGameObject(fe.object3D,ee.m_mLngLat.x,ee.m_mLngLat.y,ee.m_nHeight);fe.object3D.transform.Translate(ee.m_mOffset,1);fe.object3D.transform.Rotate({x:0,y:0,z:0},1)}}o["Request"]("GET","json",de,null,null,function(ge){fe["m_pMeta"]=ge;var he={m_pPath:de.substring(0,de.lastIndexOf("/")+1),m_aFile:[]};var ie=[0];for(var je=0;je<ge.layers.length;je++){if("meshPyramid"===ge.layers[je].type){ie.push(je);ie.push(he.m_aFile.length);he.m_aFile.push(ge.layers[je].root)}}ie[0]=he.m_aFile.length;var ke=fe["_CreateBuffer"](4*ie.length);var le=o["WASM"]["HEAP32"](ke,4*ie.length);le.set(ie);fe["_Initialize"](ke);fe.m_pFileLut.push(he)});return fe}};function t(me,ne,oe){p=ne;q=oe;for(var pe=0,qe=me;pe<qe.length;pe++){var re=qe[pe];if(re){var se=re.prototype;if(r[se._type_name]){r[se._type_name](se)}if("Miaokit"===se._type_name){o["Miaokit"]=new re(0,0)}else if("Gis"===se._type_name){r["Gis"]["g_pIns"]=new re(0,0)}else if("Panoramas"===se._type_name){r["Panoramas"]["g_pIns"]=new re(0,0)}}}}o["WASM"]=o["WASM"]||{};o["WASM"]["LoadClass"]=t;return[]});MiaokitMerge(function(te){te["m_pLogo"]=null;var ue=undefined;var ve=false;var we=false;function xe(){te["Track"]("Preload");te["Request"]("GET","json",te["m_pConfigPath"],null,null,function(Ae){if(!Ae){te["Track"]("配置文件错误！",3);return}te["m_pConfig"]=Ae;te["Fetch"](Ae.MODULE,function(De){if(ue){ue(De)}else{ue=De}});if(Ae.SVE){var Be=function(Ee){var Fe=Ae.SVE[Ee];Fe.m_pData=null;Fe.m_pTile=null;if(true===Fe.m_bPreload){te["Fetch"](Fe.m_pProject,function(Ge){Fe.m_pData=Ge;if(we&&Ge){Fe.m_pTile=te["Miaokit"]["LoadTile"](Fe.m_pData);Fe.m_pData=null;te["App"]["ActiveTile"](Fe)}})}};for(var Ce=0;Ce<Ae.SVE.length;Ce++){Be(Ce)}}if(te["App"]&&te["App"].m_pProject){te["App"]["Preload"]()}else{ve=true}})}function ye(He,Ie){te["Track"]("LoadEngine");if(ve){te["App"]["Preload"]();ve=false}te["WASM"]["LoadEngine"]({OnEngineLoad:function(Je){te["Track"]("LoadEngine End");if(ue){te["Track"]("LoadMiaokit");te["WASM"]["LoadMiaokit"](ue,Je,function(){He();we=true;ze()})}else{te["Track"]("LoadMiaokit Delay");ue=function(Ke){te["Track"]("LoadMiaokit");te["WASM"]["LoadMiaokit"](Ke,Je,function(){He();we=true;ze()})}}},OnRenderingEvent:function(Le){if(we){Ie(Le)}}})}function ze(){te["Track"]("LoadMiaokit End");var Me=te["m_pConfig"]["SVE"];if(Me){for(var Ne=0,Oe=Me;Ne<Oe.length;Ne++){var Pe=Oe[Ne];if(true===Pe.m_bPreload){if(null===Pe.m_pTile&&null!==Pe.m_pData){Pe.m_pTile=te["Miaokit"]["LoadTile"](Pe.m_pData);Pe.m_pData=null;te["App"]["ActiveTile"](Pe)}}}}}xe["_name"]="Preload";ye["_name"]="Load";return[xe,ye]});MiaokitMerge(function(Qe){var Re=function(){function Te(){}Te.Clamp=function(Ue,Ve,We){if(Ue>We){return We}if(Ue<Ve){return Ve}return Ue};return Te}();var Se=function(){function Xe(Ye,Ze,$e){this.x=0;this.y=0;this.z=0;this.x=Ye;this.y=Ze;this.z=$e}Xe.Scale=function(_e,af){return{x:af.x*_e,y:af.y*_e,z:af.z*_e}};return Xe}();Re["_name"]="Mathf";Se["_name"]="Vector3";return[Re,Se]});MiaokitMerge(function(bf){var cf=null;var df=null;var ef=null;var ff=[null];var gf=null;var hf=[null];var jf=1;var kf=0;var lf=[undefined];var mf=null;var nf=null;function of(yf){yf["isnanf"]=isNaN;yf["isinff"]=isFinite;yf["powf"]=Math.pow;yf["sqrtf"]=Math.sqrt;yf["expf"]=Math.exp;yf["logf"]=Math.log;yf["floorf"]=Math.floor;yf["ceilf"]=Math.ceil;yf["sinf"]=Math.sin;yf["cosf"]=Math.cos;yf["tanf"]=Math.tan;yf["asinf"]=Math.asin;yf["acosf"]=Math.acos;yf["atanf"]=Math.atan;yf["atan2f"]=Math.atan2;yf["ldexpf"]=function(zf,Af){return zf*Math.pow(2,Af)}}function pf(Bf){function Cf(Mf){var Nf=bf["WASM"].GetString(Mf);if(!Nf.startsWith("http")){Nf="./data/projects/sve/"+Nf}if(Nf.endsWith("assetbundle")){Nf+=".bin"}return Nf}function Df(Of,Pf,Qf,Rf,Sf){var Tf=Cf(Of);var Uf=cf.get(Qf);var Vf=cf.get(Rf);bf["Fetch"](Tf,function(Wf){if(Wf){var Xf=Uf(Pf,Wf.byteLength,Sf);if(Xf){bf["WASM"]["HEAPU8"](Xf,Wf.byteLength).set(new Uint8Array(Wf))}}else{console.error("资源丢失:",Tf)}Vf(Pf,Sf)})}function Ef(Yf,Zf,$f,_f,ag){var bg=Cf(Yf);var cg=cf.get($f);var dg=gf.CreateImage();var eg=gf.Get(dg);eg.crossOrigin="anonymous";eg.src=bg;eg.onload=function(fg){cg(Zf,dg,ag)}}function Ff(gg,hg,ig,jg,kg){Df(gg,hg,ig,jg,kg)}function Gf(lg,mg,ng,og,pg){mf["LoadTerrain"](lg,mg,ng,og,pg)}function Hf(qg,rg,sg,tg,ug){var vg=bf["WASM"]["HEAP32"](qg,16);mf["LoadBlockbox"](rg,vg[0],vg[1],vg[2],vg[3],sg,tg)}function If(wg,xg){var yg=bf["WASM"]["HEAP32"](wg,12);mf["Load3MX"](yg[0],yg[1],yg[2],xg)}function Jf(zg,Ag,Bg,Cg,Dg){Df(zg,Ag,Bg,Cg,Dg)}function Kf(Eg,Fg,Gg,Hg){var Ig=cf.get(Hg);var Jg=bf["WASM"]["HEAP8"](Gg,Fg);var Kg=new Blob([Jg]);var Lg=window.URL.createObjectURL(Kg);var Mg=gf.CreateImage();var Ng=gf.Get(Mg);Ng.src=Lg;Ng.onload=function(Og){Ig(Eg,Mg);window.URL.revokeObjectURL(Lg)}}var Lf=[undefined,Df,Ef,Ff,Gf,Hf,If,Jf,Kf];Bf["APP_LOAD"]=function(Pg,Qg,Rg,Sg,Tg,Ug){Lf[Pg](Qg,Rg,Sg,Tg,Ug)}}function qf(Vg){var Wg={NaN:NaN,Infinity:Infinity};of(Vg);pf(Vg);Vg["APP_DYNAMIC_LINK"]=function(Xg,Yg){var Zg=bf["WASM"]["HEAPU32"](Xg,Yg);var $g=Zg[0];var _g=Zg[1];for(var ah=0;ah<$g;ah++){var bh=Zg[2+ah]-1;var ch=Zg[_g++];var dh=Zg[_g++];var eh=bf["WASM"].GetString(ch,dh);var fh=JSON.parse(eh);var gh=function(kh,lh){this["m_nID"]=kh;this["m_nObject"]=lh};var hh=gh.prototype;hh["_type_name"]=fh[0];hh["_type_id"]=ah+1;hh["_ins_count"]=0;lf[ah+1]=gh;var ih=function(mh){var nh=cf.get(Zg[_g++]);_g++;var oh=function(){var ph=Array.prototype.slice.call(arguments);ph.unshift(this.m_nObject);return nh.apply(this,ph)};if(0===mh){hh["_"+fh[mh]]=oh}else{hh[fh[mh]]=oh}};for(var jh=0;jh<bh;jh++){ih(jh)}}bf["WASM"]["LoadClass"](lf,sf,vf);bf["Miaokit"]["ResizeCavans"]=function(qh,rh){if(ef.SE_RESIZE){ef.SE_RESIZE(qh,rh)}}};Vg["APP_PRINT"]=function(sh,th,uh){var vh=bf["WASM"].GetString(sh,th);bf["Track"](vh,uh)};Vg["APP_DO_ACTION"]=function(wh,xh,yh,zh){ff[wh](xh,yh,zh)};Vg["APP_CREATE_OBJ"]=function(Ah,Bh){var Ch=tf();var Dh=new lf[Ah](Ch,Bh);hf[Ch]=Dh;lf[Ah].prototype._ins_count++;return Ch};Vg["APP_FREE_OBJ"]=function(Eh){var Fh=hf[Eh];lf[Fh._type_id].prototype._ins_count--;uf(Eh)};nf=bf["ShaderLab"].APP_DO_OPERATORS;nf[7]=function(Gh,Hh){if(0===Gh){gf.FreeImage(Hh)}else if(1===Gh){gf.FreeBuffer(Hh)}return 0};Vg["APP_DO"]=function(Ih,Jh,Kh,Lh,Mh){return nf[Ih](Jh,Kh,Lh,Mh)};df=Vg["memory"];bf["WASM"]["m_pMemory"]=bf["WASM"]["m_pMemory"]||df;return{env:Vg,global:Wg}}function rf(Nh,Oh,Ph){gf=bf["GL"]["ImageCache"];Oh=qf(Oh);WebAssembly.instantiate(Nh,Oh).then(function(Qh){return Qh.instance}).then(function(Rh){ef=Rh.exports;cf=ef.__indirect_function_table;bf["WASM"]["Update"]=Rh.exports.SE_UPDATE;bf["WASM"]["Malloc"]=Rh.exports.Malloc;bf["WASM"]["Free"]=Rh.exports.Free;bf["ShaderLab"]["DrawPass_"]=Rh.exports.SE_DRAW_PASS;bf["ShaderLab"]["SetSunlight"]=Rh.exports.SE_SUNLIGHT;bf["ShaderLab"]["CreateUniformsDesc"]=Rh.exports.SE_CREATE_UNIFORMS_DESC;bf["ShaderLab"]["GetTexture"]=function(Sh){return ef.SE_RESOURCE(9,Sh)};bf["ShaderLab"]["GetObject"]=function(Th){var Uh=ef.SE_RESOURCE(13,Th);if(Uh){return sf(Uh)}return null};bf["Track"]("Start thread");bf["WASM"]["Worker"]=xf(function(){bf["Track"]("Start thread succeed")});ef.Start();Ph()})}function sf(Vh){return hf[Vh]}function tf(){var Wh=jf;if(hf.length>jf){jf=hf[jf]}else{jf++}kf++;return Wh}function uf(Xh){hf[Xh]=jf;jf=Xh;kf--}function vf(Yh){var Zh="'系统运行':{";Zh+="'时间':"+(bf.Time()/1e3).toFixed(0);Zh+=", '帧率':"+Yh;Zh+=", 'WASM内存':"+bf.WASM.m_pMemory.buffer.byteLength/1024/1024;Zh+="}";var $h="'JS对象':{";$h+="'工厂':["+hf.length+", "+kf+", "+(hf.length-kf)+"]";$h+=gf.Analyze();for(var _h=1;_h<lf.length;_h++){$h+=", '"+lf[_h].prototype._type_name+"':"+lf[_h].prototype._ins_count}$h+="}";return[Zh,$h]}function wf(ai){var bi=ff.length;ff.push(ai);return bi}function xf(ci){var di=ef.UTIL_WORKER_CODE();var ei=bf["WASM"]["HEAPU32"](di,16);if(false){mf=new Worker(window.URL.createObjectURL(new Blob([bf["WASM"]["HEAPU8"](ei[2],ei[3])])));var fi=bf["WASM"]["HEAPU8"]().slice(ei[0],ei[0]+ei[1]);var gi=fi.buffer;mf.postMessage({m_nID:1,m_aCode:gi},[gi])}else{var hi=bf["m_pConfig"]["MODULE"].replace(".wasm","");mf=new Worker(hi+"Worker.min.js");fetch(hi+"Worker.wasm").then(function(ii){return ii.arrayBuffer()}).then(function(ji){if(ji){mf.postMessage({m_nID:1,m_aCode:ji},[ji])}else{console.error("fetch error: ./js/Miaokit/MiaokitWorker.wasm",ji)}}).catch(function(ki){console.error("fetch error: ./js/Miaokit/MiaokitWorker.wasm",ki)})}mf.onmessage=function(li){var mi=li.data;switch(mi.m_nID){case 1:ci();ci=null;break;case 2:mf["OnLoadTerrain"](mi);break;case 3:mf["OnLoadBlockbox"](mi);break;case 4:mf["OnLoad3MX"](mi);break;default:console.error("子线程消息异常:",mi);break}};mf["LoadTerrain"]=function(ni,oi,pi,qi,ri){mf.postMessage({m_nID:2,m_pPath:bf["WASM"].GetString(ni),m_nRequest:oi,m_nCallback:pi,m_nTS:ri})};mf["OnLoadTerrain"]=function(si){var ti=cf.get(si.m_nCallback);var ui=si.m_pData;var vi=0;if(ui){vi=gf.PushBuffer(ui)}else{console.warn("Terrain miss:",si.m_pPath)}ti(si.m_nRequest,vi,si.m_nTS)};mf["LoadBlockbox"]=function wi(xi,yi,zi,Ai,Bi,Ci,Di){mf.postMessage({m_nID:3,m_nRequest:xi,m_nCol:yi,m_nRow:zi,m_nColOffset:Ai,m_nRowOffset:Bi,m_nAlloc:Ci,m_nCallback:Di})};mf["OnLoadBlockbox"]=function(Ei){var Fi=cf.get(Ei.m_nAlloc);var Gi=cf.get(Ei.m_nCallback);var Hi=Ei.m_pData;var Ii=[0,0,0,0];for(var Ji=0;Ji<4;Ji++){var Ki=Hi[Ji];if(0<Ki.m_nVertexCount&&0<Ki.m_nSubmeshCount){var Li=new bf.Mesh;var Mi=new Int32Array(Ki.m_aIndex);Li.position=new Float32Array(Ki.m_aPosition);Li.normal=new Float32Array(Ki.m_aNormal);Li.uv=new Float32Array(Ki.m_aUV);for(var Ni=0;Ni<Ki.m_nSubmeshCount;Ni++){var Oi=Mi[2*Ni];var Pi=Mi[2*Ni+1];var Qi=[];for(var Ri=Oi;Ri<Pi;Ri++){Qi.push(Ri)}Li.SetIndices(Ni,new Int32Array(Qi),4)}Li.Apply();Ii[Ji]=Li.m_nObject}else{Ii[Ji]=0}}var Si=Fi(Ei.m_nRequest,16);if(Si){bf["WASM"]["HEAPU32"](Si,16).set(new Uint32Array(Ii));Gi(Ei.m_nRequest)}};mf["Load3MX"]=function(Ti,Ui,Vi,Wi){var Xi=sf(Ti);if(Xi){var Yi=Xi.m_pFileLut[Ui];var Zi=Yi.m_pPath+Yi.m_aFile[Vi];var $i=Xi.m_pFileLut.length;Xi.m_pFileLut.push(null);mf.postMessage({m_nID:4,m_nDior:Ti,m_pPath:Zi,m_nRequest:Wi,m_nNewFolder:$i})}};mf["OnLoad3MX"]=function(_i){var aj=_i.m_pData;if(aj){var bj=sf(_i.m_nDior);if(bj){bj.m_pFileLut[_i.m_nNewFolder]=_i.m_pNewFolder;var cj=new Int32Array(aj[0]);var dj=cj[1];var ej=cj[2];var fj=4+9*dj;var gj=0;var hj=[];var ij=function(){if(ej===++gj||0==ej){var lj=aj[0].byteLength;var mj=bj["_CreateBuffer"](lj);var nj=bf["WASM"]["HEAP32"](mj,lj);nj.set(cj);bj["_Dispose"](_i.m_nRequest)}};var jj=function(oj){var pj=cj[fj+0];var qj=cj[fj+1];if(0===qj){var rj=aj[1+oj];if(null!==rj){var sj=gf.CreateImage();var tj=gf.Get(sj);var uj=new Blob([new Int8Array(rj)]);var vj=window.URL.createObjectURL(uj);tj.src=vj;tj.onload=function(zj){ij();window.URL.revokeObjectURL(vj)};hj[pj]=ef["SE_CREATE_INTERNAL_TEXTURE"]();cj[fj+3]=hj[pj];cj[fj+4]=sj}else{hj[pj]=0;cj[fj+3]=hj[pj];cj[fj+4]=0;ij()}}else if(1===qj){cj[fj+4]=hj[cj[fj+5]];var rj=aj[1+oj];if(null!==rj){var wj=rj.byteLength;var xj=bj["_CreateBuffer"](wj);var yj=bf["WASM"]["HEAP8"](xj,wj);yj.set(new Int8Array(rj));bj["_MarkBuilding"](xj);hj[pj]=ef["SE_CREATE_INTERNAL_MESH"](0,xj);cj[fj+3]=hj[pj];ij()}else{hj[pj]=0;cj[fj+3]=hj[pj];ij()}}else{hj[pj]=0;cj[fj+3]=hj[pj];cj[fj+4]=0;ij()}fj+=6};for(var kj=0;kj<ej;kj++){jj(kj)}if(0===ej){ij()}}}else{console.warn("3mx miss:",_i.m_pPath)}};return mf}bf["WASM"]=bf["WASM"]||{};bf["WASM"]["LoadMiaokit"]=rf;bf["WASM"]["GetObject"]=sf;bf["WASM"]["RegisterDelegate"]=wf;return[]});MiaokitMerge(function(Aj){var Bj=null;var Cj=null;var Dj=null;var Ej=null;var Fj=null;var Gj=null;var Hj=null;var Ij=null;var Jj=null;var Kj=null;var Lj=null;var Mj=null;var Nj=null;var Oj=null;var Pj=null;var Qj=null;var Rj=0;var Sj=function(){var Uj=Aj.m_pConfig.WEBGL;var Vj=Aj.m_pConfig.QUALITY;if(0===Vj){Dj="\n                #define LOW_QUALITY\n            ";Ej="\n                #define LOW_QUALITY\n            "}else if(1===Vj){Dj="\n                #define MEDIUM_QUALITY\n            ";Ej="\n                #define MEDIUM_QUALITY\n            "}else{Dj="\n                #define HIGH_QUALITY\n            ";Ej="\n                #define HIGH_QUALITY\n            "}if(1===Uj){Bj="\n                precision highp float;\n                precision mediump sampler2D;\n\n                uniform lowp vec4 u_Sunlight;\n                uniform lowp vec4 u_Picker;\n                uniform lowp vec4 u_EyePos;\n                uniform lowp vec4 u_Mark;\n                uniform highp mat4 u_MatG;\n                uniform highp mat4 u_MatVP;\n            ";Cj="\n                precision highp float;\n                precision mediump sampler2D;\n\n                uniform lowp vec4 u_Sunlight;\n                uniform lowp vec4 u_Picker;\n                uniform lowp vec4 u_EyePos;\n                uniform lowp vec4 u_Mark;\n                uniform highp mat4 u_MatG;\n                uniform highp mat4 u_MatVP;\n            "}else{Bj="#version 300 es\n                #define attribute in\n                #define varying out\n                #define texture2D texture\n\n                precision highp float;\n                precision mediump sampler2D;\n\n                uniform CommonBlock\n                {\n                    lowp vec4 u_Sunlight;\n                    lowp vec4 u_Picker;\n                    lowp vec4 u_EyePos;\n                    lowp vec4 u_Mark;\n                    highp mat4 u_MatG;\n                    highp mat4 u_MatVP;\n                };\n            ";Cj="#version 300 es\n                #define varying in\n                #define texture2D texture\n                #define gl_FragColor FragColor\n\n                precision highp float;\n                precision mediump sampler2D;\n\n                uniform CommonBlock\n                {\n                    lowp vec4 u_Sunlight;\n                    lowp vec4 u_Picker;\n                    lowp vec4 u_EyePos;\n                    lowp vec4 u_Mark;\n                    highp mat4 u_MatG;\n                    highp mat4 u_MatVP;\n                };\n\n                out vec4 FragColor;\n            "}Rj=Vj;return{DeclareVS:Bj+Dj+Fj,DeclareFS:Cj+Ej+Gj,ClearVS:Hj,ClearFS:Ij,RenderVS:Jj,RenderFS:Kj,PostprocessVS:Lj,PostprocessFS:Mj,ATOM_VS:Oj,ATOM_FS:Pj,BRDF_VS:"",BRDF_FS:Nj}};var Tj={_name:"Shader",GetSourceCode:function(Wj){if(!Qj){Qj=Sj()}var Xj=Tj[Wj];var Yj="";var Zj="";if(Xj.include){var $j=Xj.include[Rj];if($j){for(var _j=0,ak=$j;_j<ak.length;_j++){var bk=ak[_j];Yj+=Qj[bk+"_VS"];Zj+=Qj[bk+"_FS"]}}}return[Qj["DeclareVS"]+Yj+Xj.vs_src+Qj[Xj.type+"VS"],Qj["DeclareFS"]+Zj+Xj.fs_src+Qj[Xj.type+"FS"]]}};Fj="\nattribute mediump vec3 a_Position;\nattribute mediump vec3 a_Normal;\nattribute mediump vec2 a_UV;\nattribute mediump vec4 a_Color;\nattribute mediump vec4 a_Tangent;\nattribute mediump vec4 a_Object;\nattribute highp mat4 a_MatW;\n\nvarying vec4 v_Object;\n\n/// ����ռ�����ת����ռ�����\nvec3 ObjectToWorldPos(vec3 i_Position)\n{\n    return (a_MatW * vec4(i_Position, 1.0)).xyz;\n}\n\n/// ����ռ�����ת�ü��ռ�����\nvec4 ObjectToClipPos(vec3 i_Position)\n{\n    // GIS�ı任����ֵ������ת��Ϣ��δ����λ����Ϣ�����⾫�Ȳ�����ɻ��涶��\n    // return u_MatVP * u_MatG * a_MatW * vec4(i_Position, 1.0);\n    \n    vec4 mPosition = vec4(i_Position, 1.0);\n    mPosition = u_MatG * a_MatW * mPosition;\n    mPosition.y = mPosition.y - 6378137.0;\n\n    return u_MatVP * mPosition;\n}\n\n/// ����ռ䷨��ת����ռ䷨��\nvec3 ObjectToWorldNormal(vec3 i_Normal)\n{\n    return normalize((u_MatG * a_MatW * vec4(i_Normal, 0.0)).xyz);\n}";Gj="\nuniform sampler2D u_MainTex;\nvarying vec4 v_Object;\n\n/// ����2D����\nvec4 Tex2D(sampler2D i_Tex, vec2 i_UV)\n{\n    i_UV.x = fract(i_UV.x);\n    i_UV.y = fract(1.0 - i_UV.y);\n\n    return texture2D(i_Tex, i_UV);\n}";Hj="\nvoid main()\n{\n    gl_Position = vs();\n}";Ij="\nvoid main()\n{\n    gl_FragColor = fs();\n}";Jj="\nvoid main()\n{\n    v_Object = a_Object;\n    \n    gl_Position = vs();\n}";Kj="\nvoid main()\n{\n    gl_FragColor = fs();\n    \n    float nAlpha = u_Mark.x;\n    \n    // ��͸�������https://zhuanlan.zhihu.com/p/49164063\n    if(0.01 < nAlpha)\n    {\n        // ���Σ�0-��͸����1-ȫ͸����Ĭ��ֵ0��׷��0.3��͸����\n        nAlpha = 0.3 + 0.7 * v_Object.b;\n        \n        // Gͨ������ɫ�Ҷ��ۼӡ�����֧�ֲ�ɫ͸����\n        gl_FragColor.g = dot(gl_FragColor.rgb, vec3(0.299, 0.587, 0.114));\n        // Rͨ������ϴ����ۼӣ���ֵ1.0����ֵ0.99��Ǹ�������\n        gl_FragColor.r = 1.0 - (0.01 * v_Object.a);        \n        // Bͨ����OPACITY�ۼ�\n        gl_FragColor.b = 1.0 - nAlpha;\n        gl_FragColor.g *= gl_FragColor.b;\n        // Aͨ����ALPHA�۳ˡ���ϣ�Դ����Ϊ0��Ŀ�����Դ\n        gl_FragColor.a = 1.0 - gl_FragColor.b;\n    }\n    // ��͸�����\n    else\n    {\n        // ����������\n        gl_FragColor.a = 1.0 - (0.01 * v_Object.a);\n    }\n}";Lj="\nvoid main()\n{\n    gl_Position = vs();\n}";Mj="\nvoid main()\n{\n    gl_FragColor = fs();\n}";Nj='\nconst float PI = 3.14159265358979323846;\n\nconst vec3 baseColor = vec3(0.5, 0.5, 0.5);\nconst float metallic = 0.0;\nconst float subsurface = 0.5; // 0.0\nconst float specular = 0.2;\nconst float roughness = 0.7; //0.5;\nconst float specularTint = 0.0;\nconst float anisotropic = 0.0;\nconst float sheen = 0.0;\nconst float sheenTint = 0.5;\nconst float clearcoat = 0.0;\nconst float clearcoatGloss = 1.0;\n\nfloat sqr(float x) { return x * x; }\n\nfloat SchlickFresnel(float u)\n{\n\tfloat m = clamp(1.0 - u, 0.0, 1.0);\n\tfloat m2 = m * m;\n\treturn m2 * m2 * m; // pow(m,5)\n}\n\nfloat GTR1(float NdotH, float a)\n{\n\tif (a >= 1.0) return 1.0 / PI;\n\tfloat a2 = a * a;\n\tfloat t = 1.0 + (a2 - 1.0) * NdotH * NdotH;\n\treturn (a2 - 1.0) / (PI * log(a2) * t);\n}\n\nfloat GTR2(float NdotH, float a)\n{\n\tfloat a2 = a * a;\n\tfloat t = 1.0 + (a2 - 1.0) * NdotH * NdotH;\n\treturn a2 / (PI * t * t);\n}\n\nfloat GTR2_aniso(float NdotH, float HdotX, float HdotY, float ax, float ay)\n{\n\treturn 1.0 / (PI * ax * ay * sqr(sqr(HdotX / ax) + sqr(HdotY / ay) + NdotH * NdotH));\n}\n\nfloat smithG_GGX(float NdotV, float alphaG)\n{\n\tfloat a = alphaG * alphaG;\n\tfloat b = NdotV * NdotV;\n\treturn 1.0 / (NdotV + sqrt(a + b - a * b));\n}\n\nfloat smithG_GGX_aniso(float NdotV, float VdotX, float VdotY, float ax, float ay)\n{\n\treturn 1.0 / (NdotV + sqrt(sqr(VdotX * ax) + sqr(VdotY * ay) + sqr(NdotV)));\n}\n\nvec3 mon2lin(vec3 x)\n{\n\treturn vec3(pow(x[0], 2.2), pow(x[1], 2.2), pow(x[2], 2.2));\n}\n\nvec3 BRDF(vec3 L, vec3 V, vec3 N, vec3 X, vec3 Y)\n{\n    //x��y����ֱ��ʾ�˱�����������͸�������������\n    //https://www.cnblogs.com/starfallen/p/3572352.html\n\n\tfloat NdotL = dot(N, L);\n\tfloat NdotV = dot(N, V);\n\tif (NdotL < 0.0 || NdotV < 0.0) return vec3(0.0);\n\n\tvec3 H = normalize(L + V);\n\tfloat NdotH = dot(N, H);\n\tfloat LdotH = dot(L, H);\n\n\tvec3 Cdlin = mon2lin(baseColor);\n\tfloat Cdlum = 0.3 * Cdlin[0] + 0.6 * Cdlin[1] + 0.1 * Cdlin[2]; // luminance approx.\n\n\tvec3 Ctint = Cdlum > 0.0 ? Cdlin / Cdlum : vec3(1.0); // normalize lum. to isolate hue+sat\n\tvec3 Cspec0 = mix(specular * 0.08 * mix(vec3(1.0), Ctint, specularTint), Cdlin, metallic);\n\tvec3 Csheen = mix(vec3(1.0), Ctint, sheenTint);\n\n\t// Diffuse fresnel - go from 1 at normal incidence to .5 at grazing\n\t// and mix in diffuse retro-reflection based on roughness\n\tfloat FL = SchlickFresnel(NdotL), FV = SchlickFresnel(NdotV);\n\tfloat Fd90 = 0.5 + 2.0 * LdotH * LdotH * roughness;\n\tfloat Fd = mix(1.0, Fd90, FL) * mix(1.0, Fd90, FV);\n\n\t// Based on Hanrahan-Krueger brdf approximation of isotropic bssrdf\n\t// 1.25 scale is used to (roughly) preserve albedo\n\t// Fss90 used to "flatten" retroreflection based on roughness\n\tfloat Fss90 = LdotH * LdotH * roughness;\n\tfloat Fss = mix(1.0, Fss90, FL) * mix(1.0, Fss90, FV);\n\tfloat ss = 1.25 * (Fss * (1.0 / (NdotL + NdotV) - 0.5) + 0.5);\n\n\t// specular\n\tfloat aspect = sqrt(1.0 - anisotropic * 0.9);\n\tfloat ax = max(0.001, sqr(roughness) / aspect);\n\tfloat ay = max(0.001, sqr(roughness) * aspect);\n\tfloat Ds = GTR2_aniso(NdotH, dot(H, X), dot(H, Y), ax, ay);\n\tfloat FH = SchlickFresnel(LdotH);\n\tvec3 Fs = mix(Cspec0, vec3(1.0), FH);\n\tfloat Gs;\n\tGs = smithG_GGX_aniso(NdotL, dot(L, X), dot(L, Y), ax, ay);\n\tGs *= smithG_GGX_aniso(NdotV, dot(V, X), dot(V, Y), ax, ay);\n\n\t// sheen\n\tvec3 Fsheen = FH * sheen * Csheen;\n\n\t// clearcoat (ior = 1.5 -> F0 = 0.04)\n\tfloat Dr = GTR1(NdotH, mix(0.1, 0.001, clearcoatGloss));\n\tfloat Fr = mix(0.04, 1.0, FH);\n\tfloat Gr = smithG_GGX(NdotL, 0.25) * smithG_GGX(NdotV, 0.25);\n\n\treturn ((1.0 / PI) * mix(Fd, ss, subsurface) * Cdlin + Fsheen) * (1.0 - metallic) + Gs * Fs * Ds + 0.25 * clearcoat * Gr * Fr * Dr;\n}';Oj="\nvarying vec4 v_ViewDir;\nvarying vec4 v_Scattering;\nvarying vec4 v_Attenuate;\n\n//P and ray define the line; O is the sphere's center point\nvec3 CalculateIntersection(vec3 P, vec3 ray, vec3 O, float r)\n{\n\tvec3 PO = O - P;\n\tfloat lPO = length(PO);\n\tfloat B = 2.0 * dot(PO, ray);\n\n\tfloat C = B * B - 4.0 * (lPO * lPO - r * r);\n\tfloat det = sqrt(max(0.0, C));\n\n\tfloat d = 0.5*(B-det);\n\tvec3 intersect = P + d * ray;\n\n\treturn intersect;\n}\n\nvoid Atmosphere(vec3 mLightDir, vec3 mWorldPos)\n{\n    // ����ɢ�䣬���Ӧ�����㣬�����Ӧ�����ڲ�֮�⣬��������Ϊ���뾶���ڲ�뾶�����뾶ӦԶ�����ڲ�뾶\n    //650 nm for red; 570 nm for green; 475 nm for blue\n    vec3 _Wave = vec3(5.602046, 9.473285, 20.49314);\n    vec3 _ESun = vec3(20.0, 20.0, 20.0);\n    vec3 _PlanetPos = vec3(0.0, -6378137.0, 0.0);\n    float _Sealevel = 6378137.0;\n    float _OuterRadius = 6478137.0;\n    float _SampleNum = 5.0;\n    //Rayleigh scattering constant\n    float _Kr = 0.0025;\n    //Mie scattering constant\n    float _Km = 0.001;\n    //the altitude at which the atmosphere's average density is found\n    float _H0 = 0.25;\n\n    vec3 mRay = mWorldPos - u_EyePos.xyz;\n    float nDepth = length(mRay); mRay = mRay / nDepth;\n\n    float nSampleLength = nDepth / _SampleNum;\n    vec3 mSampleRay = mRay * nSampleLength;\n    vec3 mSamplePoint = u_EyePos.xyz + mSampleRay * 0.5;\n    vec3 mInScattering = vec3(0.0, 0.0, 0.0);\n    vec3 mOutScatteringAB = vec3(0.0, 0.0, 0.0);\n    vec3 mOutGroundScatteringAB = vec3(0.0, 0.0, 0.0);\n    float nInvOuterH = 1.0 / (_OuterRadius-_Sealevel);\n\n    for(int i=0; i</*_SampleNum*/5; i++)\n    {\n\t    vec3 mCrossPoint = CalculateIntersection(mSamplePoint, -mLightDir, _PlanetPos, _OuterRadius);\n\t    //AP out scattering\n\t    vec3 mAPRay = (mSamplePoint - u_EyePos.xyz) / _SampleNum;\n\t    float nAPRayLength = length(mAPRay);\n\t    vec3 mSampleAP = u_EyePos.xyz + mAPRay * 0.5;\n\t    vec3 mOutScatteringAP = vec3(0.0, 0.0, 0.0);\n\n\t    for(int m=0; m</*_SampleNum*/5; m++)\n\t    {\n\t\t    mOutScatteringAP += exp(-(length(mSampleAP - _PlanetPos) - _Sealevel) * nInvOuterH / _H0) * nAPRayLength * nInvOuterH;\n\t\t    mSampleAP += mAPRay;\n\t    }\n\t    mOutScatteringAP = 4.0 * 3.14 * (_Km + _Kr * _Wave) * mOutScatteringAP;\n\n\t    //PC out scattering\n\t    vec3 mPCRay = (mCrossPoint - mSamplePoint) / _SampleNum;\n\t    float nPCRayLength = length(mPCRay);\n\t    vec3 mSamplePC = mSamplePoint + mPCRay*0.5;\n\t    vec3 mOutScatteringPC = vec3(0.0, 0.0, 0.0);\n\n\t    for(int n=0; n</*_SampleNum*/5; n++)\n\t    {\n\t\t    mOutScatteringPC += exp(-(length(mSamplePC - _PlanetPos) - _Sealevel) * nInvOuterH / _H0) * nPCRayLength * nInvOuterH;\n\t\t    mSamplePC += mPCRay;\n\t    }\n\t    mOutScatteringPC = 4.0 * 3.14 * (_Km + _Kr * _Wave) * mOutScatteringPC;\n\n\t    mInScattering += exp(-(length(mSamplePoint - _PlanetPos) - _Sealevel) * nInvOuterH / _H0) * nSampleLength * nInvOuterH * exp(-mOutScatteringAP - mOutScatteringPC);\n\t    mSamplePoint+=mSampleRay;\n\t    mOutScatteringAB = mCrossPoint;\n        mOutGroundScatteringAB = mOutScatteringAP + mOutScatteringPC;\n    }\n\n    vec3 mAttenuateGround = exp(-mOutGroundScatteringAB);\n\n    v_ViewDir.xyz = u_EyePos.xyz - mWorldPos;\n    v_Scattering.xyz = mInScattering * _ESun * _Kr * _Wave;\n    v_Attenuate.xyz = mInScattering * _ESun * _Km;\n\n    v_ViewDir.w = mAttenuateGround.x;\n    v_Scattering.w = mAttenuateGround.y;\n    v_Attenuate.w = mAttenuateGround.z;\n\n    //Ground : v_ScatteringR = v_Scattering; v_ScatteringM = v_Attenuate; v_Attenuate = v_AttenuateGround;\n    //v_ViewDir = u_EyePos.xyz - mWorldPos;\n    //v_ScatteringR = mInScattering * _ESun * _Kr * _Wave;\n    //v_ScatteringM = mInScattering * _ESun * _Km;\n    //v_Attenuate = exp(-mOutGroundScatteringAB);\n}";Pj="\nvarying vec4 v_ViewDir;\nvarying vec4 v_Scattering;\nvarying vec4 v_Attenuate;\n\nfloat PhaseRayleigh(float nCostheta)\n{\n\treturn 0.75 * (1.0 + nCostheta * nCostheta);\n}\n\nfloat PhaseMie(float nCostheta, float g, float g2)\n{\n\treturn 1.5 * ((1.0 - g2) / (2.0 + g2)) * (1.0 + nCostheta * nCostheta) / pow(1.0 + g2 - 2.0 * g * nCostheta, 1.5);\n}\n\nvec4 AtmosphereColor(vec4 mColor, vec3 mLightDir)\n{\n    float _G = -0.990;\n    float _G2 = _G * _G;\n    \n    float nCostheta = dot(normalize(v_ViewDir.xyz), mLightDir);\n    float nPhaseMie = PhaseMie(nCostheta, _G, _G2);\n    float nPhaseRayleigh = PhaseRayleigh(nCostheta);\n\t\t\t\t\n    mColor.rgb = v_Scattering.xyz * nPhaseRayleigh + v_Attenuate.xyz * nPhaseMie;\n    mColor.a = mColor.b + 0.35;\n    mColor = clamp(mColor, 0.0, 0.9);\n\n    return mColor;\n}\n\nvec4 AtmosphereLight(vec4 mColor, vec3 mLightDir)\n{\n    // Ground : v_ScatteringR = v_Scattering.xyz; v_ScatteringM = v_Attenuate.xyz; v_Attenuate = v_AttenuateGround;\n    \n    float _G = -0.980;\n    float _G2 = _G * _G;\n    \n    float nCostheta = dot(normalize(v_ViewDir.xyz), mLightDir);\n    float nPhaseMie = PhaseMie(nCostheta, _G, _G2);\n    float nPhaseRayleigh = PhaseRayleigh(nCostheta);\n    \n    mColor.rgb = v_Scattering.xyz * nPhaseRayleigh + v_Attenuate.xyz * nPhaseMie + mColor.rgb * vec3(v_ViewDir.w, v_Scattering.w, v_Attenuate.w)/*v_AttenuateGround*/;\n    \n    return mColor;\n}";return[Tj]});MiaokitMerge(function(ck){var dk=undefined;var ek=true;var fk=[];var gk={RGBA32_FLOAT:function(){return true?[dk["RGBA32F"],dk.RGBA,dk.FLOAT]:[dk.RGBA,dk.RGBA,dk.FLOAT]},RGBA16_FLOAT:function(){return true?[dk["RGBA16F"],dk.RGBA,dk["HALF_FLOAT"]]:[dk.RGBA,dk.RGBA,36193]},RGBA8:function(){return true?[dk.RGBA,dk.RGBA,dk.UNSIGNED_BYTE]:[dk.RGBA,dk.RGBA,dk.UNSIGNED_BYTE]},D16_UNORM:function(){return true?[dk["DEPTH_COMPONENT16"],dk.DEPTH_COMPONENT,dk.UNSIGNED_SHORT]:[dk.DEPTH_COMPONENT,dk.DEPTH_COMPONENT,dk.UNSIGNED_SHORT]},D24_UNORM:function(){return true?[dk["DEPTH_COMPONENT24"],dk.DEPTH_COMPONENT,dk.UNSIGNED_INT]:[dk.DEPTH_COMPONENT,dk.DEPTH_COMPONENT,dk.UNSIGNED_INT]},D24S8_UNORM:function(){return true?[dk.DEPTH_STENCIL,dk.DEPTH_STENCIL,34042]:[dk.DEPTH_STENCIL,dk.DEPTH_STENCIL,34042]}};var hk={Opaque:1,Transparent:2,Outline:4,CastShadow:8,ReceiveShadow:16};var ik=null;var jk=["u_Sunlight","u_Picker","u_EyePos","u_MatG","u_MatVP","u_Color","u_MainTex","",""];var kk=[null];var lk=[null];var mk=[null];var nk=[null];var ok=[new Int32Array([0,0,0,0]),new Float32Array([0,0,0,0]),new Float32Array([1,0,0,0,1,0,0,0,1]),new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),new Int32Array([0,0,0,0]),new Int32Array([0,0,0,0]),new Int32Array([0,0,0,0]),new Int32Array([0,0,0,0])];var pk=[function(Vk,Wk,Xk){Ck(kk[Vk],nk[Wk])},function(Yk,Zk,$k){Dk(kk[Yk],nk[Zk])},function(_k,al,bl){Ek(kk[_k],nk[al])},function(cl,dl,el){Fk(kk[cl],nk[dl])},function(fl,gl,hl){var il=nk[gl];var jl=il[1];if(il[0]){jl=Tk.GetTexture(jl);if(jl){il[0]=0;il[1]=jl}}var kl=fk[jl]||zk;if(null===kl){console.log("BindTexture null!");return}dk.activeTexture(33984+hl);dk.bindTexture(3553,kl)},function(ll,ml){console.error("Unsupported UniformCubemap!")},null,function(nl,ol,pl){var ql=nk[ol];var rl=ql[1];if(ql[0]){rl=Tk.GetTexture(rl);if(rl){ql[0]=0;ql[1]=rl}}var sl=fk[rl]||zk;if(null===sl){console.log("BindTexture null!");return}dk.activeTexture(33984+pl);dk.bindTexture(35866,sl)}];var qk=[null];var rk=[null];var sk=1280;var tk=720;var uk=1;var vk=0;var wk=null;var xk=new Float32Array(4);var yk=[0,0,0,0];var zk=null;var Ak=null;var Bk=0;function Ck(tl,ul){if(undefined===tl.mark){dk.uniform4iv(tl,ul)}else if(uk!==tl.mark){dk.uniform4iv(tl,ul);tl.mark=uk}}function Dk(vl,wl){if(undefined===vl.mark){dk.uniform4fv(vl,wl)}else if(uk!==vl.mark){dk.uniform4fv(vl,wl);vl.mark=uk}}function Ek(xl,yl){if(undefined===xl.mark){dk.uniformMatrix3fv(xl,false,yl)}else if(uk!==xl.mark){dk.uniformMatrix3fv(xl,false,yl);xl.mark=uk}}function Fk(zl,Al){if(undefined===zl.mark){dk.uniformMatrix4fv(zl,false,Al)}else if(uk!==zl.mark){dk.uniformMatrix4fv(zl,false,Al);zl.mark=uk}}function Gk(Bl,Cl){var Dl=dk.createShader(Bl);if(!Dl){console.error("Could not create shader object!");return null}dk.shaderSource(Dl,Cl);dk.compileShader(Dl);if(!dk.getShaderParameter(Dl,dk.COMPILE_STATUS)){var El=dk.getShaderInfoLog(Dl);dk.deleteShader(Dl);console.error("Could not compile shader! \n\n"+El);return null}return Dl}function Hk(Fl){var Gl=Fl.program;var Hl=0;{dk.bindAttribLocation(Gl,0,"a_Position");dk.bindAttribLocation(Gl,1,"a_Normal");dk.bindAttribLocation(Gl,2,"a_UV");dk.bindAttribLocation(Gl,3,"a_Color");dk.bindAttribLocation(Gl,4,"a_Tangent");dk.bindAttribLocation(Gl,5,"a_Object");dk.bindAttribLocation(Gl,6,"a_MatW")}{dk.linkProgram(Gl);if(!dk.getProgramParameter(Gl,dk.LINK_STATUS)){var Il=dk.getProgramInfoLog(Gl);console.error("Could not compile program! \n\n"+Il);return 0}}{var Jl=dk.getProgramParameter(Gl,35718);if(ek){Jl-=6;var Kl=dk["getUniformBlockIndex"](Gl,"CommonBlock")}var Ll=Tk.CreateUniformsDesc(Jl);var Ml=nk[Ll];var Nl={};var Ol=0;Ml[19]=mk.push(Nl)-1;qk[Ml[19]]=Fl;dk.useProgram(Gl);for(var Pl=0;Pl<2;Pl++){var Ql=Jl+(ek?6:0);for(var Rl=0;Rl<Ql;Rl++){var Il=dk.getActiveUniform(Gl,Rl);var Sl=Il.type;if(35678===Sl||35680===Sl||36289===Sl){if(0!==Pl){continue}}else{if(1!==Pl){continue}}var Tl=Il.name;var Ul=dk.getUniformLocation(Gl,Tl);if(!Ul){continue}var Vl=kk.push(Ul)-1;for(var Wl=0;Wl<jk.length;Wl++){if(Tl===jk[Wl]){Ml[Wl]=Ol;if(5>Wl){Ul.mark=1}break}}switch(Sl){case 35669:Sl=0;break;case 35666:Sl=1;break;case 35675:Sl=2;break;case 35676:Sl=3;break;case 35678:Sl=4;break;case 35680:Sl=5;break;case 36289:Sl=7;break;default:console.error("Unsupported uniform type:",Il);break}Ml[20+Ol]=Vl;Ml[20+Jl+Ol]=Sl;Nl[Tl]=Ol;lk[Vl]=Tl;if(0===Pl){dk.uniform1i(Ul,Ol)}Ol++}}if(Ol!==Jl){console.error("Process uniform cout error!",Jl,Ol)}Hl=Ml[16]}{var Xl=0;if(Fl.mark){for(var Yl=0,Zl=Fl.mark;Yl<Zl.length;Yl++){var $l=Zl[Yl];Xl|=hk[$l]}}Fl.mode=Xl}return Hl}function Ik(_l){if(!_l){return null}var am=ck.Shader[_l];if(!am){console.error("Could not find shader:",_l);return null}if(am.program){return am}var bm=ck.Shader.GetSourceCode(_l);am.vs=Gk(dk.VERTEX_SHADER,bm[0]);if(!am.vs){console.error("Could not create vertex shader:",_l);return null}am.fs=Gk(dk.FRAGMENT_SHADER,bm[1]);if(!am.fs){dk.deleteShader(am.vs);am.vs=null;console.error("Could not create fragment shader:",_l);return null}am.program=dk.createProgram();if(!am.program){dk.deleteShader(am.vs);dk.deleteShader(am.fs);am.vs=null;am.fs=null;console.error("Could not create program object!");return null}dk.attachShader(am.program,am.vs);dk.attachShader(am.program,am.fs);am.id=Hk(am);if(!am.id){dk.deleteProgram(am.program);dk.deleteShader(am.vs);dk.deleteShader(am.fs);am.program=null;am.vs=null;am.fs=null}return am}function Jk(cm,dm){var em=undefined;var fm=undefined;var gm=undefined;var hm=undefined;var im=0;function jm(){var tm=nk[cm];var um=nk[dm];var vm=qk[tm[19]];var wm=tm[20];var xm=20+tm[17];em=vm.program;fm=mk[tm[19]];gm=tm;hm=[];im=tm[17];var ym=function(Hm){var Im=Hm;var Jm=nk[um[Im]];var Km=kk[wm+Im];var Lm=tm[xm+Im];var Mm=[function(){return Jm},function(Nm){Jm.set(Nm)},undefined];switch(Lm){case 0:Mm[2]=function(){Ck(Km,Jm)};break;case 1:Mm[2]=function(){Dk(Km,Jm)};break;case 2:Mm[2]=function(){Ek(Km,Jm)};break;case 3:Mm[2]=function(){Fk(Km,Jm)};break;case 4:Mm[2]=function(){var Om=Jm[1];if(Jm[0]){Om=Tk.GetTexture(Om);if(Om){Jm[0]=0;Jm[1]=Om}}var Pm=fk[Om]||zk;if(null===Pm){console.log("BindTexture null!");return}dk.activeTexture(33984+Im);dk.bindTexture(3553,Pm)};break;case 7:Mm[2]=function(){var Qm=Jm[1];if(Jm[0]){Qm=Tk.GetTexture(Qm);if(Qm){Jm[0]=0;Jm[1]=Qm}}var Rm=fk[Qm]||zk;if(null===Rm){console.log("BindTexture null!");return}dk.activeTexture(33984+Im);dk.bindTexture(35866,Rm)};break;default:console.error("Unsupported uniform type!",Lm);break}hm[Im]=Mm};for(var zm=0;zm<im;zm++){ym(zm)}if(vm.uniform_values){for(var Am=0,Bm=vm.uniform_values;Am<Bm.length;Am++){var Cm=Bm[Am];var Dm=fm[Cm[0]];if(undefined!==Dm){var Em=tm[xm+Dm];if(4===Em||5===Em){var Fm=Tk.Pipeline["Resource"][Cm[1]];var Gm=[0,Fm.Handle,0,0];hm[Dm][1](Gm)}}}}return vm.mode}function km(Sm){if(wk){wk(rk[dm],dk)}if(vk!==cm){dk.useProgram(em);vk=cm;if(Ak){dk["bindBufferBase"](dk["UNIFORM_BUFFER"],0,Ak)}}for(var Tm=0,Um=hm;Tm<Um.length;Tm++){var Vm=Um[Tm];Vm[2]()}}function lm(Wm){return fm[Wm]}function mm(Xm){return hm[Xm][0]()}function nm(Ym){Ym=gm[Ym];if(-1<Ym){return hm[Ym][0]()}return null}function om(Zm){var $m=fm[Zm];if(undefined!==$m){return hm[$m][0]()}return null}function pm(_m,an){hm[_m][1](an);if(vk===cm){hm[_m][2]()}}function qm(bn,cn){bn=gm[bn];if(-1<bn){hm[bn][1](cn);if(vk===cm){hm[bn][2]()}}}function rm(dn,en){var fn=fm[dn];if(undefined!==fn){hm[fn][1](en);if(vk===cm){hm[fn][2]()}}}function sm(gn){hm[gn][2]()}rk[dm]=[jm,km,lm,mm,nm,om,pm,qm,rm,sm];return jm()}function Kk(hn){{Object.defineProperty(hn,"Attr",{get:function(){if(!this.Attr_){this.Attr_=rk[this._VarList()]}return this.Attr_}})}{var jn=function(ln){var mn=ln;Object.defineProperty(hn,jk[ln],{get:function(){return this.Attr[4](mn)},set:function(nn){if(nn){this.Attr[7](mn,nn)}}})};for(var kn=0;kn<jk.length;kn++){jn(kn)}}{}}function Lk(on){var pn=dk.createTexture();if(!pn){console.error("Could not create texture object!");return null}dk.bindTexture(dk.TEXTURE_2D,pn);dk.texParameteri(dk.TEXTURE_2D,dk.TEXTURE_MIN_FILTER,dk.NEAREST);dk.texParameteri(dk.TEXTURE_2D,dk.TEXTURE_MAG_FILTER,dk.NEAREST);dk.texParameteri(dk.TEXTURE_2D,dk.TEXTURE_WRAP_S,dk.CLAMP_TO_EDGE);dk.texParameteri(dk.TEXTURE_2D,dk.TEXTURE_WRAP_T,dk.CLAMP_TO_EDGE);dk.texImage2D(dk.TEXTURE_2D,0,dk.RGBA,1,1,0,dk.RGBA,dk.UNSIGNED_BYTE,new Uint8Array(4));var qn=new Image;qn.crossOrigin="anonymous";qn.src=on.URL;qn.onload=function(rn){dk.bindTexture(dk.TEXTURE_2D,pn);dk.texImage2D(dk.TEXTURE_2D,0,dk.RGBA,dk.RGBA,dk.UNSIGNED_BYTE,qn);dk.bindTexture(dk.TEXTURE_2D,null)};dk.bindTexture(dk.TEXTURE_2D,null);return pn}function Mk(sn){var tn=dk.createTexture();if(!tn){console.error("Could not create texture object!");return null}dk.bindTexture(dk.TEXTURE_2D,tn);var un=sn.Params;dk.texParameteri(dk.TEXTURE_2D,dk.TEXTURE_MAG_FILTER,dk[un[1]]);dk.texParameteri(dk.TEXTURE_2D,dk.TEXTURE_MIN_FILTER,dk[un[0]]);dk.texParameteri(dk.TEXTURE_2D,dk.TEXTURE_WRAP_S,dk[un[2]]);dk.texParameteri(dk.TEXTURE_2D,dk.TEXTURE_WRAP_T,dk[un[3]]);var vn=gk[sn.Format]();dk.texImage2D(dk.TEXTURE_2D,sn.Levels,vn[0],sn.Width,sn.Height,0,vn[1],vn[2],null);dk.bindTexture(dk.TEXTURE_2D,null);tn["_Format"]=vn;return tn}function Nk(wn,xn){var yn=dk.createFramebuffer();if(!yn){console.error("Could not create framebuffer object!");return null}dk.bindFramebuffer(dk.FRAMEBUFFER,yn);dk.framebufferTexture2D(dk.FRAMEBUFFER,dk.COLOR_ATTACHMENT0,dk.TEXTURE_2D,wn,0);if(xn&&xn["_Format"][0]===dk.DEPTH_STENCIL){dk.framebufferTexture2D(dk.FRAMEBUFFER,dk.DEPTH_STENCIL_ATTACHMENT,dk.TEXTURE_2D,xn,0)}else{dk.framebufferTexture2D(dk.FRAMEBUFFER,dk.DEPTH_ATTACHMENT,dk.TEXTURE_2D,xn,0)}if(dk.FRAMEBUFFER_COMPLETE!=dk.checkFramebufferStatus(dk.FRAMEBUFFER)){dk.deleteFramebuffer(yn);console.error("Framebuffer check failed!");return null}return yn}var Ok=function(zn){if(ek){nk[Bk][12]=zn;dk.bindBuffer(dk["UNIFORM_BUFFER"],Ak);dk.bufferData(dk["UNIFORM_BUFFER"],nk[Bk],dk.DYNAMIC_DRAW)}};var Pk=null;var Qk=null;var Rk=null;var Sk=null;var Tk={_name:"ShaderLab",Pipeline:null,Init:function(An){dk=ck["GL"]["Ctx"];fk=ck["GL"]["_textures"];sk=dk.canvas.width;tk=dk.canvas.height;Pk=ck["GL"]["BindViewport"];Qk=ck["GL"]["BindDepth"];Rk=ck["GL"]["BindBlend"];Sk=ck["GL"]["BindStencil"];if(ek){var Bn=dk.createBuffer();if(Bn){dk.bindBuffer(dk["UNIFORM_BUFFER"],Bn);dk.bufferData(dk["UNIFORM_BUFFER"],64*3,dk.DYNAMIC_DRAW);dk.bindBuffer(dk["UNIFORM_BUFFER"],null);Ak=Bn}}this.Pipeline.Init();for(var Cn=0,Dn=this.Pipeline.RenderTarget;Cn<Dn.length;Cn++){var En=Dn[Cn];if(En){En.Width=En.Width||sk;En.Height=En.Height||tk;En.Levels=En.Levels||0;En.Params=En.Params||["NEAREST","NEAREST","CLAMP_TO_EDGE","CLAMP_TO_EDGE"];En.Texture=Mk(En);En.Handle=ck["GL"]["RegisterTexture"](En.Texture);En.Size=[1/En.Width,1/En.Height,En.Width,En.Height]}}for(var Fn=0,Gn=this.Pipeline.Resource;Fn<Gn.length;Fn++){var Hn=Gn[Fn];if(Hn){if("2D"===Hn.TYPE){Hn.Texture=Lk(Hn);Hn.Handle=ck["GL"]["RegisterTexture"](Hn.Texture);if(2===Hn.ID){zk=Hn.Texture}}}}function In(Sn){var Tn=Sn.RenderTarget;if(Tn){var Un=Tk.Pipeline["RenderTarget"][Tn[0]];var Vn=Tk.Pipeline["RenderTarget"][Tn[1]];Sn.Framebuffer=Nk(Un.Texture,Vn?Vn.Texture:null);if(!Sn.Framebuffer){console.log(Sn)}Sn.Framebuffer.width=Un.Size[2];Sn.Framebuffer.height=Un.Size[3]}else{Sn.Framebuffer=null}}for(var Jn=0,Kn=this.Pipeline.Pass;Jn<Kn.length;Jn++){var Ln=Kn[Jn];if(Ln){if("Clear"===Ln.Type){Ln._Type=2}else{Ln._Type="Render"===Ln.Type?0:1}Ln._Mask=0;for(var Mn=0,Nn=Ln.Mask;Mn<Nn.length;Mn++){var On=Nn[Mn];Ln._Mask+=hk[On]}In(Ln);if(Ln.Pingpong){for(var Pn=0,Qn=Ln.Pingpong;Pn<Qn.length;Pn++){var Rn=Qn[Pn];In(Rn)}}}}},Draw:function(){uk++;var Wn=0;var Xn=this.Pipeline.Picker;if(Xn){yk[0]=Xn.x;yk[1]=dk.canvas.height-Xn.y}else{yk[0]=-10;yk[1]=-10}Ok(0);for(var Yn=0,Zn=this.Pipeline.Pass;Yn<Zn.length;Yn++){var $n=Zn[Yn];Uk.BeginDrawPass();if($n.Pingpong){for(var _n=0;_n<$n.PingpongCount;_n++){for(var ao=0;ao<$n.Pingpong.length;ao++){$n.Framebuffer=$n.Pingpong[ao].Framebuffer;$n.SetUniforms=$n.Pingpong[ao].SetUniforms;this.DrawPass($n,Tk.DrawPass_)}}}else{this.DrawPass($n,Tk.DrawPass_)}Uk.EndDrawPass(Wn++)}},DrawPass:function(bo,co){dk.bindFramebuffer(dk.FRAMEBUFFER,bo.Framebuffer);Pk(bo.Framebuffer,sk,tk);Qk(bo.Depth);Rk(bo.Blend,Ok);Sk(bo.Stencil);var eo=bo.ClearTarget;if(eo){var fo=0;if(eo.Color){dk.clearColor(eo.Color.r,eo.Color.g,eo.Color.b,eo.Color.a);fo+=dk.COLOR_BUFFER_BIT}if(undefined!==eo.Depth){dk.clearDepth(eo.Depth);fo+=dk.DEPTH_BUFFER_BIT}if(undefined!==eo.Stencil){dk.clearStencil(eo.Stencil);fo+=dk.STENCIL_BUFFER_BIT}dk.clear(fo)}wk=bo.SetUniforms;if(bo.Shader){if(!bo._Material){bo._Material=new ck["Material"](bo.Shader)}bo._Material._Bind()}co(bo._Type,bo._Mask);if(bo.Postprocess){bo.Postprocess(dk)}},PreflushBuffer:function(){var go=nk.length;var ho=new Array(go);for(var io=0;io<go;io++){var jo=nk[io];if(jo){if("Float32Array"===jo.constructor.name){ho[io]=jo.length}else{ho[io]=-jo.length}nk[io]=jo.byteOffset}}return ho},FlushBuffer:function(ko,lo){ik=ko;var mo=nk.length;for(var no=0;no<mo;no++){var oo=nk[no];if(oo){var po=lo[no];if(0<po){nk[no]=new Float32Array(ik,oo,po)}else{nk[no]=new Int32Array(ik,oo,-po)}}}for(var no=0;no<mo;no++){var qo=rk[no];if(qo){qo[0]()}}ck["GL"]["FlushHeap"]()},ResizeCanvas:function(ro,so){},PickObject:function(){var to=this.Pipeline.Picker;if(to){dk.readPixels(to.x,dk.canvas.height-to.y,1,1,dk.RGBA,dk.FLOAT,xk);if(0>xk[3]){var uo=Math.ceil(xk[0]*1e4)*8192+Math.ceil(xk[1]*1e4);var vo=Math.ceil(xk[2]*1e4);var wo=this["GetObject"](uo);to.Feedback(wo,vo)}else{to.Feedback(null,0)}this.Pipeline.Picker=null}},APP_DO_OPERATORS:[function(xo){var yo=ck["ShaderLab"]["Pipeline"]["InternalShader"][xo];var zo=Ik(yo);return zo.id},function(Ao,Bo,Co,Do){var Eo=null;switch(Bo){case 0:Eo=new Int32Array(ik,Do,4);Eo.set(ok[0]);break;case 1:Eo=new Float32Array(ik,Do,4);Eo.set(ok[1]);break;case 2:Eo=new Float32Array(ik,Do,9);Eo.set(ok[2]);break;case 3:Eo=new Float32Array(ik,Do,16);Eo.set(ok[3]);break;case 4:Eo=new Int32Array(ik,Do,4);Eo.set(ok[4]);break;case 5:Eo=new Int32Array(ik,Do,4);Eo.set(ok[5]);break;case 6:Eo=new Int32Array(ik,Do,Co);break;case 7:Eo=new Int32Array(ik,Do,4);Eo.set(ok[7]);break;case 8:Eo=new Float32Array(ik,Do,48);Bk=Ao;break;default:console.error("Unsupported uniform type:",Bo);break}nk[Ao]=Eo;return Ao},function(Fo,Go,Ho,Io){pk[Fo](Go,Ho,Io);return 0},function(Jo,Ko,Lo,Mo){var No=ck["WASM"].GetString(Mo);var Oo=nk[Jo];var Po=mk[Oo[19]];var Qo=Po[No];return undefined===Qo?0:Qo},function(Ro,So){rk[So][1](Ro);return 0},function(){Tk.Draw()},Jk,null],ExpandMaterial:Kk,CreateUniformsDesc:undefined,GetTexture:undefined,DrawPass_:undefined,SetSunlight:undefined};var Uk={_name:"Profiler",m_pMsg:"",m_nCycleStart:0,m_nCycleTick:0,m_nBeginCycle:0,m_nTotalCycle:0,m_nBeginScript:0,m_nTotalScript:0,m_nBeginUpdate:0,m_nTotalUpdate:0,m_nBeginDraw:0,m_nTotalDraw:0,m_nBeginMaterial:0,m_nTotalMaterial:0,m_nBeginDrawPass:0,m_nTotalDrawPass:[],BeginCycle:function(){if(0===Uk.m_nCycleTick){Uk.m_nCycleStart=ck["Time"]();Uk.m_nCycleTick=0;Uk.m_nBeginCycle=0;Uk.m_nTotalCycle=0;Uk.m_nBeginScript=0;Uk.m_nTotalScript=0;Uk.m_nBeginUpdate=0;Uk.m_nTotalUpdate=0;Uk.m_nBeginDraw=0;Uk.m_nTotalDraw=0;Uk.m_nBeginMaterial=0;Uk.m_nTotalMaterial=0;Uk.m_nBeginDrawPass=0;Uk.m_nTotalDrawPass=[]}Uk.m_nBeginCycle=ck["Time"]()},EndCycle:function(){Uk.m_nTotalCycle+=ck["Time"]()-Uk.m_nBeginCycle;if(60===++Uk.m_nCycleTick){var To={"总耗时":ck["Time"]()-Uk.m_nCycleStart,"应用循环":Uk.m_nTotalCycle,"脚本逻辑":Uk.m_nTotalScript,"场景更新":Uk.m_nTotalUpdate,"场景绘制":Uk.m_nTotalDraw,"通道绘制":Uk.m_nTotalDrawPass};Uk.m_pMsg="'开销统计':"+JSON.stringify(To);Uk.m_nCycleTick=0}},BeginScript:function(){Uk.m_nBeginScript=ck["Time"]()},EndScript:function(){Uk.m_nTotalScript+=ck["Time"]()-Uk.m_nBeginScript},BeginUpdate:function(){Uk.m_nBeginUpdate=ck["Time"]()},EndUpdate:function(){Uk.m_nTotalUpdate+=ck["Time"]()-Uk.m_nBeginUpdate},BeginDraw:function(){Uk.m_nBeginDraw=ck["Time"]()},EndDraw:function(){Uk.m_nTotalDraw+=ck["Time"]()-Uk.m_nBeginDraw},BeginMaterial:function(){Uk.m_nBeginMaterial=ck["Time"]()},EndMaterial:function(){Uk.m_nTotalMaterial+=ck["Time"]()-Uk.m_nBeginMaterial},BeginDrawPass:function(){Uk.m_nBeginDrawPass=ck["Time"]()},EndDrawPass:function(Uo){Uk.m_nTotalDrawPass[Uo]=(Uk.m_nTotalDrawPass[Uo]?Uk.m_nTotalDrawPass[Uo]:0)+ck["Time"]()-Uk.m_nBeginDrawPass}};return[Tk,Uk]});MiaokitMerge(function(Vo){if("Sisyphus"!==Vo["m_pConfig"]["ENGINE"]){return[]}var Wo=undefined;var Xo=true;function Yo(cp){Zo();Wo=cp.OnRenderingEvent;$o();var dp={memory:new WebAssembly.Memory({initial:64*16,maximum:32768}),APP_PLUGIN_TYPE:function(){return 2},APP_MEM_TYPE:function(){return 2},APP_MEM_RESERVE:function(){return 1024},APP_MEM_MALLOC:function(ep){alert("SISYPHUS��չ��֧��ʹ�÷������ڴ�!");return 0},APP_MEM_FREE:function(fp){alert("SISYPHUS��չ��֧��ʹ�÷������ڴ�!")},APP_MEM_BASE:function(){return 64*1024*1024},APP_MEM_GROW:function(gp){if(Vo["ShaderLab"]){var hp=Vo["ShaderLab"]["PreflushBuffer"]();dp["memory"].grow(gp/64/1024);var ip=dp["memory"].buffer;Vo["ShaderLab"]["FlushBuffer"](ip,hp)}else{dp["memory"].grow(gp/64/1024)}},APP_MEM_RECYCLE:function(jp){alert("WAMSģ�鲻֧�ֻ����ڴ�!")},UNITY_CREATE_OBJ:function(){alert("δװ��UNITY��չ!");return 0},UNITY_FREE_OBJ:function(){alert("δװ��UNITY��չ!");return 0},UNITY_GET:function(){alert("δװ��UNITY��չ!");return 0},UNITY_DO:function(){alert("δװ��UNITY��չ!");return 0}};Object["assign"](dp,bp.Export);cp.OnEngineLoad(dp)}function Zo(){var kp=document.getElementById("unityContainer");var lp=document.createElement("canvas");lp.id="3d";lp.width=kp.offsetWidth;lp.height=kp.offsetHeight;lp.style.width="100%";lp.style.height="100%";lp.style.top="0rem";lp.style.bottom="0rem";lp.style.left="0rem";lp.style.right="0rem";lp.style.position="absolute";lp.style.zIndex="1";kp.appendChild(lp);bp["CreateContext"](lp,null);Vo["ShaderLab"]["Init"](bp)}function $o(){if(Xo){Xo=false;ap()}}function _o(){Xo=true}function ap(){if(Xo){return}Vo.Profiler.BeginCycle();Vo.Profiler.BeginScript();Wo(0);Vo.Profiler.EndScript();if(Vo["WASM"]["Update"]){Vo.Profiler.BeginUpdate();Vo["WASM"]["Update"](0);Vo.Profiler.EndUpdate();Vo.Profiler.BeginDraw();Vo["WASM"]["Update"](1);Vo.Profiler.EndDraw()}Vo.Profiler.EndCycle();requestAnimationFrame(ap)}var bp=function(){var mp=undefined;var np=[-1,-1,-1,-1];var op=[-1,-1,-1];var pp=[-1,-1,-1,-1,-1,-1,-1];var qp=[-1,-1,-1,-1,-1,-1,-1];var rp=[null];var sp=null;var tp=null;var up=0;var vp=function(){var Dp=[null];var Ep=[];var Fp=[];var Gp=0;var Hp=0;return{Analyze:function(){return", 'Image':["+Gp+","+Ep.length+","+Hp+","+Fp.length+"]"},Get:function(Ip){return Dp[Ip]},CreateImage:function(){var Jp=null;if(0<Ep.length){Jp=Ep.pop()}else{Gp++;Jp=Dp.push(new Image)-1}return Jp},FreeImage:function(Kp){Ep.push(Kp)},PushBuffer:function(Lp){var Mp=null;if(0<Fp.length){Mp=Fp.pop()}else{Hp++;Mp=Dp.push(null)-1}Dp[Mp]=Lp;return Mp},FreeBuffer:function(Np){Dp[Np]=null;Fp.push(Np)}}}();var wp=function(Op){var Pp=rp.length;Op.name=Pp;rp[Pp]=Op;return Pp};var xp=function(Qp){return rp[Qp]};var yp=function(Rp,Sp){rp[Rp]=Sp};var zp=function(Tp,Up){tp[Tp>>2]=Up};var Ap=function(Vp){return tp[Vp>>2]};var Bp=function(Wp,Xp){return sp.subarray(Wp,Wp+Xp)};var Cp={glGenVertexArrays:function(Yp,Zp){var $p=mp["createVertexArray"]();if(!$p||1!=Yp){console.error("gl.createVertexArray error!");return}var _p=wp($p);zp(Zp,_p)},glDeleteVertexArrays:function(aq,bq){var cq=Ap(bq);var dq=xp(cq);if(!dq||1!=aq){console.error("gl.deleteVertexArray error!");return}mp["deleteVertexArray"](dq);yp(cq,null)},glBindVertexArray:function(eq){mp["bindVertexArray"](xp(eq))},glVertexAttribPointer:function(fq,gq,hq,iq,jq,kq){mp.vertexAttribPointer(fq,gq,hq,!!iq,jq,kq)},glEnableVertexAttribArray:function(lq){mp.enableVertexAttribArray(lq)},glVertexAttribDivisor:function(mq,nq){mp["vertexAttribDivisor"](mq,nq)},glGenTextures:function(oq,pq){var qq=mp.createTexture();if(!qq||1!=oq){console.error("gl.createTexture error!");return}var rq=wp(qq);zp(pq,rq)},glDeleteTextures:function(sq,tq){var uq=Ap(tq);var vq=xp(uq);if(!vq||1!=sq){console.error("gl.deleteTexture error!");return}mp.deleteTexture(vq);yp(uq,null)},glActiveTexture:function(wq){mp.activeTexture(wq)},glBindTexture:function(xq,yq){mp.bindTexture(xq,xp(yq))},glTexParameteri:function(zq,Aq,Bq){mp.texParameteri(zq,Aq,Bq)},glTexImage2DObj:function(Cq,Dq,Eq,Fq,Gq,Hq,Iq,Jq,Kq,Lq){if(0==Lq){var Mq=vp.Get(Kq);if(Mq){if(Mq instanceof ArrayBuffer){mp.texImage2D(Cq,Dq,Eq,Fq,Gq,Hq,Iq,Jq,new Uint8Array(Mq));vp.FreeBuffer(Kq)}else{mp.texParameterf(Cq,34046,up);mp.texImage2D(Cq,Dq,Eq,Iq,Jq,Mq);vp.FreeImage(Kq)}}}else{mp.texImage2D(Cq,Dq,Eq,Fq,Gq,Hq,Iq,Jq,0===Kq?new Uint8Array(3):Bp(Kq,Lq))}},glGenBuffers:function(Nq,Oq){var Pq=mp.createBuffer();if(!Pq||1!=Nq){console.error("gl.createBuffer error!");return}var Qq=wp(Pq);zp(Oq,Qq)},glDeleteBuffers:function(Rq,Sq){var Tq=Ap(Sq);var Uq=xp(Tq);if(!Uq||1!=Rq){console.error("gl.deleteBuffer error!");return}mp.deleteBuffer(Uq);yp(Tq,null)},glBindBuffer:function(Vq,Wq){mp.bindBuffer(Vq,xp(Wq))},glBufferData:function(Xq,Yq,Zq,$q){if(!Zq){mp.bufferData(Xq,Yq,$q)}else{mp.bufferData(Xq,Bp(Zq,Yq),$q)}},glBufferSubData:function(_q,ar,br,cr){mp.bufferSubData(_q,ar,Bp(cr,br))},glBlendEquationSeparate:function(dr,er){if(dr!=pp[1]||er!=pp[2]){mp.blendEquationSeparate(dr,er);pp[1]=dr;pp[2]=er}},glBlendFuncSeparate:function(fr,gr,hr,ir){if(fr!=pp[3]||gr!=pp[4]||hr!=pp[5]||ir!=pp[6]){mp.blendFuncSeparate(fr,gr,hr,ir);pp[3]=fr;pp[4]=gr;pp[5]=hr;pp[6]=ir}},glEnable:function(jr){mp.enable(jr)},glDisable:function(kr){mp.disable(kr)},glDepthFunc:function(lr){mp.depthFunc(lr)},glDepthMask:function(mr){mp.depthMask(!!mr)},glCullFace:function(nr){mp.cullFace(nr)},glPolygonOffset:function(or,pr){mp.polygonOffset(or,pr)},glViewport:function(qr,rr,sr,tr){if(sr!=np[2]||tr!=np[3]){mp.viewport(qr,rr,sr,tr);np[2]=sr;np[3]=tr}},glDrawArrays:function(ur,vr,wr){mp.drawArrays(ur,vr,wr)},glDrawArraysInstanced:function(xr,yr,zr,Ar){mp["drawArraysInstanced"](xr,yr,zr,Ar)},glDrawElements:function(Br,Cr,Dr,Er){mp.drawElements(Br,Cr,Dr,Er)},glDrawElementsInstanced:function(Fr,Gr,Hr,Ir,Jr){mp["drawElementsInstanced"](Fr,Gr,Hr,Ir,Jr)}};return{_name:"GL",_textures:rp,Ctx:null,ImageCache:vp,Export:Cp,FlushHeap:function(){sp=Vo["WASM"]["HEAPU8"]();tp=Vo["WASM"]["HEAP32"]()},CreateContext:function(Kr,Lr){Lr=Lr||{majorVersion:2,minorVersion:0,alpha:0,depth:0,stencil:0,antialias:0,premultipliedAlpha:0,preserveDrawingBuffer:0,preferLowPowerToHighPerformance:0,failIfMajorPerformanceCaveat:0,enableExtensionsByDefault:1,explicitSwapControl:0,proxyContextToMainThread:0,renderViaOffscreenBackBuffer:0};if(Lr["explicitSwapControl"]){return 0}if(Lr["majorVersion"]==1){mp=Kr.getContext("webgl",Lr)||Kr.getContext("experimental-webgl",Lr);if(!mp){console.error("create webgl_1 error!");return}var Mr=mp.getExtension("ANGLE_instanced_arrays");if(Mr){mp["vertexAttribDivisor"]=function(Vr,Wr){Mr["vertexAttribDivisorANGLE"](Vr,Wr)};mp["drawArraysInstanced"]=function(Xr,Yr,Zr,$r){Mr["drawArraysInstancedANGLE"](Xr,Yr,Zr,$r)};mp["drawElementsInstanced"]=function(_r,as,bs,cs,ds){Mr["drawElementsInstancedANGLE"](_r,as,bs,cs,ds)}}else{console.error("!ANGLE_instanced_arrays")}var Nr=mp.getExtension("OES_vertex_array_object");if(Nr){mp["createVertexArray"]=function(){return Nr["createVertexArrayOES"]()};mp["deleteVertexArray"]=function(es){Nr["deleteVertexArrayOES"](es)};mp["bindVertexArray"]=function(fs){Nr["bindVertexArrayOES"](fs)}}else{console.error("!OES_vertex_array_object")}var Or=["EXT_color_buffer_half_float","OES_texture_half_float","EXT_texture_filter_anisotropic","WEBGL_depth_texture","OES_element_index_uint","EXT_frag_depth","EXT_blend_minmax"];for(var Pr=0,Qr=Or;Pr<Qr.length;Pr++){var Rr=Qr[Pr];var Sr=mp.getExtension(Rr);if(!Sr){console.error("!"+Rr)}}}else{mp=Kr.getContext("webgl2",Lr);if(!mp){console.error("create webgl_2 error!");return}var Or=["EXT_color_buffer_float","EXT_texture_filter_anisotropic"];for(var Tr=0,Ur=Or;Tr<Ur.length;Tr++){var Rr=Ur[Tr];var Sr=mp.getExtension(Rr);if(!Sr){console.error("!"+Rr)}}}up=mp.getParameter(34047);bp.Ctx=mp;return 0},DestroyContext:function(){console.error("!DestroyContext")},GetTextureByHandle:function(gs){return rp[gs]},RegisterTexture:function(hs){return wp(hs)},BindViewport:function(is,js,ks){var ls=is&&is.width||js;var ms=is&&is.height||ks;if(ls!=np[2]||ms!=np[3]){mp.viewport(0,0,ls,ms);np[2]=ls;np[3]=ms}},BindDepth:function(ns){if(ns){var os=ns.Write;var ps=mp[ns.Func];if(1!=op[0]){mp.enable(mp.DEPTH_TEST);op[0]=1}if(os!=op[1]){mp.depthMask(os);op[1]=os}if(ps!=op[2]){mp.depthFunc(ps);op[2]=ps}}else{if(0!=op[0]){mp.disable(mp.DEPTH_TEST);op[0]=0}}},BindBlend:function(qs,rs){if(qs){var ss=mp[qs.ColorFunc];var ts=mp[qs.AlphaFunc];var us=mp[qs.ColorSrc];var vs=mp[qs.ColorDest];var ws=mp[qs.AlphaSrc];var xs=mp[qs.AlphaDest];if(1!=pp[0]){mp.enable(mp.BLEND);pp[0]=1;rs(1)}mp.blendEquationSeparate(ss,ts);pp[1]=ss;pp[2]=ts;mp.blendFuncSeparate(us,vs,ws,xs);pp[3]=us;pp[4]=vs;pp[5]=ws;pp[6]=xs}else{if(0!=pp[0]){mp.disable(mp.BLEND);pp[0]=0;rs(0)}}},BindStencil:function(ys){if(ys){var zs=mp[ys.Func];var As=ys.Value;var Bs=ys.Mask;var Cs=mp[ys.Faild];var Ds=mp[ys.ZFaild];var Es=mp[ys.Pass];if(1!=qp[0]){mp.enable(mp.STENCIL_TEST);qp[0]=1}if(zs!=qp[1]||As!=qp[2]||Bs!=qp[3]){mp.stencilFunc(zs,As,Bs);qp[1]=zs;qp[2]=As;qp[3]=Bs}if(Cs!=qp[4]||Ds!=qp[5]||Es!=qp[6]){mp.stencilOp(Cs,Ds,Es);qp[4]=Cs;qp[5]=Ds;qp[6]=Es}}else{if(0!=qp[0]){mp.disable(mp.STENCIL_TEST);qp[0]=0}}}}}();Vo["WASM"]=Vo["WASM"]||{};Vo["WASM"]["LoadEngine"]=Yo;$o["_name"]="Start";_o["_name"]="Stop";return[bp,$o,_o]});MiaokitMerge(function(Fs){var Gs=Date.now();function Hs(){return Date.now()-Gs}function Is(Ls,Ms){if(Ms===void 0){Ms=0}if(2===Ms){console.warn("Track:",Hs(),Ls)}else if(2<Ms){console.error("Track:",Hs(),Ls)}else{console.info("Track:",Hs(),Ls)}}function Js(Ns,Os,Ps){if(Ps===void 0){Ps=undefined}var Qs=new XMLHttpRequest;Qs.open("GET",Ns,true);Qs.responseType="arraybuffer";Qs.onprogress=function(Rs){if(0<Rs.total&&Ps){Ps(Rs.loaded/Rs.total)}};Qs.onload=function(Ss){if(Qs.status==200){Os(Qs.response)}else{Os(null)}};Qs.onerror=function(Ts){Is(Ts,2);Os(null)};Qs.send(null)}function Ks(Us,Vs,Ws,Xs,Ys,Zs){var $s=new XMLHttpRequest;$s.onprogress=function(_s){if(0<_s.total&&Ys){Ys(_s.loaded/_s.total)}};$s.onload=function(at){if($s.status==200){Zs($s.response)}else{Zs(null)}$s=null};$s.onerror=function(bt){Is(bt,2);Zs(null)};$s.responseType=Vs;$s.open(Us,Ws,true);$s.send(Xs)}Hs["_name"]="Time";Is["_name"]="Track";Js["_name"]="Fetch";Ks["_name"]="Request";return[Hs,Is,Js,Ks]});MiaokitMerge(function(ct){if("Unity"!==ct["m_pConfig"]["ENGINE"]){return[]}if(!UnityLoader){return[]}var dt=ct["m_pLogo"]||"data:image/png;base64,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";UnityLoader.Progress.Styles.Dark.progressLogoUrl=dt;UnityLoader.Progress.Styles.Light.progressLogoUrl=dt;if(UnityLoader.SystemInfo.mobile){UnityLoader.SystemInfo.mobile=false;UnityLoader.downloadJob=function(lt,mt){var nt=new XMLHttpRequest;nt.open("GET",mt.parameters.url);nt.responseType="arraybuffer";nt.onload=function(){UnityLoader.Compression.decompress(new Uint8Array(nt.response),function(ot){mt.complete(ot)})};if(mt.parameters.onprogress)nt.addEventListener("progress",mt.parameters.onprogress);if(mt.parameters.onload)nt.addEventListener("load",mt.parameters.onload);nt.send()}}UnityLoader.processWasmFrameworkJob=function(pt,qt){var rt=UnityLoader.Job.result(pt,"downloadWasmFramework");UnityLoader.loadCode(pt,rt,function(st,tt){pt["mainScriptUrlOrBlob"]=tt;if(pt.isModularized){UnityLoader[st]=UnityModule}pt["instantiateWasm"]=function(ut,vt){ht(pt,ut["env"]);if(pt["wasmBinary"]){WebAssembly.instantiate(pt["wasmBinary"],ut).then(function(wt){vt(wt.instance,wt.module)})}else{console.info("MiaokitLoader.InitUnity.instantiateWasm error!")}return{}};UnityLoader[st](pt);qt.complete()},{Module:pt,url:pt["wasmFrameworkUrl"],isModularized:pt.isModularized})};var et=null;var ft=null;var gt={};function ht(xt,yt){Object["assign"](yt,{_Init:function(zt,At){ct["WASM"]["m_pMemory"]=ct["WASM"]["m_pMemory"]||ft.Module.wasmMemory;it(xt,gt,zt,At);jt(ft,gt);et.OnEngineLoad(gt)},_RenderingEvent:function(Bt){et.OnRenderingEvent(Bt)}});ct["GL"]=yt}function it(Ct,Dt,Et,Ft){var Gt=ct.WASM.GetString(Et,Ft);var Ht=JSON.parse(Gt);var It=function(Mt){var Nt=function(){var Ot=Array.prototype.slice.call(arguments);Ot.unshift(Nt["m_nAddr"]);return Nt["m_pFunc"].apply(this,Ot)};Nt["m_pFunc"]=Ct[Mt.Call];Nt["m_nAddr"]=Mt.Addr;Dt[Mt.Name]=Nt};for(var Jt=0,Kt=Ht.List;Jt<Kt.length;Jt++){var Lt=Kt[Jt];It(Lt)}}function jt(Pt,Qt){Qt["APP_PLUGIN_TYPE"]=function(){return 1};Qt["APP_MEM_TYPE"]=function(){return 1};Qt["memory"]=function(Rt){var St=32*1024*1024;var Tt=Rt._memalign(16,St);var Ut=St-Tt;Rt._free(Tt);var Vt=Rt._memalign(16,Ut+St);if(Vt!==Tt){console.error("miaokit.prememory: addr error",Tt,Vt);return}if(Vt+Ut+St!==67108864){console.error("miaokit.prememory: addr end error",Vt+Ut+St);return}Qt["APP_MEM_RESERVE"]=function(){return Vt};return Rt.wasmMemory}(ft.Module);Qt["APP_MEM_MALLOC"]=function(Wt){return ft.Module._memalign(16,Wt)};Qt["APP_MEM_FREE"]=function(Xt){ft.Module._free(Xt)};Qt["APP_MEM_BASE"]=function(){alert("UNITY��չ��֧��ʹ�������ڴ�!");return 0};Qt["APP_MEM_GROW"]=function(Yt){alert("UNITY��չ��֧��ʹ�������ڴ�!");return 0};Qt["APP_MEM_RECYCLE"]=function(Zt){alert("UNITY��չ��֧��ʹ�������ڴ�!");return 0}}function kt($t){et=$t;ft=UnityLoader.instantiate("unityContainer",ct["m_pConfig"]["UNITY"])}ct["WASM"]=ct["WASM"]||{};ct["WASM"]["LoadEngine"]=kt;return[]});MiaokitMerge(function(_t){var au=undefined;var bu=new TextDecoder("utf-8");var cu=new TextEncoder;function du(eu){if(!au||_t["WASM"].m_pMemory.buffer.byteLength!==au[0].byteLength){if(!au){au=[]}au[0]=new Int8Array(_t["WASM"].m_pMemory.buffer);au[1]=new Uint8Array(_t["WASM"].m_pMemory.buffer);au[2]=new Int16Array(_t["WASM"].m_pMemory.buffer);au[3]=new Uint16Array(_t["WASM"].m_pMemory.buffer);au[4]=new Int32Array(_t["WASM"].m_pMemory.buffer);au[5]=new Uint32Array(_t["WASM"].m_pMemory.buffer);au[6]=new Float32Array(_t["WASM"].m_pMemory.buffer);au[7]=new Float64Array(_t["WASM"].m_pMemory.buffer)}return au[eu]}_t["WASM"]=_t["WASM"]||{};_t["WASM"]["HEAP8"]=function(fu,gu){if(fu===void 0){fu=0}if(gu===void 0){gu=0}var hu=du(0);if(fu&&gu){return hu.subarray(fu,fu+gu)}else{return hu}};_t["WASM"]["HEAPU8"]=function(iu,ju){if(iu===void 0){iu=0}if(ju===void 0){ju=0}var ku=du(1);if(iu&&ju){return ku.subarray(iu,iu+ju)}else{return ku}};_t["WASM"]["HEAP16"]=function(lu,mu){if(lu===void 0){lu=0}if(mu===void 0){mu=0}var nu=du(2);if(lu&&mu){return nu.subarray(lu/2,(lu+mu)/2)}else{return nu}};_t["WASM"]["HEAPU16"]=function(ou,pu){if(ou===void 0){ou=0}if(pu===void 0){pu=0}var qu=du(3);if(ou&&pu){return qu.subarray(ou/2,(ou+pu)/2)}else{return qu}};_t["WASM"]["HEAP32"]=function(ru,su,tu){if(ru===void 0){ru=0}if(su===void 0){su=0}var uu=du(4);if(ru&&su){if(tu){return uu.slice(ru/4,(ru+su)/4)}else{return uu.subarray(ru/4,(ru+su)/4)}}else{return uu}};_t["WASM"]["HEAPU32"]=function(vu,wu){if(vu===void 0){vu=0}if(wu===void 0){wu=0}var xu=du(5);if(vu&&wu){return xu.subarray(vu/4,(vu+wu)/4)}else{return xu}};_t["WASM"]["HEAPF32"]=function(yu,zu,Au){if(yu===void 0){yu=0}if(zu===void 0){zu=0}var Bu=du(6);if(yu&&zu){if(Au){return Bu.slice(yu/4,(yu+zu)/4)}else{return Bu.subarray(yu/4,(yu+zu)/4)}}else{return Bu}};_t["WASM"]["HEAPF64"]=function(Cu,Du){if(Cu===void 0){Cu=0}if(Du===void 0){Du=0}var Eu=du(7);if(Cu&&Du){return Eu.subarray(Cu/8,(Cu+Du)/8)}else{return Eu}};_t["WASM"]["GetString"]=function(Fu,Gu){if(!Gu){var Hu=_t["WASM"].HEAPU8();var Iu=Fu;while(0!==Hu[Iu++]);Gu=Iu-Fu-1}var Ju=_t["WASM"].HEAPU8(Fu,Gu);var Ku=bu.decode(Ju);return Ku};_t["WASM"]["SetString"]=function(Lu,Mu){var Nu=cu.encode(Mu);var Ou=_t["WASM"].HEAPU8(Lu,Nu.byteLength);Ou.set(Nu)};_t["WASM"]["EncodeString"]=function(Pu){return cu.encode(Pu)};_t["WASM"]["m_pMemory"]=null;return[]});