var MiaokitModule=function(a,b){var c=this;c["m_pConfigPath"]=b;c["m_pConfig"]={ENGINE:a};c["Merge"](c);c["Preload"]()};var MiaokitMerge=function(d){var e=[];d["Merge"]=d["Merge"]||function(f){for(var g=0,h=e;g<h.length;g++){var i=h[g];var j=i(f);if(j){for(var k=0,l=j;k<l.length;k++){var m=l[k];f[m._name]=m}}}};return function(n){e.push(n)}}(MiaokitModule.prototype);MiaokitMerge(function(o){var p=undefined;var q=undefined;var r={};var s=function(u,v){if(v===void 0){v=undefined}var w=0;this.length=u(-1);this[Symbol.iterator]=function(){return{next:function(){var x=u(w);if(x){var y=p(x);w=v?w+1:y.m_nObject;return{value:y,done:false}}return{value:undefined,done:true}}}}};r["Transform"]=function(z){Object.defineProperty(z,"position",{get:function(){var A=this["_GetPosition"]()/4;var B=o["WASM"].HEAPF32();return{x:B[A],y:B[A+1],z:B[A+2]}},set:function(C){this["_SetPosition"](C.x,C.y,C.z)}});Object.defineProperty(z,"euler",{get:function(){var D=this["_GetEuler"]()/4;var E=o["WASM"].HEAPF32();return{x:E[D],y:E[D+1],z:E[D+2]}},set:function(F){this["_SetEuler"](F.x,F.y,F.z)}});Object.defineProperty(z,"rotation",{get:function(){var G=this["_GetRotation"]()/4;var H=o["WASM"].HEAPF32();return{x:H[G],y:H[G+1],z:H[G+2],w:H[G+3]}},set:function(I){this["_SetRotation"](I.x,I.y,I.z,I.w)}});Object.defineProperty(z,"scale",{get:function(){var J=this["_GetScale"]()/4;var K=o["WASM"].HEAPF32();return{x:K[J],y:K[J+1],z:K[J+2]}},set:function(L){this["_SetScale"](L.x,L.y,L.z)}});Object.defineProperty(z,"localPosition",{get:function(){var M=this["_GetLocalPosition"]()/4;var N=o["WASM"].HEAPF32();return{x:N[M],y:N[M+1],z:N[M+2]}},set:function(O){this["_SetLocalPosition"](O.x,O.y,O.z)}});Object.defineProperty(z,"localEuler",{get:function(){var P=this["_GetLocalEuler"]()/4;var Q=o["WASM"].HEAPF32();return{x:Q[P],y:Q[P+1],z:Q[P+2]}},set:function(R){this["_SetLocalEuler"](R.x,R.y,R.z)}});Object.defineProperty(z,"localRotation",{get:function(){var S=this["_GetLocalRotation"]()/4;var T=o["WASM"].HEAPF32();return{x:T[S],y:T[S+1],z:T[S+2],w:T[S+3]}},set:function(U){this["_SetLocalRotation"](U.x,U.y,U.z,U.w)}});Object.defineProperty(z,"localScale",{get:function(){var V=this["_GetLocalScale"]()/4;var W=o["WASM"].HEAPF32();return{x:W[V],y:W[V+1],z:W[V+2]}},set:function(X){this["_SetLocalScale"](X.x,X.y,X.z)}});Object.defineProperty(z,"right",{get:function(){var Y=this["_GetRight"]()/4;var Z=o["WASM"].HEAPF32();return{x:Z[Y],y:Z[Y+1],z:Z[Y+2]}},set:function($){this["_SetRight"]($.x,$.y,$.z)}});Object.defineProperty(z,"up",{get:function(){var _=this["_GetUp"]()/4;var aa=o["WASM"].HEAPF32();return{x:aa[_],y:aa[_+1],z:aa[_+2]}},set:function(){var ba=this["_SetUp"]()/4;var ca=o["WASM"].HEAPF32();return{x:ca[ba],y:ca[ba+1],z:ca[ba+2]}}});Object.defineProperty(z,"forward",{get:function(){var da=this["_GetForward"]()/4;var ea=o["WASM"].HEAPF32();return{x:ea[da],y:ea[da+1],z:ea[da+2]}},set:function(){var fa=this["_SetForward"]()/4;var ga=o["WASM"].HEAPF32();return{x:ga[fa],y:ga[fa+1],z:ga[fa+2]}}});Object.defineProperty(z,"regionPosition",{get:function(){var ha=this["_GisToWorld"]()/4;var ia=o["WASM"].HEAPF32();return{x:ia[ha],y:ia[ha+1],z:ia[ha+2]}}});z["Rotate"]=function(ja,ka){this["_Rotate"](ja.x,ja.y,ja.z,ka)};z["Rotate2"]=function(la,ma,na){this["_Rotate2"](la.x,la.y,la.z,ma,na)};z["Translate"]=function(oa,pa){this["_Translate"](oa.x,oa.y,oa.z,pa)};z["TransformPoint"]=function(qa){var ra=this["_TransformPoint"](qa.x,qa.y,qa.z)/4;var sa=o["WASM"].HEAPF32();return{x:sa[ra],y:sa[ra+1],z:sa[ra+2]}}};r["GameObject"]=function(ta){Object.defineProperty(ta,"name",{get:function(){if(!this._name){var ua=this._GetName(0);var va=this._GetName(1);this._name=o["WASM"].GetString(va,ua)}return this._name}});Object.defineProperty(ta,"transform",{get:function(){return p(this["_GetTransform"]())}});Object.defineProperty(ta,"mesh",{get:function(){return p(this["_GetMesh"]())},set:function(wa){this["_SetMesh"](wa.m_nObject)}});Object.defineProperty(ta,"children",{get:function(){var xa=this;return new s(function(ya){return xa._IterChild(ya)},true)}});Object.defineProperty(ta,"parent",{get:function(){return p(this["_GetParent"]())}});Object.defineProperty(ta,"data",{get:function(){return p(this["_GetUserData"]())},set:function(za){}});Object.defineProperty(ta,"enableCollider",{set:function(Aa){this["_EnableCollider"](Aa)}});Object.defineProperty(ta,"active",{set:function(Ba){this["_Active"](Ba)}});Object.defineProperty(ta,"highlight",{set:function(Ca){this["_Highlight"](Ca)}});Object.defineProperty(ta,"transparent",{set:function(Da){console.warn("transparent discard!")}});Object.defineProperty(ta,"opacity",{set:function(Ea){this["_Transparent"](Ea)}});ta["Destory"]=function(){this["_Destory"]()};o["GameObject"]=function(){return p(ta._GameObject())}};r["Miaokit"]=function(Fa){Fa["LoadTile"]=function(Ga){var Ha=this["_Malloc"](Ga.byteLength);if(Ha){o["WASM"]["HEAPU8"](Ha,Ga.byteLength).set(new Uint8Array(Ga));var Ia=this["_LoadTile"](Ha,Ga.byteLength);var Ja=p(Ia);return Ja}return null};Fa["Analyze"]=function(Ka){var La=this["_Analyze"]();var Ma=o["WASM"].HEAP32()[La/4];var Na=o["WASM"].GetString(La+4,Ma);try{var Oa=JSON.parse(Na);var Pa=q(Ka).concat(Oa);return Pa}catch(Qa){console.log(Na)}return null};Fa["PickEntity"]=function(Ra){return p(this["_PickEntity"](Ra))};Fa["GetScene"]=function(Sa){return p(this["_GetScene"](Sa))};Fa["WorldToScreenPoint"]=function(Ta){var Ua=this["_WorldToScreenPoint"](Ta.x,Ta.y,Ta.z)/4;var Va=o["WASM"].HEAPF32();return{x:Va[Ua],y:Va[Ua+1],z:Va[Ua+2]}};Fa["ScreenPointToRay"]=function(Wa){var Xa=this["_ScreenPointToRay"](Wa.x,Wa.y,Wa.z)/4;var Ya=o["WASM"].HEAPF32();return{m_mOrigin:{x:Ya[Xa],y:Ya[Xa+1],z:Ya[Xa+2]},m_mDirection:{x:Ya[Xa+4],y:Ya[Xa+5],z:Ya[Xa+6]}}};Object.defineProperty(Fa,"camera",{get:function(){return p(this["_GetCamera"]())}});Object.defineProperty(Fa,"cameraMode",{set:function(Za){this["_SetCameraMode"](Za)}});Object.defineProperty(Fa,"gis",{get:function(){if(!this._gis){this._gis=r["Gis"]["g_pIns"]}return this._gis}});Object.defineProperty(Fa,"progress",{get:function(){return this["_GetProgress"]()}})};r["Mesh"]=function($a){$a["SetVertices"]=function(_a,ab){this["m_aVertex"]=this["m_aVertex"]||[];this["m_aVertex"].push({m_pArray:ab,m_nSlot:this["_SlotLut"][_a],m_nItemSize:this["_SizeLut"][_a]})};$a["SetIndices"]=function(bb,cb,db){this["m_aIndex"]=this["m_aIndex"]||[];this["m_aIndex"][bb]={m_pArray:cb,m_nItemSize:db}};$a["Apply"]=function(){var eb=this["m_aVertex"];var fb=this["m_aIndex"];if(!eb||!fb){return}var gb=2+2*eb.length+3*fb.length;var hb=this._CreateBuffer(gb);var ib=o["WASM"]["HEAP32"](hb,gb*4);var jb=0;ib[jb++]=eb.length;ib[jb++]=fb.length;for(var kb=0;kb<eb.length;kb++){ib[jb++]=eb[kb].m_nSlot;ib[jb++]=eb[kb].m_pArray.length/eb[kb].m_nItemSize}for(var kb=0;kb<fb.length;kb++){ib[jb++]=0;ib[jb++]=0;ib[jb++]=fb[kb].m_pArray.length}this._CreateBuffer(0);for(var kb=0;kb<eb.length;kb++){var lb=eb[kb].m_pArray;var mb=this._GetVertexBuffer(kb);var nb=o["WASM"]["HEAPF32"](mb,lb.length*4);nb.set(lb)}for(var kb=0;kb<fb.length;kb++){var lb=fb[kb].m_pArray;var mb=this._GetIndexBuffer(kb);var nb=o["WASM"]["HEAP32"](mb,lb.length*4);nb.set(lb)}this._Apply();this["m_aVertex"]=undefined;this["m_aIndex"]=undefined};$a["_SlotLut"]={position:0,normal:1,uv:2,color:3,tangent:4,uv2:9,uv3:10,uv4:11,uv5:12,uv6:13,uv7:14,uv8:15};$a["_SizeLut"]={position:3,normal:3,uv:2,color:4,tangent:4,uv2:2,uv3:2,uv4:2,uv5:2,uv6:2,uv7:2,uv8:2};Object.defineProperty($a,"position",{set:function(ob){this.SetVertices("position",ob)}});Object.defineProperty($a,"normal",{set:function(pb){this.SetVertices("normal",pb)}});Object.defineProperty($a,"uv",{set:function(qb){this.SetVertices("uv",qb)}});Object.defineProperty($a,"triangles",{set:function(rb){this.SetIndices(0,rb)}});Object.defineProperty($a,"material",{set:function(sb){this.SetMaterial(0,sb)}});o["Mesh"]=function(){return p($a._Mesh())}};r["Texture2D"]=function(tb){tb["SetImageData"]=function(ub){var vb=this._CreateBuffer(ub.byteLength);if(vb){o["WASM"]["HEAPU8"](vb,ub.byteLength).set(new Uint8Array(ub));this._Apply()}};tb["Load"]=function(wb){var xb=this;o["Fetch"](wb,function(yb){if(yb){xb.SetImageData(yb)}})};o["Texture2D"]=function(zb){var Ab=p(tb._Texture2D());if(zb){if("string"===typeof zb){this.Load(zb)}else{this.SetImageData(zb)}}return Ab}};r["Material"]=function(Bb){if("Sisyphus"===o["m_pConfig"]["ENGINE"]){o["ShaderLab"].ExpandMaterial(Bb)}Bb["GetTexture"]=function(){return p(this["_GetTexture"]())};Bb["SetTexture"]=function(Cb){this["_SetTexture"](Cb.m_nObject)};o["Material"]=function(Db){if(Db===void 0){Db=undefined}var Eb=null;if(Db){var Fb=o["ShaderLab"]["Pipeline"]["InternalShader"];var Gb=Fb[0];Fb[0]=Db;Eb=p(Bb._Material());Fb[0]=Gb}else{Eb=p(Bb._Material())}return Eb}};r["Tile"]=function(Hb){Object.defineProperty(Hb,"scenes",{get:function(){var Ib=this;return new s(function(Jb){return Ib._IterWork(Jb)})}});Object.defineProperty(Hb,"object3D",{get:function(){if(undefined===this._object3D){var Kb=this._GetObject(this.m_nObject);if(0===Kb){this._object3D=null;return null}this._object3D=p(Kb)}return this._object3D}})};r["Scene"]=function(Lb){Lb["GetLayer"]=function(Mb){return p(this["_GetLayer"](Mb))};Object.defineProperty(Lb,"id",{get:function(){if(!this._id){var Nb=this._GetID(0);var Ob=this._GetID(1);this._id=o["WASM"].GetString(Ob,Nb)}return this._id}});Object.defineProperty(Lb,"layers",{get:function(){var Pb=this;return new s(function(Qb){return Pb._IterLayer(Qb)})}});Object.defineProperty(Lb,"object3D",{get:function(){if(undefined===this._object3D){var Rb=this._GetObject(this.m_nObject);if(0===Rb){this._object3D=null;return null}this._object3D=p(Rb)}return this._object3D}});Object.defineProperty(Lb,"viewState",{get:function(){return{m_mTarget:{x:0,y:0,z:0},m_nPitch:45,m_nYaw:0,m_nDistance:60,m_mOrthoTarget:{x:0,y:0,z:0},m_nOrthoScaled:0,m_nOrthoRotate:0}}});Object.defineProperty(Lb,"binding",{get:function(){return p(this._GetBinding())}})};r["Layer"]=function(Sb){Object.defineProperty(Sb,"id",{get:function(){if(!this._id){var Tb=this._GetID(0);var Ub=this._GetID(1);this._id=o["WASM"].GetString(Ub,Tb)}return this._id}});Object.defineProperty(Sb,"sites",{get:function(){var Vb=this;return new s(function(Wb){return Vb._IterSite(Wb)})}});Object.defineProperty(Sb,"object3D",{get:function(){if(undefined===this._object3D){var Xb=this._GetObject(this.m_nObject);if(0===Xb){this._object3D=null;return null}this._object3D=p(Xb)}return this._object3D}});Object.defineProperty(Sb,"viewState",{get:function(){var Yb=this["_GetViewState"]();if(0<Yb){var Zb=o["WASM"]["HEAPF32"](Yb,4*11);var $b=0;return{m_mTarget:{x:Zb[$b++],y:Zb[$b++],z:Zb[$b++]},m_nPitch:Zb[$b++],m_nYaw:Zb[$b++],m_nDistance:Zb[$b++],m_mOrthoTarget:{x:Zb[$b++],y:Zb[$b++],z:Zb[$b++]},m_nOrthoScaled:Zb[$b++],m_nOrthoRotate:Zb[$b++]}}return null}})};r["Attachment"]=function(_b){Object.defineProperty(_b,"entityType",{get:function(){return this._GetEntityType()}});Object.defineProperty(_b,"secondType",{get:function(){return this._GetSecondType()}});Object.defineProperty(_b,"flag",{get:function(){return this._GetFlag()}});Object.defineProperty(_b,"object3D",{get:function(){return p(this._GetObject())}});Object.defineProperty(_b,"viewState",{get:function(){var ac=this["_GetViewState"]();if(0<ac){var bc=o["WASM"]["HEAPF32"](ac,4*11);var cc=0;var dc={m_mTarget:{x:bc[cc++],y:bc[cc++],z:bc[cc++]},m_nPitch:bc[cc++],m_nYaw:bc[cc++],m_nDistance:bc[cc++],m_mOrthoTarget:{x:bc[cc++],y:bc[cc++],z:bc[cc++]},m_nOrthoScaled:bc[cc++],m_nOrthoRotate:bc[cc++]};console.log("attachment view:",dc);return dc}else{console.log("attachment view: null")}return null}})};r["Site"]=function(ec){Object.defineProperty(ec,"id",{get:function(){if(!this._id){var fc=this._GetID(0);var gc=this._GetID(1);this._id=o["WASM"].GetString(gc,fc)}return this._id}});Object.defineProperty(ec,"layer",{get:function(){return p(this["_Layer"]())}});Object.defineProperty(ec,"scene",{get:function(){return p(this["_Scene"]())}});Object.defineProperty(ec,"type",{get:function(){return this["_Type"]()}});Object.defineProperty(ec,"number",{get:function(){return this["_Number"]()}});Object.defineProperty(ec,"position",{get:function(){var hc=this["_Position"]()/4;var ic=o["WASM"].HEAPF32();return{x:ic[hc],y:ic[hc+1],z:ic[hc+2]}}})};r["Prefab"]=function(jc){jc["Instantiate"]=function(){return p(this["_Instantiate"]())};o["LoadPrefab"]=function(kc,lc){o["Fetch"](kc,function(mc){var nc=null;if(mc){var oc=jc._Prefab();var pc=p(oc);var qc=pc.CreateBuffer(mc.byteLength);if(qc){o["WASM"]["HEAPU8"](qc,mc.byteLength).set(new Uint8Array(mc));pc.Apply();nc=pc}}lc(nc)})}};r["Gis"]=function(rc){rc["Update"]=function(sc,tc,uc){return this["_Update"](sc,tc,uc)};rc["AddSvetile"]=function(vc){var wc=o["WASM"]["EncodeString"](vc.m_pUrl);var xc=this["_CreateSvetileDesc"](wc.byteLength);var yc=o["WASM"]["HEAPU32"](xc,4*8);yc[0]=vc.m_nID;yc[1]=vc.m_nFlags;o["WASM"]["HEAPU8"](yc[2],wc.byteLength).set(wc,0);yc[3]=0;yc[4]=o["WASM"]["RegisterDelegate"](function(Ac,Bc){vc.OnActive(p(Ac),0<Bc)});var zc=o["WASM"]["HEAPF32"](xc+20,16);zc[0]=vc.m_mLngLat.x;zc[1]=vc.m_mLngLat.y;zc[2]=vc.m_mSize.x;zc[3]=vc.m_mSize.y;this["_AddSvetile"](xc)};rc["AddMapbox"]=function(Cc){var Dc=this["_GetMapboxDesc"]();var Ec=o["WASM"]["HEAPF32"](Dc,40);Ec[0]=Cc.m_mOffset.x;Ec[1]=Cc.m_mOffset.y;Ec[2]=Cc.m_mOffset.z;Ec[3]=Cc.m_mScale.x;Ec[4]=Cc.m_mScale.y;Ec[5]=Cc.m_mScale.z;Ec[6]=Cc.m_mLngLat.x;Ec[7]=Cc.m_mLngLat.y;Ec[8]=Cc.m_mSize.x;Ec[9]=Cc.m_mSize.y;this["_AddMapbox"](Dc)};rc["AddGameObject"]=function(Fc,Gc,Hc,Ic){this["_AddGameObject"](Fc.m_nObject,Gc,Hc,Ic)};Object.defineProperty(rc,"imageServer",{set:function(Jc){if(!Jc){Jc="http://t%d.tianditu.gov.cn/DataServer?T=vec_c&tk=fb14b0853d59b619e18c259898bd0d4d&x=%d&y=%d&l=%d"}var Kc=this["_GetServer"](1);o["WASM"].SetString(Kc,Jc)}});Object.defineProperty(rc,"terrainServer",{set:function(Lc){if(!Lc){Lc="https://t%d.tianditu.gov.cn/dem_sjk/DataServer?T=ele_c&tk=fb14b0853d59b619e18c259898bd0d4d&x=%d&y=%d&l=%d"}var Mc=this["_GetServer"](0);o["WASM"].SetString(Mc,Lc)}})};r["Dioramas3MX"]=function(Nc){Nc["_Load3MX"]=function(Oc,Pc,Qc){var Rc=this;var Sc=Rc.m_pFileLut[Oc];var Tc=Sc.m_pPath+Sc.m_aFile[Pc];o["Request"]("GET","arraybuffer",Tc,null,null,function(Uc){if(!Uc){return}var Vc=new Uint32Array(Uc,0,2);if(1113083187===Vc[0]){var Wc=Vc[1]>>8;var Xc=9+Wc;var Yc=Uc.byteLength-Xc;var Zc=new Uint8Array(Uc,9,Wc);var $c=Rc.m_pTextDecoder.decode(Zc);var _c=JSON.parse($c);var ad={m_pPath:Tc.substring(0,Tc.lastIndexOf("/")+1),m_aFile:[]};var bd=[];var cd=[];var dd=_c.resources;var ed=0;for(var fd=0;fd<dd.length;fd++){bd.push(fd);if("textureBuffer"===dd[fd].type){bd.push(0);cd.push(fd);if("jpg"===dd[fd].format){bd.push(0)}else if("png"===dd[fd].format){bd.push(1)}else{bd.push(1e4)}}else if("geometryBuffer"===dd[fd].type){bd.push(1);if("ctm"===dd[fd].format){bd.push(0)}else{bd.push(1e4)}}else{bd.push(1e4);bd.push(1e4)}bd.push(dd[fd].size);bd.push(ed);ed+=dd[fd].size;bd.push(1e4);if(dd[fd].texture){for(var gd=0;gd<dd.length;gd++){if(dd[fd].texture===dd[gd].id){bd[bd.length-1]=gd;break}}}}var hd=[];var id=_c.nodes;for(var fd=0;fd<id.length;fd++){var jd=id[fd];var kd=jd.bbMax[0]-jd.bbMin[0];var ld=jd.bbMax[1]-jd.bbMin[1];var md=jd.bbMax[2]-jd.bbMin[2];var nd=Math.sqrt(kd*kd+ld*ld+md*md);hd.push(Math.floor(parseInt(jd.bbMin[0]+jd.bbMax[0])*.5*100));hd.push(Math.floor(parseInt(jd.bbMin[1]+jd.bbMax[1])*.5*100));hd.push(Math.floor(parseInt(jd.bbMin[2]+jd.bbMax[2])*.5*100));hd.push(Math.floor(nd*100));hd.push(Math.floor(jd.maxScreenDiameter));var od=jd.children?jd.children.length:0;if(0<od){hd.push(ad.m_aFile.length);for(var gd=0;gd<od;gd++){ad.m_aFile.push(jd.children[gd])}hd.push(ad.m_aFile.length)}else{hd.push(-1);hd.push(-1)}var pd=jd.resources?jd.resources.length:0;if(0<pd){hd.push(cd.length);for(var gd=0;gd<pd;gd++){for(var qd=0;qd<dd.length;qd++){if(jd.resources[gd]===dd[qd].id){cd.push(qd);break}}}hd.push(cd.length)}else{hd.push(-1);hd.push(-1)}}var rd=4+9*id.length+6*cd.length;var sd=4*rd;var td=sd+Yc;var ud=Rc["_CreateBuffer"](td);if(ud){var vd=o["WASM"]["HEAP32"](ud,sd);vd[0]=sd;vd[1]=id.length;vd[2]=cd.length;vd[3]=Rc.m_pFileLut.length;vd.set(hd,4);var wd=4+hd.length;for(var fd=0;fd<cd.length;fd++){var xd=6*cd[fd];for(var gd=0;gd<6;gd++){vd[wd++]=bd[xd++]}}var yd=o["WASM"]["HEAPU8"](ud+sd,Yc);yd.set(new Uint8Array(Uc,Xc,Yc));Rc["_Dispose"](Qc)}Rc.m_pFileLut.push(ad)}})};Nc["Update"]=function(){return this["_Update"]()};Object.defineProperty(Nc,"object3D",{get:function(){return p(this["_GetObject"]())}});o["Dioramas3MX"]=function(zd,Ad){var Bd=p(Nc._Dioramas3MX());Bd.m_pFileLut=[];Bd.m_pTextDecoder=new TextDecoder("utf-8");if(Ad){if(Ad.m_pGis){Ad.m_pGis.AddGameObject(Bd.object3D,Ad.m_mLngLat.x,Ad.m_mLngLat.y,Ad.m_nHeight);Bd.object3D.transform.Translate(Ad.m_mOffset,1);Bd.object3D.transform.Rotate({x:0,y:0,z:0},1)}}o["Request"]("GET","json",zd,null,null,function(Cd){Bd["m_pMeta"]=Cd;var Dd={m_pPath:zd.substring(0,zd.lastIndexOf("/")+1),m_aFile:[]};var Ed=[0];for(var Fd=0;Fd<Cd.layers.length;Fd++){if("meshPyramid"===Cd.layers[Fd].type){Ed.push(Fd);Ed.push(Dd.m_aFile.length);Dd.m_aFile.push(Cd.layers[Fd].root)}}Ed[0]=Dd.m_aFile.length;var Gd=Bd["_CreateBuffer"](4*Ed.length);var Hd=o["WASM"]["HEAP32"](Gd,4*Ed.length);Hd.set(Ed);Bd["_Initialize"](Gd);Bd.m_pFileLut.push(Dd)});return Bd}};function t(Id,Jd,Kd){p=Jd;q=Kd;for(var Ld=0,Md=Id;Ld<Md.length;Ld++){var Nd=Md[Ld];if(Nd){var Od=Nd.prototype;if(r[Od._type_name]){r[Od._type_name](Od)}if("Miaokit"===Od._type_name){o["Miaokit"]=new Nd(0,0)}else if("Gis"===Od._type_name){r["Gis"]["g_pIns"]=new Nd(0,0)}}}}o["WASM"]=o["WASM"]||{};o["WASM"]["LoadClass"]=t;return[]});MiaokitMerge(function(Pd){Pd["m_pLogo"]=null;var Qd=undefined;var Rd=false;var Sd=false;function Td(){Pd["Track"]("Preload");Pd["Request"]("GET","json",Pd["m_pConfigPath"],null,null,function(Wd){if(!Wd){Pd["Track"]("配置文件错误！",3);return}Pd["m_pConfig"]=Wd;Pd["Fetch"](Wd.MODULE,function(Zd){if(Qd){Qd(Zd)}else{Qd=Zd}});if(Wd.SVE){var Xd=function($d){var _d=Wd.SVE[$d];_d.m_pData=null;_d.m_pTile=null;if(true===_d.m_bPreload){Pd["Fetch"](_d.m_pProject,function(ae){_d.m_pData=ae;if(Sd&&ae){_d.m_pTile=Pd["Miaokit"]["LoadTile"](_d.m_pData);_d.m_pData=null;Pd["App"]["ActiveTile"](_d)}})}};for(var Yd=0;Yd<Wd.SVE.length;Yd++){Xd(Yd)}}if(Pd["App"]&&Pd["App"].m_pProject){Pd["App"]["Preload"]()}else{Rd=true}})}function Ud(be,ce){Pd["Track"]("LoadEngine");if(Rd){Pd["App"]["Preload"]();Rd=false}Pd["WASM"]["LoadEngine"]({OnEngineLoad:function(de){Pd["Track"]("LoadEngine End");if(Qd){Pd["Track"]("LoadMiaokit");Pd["WASM"]["LoadMiaokit"](Qd,de,function(){be();Sd=true;Vd()})}else{Pd["Track"]("LoadMiaokit Delay");Qd=function(ee){Pd["Track"]("LoadMiaokit");Pd["WASM"]["LoadMiaokit"](ee,de,function(){be();Sd=true;Vd()})}}},OnRenderingEvent:function(fe){if(Sd){ce(fe)}}})}function Vd(){Pd["Track"]("LoadMiaokit End");var ge=Pd["m_pConfig"]["SVE"];if(ge){for(var he=0,ie=ge;he<ie.length;he++){var je=ie[he];if(true===je.m_bPreload){if(null===je.m_pTile&&null!==je.m_pData){je.m_pTile=Pd["Miaokit"]["LoadTile"](je.m_pData);je.m_pData=null;Pd["App"]["ActiveTile"](je)}}}}}Td["_name"]="Preload";Ud["_name"]="Load";return[Td,Ud]});MiaokitMerge(function(ke){var le=function(){function ne(){}ne.Clamp=function(oe,pe,qe){if(oe>qe){return qe}if(oe<pe){return pe}return oe};return ne}();var me=function(){function re(se,te,ue){this.x=0;this.y=0;this.z=0;this.x=se;this.y=te;this.z=ue}re.Scale=function(ve,we){return{x:we.x*ve,y:we.y*ve,z:we.z*ve}};return re}();le["_name"]="Mathf";me["_name"]="Vector3";return[le,me]});MiaokitMerge(function(xe){var ye=null;var ze=null;var Ae=null;var Be=[null];var Ce=null;var De=[null];var Ee=1;var Fe=0;var Ge=[undefined];var He=null;var Ie=null;function Je(Te){Te["isnanf"]=isNaN;Te["isinff"]=isFinite;Te["powf"]=Math.pow;Te["sqrtf"]=Math.sqrt;Te["expf"]=Math.exp;Te["logf"]=Math.log;Te["floorf"]=Math.floor;Te["ceilf"]=Math.ceil;Te["sinf"]=Math.sin;Te["cosf"]=Math.cos;Te["tanf"]=Math.tan;Te["asinf"]=Math.asin;Te["acosf"]=Math.acos;Te["atanf"]=Math.atan;Te["atan2f"]=Math.atan2;Te["ldexpf"]=function(Ue,Ve){return Ue*Math.pow(2,Ve)}}function Ke(We){function Xe(ff){var gf=xe["WASM"].GetString(ff);if(!gf.startsWith("http")){gf="./data/projects/sve/"+gf}if(gf.endsWith("assetbundle")){gf+=".bin"}return gf}function Ye(hf,jf,kf,lf,mf){var nf=Xe(hf);var of=ye.get(kf);var pf=ye.get(lf);xe["Fetch"](nf,function(qf){if(qf){var rf=of(jf,qf.byteLength,mf);if(rf){xe["WASM"]["HEAPU8"](rf,qf.byteLength).set(new Uint8Array(qf))}}else{console.error("资源丢失:",nf)}pf(jf,mf)})}function Ze(sf,tf,uf,vf,wf){var xf=Xe(sf);var yf=ye.get(uf);var zf=Ce.CreateImage();var Af=Ce.Get(zf);Af.crossOrigin="anonymous";Af.src=xf;Af.onload=function(Bf){yf(tf,zf,wf)}}function $e(Cf,Df,Ef,Ff,Gf){Ye(Cf,Df,Ef,Ff,Gf)}function _e(Hf,If,Jf,Kf,Lf){He["LoadTerrain"](Hf,If,Jf,Kf,Lf)}function af(Mf,Nf,Of,Pf,Qf){var Rf=xe["WASM"]["HEAP32"](Mf,16);He["LoadBlockbox"](Nf,Rf[0],Rf[1],Rf[2],Rf[3],Of,Pf)}function bf(Sf,Tf){var Uf=xe["WASM"]["HEAP32"](Sf,12);He["Load3MX"](Uf[0],Uf[1],Uf[2],Tf)}function cf(Vf,Wf,Xf,Yf,Zf){Ye(Vf,Wf,Xf,Yf,Zf)}function df($f,_f,ag,bg){var cg=ye.get(bg);var dg=xe["WASM"]["HEAP8"](ag,_f);var eg=new Blob([dg]);var fg=window.URL.createObjectURL(eg);var gg=Ce.CreateImage();var hg=Ce.Get(gg);hg.src=fg;hg.onload=function(ig){cg($f,gg);window.URL.revokeObjectURL(fg)}}var ef=[undefined,Ye,Ze,$e,_e,af,bf,cf,df];We["APP_LOAD"]=function(jg,kg,lg,mg,ng,og){ef[jg](kg,lg,mg,ng,og)}}function Le(pg){var qg={NaN:NaN,Infinity:Infinity};Je(pg);Ke(pg);pg["APP_DYNAMIC_LINK"]=function(rg,sg){var tg=xe["WASM"]["HEAPU32"](rg,sg);var ug=tg[0];var vg=tg[1];for(var wg=0;wg<ug;wg++){var xg=tg[2+wg]-1;var yg=tg[vg++];var zg=tg[vg++];var Ag=xe["WASM"].GetString(yg,zg);var Bg=JSON.parse(Ag);var Cg=function(Gg,Hg){this["m_nID"]=Gg;this["m_nObject"]=Hg};var Dg=Cg.prototype;Dg["_type_name"]=Bg[0];Dg["_type_id"]=wg+1;Dg["_ins_count"]=0;Ge[wg+1]=Cg;var Eg=function(Ig){var Jg=ye.get(tg[vg++]);vg++;var Kg=function(){var Lg=Array.prototype.slice.call(arguments);Lg.unshift(this.m_nObject);return Jg.apply(this,Lg)};if(0===Ig){Dg["_"+Bg[Ig]]=Kg}else{Dg[Bg[Ig]]=Kg}};for(var Fg=0;Fg<xg;Fg++){Eg(Fg)}}xe["WASM"]["LoadClass"](Ge,Ne,Qe);xe["Miaokit"]["ResizeCavans"]=function(Mg,Ng){if(Ae.SE_RESIZE){Ae.SE_RESIZE(Mg,Ng)}}};pg["APP_PRINT"]=function(Og,Pg,Qg){var Rg=xe["WASM"].GetString(Og,Pg);xe["Track"](Rg,Qg)};pg["APP_DO_ACTION"]=function(Sg,Tg,Ug,Vg){Be[Sg](Tg,Ug,Vg)};pg["APP_CREATE_OBJ"]=function(Wg,Xg){var Yg=Oe();var Zg=new Ge[Wg](Yg,Xg);De[Yg]=Zg;Ge[Wg].prototype._ins_count++;return Yg};pg["APP_FREE_OBJ"]=function($g){var _g=De[$g];Ge[_g._type_id].prototype._ins_count--;Pe($g)};Ie=xe["ShaderLab"].APP_DO_OPERATORS;Ie[7]=function(ah,bh){if(0===ah){Ce.FreeImage(bh)}else if(1===ah){Ce.FreeBuffer(bh)}return 0};pg["APP_DO"]=function(ch,dh,eh,fh,gh){return Ie[ch](dh,eh,fh,gh)};ze=pg["memory"];xe["WASM"]["m_pMemory"]=xe["WASM"]["m_pMemory"]||ze;return{env:pg,global:qg}}function Me(hh,ih,jh){Ce=xe["GL"]["ImageCache"];ih=Le(ih);WebAssembly.instantiate(hh,ih).then(function(kh){return kh.instance}).then(function(lh){Ae=lh.exports;ye=Ae.__indirect_function_table;xe["WASM"]["Update"]=lh.exports.SE_UPDATE;xe["WASM"]["Malloc"]=lh.exports.Malloc;xe["WASM"]["Free"]=lh.exports.Free;xe["ShaderLab"]["DrawPass_"]=lh.exports.SE_DRAW_PASS;xe["ShaderLab"]["SetSunlight"]=lh.exports.SE_SUNLIGHT;xe["ShaderLab"]["CreateUniformsDesc"]=lh.exports.SE_CREATE_UNIFORMS_DESC;xe["ShaderLab"]["GetTexture"]=function(mh){return Ae.SE_RESOURCE(9,mh)};xe["ShaderLab"]["GetObject"]=function(nh){var oh=Ae.SE_RESOURCE(13,nh);if(oh){return Ne(oh)}return null};xe["Track"]("Start thread");xe["WASM"]["Worker"]=Se(function(){xe["Track"]("Start thread succeed")});Ae.Start();jh()})}function Ne(ph){return De[ph]}function Oe(){var qh=Ee;if(De.length>Ee){Ee=De[Ee]}else{Ee++}Fe++;return qh}function Pe(rh){De[rh]=Ee;Ee=rh;Fe--}function Qe(sh){var th="'系统运行':{";th+="'时间':"+(xe.Time()/1e3).toFixed(0);th+=", '帧率':"+sh;th+=", 'WASM内存':"+xe.WASM.m_pMemory.buffer.byteLength/1024/1024;th+="}";var uh="'JS对象':{";uh+="'工厂':["+De.length+", "+Fe+", "+(De.length-Fe)+"]";uh+=Ce.Analyze();for(var vh=1;vh<Ge.length;vh++){uh+=", '"+Ge[vh].prototype._type_name+"':"+Ge[vh].prototype._ins_count}uh+="}";return[th,uh]}function Re(wh){var xh=Be.length;Be.push(wh);return xh}function Se(yh){var zh=Ae.UTIL_WORKER_CODE();var Ah=xe["WASM"]["HEAPU32"](zh,16);if(false){He=new Worker(window.URL.createObjectURL(new Blob([xe["WASM"]["HEAPU8"](Ah[2],Ah[3])])));var Bh=xe["WASM"]["HEAPU8"]().slice(Ah[0],Ah[0]+Ah[1]);var Ch=Bh.buffer;He.postMessage({m_nID:1,m_aCode:Ch},[Ch])}else{var Dh=xe["m_pConfig"]["MODULE"].replace(".wasm","");He=new Worker(Dh+"Worker.min.js");fetch(Dh+"Worker.wasm").then(function(Eh){return Eh.arrayBuffer()}).then(function(Fh){if(Fh){He.postMessage({m_nID:1,m_aCode:Fh},[Fh])}else{console.error("fetch error: ./js/Miaokit/MiaokitWorker.wasm",Fh)}}).catch(function(Gh){console.error("fetch error: ./js/Miaokit/MiaokitWorker.wasm",Gh)})}He.onmessage=function(Hh){var Ih=Hh.data;switch(Ih.m_nID){case 1:yh();yh=null;break;case 2:He["OnLoadTerrain"](Ih);break;case 3:He["OnLoadBlockbox"](Ih);break;case 4:He["OnLoad3MX"](Ih);break;default:console.error("子线程消息异常:",Ih);break}};He["LoadTerrain"]=function(Jh,Kh,Lh,Mh,Nh){He.postMessage({m_nID:2,m_pPath:xe["WASM"].GetString(Jh),m_nRequest:Kh,m_nCallback:Lh,m_nTS:Nh})};He["OnLoadTerrain"]=function(Oh){var Ph=ye.get(Oh.m_nCallback);var Qh=Oh.m_pData;var Rh=0;if(Qh){Rh=Ce.PushBuffer(Qh)}else{console.warn("Terrain miss:",Oh.m_pPath)}Ph(Oh.m_nRequest,Rh,Oh.m_nTS)};He["LoadBlockbox"]=function Sh(Th,Uh,Vh,Wh,Xh,Yh,Zh){He.postMessage({m_nID:3,m_nRequest:Th,m_nCol:Uh,m_nRow:Vh,m_nColOffset:Wh,m_nRowOffset:Xh,m_nAlloc:Yh,m_nCallback:Zh})};He["OnLoadBlockbox"]=function($h){var _h=ye.get($h.m_nAlloc);var ai=ye.get($h.m_nCallback);var bi=$h.m_pData;var ci=[0,0,0,0];for(var di=0;di<4;di++){var ei=bi[di];if(0<ei.m_nVertexCount&&0<ei.m_nSubmeshCount){var fi=new xe.Mesh;var gi=new Int32Array(ei.m_aIndex);fi.position=new Float32Array(ei.m_aPosition);fi.normal=new Float32Array(ei.m_aNormal);fi.uv=new Float32Array(ei.m_aUV);for(var hi=0;hi<ei.m_nSubmeshCount;hi++){var ii=gi[2*hi];var ji=gi[2*hi+1];var ki=[];for(var li=ii;li<ji;li++){ki.push(li)}fi.SetIndices(hi,new Int32Array(ki),4)}fi.Apply();ci[di]=fi.m_nObject}else{ci[di]=0}}var mi=_h($h.m_nRequest,16);if(mi){xe["WASM"]["HEAPU32"](mi,16).set(new Uint32Array(ci));ai($h.m_nRequest)}};He["Load3MX"]=function(ni,oi,pi,qi){var ri=Ne(ni);if(ri){var si=ri.m_pFileLut[oi];var ti=si.m_pPath+si.m_aFile[pi];var ui=ri.m_pFileLut.length;ri.m_pFileLut.push(null);He.postMessage({m_nID:4,m_nDior:ni,m_pPath:ti,m_nRequest:qi,m_nNewFolder:ui})}};He["OnLoad3MX"]=function(vi){var wi=vi.m_pData;if(wi){var xi=Ne(vi.m_nDior);if(xi){xi.m_pFileLut[vi.m_nNewFolder]=vi.m_pNewFolder;var yi=new Int32Array(wi[0]);var zi=yi[1];var Ai=yi[2];var Bi=4+9*zi;var Ci=0;var Di=[];var Ei=function(){if(Ai===++Ci||0==Ai){var Hi=wi[0].byteLength;var Ii=xi["_CreateBuffer"](Hi);var Ji=xe["WASM"]["HEAP32"](Ii,Hi);Ji.set(yi);xi["_Dispose"](vi.m_nRequest)}};var Fi=function(Ki){var Li=yi[Bi+0];var Mi=yi[Bi+1];if(0===Mi){var Ni=wi[1+Ki];if(null!==Ni){var Oi=Ce.CreateImage();var Pi=Ce.Get(Oi);var Qi=new Blob([new Int8Array(Ni)]);var Ri=window.URL.createObjectURL(Qi);Pi.src=Ri;Pi.onload=function(Vi){Ei();window.URL.revokeObjectURL(Ri)};Di[Li]=Ae["SE_CREATE_INTERNAL_TEXTURE"]();yi[Bi+3]=Di[Li];yi[Bi+4]=Oi}else{Di[Li]=0;yi[Bi+3]=Di[Li];yi[Bi+4]=0;Ei()}}else if(1===Mi){yi[Bi+4]=Di[yi[Bi+5]];var Ni=wi[1+Ki];if(null!==Ni){var Si=Ni.byteLength;var Ti=xi["_CreateBuffer"](Si);var Ui=xe["WASM"]["HEAP8"](Ti,Si);Ui.set(new Int8Array(Ni));Di[Li]=Ae["SE_CREATE_INTERNAL_MESH"](0,Ti);yi[Bi+3]=Di[Li];Ei()}else{Di[Li]=0;yi[Bi+3]=Di[Li];Ei()}}else{Di[Li]=0;yi[Bi+3]=Di[Li];yi[Bi+4]=0;Ei()}Bi+=6};for(var Gi=0;Gi<Ai;Gi++){Fi(Gi)}if(0===Ai){Ei()}}}else{console.warn("3mx miss:",vi.m_pPath)}};return He}xe["WASM"]=xe["WASM"]||{};xe["WASM"]["LoadMiaokit"]=Me;xe["WASM"]["GetObject"]=Ne;xe["WASM"]["RegisterDelegate"]=Re;return[]});MiaokitMerge(function(Wi){var Xi=undefined;var Yi=true;var Zi={};var $i=[];var _i={RGBA32_FLOAT:function(){return true?[Xi["RGBA32F"],Xi.RGBA,Xi.FLOAT]:[Xi.RGBA,Xi.RGBA,Xi.FLOAT]},RGBA16_FLOAT:function(){return true?[Xi["RGBA16F"],Xi.RGBA,Xi["HALF_FLOAT"]]:[Xi.RGBA,Xi.RGBA,36193]},RGBA8:function(){return true?[Xi.RGBA,Xi.RGBA,Xi.UNSIGNED_BYTE]:[Xi.RGBA,Xi.RGBA,Xi.UNSIGNED_BYTE]},D16_UNORM:function(){return true?[Xi["DEPTH_COMPONENT16"],Xi.DEPTH_COMPONENT,Xi.UNSIGNED_SHORT]:[Xi.DEPTH_COMPONENT,Xi.DEPTH_COMPONENT,Xi.UNSIGNED_SHORT]},D24_UNORM:function(){return true?[Xi["DEPTH_COMPONENT24"],Xi.DEPTH_COMPONENT,Xi.UNSIGNED_INT]:[Xi.DEPTH_COMPONENT,Xi.DEPTH_COMPONENT,Xi.UNSIGNED_INT]},D24S8_UNORM:function(){return true?[Xi.DEPTH_STENCIL,Xi.DEPTH_STENCIL,34042]:[Xi.DEPTH_STENCIL,Xi.DEPTH_STENCIL,34042]}};var aj={Opaque:1,Transparent:2,Outline:4,CastShadow:8,ReceiveShadow:16};var bj=null;var cj=["u_Sunlight","u_Picker","u_EyePos","u_MatG","u_MatVP","u_Color","u_MainTex","",""];var dj=[null];var ej=[null];var fj=[null];var gj=[null];var hj=[new Int32Array([0,0,0,0]),new Float32Array([0,0,0,0]),new Float32Array([1,0,0,0,1,0,0,0,1]),new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),new Int32Array([0,0,0,0]),new Int32Array([0,0,0,0]),new Int32Array([0,0,0,0]),new Int32Array([0,0,0,0])];var ij=[function(Qj,Rj,Sj){vj(dj[Qj],gj[Rj])},function(Tj,Uj,Vj){wj(dj[Tj],gj[Uj])},function(Wj,Xj,Yj){xj(dj[Wj],gj[Xj])},function(Zj,$j,_j){yj(dj[Zj],gj[$j])},function(ak,bk,ck){var dk=gj[bk];var ek=dk[1];if(dk[0]){ek=Mj.GetTexture(ek);if(ek){dk[0]=0;dk[1]=ek}}var fk=$i[ek]||sj;if(null===fk){console.log("BindTexture null!");return}Xi.activeTexture(33984+ck);Xi.bindTexture(3553,fk)},function(gk,hk){console.error("Unsupported UniformCubemap!")},null,function(ik,jk,kk){var lk=gj[jk];var mk=lk[1];if(lk[0]){mk=Mj.GetTexture(mk);if(mk){lk[0]=0;lk[1]=mk}}var nk=$i[mk]||sj;if(null===nk){console.log("BindTexture null!");return}Xi.activeTexture(33984+kk);Xi.bindTexture(35866,nk)}];var jj=[null];var kj=[null];var lj=1280;var mj=720;var nj=1;var oj=0;var pj=null;var qj=new Float32Array(4);var rj=[0,0,0,0];var sj=null;var tj=null;var uj=0;function vj(ok,pk){if(undefined===ok.mark){Xi.uniform4iv(ok,pk)}else if(nj!==ok.mark){Xi.uniform4iv(ok,pk);ok.mark=nj}}function wj(qk,rk){if(undefined===qk.mark){Xi.uniform4fv(qk,rk)}else if(nj!==qk.mark){Xi.uniform4fv(qk,rk);qk.mark=nj}}function xj(sk,tk){if(undefined===sk.mark){Xi.uniformMatrix3fv(sk,false,tk)}else if(nj!==sk.mark){Xi.uniformMatrix3fv(sk,false,tk);sk.mark=nj}}function yj(uk,vk){if(undefined===uk.mark){Xi.uniformMatrix4fv(uk,false,vk)}else if(nj!==uk.mark){Xi.uniformMatrix4fv(uk,false,vk);uk.mark=nj}}function zj(wk,xk){var yk=Xi.createShader(wk);if(!yk){console.error("Could not create shader object!");return null}Xi.shaderSource(yk,xk);Xi.compileShader(yk);if(!Xi.getShaderParameter(yk,Xi.COMPILE_STATUS)){var zk=Xi.getShaderInfoLog(yk);Xi.deleteShader(yk);console.error("Could not compile shader! \n\n"+zk);return null}return yk}function Aj(Ak){var Bk=Ak.program;var Ck=0;{Xi.bindAttribLocation(Bk,0,"a_Position");Xi.bindAttribLocation(Bk,1,"a_Normal");Xi.bindAttribLocation(Bk,2,"a_UV");Xi.bindAttribLocation(Bk,3,"a_Color");Xi.bindAttribLocation(Bk,4,"a_Tangent");Xi.bindAttribLocation(Bk,5,"a_Object");Xi.bindAttribLocation(Bk,6,"a_MatW")}{Xi.linkProgram(Bk);if(!Xi.getProgramParameter(Bk,Xi.LINK_STATUS)){var Dk=Xi.getProgramInfoLog(Bk);console.error("Could not compile program! \n\n"+Dk);return 0}}{var Ek=Xi.getProgramParameter(Bk,35718);if(Yi){Ek-=6;var Fk=Xi["getUniformBlockIndex"](Bk,"CommonBlock")}var Gk=Mj.CreateUniformsDesc(Ek);var Hk=gj[Gk];var Ik={};var Jk=0;Hk[19]=fj.push(Ik)-1;jj[Hk[19]]=Ak;Xi.useProgram(Bk);for(var Kk=0;Kk<2;Kk++){var Lk=Ek+(Yi?6:0);for(var Mk=0;Mk<Lk;Mk++){var Dk=Xi.getActiveUniform(Bk,Mk);var Nk=Dk.type;if(35678===Nk||35680===Nk||36289===Nk){if(0!==Kk){continue}}else{if(1!==Kk){continue}}var Ok=Dk.name;var Pk=Xi.getUniformLocation(Bk,Ok);if(!Pk){continue}var Qk=dj.push(Pk)-1;for(var Rk=0;Rk<cj.length;Rk++){if(Ok===cj[Rk]){Hk[Rk]=Jk;if(5>Rk){Pk.mark=1}break}}switch(Nk){case 35669:Nk=0;break;case 35666:Nk=1;break;case 35675:Nk=2;break;case 35676:Nk=3;break;case 35678:Nk=4;break;case 35680:Nk=5;break;case 36289:Nk=7;break;default:console.error("Unsupported uniform type:",Dk);break}Hk[20+Jk]=Qk;Hk[20+Ek+Jk]=Nk;Ik[Ok]=Jk;ej[Qk]=Ok;if(0===Kk){Xi.uniform1i(Pk,Jk)}Jk++}}if(Jk!==Ek){console.error("Process uniform cout error!",Ek,Jk)}Ck=Hk[16]}{var Sk=0;if(Ak.mark){for(var Tk=0,Uk=Ak.mark;Tk<Uk.length;Tk++){var Vk=Uk[Tk];Sk|=aj[Vk]}}Ak.mode=Sk}return Ck}function Bj(Wk){if(!Wk){return null}var Xk=Zi[Wk];if(!Xk){console.error("Could not find shader:",Wk);return null}if(Xk.program){return Xk}Xk.vs=zj(Xi.VERTEX_SHADER,Zi["Common"]["DeclareVS"]+Xk.vs_src+Zi["Common"][Xk.type+"VS"]);if(!Xk.vs){console.error("Could not create vertex shader:",Wk);return null}Xk.fs=zj(Xi.FRAGMENT_SHADER,Zi["Common"]["DeclareFS"]+Xk.fs_src+Zi["Common"][Xk.type+"FS"]);if(!Xk.fs){Xi.deleteShader(Xk.vs);Xk.vs=null;console.error("Could not create fragment shader:",Wk);return null}Xk.program=Xi.createProgram();if(!Xk.program){Xi.deleteShader(Xk.vs);Xi.deleteShader(Xk.fs);Xk.vs=null;Xk.fs=null;console.error("Could not create program object!");return null}Xi.attachShader(Xk.program,Xk.vs);Xi.attachShader(Xk.program,Xk.fs);Xk.id=Aj(Xk);if(!Xk.id){Xi.deleteProgram(Xk.program);Xi.deleteShader(Xk.vs);Xi.deleteShader(Xk.fs);Xk.program=null;Xk.vs=null;Xk.fs=null}return Xk}function Cj(Yk,Zk){var $k=undefined;var _k=undefined;var al=undefined;var bl=undefined;var cl=0;function dl(){var nl=gj[Yk];var ol=gj[Zk];var pl=jj[nl[19]];var ql=nl[20];var rl=20+nl[17];$k=pl.program;_k=fj[nl[19]];al=nl;bl=[];cl=nl[17];var sl=function(Bl){var Cl=Bl;var Dl=gj[ol[Cl]];var El=dj[ql+Cl];var Fl=nl[rl+Cl];var Gl=[function(){return Dl},function(Hl){Dl.set(Hl)},undefined];switch(Fl){case 0:Gl[2]=function(){vj(El,Dl)};break;case 1:Gl[2]=function(){wj(El,Dl)};break;case 2:Gl[2]=function(){xj(El,Dl)};break;case 3:Gl[2]=function(){yj(El,Dl)};break;case 4:Gl[2]=function(){var Il=Dl[1];if(Dl[0]){Il=Mj.GetTexture(Il);if(Il){Dl[0]=0;Dl[1]=Il}}var Jl=$i[Il]||sj;if(null===Jl){console.log("BindTexture null!");return}Xi.activeTexture(33984+Cl);Xi.bindTexture(3553,Jl)};break;case 7:Gl[2]=function(){var Kl=Dl[1];if(Dl[0]){Kl=Mj.GetTexture(Kl);if(Kl){Dl[0]=0;Dl[1]=Kl}}var Ll=$i[Kl]||sj;if(null===Ll){console.log("BindTexture null!");return}Xi.activeTexture(33984+Cl);Xi.bindTexture(35866,Ll)};break;default:console.error("Unsupported uniform type!",Fl);break}bl[Cl]=Gl};for(var tl=0;tl<cl;tl++){sl(tl)}if(pl.uniform_values){for(var ul=0,vl=pl.uniform_values;ul<vl.length;ul++){var wl=vl[ul];var xl=_k[wl[0]];if(undefined!==xl){var yl=nl[rl+xl];if(4===yl||5===yl){var zl=Mj.Pipeline["Resource"][wl[1]];var Al=[0,zl.Handle,0,0];bl[xl][1](Al)}}}}return pl.mode}function el(Ml){if(pj){pj(kj[Zk],Xi)}if(oj!==Yk){Xi.useProgram($k);oj=Yk;if(tj){Xi["bindBufferBase"](Xi["UNIFORM_BUFFER"],0,tj)}}for(var Nl=0,Ol=bl;Nl<Ol.length;Nl++){var Pl=Ol[Nl];Pl[2]()}}function fl(Ql){return _k[Ql]}function gl(Rl){return bl[Rl][0]()}function hl(Sl){Sl=al[Sl];if(-1<Sl){return bl[Sl][0]()}return null}function il(Tl){var Ul=_k[Tl];if(undefined!==Ul){return bl[Ul][0]()}return null}function jl(Vl,Wl){bl[Vl][1](Wl);if(oj===Yk){bl[Vl][2]()}}function kl(Xl,Yl){Xl=al[Xl];if(-1<Xl){bl[Xl][1](Yl);if(oj===Yk){bl[Xl][2]()}}}function ll(Zl,$l){var _l=_k[Zl];if(undefined!==_l){bl[_l][1]($l);if(oj===Yk){bl[_l][2]()}}}function ml(am){bl[am][2]()}kj[Zk]=[dl,el,fl,gl,hl,il,jl,kl,ll,ml];return dl()}function Dj(bm){{Object.defineProperty(bm,"Attr",{get:function(){if(!this.Attr_){this.Attr_=kj[this._VarList()]}return this.Attr_}})}{var cm=function(em){var fm=em;Object.defineProperty(bm,cj[em],{get:function(){return this.Attr[4](fm)},set:function(gm){if(gm){this.Attr[7](fm,gm)}}})};for(var dm=0;dm<cj.length;dm++){cm(dm)}}{}}function Ej(hm){var im=Xi.createTexture();if(!im){console.error("Could not create texture object!");return null}Xi.bindTexture(Xi.TEXTURE_2D,im);Xi.texParameteri(Xi.TEXTURE_2D,Xi.TEXTURE_MIN_FILTER,Xi.LINEAR);Xi.texParameteri(Xi.TEXTURE_2D,Xi.TEXTURE_MAG_FILTER,Xi.LINEAR);Xi.texParameteri(Xi.TEXTURE_2D,Xi.TEXTURE_WRAP_S,Xi.CLAMP_TO_EDGE);Xi.texParameteri(Xi.TEXTURE_2D,Xi.TEXTURE_WRAP_T,Xi.CLAMP_TO_EDGE);var jm=new Image;jm.crossOrigin="anonymous";jm.src=hm.URL;jm.onload=function(km){Xi.bindTexture(Xi.TEXTURE_2D,im);Xi.texImage2D(Xi.TEXTURE_2D,0,Xi.RGB,Xi.RGB,Xi.UNSIGNED_BYTE,jm);Xi.bindTexture(Xi.TEXTURE_2D,null)};Xi.bindTexture(Xi.TEXTURE_2D,null);return im}function Fj(lm){var mm=Xi.createTexture();if(!mm){console.error("Could not create texture object!");return null}Xi.bindTexture(Xi.TEXTURE_2D,mm);var nm=lm.Params;Xi.texParameteri(Xi.TEXTURE_2D,Xi.TEXTURE_MAG_FILTER,Xi[nm[1]]);Xi.texParameteri(Xi.TEXTURE_2D,Xi.TEXTURE_MIN_FILTER,Xi[nm[0]]);Xi.texParameteri(Xi.TEXTURE_2D,Xi.TEXTURE_WRAP_S,Xi[nm[2]]);Xi.texParameteri(Xi.TEXTURE_2D,Xi.TEXTURE_WRAP_T,Xi[nm[3]]);var om=_i[lm.Format]();Xi.texImage2D(Xi.TEXTURE_2D,lm.Levels,om[0],lm.Width,lm.Height,0,om[1],om[2],null);Xi.bindTexture(Xi.TEXTURE_2D,null);mm["_Format"]=om;return mm}function Gj(pm,qm){var rm=Xi.createFramebuffer();if(!rm){console.error("Could not create framebuffer object!");return null}Xi.bindFramebuffer(Xi.FRAMEBUFFER,rm);Xi.framebufferTexture2D(Xi.FRAMEBUFFER,Xi.COLOR_ATTACHMENT0,Xi.TEXTURE_2D,pm,0);if(qm&&qm["_Format"][0]===Xi.DEPTH_STENCIL){Xi.framebufferTexture2D(Xi.FRAMEBUFFER,Xi.DEPTH_STENCIL_ATTACHMENT,Xi.TEXTURE_2D,qm,0)}else{Xi.framebufferTexture2D(Xi.FRAMEBUFFER,Xi.DEPTH_ATTACHMENT,Xi.TEXTURE_2D,qm,0)}if(Xi.FRAMEBUFFER_COMPLETE!=Xi.checkFramebufferStatus(Xi.FRAMEBUFFER)){Xi.deleteFramebuffer(rm);console.error("Framebuffer check failed!");return null}return rm}var Hj=function(sm){if(Yi){gj[uj][12]=sm;Xi.bindBuffer(Xi["UNIFORM_BUFFER"],tj);Xi.bufferData(Xi["UNIFORM_BUFFER"],gj[uj],Xi.DYNAMIC_DRAW)}};var Ij=null;var Jj=null;var Kj=null;var Lj=null;var Mj={_name:"ShaderLab",Shader:Zi,Pipeline:null,Init:function(tm){Xi=Wi["GL"]["Ctx"];$i=Wi["GL"]["_textures"];lj=Xi.canvas.width;mj=Xi.canvas.height;Ij=Wi["GL"]["BindViewport"];Jj=Wi["GL"]["BindDepth"];Kj=Wi["GL"]["BindBlend"];Lj=Wi["GL"]["BindStencil"];if(Yi){var um=Xi.createBuffer();if(um){Xi.bindBuffer(Xi["UNIFORM_BUFFER"],um);Xi.bufferData(Xi["UNIFORM_BUFFER"],64*3,Xi.DYNAMIC_DRAW);Xi.bindBuffer(Xi["UNIFORM_BUFFER"],null);tj=um}}for(var vm=0,wm=this.Pipeline.RenderTarget;vm<wm.length;vm++){var xm=wm[vm];if(xm){xm.Width=xm.Width||lj;xm.Height=xm.Height||mj;xm.Levels=xm.Levels||0;xm.Params=xm.Params||["NEAREST","NEAREST","CLAMP_TO_EDGE","CLAMP_TO_EDGE"];xm.Texture=Fj(xm);xm.Handle=Wi["GL"]["RegisterTexture"](xm.Texture);xm.Size=[1/xm.Width,1/xm.Height,xm.Width,xm.Height]}}for(var ym=0,zm=this.Pipeline.Resource;ym<zm.length;ym++){var Am=zm[ym];if(Am){if("2D"===Am.TYPE){Am.Texture=Ej(Am);Am.Handle=Wi["GL"]["RegisterTexture"](Am.Texture);if(2===Am.ID){sj=Am.Texture}}}}function Bm(Lm){var Mm=Lm.RenderTarget;if(Mm){var Nm=Mj.Pipeline["RenderTarget"][Mm[0]];var Om=Mj.Pipeline["RenderTarget"][Mm[1]];Lm.Framebuffer=Gj(Nm.Texture,Om?Om.Texture:null);if(!Lm.Framebuffer){console.log(Lm)}Lm.Framebuffer.width=Nm.Size[2];Lm.Framebuffer.height=Nm.Size[3]}else{Lm.Framebuffer=null}}for(var Cm=0,Dm=this.Pipeline.Pass;Cm<Dm.length;Cm++){var Em=Dm[Cm];if(Em){if("Clear"===Em.Type){Em._Type=2}else{Em._Type="Render"===Em.Type?0:1}Em._Mask=0;for(var Fm=0,Gm=Em.Mask;Fm<Gm.length;Fm++){var Hm=Gm[Fm];Em._Mask+=aj[Hm]}Bm(Em);if(Em.Pingpong){for(var Im=0,Jm=Em.Pingpong;Im<Jm.length;Im++){var Km=Jm[Im];Bm(Km)}}}}},Draw:function(){nj++;var Pm=0;var Qm=this.Pipeline.Picker;if(Qm){rj[0]=Qm.x;rj[1]=Xi.canvas.height-Qm.y}else{rj[0]=-10;rj[1]=-10}Hj(0);for(var Rm=0,Sm=this.Pipeline.Pass;Rm<Sm.length;Rm++){var Tm=Sm[Rm];Nj.BeginDrawPass();if(Tm.Pingpong){for(var Um=0;Um<Tm.PingpongCount;Um++){for(var Vm=0;Vm<Tm.Pingpong.length;Vm++){Tm.Framebuffer=Tm.Pingpong[Vm].Framebuffer;Tm.SetUniforms=Tm.Pingpong[Vm].SetUniforms;this.DrawPass(Tm,Mj.DrawPass_)}}}else{this.DrawPass(Tm,Mj.DrawPass_)}Nj.EndDrawPass(Pm++)}},DrawPass:function(Wm,Xm){Xi.bindFramebuffer(Xi.FRAMEBUFFER,Wm.Framebuffer);Ij(Wm.Framebuffer,lj,mj);Jj(Wm.Depth);Kj(Wm.Blend,Hj);Lj(Wm.Stencil);var Ym=Wm.ClearTarget;if(Ym){var Zm=0;if(Ym.Color){Xi.clearColor(Ym.Color.r,Ym.Color.g,Ym.Color.b,Ym.Color.a);Zm+=Xi.COLOR_BUFFER_BIT}if(undefined!==Ym.Depth){Xi.clearDepth(Ym.Depth);Zm+=Xi.DEPTH_BUFFER_BIT}if(undefined!==Ym.Stencil){Xi.clearStencil(Ym.Stencil);Zm+=Xi.STENCIL_BUFFER_BIT}Xi.clear(Zm)}pj=Wm.SetUniforms;if(Wm.Shader){if(!Wm._Material){Wm._Material=new Wi["Material"](Wm.Shader)}Wm._Material._Bind()}Xm(Wm._Type,Wm._Mask);if(Wm.Postprocess){Wm.Postprocess(Xi)}},PreflushBuffer:function(){var $m=gj.length;var _m=new Array($m);for(var an=0;an<$m;an++){var bn=gj[an];if(bn){if("Float32Array"===bn.constructor.name){_m[an]=bn.length}else{_m[an]=-bn.length}gj[an]=bn.byteOffset}}return _m},FlushBuffer:function(cn,dn){bj=cn;var en=gj.length;for(var fn=0;fn<en;fn++){var gn=gj[fn];if(gn){var hn=dn[fn];if(0<hn){gj[fn]=new Float32Array(bj,gn,hn)}else{gj[fn]=new Int32Array(bj,gn,-hn)}}}for(var fn=0;fn<en;fn++){var jn=kj[fn];if(jn){jn[0]()}}Wi["GL"]["FlushHeap"]()},ResizeCanvas:function(kn,ln){},PickObject:function(){var mn=this.Pipeline.Picker;if(mn){Xi.readPixels(mn.x,Xi.canvas.height-mn.y,1,1,Xi.RGBA,Xi.FLOAT,qj);if(0>qj[3]){var nn=Math.ceil(qj[0]*1e4)*8192+Math.ceil(qj[1]*1e4);var on=Math.ceil(qj[2]*1e4);var pn=this["GetObject"](nn);mn.Feedback(pn,on)}else{mn.Feedback(null,0)}this.Pipeline.Picker=null}},APP_DO_OPERATORS:[function(qn){var rn=Wi["ShaderLab"]["Pipeline"]["InternalShader"][qn];var sn=Bj(rn);return sn.id},function(tn,un,vn,wn){var xn=null;switch(un){case 0:xn=new Int32Array(bj,wn,4);xn.set(hj[0]);break;case 1:xn=new Float32Array(bj,wn,4);xn.set(hj[1]);break;case 2:xn=new Float32Array(bj,wn,9);xn.set(hj[2]);break;case 3:xn=new Float32Array(bj,wn,16);xn.set(hj[3]);break;case 4:xn=new Int32Array(bj,wn,4);xn.set(hj[4]);break;case 5:xn=new Int32Array(bj,wn,4);xn.set(hj[5]);break;case 6:xn=new Int32Array(bj,wn,vn);break;case 7:xn=new Int32Array(bj,wn,4);xn.set(hj[7]);break;case 8:xn=new Float32Array(bj,wn,48);uj=tn;break;default:console.error("Unsupported uniform type:",un);break}gj[tn]=xn;return tn},function(yn,zn,An,Bn){ij[yn](zn,An,Bn);return 0},function(Cn,Dn,En,Fn){var Gn=Wi["WASM"].GetString(Fn);var Hn=gj[Cn];var In=fj[Hn[19]];var Jn=In[Gn];return undefined===Jn?0:Jn},function(Kn,Ln){kj[Ln][1](Kn);return 0},function(){Mj.Draw()},Cj,null],ExpandMaterial:Dj,CreateUniformsDesc:undefined,GetTexture:undefined,DrawPass_:undefined,SetSunlight:undefined};var Nj={_name:"Profiler",m_pMsg:"",m_nCycleStart:0,m_nCycleTick:0,m_nBeginCycle:0,m_nTotalCycle:0,m_nBeginScript:0,m_nTotalScript:0,m_nBeginUpdate:0,m_nTotalUpdate:0,m_nBeginDraw:0,m_nTotalDraw:0,m_nBeginMaterial:0,m_nTotalMaterial:0,m_nBeginDrawPass:0,m_nTotalDrawPass:[],BeginCycle:function(){if(0===Nj.m_nCycleTick){Nj.m_nCycleStart=Wi["Time"]();Nj.m_nCycleTick=0;Nj.m_nBeginCycle=0;Nj.m_nTotalCycle=0;Nj.m_nBeginScript=0;Nj.m_nTotalScript=0;Nj.m_nBeginUpdate=0;Nj.m_nTotalUpdate=0;Nj.m_nBeginDraw=0;Nj.m_nTotalDraw=0;Nj.m_nBeginMaterial=0;Nj.m_nTotalMaterial=0;Nj.m_nBeginDrawPass=0;Nj.m_nTotalDrawPass=[]}Nj.m_nBeginCycle=Wi["Time"]()},EndCycle:function(){Nj.m_nTotalCycle+=Wi["Time"]()-Nj.m_nBeginCycle;if(60===++Nj.m_nCycleTick){var Mn={"总耗时":Wi["Time"]()-Nj.m_nCycleStart,"应用循环":Nj.m_nTotalCycle,"脚本逻辑":Nj.m_nTotalScript,"场景更新":Nj.m_nTotalUpdate,"场景绘制":Nj.m_nTotalDraw,"通道绘制":Nj.m_nTotalDrawPass};Nj.m_pMsg="'开销统计':"+JSON.stringify(Mn);Nj.m_nCycleTick=0}},BeginScript:function(){Nj.m_nBeginScript=Wi["Time"]()},EndScript:function(){Nj.m_nTotalScript+=Wi["Time"]()-Nj.m_nBeginScript},BeginUpdate:function(){Nj.m_nBeginUpdate=Wi["Time"]()},EndUpdate:function(){Nj.m_nTotalUpdate+=Wi["Time"]()-Nj.m_nBeginUpdate},BeginDraw:function(){Nj.m_nBeginDraw=Wi["Time"]()},EndDraw:function(){Nj.m_nTotalDraw+=Wi["Time"]()-Nj.m_nBeginDraw},BeginMaterial:function(){Nj.m_nBeginMaterial=Wi["Time"]()},EndMaterial:function(){Nj.m_nTotalMaterial+=Wi["Time"]()-Nj.m_nBeginMaterial},BeginDrawPass:function(){Nj.m_nBeginDrawPass=Wi["Time"]()},EndDrawPass:function(Nn){Nj.m_nTotalDrawPass[Nn]=(Nj.m_nTotalDrawPass[Nn]?Nj.m_nTotalDrawPass[Nn]:0)+Wi["Time"]()-Nj.m_nBeginDrawPass}};var Oj="#version 300 es\n#define attribute in\n#define varying out\n#define texture2D texture\n\nprecision highp float;\nprecision mediump sampler2D;\nprecision mediump sampler2DArray;\n\nuniform CommonBlock\n{\n    lowp vec4 u_Sunlight;\n    lowp vec4 u_Picker;\n    lowp vec4 u_EyePos;\n    lowp vec4 u_Mark;\n    highp mat4 u_MatG;\n    highp mat4 u_MatVP;\n};\n";var Pj="#version 300 es\n#define varying in\n#define texture2D texture\n#define gl_FragColor FragColor\n\nprecision highp float;\nprecision mediump sampler2D;\nprecision mediump sampler2DArray;\n\nuniform CommonBlock\n{\n    lowp vec4 u_Sunlight;\n    lowp vec4 u_Picker;\n    lowp vec4 u_EyePos;\n    lowp vec4 u_Mark;\n    highp mat4 u_MatG;\n    highp mat4 u_MatVP;\n};\n\nout vec4 FragColor;\n";Mj.Shader["Common"]={DeclareVS:Oj+"\nattribute mediump vec3 a_Position;\nattribute mediump vec3 a_Normal;\nattribute mediump vec2 a_UV;\nattribute mediump vec4 a_Color;\nattribute mediump vec4 a_Tangent;\nattribute mediump vec4 a_Binormal;\nattribute mediump vec4 a_Object;\nattribute mediump mat4 a_MatW;\n\n/// 对象空间坐标转世界空间坐标\nvec3 ObjectToWorldPos(vec3 i_Position)\n{\n    return (a_MatW * vec4(i_Position, 1.0)).xyz;\n}\n\n/// 对象空间坐标转裁剪空间坐标\nvec4 ObjectToClipPos(vec3 i_Position)\n{\n    // GIS的变换矩阵值包含旋转信息，未包含位移信息，避免精度不足造成画面抖动\n    // return u_MatVP * u_MatG * a_MatW * vec4(i_Position, 1.0);\n    \n    vec4 mPosition = vec4(i_Position, 1.0);\n    mPosition = u_MatG * a_MatW * mPosition;\n    mPosition.y = mPosition.y - 6378137.0;\n\n    return u_MatVP * mPosition;\n}\n\n/// 对象空间法线转世界空间法线\nvec3 ObjectToWorldNormal(vec3 i_Normal)\n{\n    return normalize((a_MatW * vec4(i_Normal, 0.0)).xyz);\n}\n       ",DeclareFS:Pj+"\nuniform sampler2D u_MainTex;\n\n/// 采样2D纹理\nvec4 Tex2D(sampler2D i_Tex, vec2 i_UV)\n{\n    i_UV.x = fract(i_UV.x);\n    i_UV.y = fract(1.0 - i_UV.y);\n\n    return texture2D(i_Tex, i_UV);\n}\n        ",ClearVS:"\nvoid main()\n{\n    gl_Position = vs();\n}\n        ",ClearFS:"\nvoid main()\n{\n    gl_FragColor = fs();\n}\n        ",RenderVS:"\nvarying vec4 v_Object;\n\nvoid main()\n{\n    v_Object = a_Object;\n    \n    gl_Position = vs();\n}\n        ",RenderFS:"\nvarying vec4 v_Object;\n\nvoid main()\n{\n    gl_FragColor = fs();\n    \n    float nAlpha = u_Mark.x;\n    \n    // 半透明输出：https://zhuanlan.zhihu.com/p/49164063\n    if(0.01 < nAlpha)\n    {\n        // 传参：0-不透明，1-全透明，默认值0，追加0.3的透明度\n        nAlpha = 0.3 + 0.7 * v_Object.b;\n        \n        // G通道：颜色灰度累加。（不支持彩色透明）\n        gl_FragColor.g = dot(gl_FragColor.rgb, vec3(0.299, 0.587, 0.114));\n        // R通道：混合次数累加，赋值1.0。赋值0.99标记高亮区域\n        gl_FragColor.r = 1.0 - (0.01 * v_Object.a);        \n        // B通道：OPACITY累加\n        gl_FragColor.b = 1.0 - nAlpha;\n        gl_FragColor.g *= gl_FragColor.b;\n        // A通道：ALPHA累乘。混合：源因子为0、目标乘以源\n        gl_FragColor.a = 1.0 - gl_FragColor.b;\n    }\n    // 不透明输出\n    else\n    {\n        // 高亮区域标记\n        gl_FragColor.a = 1.0 - (0.01 * v_Object.a);\n    }\n}\n        ",PostprocessVS:"\nvoid main()\n{\n    gl_Position = vs();\n}\n        ",PostprocessFS:"\nvoid main()\n{\n    gl_FragColor = fs();\n}\n        ",BRDF:'\nconst float PI = 3.14159265358979323846;\n\nconst vec3 baseColor = vec3(0.5, 0.5, 0.5);\nconst float metallic = 0.0;\nconst float subsurface = 0.5; // 0.0\nconst float specular = 0.2;\nconst float roughness = 0.7;//0.5;\nconst float specularTint = 0.0;\nconst float anisotropic = 0.0;\nconst float sheen = 0.0;\nconst float sheenTint = 0.5;\nconst float clearcoat = 0.0;\nconst float clearcoatGloss = 1.0;\n\nfloat sqr(float x) { return x * x; }\n\nfloat SchlickFresnel(float u)\n{\n\tfloat m = clamp(1.0 - u, 0.0, 1.0);\n\tfloat m2 = m * m;\n\treturn m2 * m2 * m; // pow(m,5)\n}\n\nfloat GTR1(float NdotH, float a)\n{\n\tif (a >= 1.0) return 1.0 / PI;\n\tfloat a2 = a * a;\n\tfloat t = 1.0 + (a2 - 1.0) * NdotH * NdotH;\n\treturn (a2 - 1.0) / (PI * log(a2) * t);\n}\n\nfloat GTR2(float NdotH, float a)\n{\n\tfloat a2 = a * a;\n\tfloat t = 1.0 + (a2 - 1.0) * NdotH * NdotH;\n\treturn a2 / (PI * t * t);\n}\n\nfloat GTR2_aniso(float NdotH, float HdotX, float HdotY, float ax, float ay)\n{\n\treturn 1.0 / (PI * ax * ay * sqr(sqr(HdotX / ax) + sqr(HdotY / ay) + NdotH * NdotH));\n}\n\nfloat smithG_GGX(float NdotV, float alphaG)\n{\n\tfloat a = alphaG * alphaG;\n\tfloat b = NdotV * NdotV;\n\treturn 1.0 / (NdotV + sqrt(a + b - a * b));\n}\n\nfloat smithG_GGX_aniso(float NdotV, float VdotX, float VdotY, float ax, float ay)\n{\n\treturn 1.0 / (NdotV + sqrt(sqr(VdotX * ax) + sqr(VdotY * ay) + sqr(NdotV)));\n}\n\nvec3 mon2lin(vec3 x)\n{\n\treturn vec3(pow(x[0], 2.2), pow(x[1], 2.2), pow(x[2], 2.2));\n}\n\nvec3 BRDF(vec3 L, vec3 V, vec3 N, vec3 X, vec3 Y)\n{\n    //x和y方向分别表示了表面的切向量和副法线向量方向\n    //https://www.cnblogs.com/starfallen/p/3572352.html\n\n\tfloat NdotL = dot(N, L);\n\tfloat NdotV = dot(N, V);\n\tif (NdotL < 0.0 || NdotV < 0.0) return vec3(0.0);\n\n\tvec3 H = normalize(L + V);\n\tfloat NdotH = dot(N, H);\n\tfloat LdotH = dot(L, H);\n\n\tvec3 Cdlin = mon2lin(baseColor);\n\tfloat Cdlum = 0.3 * Cdlin[0] + 0.6 * Cdlin[1] + 0.1 * Cdlin[2]; // luminance approx.\n\n\tvec3 Ctint = Cdlum > 0.0 ? Cdlin / Cdlum : vec3(1.0); // normalize lum. to isolate hue+sat\n\tvec3 Cspec0 = mix(specular * 0.08 * mix(vec3(1.0), Ctint, specularTint), Cdlin, metallic);\n\tvec3 Csheen = mix(vec3(1.0), Ctint, sheenTint);\n\n\t// Diffuse fresnel - go from 1 at normal incidence to .5 at grazing\n\t// and mix in diffuse retro-reflection based on roughness\n\tfloat FL = SchlickFresnel(NdotL), FV = SchlickFresnel(NdotV);\n\tfloat Fd90 = 0.5 + 2.0 * LdotH * LdotH * roughness;\n\tfloat Fd = mix(1.0, Fd90, FL) * mix(1.0, Fd90, FV);\n\n\t// Based on Hanrahan-Krueger brdf approximation of isotropic bssrdf\n\t// 1.25 scale is used to (roughly) preserve albedo\n\t// Fss90 used to "flatten" retroreflection based on roughness\n\tfloat Fss90 = LdotH * LdotH * roughness;\n\tfloat Fss = mix(1.0, Fss90, FL) * mix(1.0, Fss90, FV);\n\tfloat ss = 1.25 * (Fss * (1.0 / (NdotL + NdotV) - 0.5) + 0.5);\n\n\t// specular\n\tfloat aspect = sqrt(1.0 - anisotropic * 0.9);\n\tfloat ax = max(0.001, sqr(roughness) / aspect);\n\tfloat ay = max(0.001, sqr(roughness) * aspect);\n\tfloat Ds = GTR2_aniso(NdotH, dot(H, X), dot(H, Y), ax, ay);\n\tfloat FH = SchlickFresnel(LdotH);\n\tvec3 Fs = mix(Cspec0, vec3(1.0), FH);\n\tfloat Gs;\n\tGs = smithG_GGX_aniso(NdotL, dot(L, X), dot(L, Y), ax, ay);\n\tGs *= smithG_GGX_aniso(NdotV, dot(V, X), dot(V, Y), ax, ay);\n\n\t// sheen\n\tvec3 Fsheen = FH * sheen * Csheen;\n\n\t// clearcoat (ior = 1.5 -> F0 = 0.04)\n\tfloat Dr = GTR1(NdotH, mix(0.1, 0.001, clearcoatGloss));\n\tfloat Fr = mix(0.04, 1.0, FH);\n\tfloat Gr = smithG_GGX(NdotL, 0.25) * smithG_GGX(NdotV, 0.25);\n\n\treturn ((1.0 / PI) * mix(Fd, ss, subsurface) * Cdlin + Fsheen) * (1.0 - metallic) + Gs * Fs * Ds + 0.25 * clearcoat * Gr * Fr * Dr;\n}\n        ',AtmosphereVS:"\nvarying vec4 v_ViewDir;\nvarying vec4 v_Scattering;\nvarying vec4 v_Attenuate;\n\n//P and ray define the line; O is the sphere's center point\nvec3 CalculateIntersection(vec3 P, vec3 ray, vec3 O, float r)\n{\n\tvec3 PO = O - P;\n\tfloat lPO = length(PO);\n\tfloat B = 2.0 * dot(PO, ray);\n\n\tfloat C = B * B - 4.0 * (lPO * lPO - r * r);\n\tfloat det = sqrt(max(0.0, C));\n\n\tfloat d = 0.5*(B-det);\n\tvec3 intersect = P + d * ray;\n\n\treturn intersect;\n}\n\nvoid Atmosphere(vec3 mLightDir, vec3 mWorldPos)\n{\n    // 大气散射，天空应分两层，摄像机应该在内层之外，大气层厚度为外层半径减内层半径，外层半径应远大于内层半径\n    //650 nm for red; 570 nm for green; 475 nm for blue\n    vec3 _Wave = vec3(5.602046, 9.473285, 20.49314);\n    vec3 _ESun = vec3(20.0, 20.0, 20.0);\n    vec3 _PlanetPos = vec3(0.0, -6378137.0, 0.0);\n    float _Sealevel = 6378137.0;\n    float _OuterRadius = 6478137.0;\n    float _SampleNum = 5.0;\n    //Rayleigh scattering constant\n    float _Kr = 0.0025;\n    //Mie scattering constant\n    float _Km = 0.001;\n    //the altitude at which the atmosphere's average density is found\n    float _H0 = 0.25;\n\n    vec3 mRay = mWorldPos - u_EyePos.xyz;\n    float nDepth = length(mRay); mRay = mRay / nDepth;\n\n    float nSampleLength = nDepth / _SampleNum;\n    vec3 mSampleRay = mRay * nSampleLength;\n    vec3 mSamplePoint = u_EyePos.xyz + mSampleRay * 0.5;\n    vec3 mInScattering = vec3(0.0, 0.0, 0.0);\n    vec3 mOutScatteringAB = vec3(0.0, 0.0, 0.0);\n    vec3 mOutGroundScatteringAB = vec3(0.0, 0.0, 0.0);\n    float nInvOuterH = 1.0 / (_OuterRadius-_Sealevel);\n\n    for(int i=0; i</*_SampleNum*/5; i++)\n    {\n\t    vec3 mCrossPoint = CalculateIntersection(mSamplePoint, -mLightDir, _PlanetPos, _OuterRadius);\n\t    //AP out scattering\n\t    vec3 mAPRay = (mSamplePoint - u_EyePos.xyz) / _SampleNum;\n\t    float nAPRayLength = length(mAPRay);\n\t    vec3 mSampleAP = u_EyePos.xyz + mAPRay * 0.5;\n\t    vec3 mOutScatteringAP = vec3(0.0, 0.0, 0.0);\n\n\t    for(int m=0; m</*_SampleNum*/5; m++)\n\t    {\n\t\t    mOutScatteringAP += exp(-(length(mSampleAP - _PlanetPos) - _Sealevel) * nInvOuterH / _H0) * nAPRayLength * nInvOuterH;\n\t\t    mSampleAP += mAPRay;\n\t    }\n\t    mOutScatteringAP = 4.0 * 3.14 * (_Km + _Kr * _Wave) * mOutScatteringAP;\n\n\t    //PC out scattering\n\t    vec3 mPCRay = (mCrossPoint - mSamplePoint) / _SampleNum;\n\t    float nPCRayLength = length(mPCRay);\n\t    vec3 mSamplePC = mSamplePoint + mPCRay*0.5;\n\t    vec3 mOutScatteringPC = vec3(0.0, 0.0, 0.0);\n\n\t    for(int n=0; n</*_SampleNum*/5; n++)\n\t    {\n\t\t    mOutScatteringPC += exp(-(length(mSamplePC - _PlanetPos) - _Sealevel) * nInvOuterH / _H0) * nPCRayLength * nInvOuterH;\n\t\t    mSamplePC += mPCRay;\n\t    }\n\t    mOutScatteringPC = 4.0 * 3.14 * (_Km + _Kr * _Wave) * mOutScatteringPC;\n\n\t    mInScattering += exp(-(length(mSamplePoint - _PlanetPos) - _Sealevel) * nInvOuterH / _H0) * nSampleLength * nInvOuterH * exp(-mOutScatteringAP - mOutScatteringPC);\n\t    mSamplePoint+=mSampleRay;\n\t    mOutScatteringAB = mCrossPoint;\n        mOutGroundScatteringAB = mOutScatteringAP + mOutScatteringPC;\n    }\n\n    vec3 mAttenuateGround = exp(-mOutGroundScatteringAB);\n\n    v_ViewDir.xyz = u_EyePos.xyz - mWorldPos;\n    v_Scattering.xyz = mInScattering * _ESun * _Kr * _Wave;\n    v_Attenuate.xyz = mInScattering * _ESun * _Km;\n\n    v_ViewDir.w = mAttenuateGround.x;\n    v_Scattering.w = mAttenuateGround.y;\n    v_Attenuate.w = mAttenuateGround.z;\n\n    //Ground : v_ScatteringR = v_Scattering; v_ScatteringM = v_Attenuate; v_Attenuate = v_AttenuateGround;\n    //v_ViewDir = u_EyePos.xyz - mWorldPos;\n    //v_ScatteringR = mInScattering * _ESun * _Kr * _Wave;\n    //v_ScatteringM = mInScattering * _ESun * _Km;\n    //v_Attenuate = exp(-mOutGroundScatteringAB);\n}\n        ",AtmosphereFS:"\nvarying vec4 v_ViewDir;\nvarying vec4 v_Scattering;\nvarying vec4 v_Attenuate;\n\nfloat PhaseRayleigh(float nCostheta)\n{\n\treturn 0.75 * (1.0 + nCostheta * nCostheta);\n}\n\nfloat PhaseMie(float nCostheta, float g, float g2)\n{\n\treturn 1.5 * ((1.0 - g2) / (2.0 + g2)) * (1.0 + nCostheta * nCostheta) / pow(1.0 + g2 - 2.0 * g * nCostheta, 1.5);\n}\n\nvec4 AtmosphereColor(vec4 mColor, vec3 mLightDir)\n{\n    float _G = -0.990;\n    float _G2 = _G * _G;\n    \n    float nCostheta = dot(normalize(v_ViewDir.xyz), mLightDir);\n    float nPhaseMie = PhaseMie(nCostheta, _G, _G2);\n    float nPhaseRayleigh = PhaseRayleigh(nCostheta);\n\t\t\t\t\n    mColor.rgb = v_Scattering.xyz * nPhaseRayleigh + v_Attenuate.xyz * nPhaseMie;\n    mColor.a = mColor.b + 0.35;\n    mColor = clamp(mColor, 0.0, 0.9);\n\n    return mColor;\n}\n\nvec4 AtmosphereLight(vec4 mColor, vec3 mLightDir)\n{\n    // Ground : v_ScatteringR = v_Scattering.xyz; v_ScatteringM = v_Attenuate.xyz; v_Attenuate = v_AttenuateGround;\n    \n    float _G = -0.980;\n    float _G2 = _G * _G;\n    \n    float nCostheta = dot(normalize(v_ViewDir.xyz), mLightDir);\n    float nPhaseMie = PhaseMie(nCostheta, _G, _G2);\n    float nPhaseRayleigh = PhaseRayleigh(nCostheta);\n    \n    mColor.rgb = v_Scattering.xyz * nPhaseRayleigh + v_Attenuate.xyz * nPhaseMie + mColor.rgb * vec3(v_ViewDir.w, v_Scattering.w, v_Attenuate.w)/*v_AttenuateGround*/;\n    \n    return mColor;\n}\n        "};return[Mj,Nj]});MiaokitMerge(function(On){if("Sisyphus"!==On["m_pConfig"]["ENGINE"]){return[]}var Pn=undefined;var Qn=true;function Rn(Xn){Sn();Pn=Xn.OnRenderingEvent;Tn();var Yn={memory:new WebAssembly.Memory({initial:64*16,maximum:32768}),APP_PLUGIN_TYPE:function(){return 2},APP_MEM_TYPE:function(){return 2},APP_MEM_RESERVE:function(){return 1024},APP_MEM_MALLOC:function(Zn){alert("SISYPHUS��չ��֧��ʹ�÷������ڴ�!");return 0},APP_MEM_FREE:function($n){alert("SISYPHUS��չ��֧��ʹ�÷������ڴ�!")},APP_MEM_BASE:function(){return 64*1024*1024},APP_MEM_GROW:function(_n){if(On["ShaderLab"]){var ao=On["ShaderLab"]["PreflushBuffer"]();Yn["memory"].grow(_n/64/1024);var bo=Yn["memory"].buffer;On["ShaderLab"]["FlushBuffer"](bo,ao)}else{Yn["memory"].grow(_n/64/1024)}},APP_MEM_RECYCLE:function(co){alert("WAMSģ�鲻֧�ֻ����ڴ�!")},UNITY_CREATE_OBJ:function(){alert("δװ��UNITY��չ!");return 0},UNITY_FREE_OBJ:function(){alert("δװ��UNITY��չ!");return 0},UNITY_GET:function(){alert("δװ��UNITY��չ!");return 0},UNITY_DO:function(){alert("δװ��UNITY��չ!");return 0}};Object["assign"](Yn,Wn.Export);Xn.OnEngineLoad(Yn)}function Sn(){var eo=document.getElementById("unityContainer");var fo=document.createElement("canvas");fo.id="3d";fo.width=eo.offsetWidth;fo.height=eo.offsetHeight;fo.style.width="100%";fo.style.height="100%";fo.style.top="0rem";fo.style.bottom="0rem";fo.style.left="0rem";fo.style.right="0rem";fo.style.position="absolute";fo.style.zIndex="1";eo.appendChild(fo);Wn["CreateContext"](fo,null);On["ShaderLab"]["Init"](Wn)}function Tn(){if(Qn){Qn=false;Vn()}}function Un(){Qn=true}function Vn(){if(Qn){return}On.Profiler.BeginCycle();On.Profiler.BeginScript();Pn(0);On.Profiler.EndScript();if(On["WASM"]["Update"]){On.Profiler.BeginUpdate();On["WASM"]["Update"](0);On.Profiler.EndUpdate();On.Profiler.BeginDraw();On["WASM"]["Update"](1);On.Profiler.EndDraw()}On.Profiler.EndCycle();requestAnimationFrame(Vn)}var Wn=function(){var go=undefined;var ho=[-1,-1,-1,-1];var io=[-1,-1,-1];var jo=[-1,-1,-1,-1,-1,-1,-1];var ko=[-1,-1,-1,-1,-1,-1,-1];var lo=[null];var mo=null;var no=null;var oo=0;var po=function(){var xo=[null];var yo=[];var zo=[];var Ao=0;var Bo=0;return{Analyze:function(){return", 'Image':["+Ao+","+yo.length+","+Bo+","+zo.length+"]"},Get:function(Co){return xo[Co]},CreateImage:function(){var Do=null;if(0<yo.length){Do=yo.pop()}else{Ao++;Do=xo.push(new Image)-1}return Do},FreeImage:function(Eo){yo.push(Eo)},PushBuffer:function(Fo){var Go=null;if(0<zo.length){Go=zo.pop()}else{Bo++;Go=xo.push(null)-1}xo[Go]=Fo;return Go},FreeBuffer:function(Ho){xo[Ho]=null;zo.push(Ho)}}}();var qo=function(Io){var Jo=lo.length;Io.name=Jo;lo[Jo]=Io;return Jo};var ro=function(Ko){return lo[Ko]};var so=function(Lo,Mo){lo[Lo]=Mo};var to=function(No,Oo){no[No>>2]=Oo};var uo=function(Po){return no[Po>>2]};var vo=function(Qo,Ro){return mo.subarray(Qo,Qo+Ro)};var wo={glGenVertexArrays:function(So,To){var Uo=go["createVertexArray"]();if(!Uo||1!=So){console.error("gl.createVertexArray error!");return}var Vo=qo(Uo);to(To,Vo)},glDeleteVertexArrays:function(Wo,Xo){var Yo=uo(Xo);var Zo=ro(Yo);if(!Zo||1!=Wo){console.error("gl.deleteVertexArray error!");return}go["deleteVertexArray"](Zo);so(Yo,null)},glBindVertexArray:function($o){go["bindVertexArray"](ro($o))},glVertexAttribPointer:function(_o,ap,bp,cp,dp,ep){go.vertexAttribPointer(_o,ap,bp,!!cp,dp,ep)},glEnableVertexAttribArray:function(fp){go.enableVertexAttribArray(fp)},glVertexAttribDivisor:function(gp,hp){go["vertexAttribDivisor"](gp,hp)},glGenTextures:function(ip,jp){var kp=go.createTexture();if(!kp||1!=ip){console.error("gl.createTexture error!");return}var lp=qo(kp);to(jp,lp)},glDeleteTextures:function(mp,np){var op=uo(np);var pp=ro(op);if(!pp||1!=mp){console.error("gl.deleteTexture error!");return}go.deleteTexture(pp);so(op,null)},glActiveTexture:function(qp){go.activeTexture(qp)},glBindTexture:function(rp,sp){go.bindTexture(rp,ro(sp))},glTexParameteri:function(tp,up,vp){go.texParameteri(tp,up,vp)},glTexImage2DObj:function(wp,xp,yp,zp,Ap,Bp,Cp,Dp,Ep){var Fp=po.Get(Ep);if(Fp){if(Fp instanceof ArrayBuffer){go.texImage2D(wp,xp,yp,zp,Ap,Bp,Cp,Dp,new Uint8Array(Fp));po.FreeBuffer(Ep)}else{go.texParameterf(wp,34046,oo);go.texImage2D(wp,xp,yp,Cp,Dp,Fp);po.FreeImage(Ep)}}},glGenBuffers:function(Gp,Hp){var Ip=go.createBuffer();if(!Ip||1!=Gp){console.error("gl.createBuffer error!");return}var Jp=qo(Ip);to(Hp,Jp)},glDeleteBuffers:function(Kp,Lp){var Mp=uo(Lp);var Np=ro(Mp);if(!Np||1!=Kp){console.error("gl.deleteBuffer error!");return}go.deleteBuffer(Np);so(Mp,null)},glBindBuffer:function(Op,Pp){go.bindBuffer(Op,ro(Pp))},glBufferData:function(Qp,Rp,Sp,Tp){if(!Sp){go.bufferData(Qp,Rp,Tp)}else{go.bufferData(Qp,vo(Sp,Rp),Tp)}},glBufferSubData:function(Up,Vp,Wp,Xp){go.bufferSubData(Up,Vp,vo(Xp,Wp))},glBlendEquationSeparate:function(Yp,Zp){if(Yp!=jo[1]||Zp!=jo[2]){go.blendEquationSeparate(Yp,Zp);jo[1]=Yp;jo[2]=Zp}},glBlendFuncSeparate:function($p,_p,aq,bq){if($p!=jo[3]||_p!=jo[4]||aq!=jo[5]||bq!=jo[6]){go.blendFuncSeparate($p,_p,aq,bq);jo[3]=$p;jo[4]=_p;jo[5]=aq;jo[6]=bq}},glEnable:function(cq){go.enable(cq)},glDisable:function(dq){go.disable(dq)},glDepthFunc:function(eq){go.depthFunc(eq)},glDepthMask:function(fq){go.depthMask(!!fq)},glCullFace:function(gq){go.cullFace(gq)},glPolygonOffset:function(hq,iq){go.polygonOffset(hq,iq)},glViewport:function(jq,kq,lq,mq){if(lq!=ho[2]||mq!=ho[3]){go.viewport(jq,kq,lq,mq);ho[2]=lq;ho[3]=mq}},glDrawArrays:function(nq,oq,pq){go.drawArrays(nq,oq,pq)},glDrawArraysInstanced:function(qq,rq,sq,tq){go["drawArraysInstanced"](qq,rq,sq,tq)},glDrawElements:function(uq,vq,wq,xq){go.drawElements(uq,vq,wq,xq)},glDrawElementsInstanced:function(yq,zq,Aq,Bq,Cq){go["drawElementsInstanced"](yq,zq,Aq,Bq,Cq)}};return{_name:"GL",_textures:lo,Ctx:null,ImageCache:po,Export:wo,FlushHeap:function(){mo=On["WASM"]["HEAPU8"]();no=On["WASM"]["HEAP32"]()},CreateContext:function(Dq,Eq){Eq=Eq||{majorVersion:2,minorVersion:0,alpha:0,depth:0,stencil:0,antialias:0,premultipliedAlpha:0,preserveDrawingBuffer:0,preferLowPowerToHighPerformance:0,failIfMajorPerformanceCaveat:0,enableExtensionsByDefault:1,explicitSwapControl:0,proxyContextToMainThread:0,renderViaOffscreenBackBuffer:0};if(Eq["explicitSwapControl"]){return 0}if(Eq["majorVersion"]==1){go=Dq.getContext("webgl",Eq)||Dq.getContext("experimental-webgl",Eq);if(!go){console.error("create webgl_1 error!");return}var Fq=go.getExtension("ANGLE_instanced_arrays");if(Fq){go["vertexAttribDivisor"]=function(Oq,Pq){Fq["vertexAttribDivisorANGLE"](Oq,Pq)};go["drawArraysInstanced"]=function(Qq,Rq,Sq,Tq){Fq["drawArraysInstancedANGLE"](Qq,Rq,Sq,Tq)};go["drawElementsInstanced"]=function(Uq,Vq,Wq,Xq,Yq){Fq["drawElementsInstancedANGLE"](Uq,Vq,Wq,Xq,Yq)}}else{console.error("!ANGLE_instanced_arrays")}var Gq=go.getExtension("OES_vertex_array_object");if(Gq){go["createVertexArray"]=function(){return Gq["createVertexArrayOES"]()};go["deleteVertexArray"]=function(Zq){Gq["deleteVertexArrayOES"](Zq)};go["bindVertexArray"]=function($q){Gq["bindVertexArrayOES"]($q)}}else{console.error("!OES_vertex_array_object")}var Hq=["EXT_color_buffer_half_float","OES_texture_half_float","EXT_texture_filter_anisotropic","WEBGL_depth_texture","OES_element_index_uint","EXT_frag_depth","EXT_blend_minmax"];for(var Iq=0,Jq=Hq;Iq<Jq.length;Iq++){var Kq=Jq[Iq];var Lq=go.getExtension(Kq);if(!Lq){console.error("!"+Kq)}}}else{go=Dq.getContext("webgl2",Eq);if(!go){console.error("create webgl_2 error!");return}var Hq=["EXT_color_buffer_float","EXT_texture_filter_anisotropic"];for(var Mq=0,Nq=Hq;Mq<Nq.length;Mq++){var Kq=Nq[Mq];var Lq=go.getExtension(Kq);if(!Lq){console.error("!"+Kq)}}}oo=go.getParameter(34047);Wn.Ctx=go;return 0},DestroyContext:function(){console.error("!DestroyContext")},GetTextureByHandle:function(_q){return lo[_q]},RegisterTexture:function(ar){return qo(ar)},BindViewport:function(br,cr,dr){var er=br&&br.width||cr;var fr=br&&br.height||dr;if(er!=ho[2]||fr!=ho[3]){go.viewport(0,0,er,fr);ho[2]=er;ho[3]=fr}},BindDepth:function(gr){if(gr){var hr=gr.Write;var ir=go[gr.Func];if(1!=io[0]){go.enable(go.DEPTH_TEST);io[0]=1}if(hr!=io[1]){go.depthMask(hr);io[1]=hr}if(ir!=io[2]){go.depthFunc(ir);io[2]=ir}}else{if(0!=io[0]){go.disable(go.DEPTH_TEST);io[0]=0}}},BindBlend:function(jr,kr){if(jr){var lr=go[jr.ColorFunc];var mr=go[jr.AlphaFunc];var nr=go[jr.ColorSrc];var or=go[jr.ColorDest];var pr=go[jr.AlphaSrc];var qr=go[jr.AlphaDest];if(1!=jo[0]){go.enable(go.BLEND);jo[0]=1;kr(1)}go.blendEquationSeparate(lr,mr);jo[1]=lr;jo[2]=mr;go.blendFuncSeparate(nr,or,pr,qr);jo[3]=nr;jo[4]=or;jo[5]=pr;jo[6]=qr}else{if(0!=jo[0]){go.disable(go.BLEND);jo[0]=0;kr(0)}}},BindStencil:function(rr){if(rr){var sr=go[rr.Func];var tr=rr.Value;var ur=rr.Mask;var vr=go[rr.Faild];var wr=go[rr.ZFaild];var xr=go[rr.Pass];if(1!=ko[0]){go.enable(go.STENCIL_TEST);ko[0]=1}if(sr!=ko[1]||tr!=ko[2]||ur!=ko[3]){go.stencilFunc(sr,tr,ur);ko[1]=sr;ko[2]=tr;ko[3]=ur}if(vr!=ko[4]||wr!=ko[5]||xr!=ko[6]){go.stencilOp(vr,wr,xr);ko[4]=vr;ko[5]=wr;ko[6]=xr}}else{if(0!=ko[0]){go.disable(go.STENCIL_TEST);ko[0]=0}}}}}();On["WASM"]=On["WASM"]||{};On["WASM"]["LoadEngine"]=Rn;Tn["_name"]="Start";Un["_name"]="Stop";return[Wn,Tn,Un]});MiaokitMerge(function(yr){var zr=Date.now();function Ar(){return Date.now()-zr}function Br(Er,Fr){if(Fr===void 0){Fr=0}if(2===Fr){console.warn("Track:",Ar(),Er)}else if(2<Fr){console.error("Track:",Ar(),Er)}else{console.info("Track:",Ar(),Er)}}function Cr(Gr,Hr,Ir){if(Ir===void 0){Ir=undefined}var Jr=new XMLHttpRequest;Jr.open("GET",Gr,true);Jr.responseType="arraybuffer";Jr.onprogress=function(Kr){if(0<Kr.total&&Ir){Ir(Kr.loaded/Kr.total)}};Jr.onload=function(Lr){if(Jr.status==200){Hr(Jr.response)}else{Hr(null)}};Jr.onerror=function(Mr){Br(Mr,2);Hr(null)};Jr.send(null)}function Dr(Nr,Or,Pr,Qr,Rr,Sr){var Tr=new XMLHttpRequest;Tr.onprogress=function(Ur){if(0<Ur.total&&Rr){Rr(Ur.loaded/Ur.total)}};Tr.onload=function(Vr){if(Tr.status==200){Sr(Tr.response)}else{Sr(null)}Tr=null};Tr.onerror=function(Wr){Br(Wr,2);Sr(null)};Tr.responseType=Or;Tr.open(Nr,Pr,true);Tr.send(Qr)}Ar["_name"]="Time";Br["_name"]="Track";Cr["_name"]="Fetch";Dr["_name"]="Request";return[Ar,Br,Cr,Dr]});MiaokitMerge(function(Xr){if("Unity"!==Xr["m_pConfig"]["ENGINE"]){return[]}if(!UnityLoader){return[]}var Yr=Xr["m_pLogo"]||"data:image/png;base64,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";UnityLoader.Progress.Styles.Dark.progressLogoUrl=Yr;UnityLoader.Progress.Styles.Light.progressLogoUrl=Yr;if(UnityLoader.SystemInfo.mobile){UnityLoader.SystemInfo.mobile=false;UnityLoader.downloadJob=function(es,fs){var gs=new XMLHttpRequest;gs.open("GET",fs.parameters.url);gs.responseType="arraybuffer";gs.onload=function(){UnityLoader.Compression.decompress(new Uint8Array(gs.response),function(hs){fs.complete(hs)})};if(fs.parameters.onprogress)gs.addEventListener("progress",fs.parameters.onprogress);if(fs.parameters.onload)gs.addEventListener("load",fs.parameters.onload);gs.send()}}UnityLoader.processWasmFrameworkJob=function(is,js){var ks=UnityLoader.Job.result(is,"downloadWasmFramework");UnityLoader.loadCode(is,ks,function(ls,ms){is["mainScriptUrlOrBlob"]=ms;if(is.isModularized){UnityLoader[ls]=UnityModule}is["instantiateWasm"]=function(ns,os){as(is,ns["env"]);if(is["wasmBinary"]){WebAssembly.instantiate(is["wasmBinary"],ns).then(function(ps){os(ps.instance,ps.module)})}else{console.info("MiaokitLoader.InitUnity.instantiateWasm error!")}return{}};UnityLoader[ls](is);js.complete()},{Module:is,url:is["wasmFrameworkUrl"],isModularized:is.isModularized})};var Zr=null;var $r=null;var _r={};function as(qs,rs){Object["assign"](rs,{_Init:function(ss,ts){Xr["WASM"]["m_pMemory"]=Xr["WASM"]["m_pMemory"]||$r.Module.wasmMemory;bs(qs,_r,ss,ts);cs($r,_r);Zr.OnEngineLoad(_r)},_RenderingEvent:function(us){Zr.OnRenderingEvent(us)}});Xr["GL"]=rs}function bs(vs,ws,xs,ys){var zs=Xr.WASM.GetString(xs,ys);var As=JSON.parse(zs);var Bs=function(Fs){var Gs=function(){var Hs=Array.prototype.slice.call(arguments);Hs.unshift(Gs["m_nAddr"]);return Gs["m_pFunc"].apply(this,Hs)};Gs["m_pFunc"]=vs[Fs.Call];Gs["m_nAddr"]=Fs.Addr;ws[Fs.Name]=Gs};for(var Cs=0,Ds=As.List;Cs<Ds.length;Cs++){var Es=Ds[Cs];Bs(Es)}}function cs(Is,Js){Js["APP_PLUGIN_TYPE"]=function(){return 1};Js["APP_MEM_TYPE"]=function(){return 1};Js["memory"]=function(Ks){var Ls=32*1024*1024;var Ms=Ks._memalign(16,Ls);var Ns=Ls-Ms;Ks._free(Ms);var Os=Ks._memalign(16,Ns+Ls);if(Os!==Ms){console.error("miaokit.prememory: addr error",Ms,Os);return}if(Os+Ns+Ls!==67108864){console.error("miaokit.prememory: addr end error",Os+Ns+Ls);return}Js["APP_MEM_RESERVE"]=function(){return Os};return Ks.wasmMemory}($r.Module);Js["APP_MEM_MALLOC"]=function(Ps){return $r.Module._memalign(16,Ps)};Js["APP_MEM_FREE"]=function(Qs){$r.Module._free(Qs)};Js["APP_MEM_BASE"]=function(){alert("UNITY��չ��֧��ʹ�������ڴ�!");return 0};Js["APP_MEM_GROW"]=function(Rs){alert("UNITY��չ��֧��ʹ�������ڴ�!");return 0};Js["APP_MEM_RECYCLE"]=function(Ss){alert("UNITY��չ��֧��ʹ�������ڴ�!");return 0}}function ds(Ts){Zr=Ts;$r=UnityLoader.instantiate("unityContainer",Xr["m_pConfig"]["UNITY"])}Xr["WASM"]=Xr["WASM"]||{};Xr["WASM"]["LoadEngine"]=ds;return[]});MiaokitMerge(function(Us){var Vs=undefined;var Ws=new TextDecoder("utf-8");var Xs=new TextEncoder;function Ys(Zs){if(!Vs||Us["WASM"].m_pMemory.buffer.byteLength!==Vs[0].byteLength){if(!Vs){Vs=[]}Vs[0]=new Int8Array(Us["WASM"].m_pMemory.buffer);Vs[1]=new Uint8Array(Us["WASM"].m_pMemory.buffer);Vs[2]=new Int16Array(Us["WASM"].m_pMemory.buffer);Vs[3]=new Uint16Array(Us["WASM"].m_pMemory.buffer);Vs[4]=new Int32Array(Us["WASM"].m_pMemory.buffer);Vs[5]=new Uint32Array(Us["WASM"].m_pMemory.buffer);Vs[6]=new Float32Array(Us["WASM"].m_pMemory.buffer);Vs[7]=new Float64Array(Us["WASM"].m_pMemory.buffer)}return Vs[Zs]}Us["WASM"]=Us["WASM"]||{};Us["WASM"]["HEAP8"]=function($s,_s){if($s===void 0){$s=0}if(_s===void 0){_s=0}var at=Ys(0);if($s&&_s){return at.subarray($s,$s+_s)}else{return at}};Us["WASM"]["HEAPU8"]=function(bt,ct){if(bt===void 0){bt=0}if(ct===void 0){ct=0}var dt=Ys(1);if(bt&&ct){return dt.subarray(bt,bt+ct)}else{return dt}};Us["WASM"]["HEAP16"]=function(et,ft){if(et===void 0){et=0}if(ft===void 0){ft=0}var gt=Ys(2);if(et&&ft){return gt.subarray(et/2,(et+ft)/2)}else{return gt}};Us["WASM"]["HEAPU16"]=function(ht,it){if(ht===void 0){ht=0}if(it===void 0){it=0}var jt=Ys(3);if(ht&&it){return jt.subarray(ht/2,(ht+it)/2)}else{return jt}};Us["WASM"]["HEAP32"]=function(kt,lt,mt){if(kt===void 0){kt=0}if(lt===void 0){lt=0}var nt=Ys(4);if(kt&&lt){if(mt){return nt.slice(kt/4,(kt+lt)/4)}else{return nt.subarray(kt/4,(kt+lt)/4)}}else{return nt}};Us["WASM"]["HEAPU32"]=function(ot,pt){if(ot===void 0){ot=0}if(pt===void 0){pt=0}var qt=Ys(5);if(ot&&pt){return qt.subarray(ot/4,(ot+pt)/4)}else{return qt}};Us["WASM"]["HEAPF32"]=function(rt,st,tt){if(rt===void 0){rt=0}if(st===void 0){st=0}var ut=Ys(6);if(rt&&st){if(tt){return ut.slice(rt/4,(rt+st)/4)}else{return ut.subarray(rt/4,(rt+st)/4)}}else{return ut}};Us["WASM"]["HEAPF64"]=function(vt,wt){if(vt===void 0){vt=0}if(wt===void 0){wt=0}var xt=Ys(7);if(vt&&wt){return xt.subarray(vt/8,(vt+wt)/8)}else{return xt}};Us["WASM"]["GetString"]=function(yt,zt){if(!zt){var At=Us["WASM"].HEAPU8();var Bt=yt;while(0!==At[Bt++]);zt=Bt-yt-1}var Ct=Us["WASM"].HEAPU8(yt,zt);var Dt=Ws.decode(Ct);return Dt};Us["WASM"]["SetString"]=function(Et,Ft){var Gt=Xs.encode(Ft);var Ht=Us["WASM"].HEAPU8(Et,Gt.byteLength);Ht.set(Gt)};Us["WASM"]["EncodeString"]=function(It){return Xs.encode(It)};Us["WASM"]["m_pMemory"]=null;return[]});