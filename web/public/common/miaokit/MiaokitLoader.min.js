var MiaokitModule=function(a,b){var c=this;c["m_pConfigPath"]=b;c["m_pConfig"]={ENGINE:a};c["Merge"](c);c["Preload"]()};var MiaokitMerge=function(d){var e=[];d["Merge"]=d["Merge"]||function(f){for(var g=0,h=e;g<h.length;g++){var i=h[g];var j=i(f);if(j){for(var k=0,l=j;k<l.length;k++){var m=l[k];f[m._name]=m}}}};return function(n){e.push(n)}}(MiaokitModule.prototype);MiaokitMerge(function(o){var p=undefined;var q=undefined;var r={};var s=function(u,v){if(v===void 0){v=undefined}var w=0;this.length=u(-1);this[Symbol.iterator]=function(){return{next:function(){var x=u(w);if(x){var y=p(x);w=v?w+1:y.m_nObject;return{value:y,done:false}}return{value:undefined,done:true}}}}};r["Transform"]=function(z){Object.defineProperty(z,"position",{get:function(){var A=this["_GetPosition"]()/4;var B=o["WASM"].HEAPF32();return{x:B[A],y:B[A+1],z:B[A+2]}},set:function(C){this["_SetPosition"](C.x,C.y,C.z)}});Object.defineProperty(z,"euler",{get:function(){var D=this["_GetEuler"]()/4;var E=o["WASM"].HEAPF32();return{x:E[D],y:E[D+1],z:E[D+2]}},set:function(F){this["_SetEuler"](F.x,F.y,F.z)}});Object.defineProperty(z,"rotation",{get:function(){var G=this["_GetRotation"]()/4;var H=o["WASM"].HEAPF32();return{x:H[G],y:H[G+1],z:H[G+2],w:H[G+3]}},set:function(I){this["_SetRotation"](I.x,I.y,I.z,I.w)}});Object.defineProperty(z,"scale",{get:function(){var J=this["_GetScale"]()/4;var K=o["WASM"].HEAPF32();return{x:K[J],y:K[J+1],z:K[J+2]}},set:function(L){this["_SetScale"](L.x,L.y,L.z)}});Object.defineProperty(z,"localPosition",{get:function(){var M=this["_GetLocalPosition"]()/4;var N=o["WASM"].HEAPF32();return{x:N[M],y:N[M+1],z:N[M+2]}},set:function(O){this["_SetLocalPosition"](O.x,O.y,O.z)}});Object.defineProperty(z,"localEuler",{get:function(){var P=this["_GetLocalEuler"]()/4;var Q=o["WASM"].HEAPF32();return{x:Q[P],y:Q[P+1],z:Q[P+2]}},set:function(R){this["_SetLocalEuler"](R.x,R.y,R.z)}});Object.defineProperty(z,"localRotation",{get:function(){var S=this["_GetLocalRotation"]()/4;var T=o["WASM"].HEAPF32();return{x:T[S],y:T[S+1],z:T[S+2],w:T[S+3]}},set:function(U){this["_SetLocalRotation"](U.x,U.y,U.z,U.w)}});Object.defineProperty(z,"localScale",{get:function(){var V=this["_GetLocalScale"]()/4;var W=o["WASM"].HEAPF32();return{x:W[V],y:W[V+1],z:W[V+2]}},set:function(X){this["_SetLocalScale"](X.x,X.y,X.z)}});Object.defineProperty(z,"right",{get:function(){var Y=this["_GetRight"]()/4;var Z=o["WASM"].HEAPF32();return{x:Z[Y],y:Z[Y+1],z:Z[Y+2]}},set:function($){this["_SetRight"]($.x,$.y,$.z)}});Object.defineProperty(z,"up",{get:function(){var _=this["_GetUp"]()/4;var aa=o["WASM"].HEAPF32();return{x:aa[_],y:aa[_+1],z:aa[_+2]}},set:function(){var ba=this["_SetUp"]()/4;var ca=o["WASM"].HEAPF32();return{x:ca[ba],y:ca[ba+1],z:ca[ba+2]}}});Object.defineProperty(z,"forward",{get:function(){var da=this["_GetForward"]()/4;var ea=o["WASM"].HEAPF32();return{x:ea[da],y:ea[da+1],z:ea[da+2]}},set:function(){var fa=this["_SetForward"]()/4;var ga=o["WASM"].HEAPF32();return{x:ga[fa],y:ga[fa+1],z:ga[fa+2]}}});Object.defineProperty(z,"regionPosition",{get:function(){var ha=this["_GisToWorld"]()/4;var ia=o["WASM"].HEAPF32();return{x:ia[ha],y:ia[ha+1],z:ia[ha+2]}}});z["Rotate"]=function(ja,ka){this["_Rotate"](ja.x,ja.y,ja.z,ka)};z["Rotate2"]=function(la,ma,na){this["_Rotate2"](la.x,la.y,la.z,ma,na)};z["Translate"]=function(oa,pa){this["_Translate"](oa.x,oa.y,oa.z,pa)};z["TransformPoint"]=function(qa){var ra=this["_TransformPoint"](qa.x,qa.y,qa.z)/4;var sa=o["WASM"].HEAPF32();return{x:sa[ra],y:sa[ra+1],z:sa[ra+2]}}};r["GameObject"]=function(ta){Object.defineProperty(ta,"name",{get:function(){if(!this._name){var ua=this._GetName(0);var va=this._GetName(1);this._name=o["WASM"].GetString(va,ua)}return this._name}});Object.defineProperty(ta,"transform",{get:function(){return p(this["_GetTransform"]())}});Object.defineProperty(ta,"mesh",{get:function(){return p(this["_GetMesh"]())},set:function(wa){this["_SetMesh"](wa.m_nObject)}});Object.defineProperty(ta,"children",{get:function(){var xa=this;return new s(function(ya){return xa._IterChild(ya)},true)}});Object.defineProperty(ta,"parent",{get:function(){return p(this["_GetParent"]())}});Object.defineProperty(ta,"data",{get:function(){return p(this["_GetUserData"]())},set:function(za){}});Object.defineProperty(ta,"enableCollider",{set:function(Aa){this["_EnableCollider"](Aa)}});Object.defineProperty(ta,"active",{set:function(Ba){this["_Active"](Ba)}});Object.defineProperty(ta,"highlight",{set:function(Ca){this["_Highlight"](Ca)}});Object.defineProperty(ta,"transparent",{set:function(Da){console.warn("transparent discard!")}});Object.defineProperty(ta,"opacity",{set:function(Ea){this["_Transparent"](Ea)}});ta["Destory"]=function(){this["_Destory"]()};o["GameObject"]=function(){return p(ta._GameObject())}};r["Miaokit"]=function(Fa){Fa["LoadTile"]=function(Ga){var Ha=this["_Malloc"](Ga.byteLength);if(Ha){o["WASM"]["HEAPU8"](Ha,Ga.byteLength).set(new Uint8Array(Ga));var Ia=this["_LoadTile"](Ha,Ga.byteLength);var Ja=p(Ia);return Ja}return null};Fa["Analyze"]=function(Ka){var La=this["_Analyze"]();var Ma=o["WASM"].HEAP32()[La/4];var Na=o["WASM"].GetString(La+4,Ma);try{var Oa=JSON.parse(Na);var Pa=q(Ka).concat(Oa);return Pa}catch(Qa){console.log(Na)}return null};Fa["PickEntity"]=function(Ra){return p(this["_PickEntity"](Ra))};Fa["GetScene"]=function(Sa){return p(this["_GetScene"](Sa))};Fa["LngLatToGis"]=function(Ta,Ua,Va){var Wa=this["_LngLatToGis"](Ta.x,Ta.y,Ua.x,Ua.y,Ua.z,Va)/4;var Xa=o["WASM"].HEAPF32();return{x:Xa[Wa],y:Xa[Wa+1],z:Xa[Wa+2]}};Fa["GisToWorld"]=function(Ya){var Za=this["_GisToWorld"](Ya.x,Ya.y,Ya.z)/4;var $a=o["WASM"].HEAPF32();return{x:$a[Za],y:$a[Za+1],z:$a[Za+2]}};Fa["WorldToScreenPoint"]=function(_a){var ab=this["_WorldToScreenPoint"](_a.x,_a.y,_a.z)/4;var bb=o["WASM"].HEAPF32();return{x:bb[ab],y:bb[ab+1],z:bb[ab+2]}};Fa["ScreenPointToRay"]=function(cb){var db=this["_ScreenPointToRay"](cb.x,cb.y,cb.z)/4;var eb=o["WASM"].HEAPF32();return{m_mOrigin:{x:eb[db],y:eb[db+1],z:eb[db+2]},m_mDirection:{x:eb[db+4],y:eb[db+5],z:eb[db+6]}}};Object.defineProperty(Fa,"camera",{get:function(){return p(this["_GetCamera"]())}});Object.defineProperty(Fa,"cameraMode",{set:function(fb){this["_SetCameraMode"](fb)}});Object.defineProperty(Fa,"gis",{get:function(){if(!this._gis){this._gis=r["Gis"]["g_pIns"]}return this._gis}});Object.defineProperty(Fa,"panoramas",{get:function(){if(!this._panoramas){this._panoramas=r["Panoramas"]["g_pIns"]}return this._panoramas}});Object.defineProperty(Fa,"progress",{get:function(){return this["_GetProgress"]()}})};r["Mesh"]=function(gb){gb["SetVertices"]=function(hb,ib){this["m_aVertex"]=this["m_aVertex"]||[];this["m_aVertex"].push({m_pArray:ib,m_nSlot:this["_SlotLut"][hb],m_nItemSize:this["_SizeLut"][hb]})};gb["SetIndices"]=function(jb,kb,lb){this["m_aIndex"]=this["m_aIndex"]||[];this["m_aIndex"][jb]={m_pArray:kb,m_nItemSize:lb}};gb["Apply"]=function(){var mb=this["m_aVertex"];var nb=this["m_aIndex"];if(!mb||!nb){return}var ob=2+2*mb.length+3*nb.length;var pb=this._CreateBuffer(ob);var qb=o["WASM"]["HEAP32"](pb,ob*4);var rb=0;qb[rb++]=mb.length;qb[rb++]=nb.length;for(var sb=0;sb<mb.length;sb++){qb[rb++]=mb[sb].m_nSlot;qb[rb++]=mb[sb].m_pArray.length/mb[sb].m_nItemSize}for(var sb=0;sb<nb.length;sb++){qb[rb++]=0;qb[rb++]=0;qb[rb++]=nb[sb].m_pArray.length}this._CreateBuffer(0);for(var sb=0;sb<mb.length;sb++){var tb=mb[sb].m_pArray;var ub=this._GetVertexBuffer(sb);var vb=o["WASM"]["HEAPF32"](ub,tb.length*4);vb.set(tb)}for(var sb=0;sb<nb.length;sb++){var tb=nb[sb].m_pArray;var ub=this._GetIndexBuffer(sb);var vb=o["WASM"]["HEAP32"](ub,tb.length*4);vb.set(tb)}this._Apply();this["m_aVertex"]=undefined;this["m_aIndex"]=undefined};gb["_SlotLut"]={position:0,normal:1,uv:2,color:3,tangent:4,uv2:9,uv3:10,uv4:11,uv5:12,uv6:13,uv7:14,uv8:15};gb["_SizeLut"]={position:3,normal:3,uv:2,color:4,tangent:4,uv2:2,uv3:2,uv4:2,uv5:2,uv6:2,uv7:2,uv8:2};Object.defineProperty(gb,"position",{set:function(wb){this.SetVertices("position",wb)}});Object.defineProperty(gb,"normal",{set:function(xb){this.SetVertices("normal",xb)}});Object.defineProperty(gb,"uv",{set:function(yb){this.SetVertices("uv",yb)}});Object.defineProperty(gb,"triangles",{set:function(zb){this.SetIndices(0,zb)}});Object.defineProperty(gb,"material",{set:function(Ab){this.SetMaterial(0,Ab)}});o["Mesh"]=function(){return p(gb._Mesh())}};r["Texture2D"]=function(Bb){Bb["SetImageData"]=function(Cb){var Db=this._CreateBuffer(Cb.byteLength);if(Db){o["WASM"]["HEAPU8"](Db,Cb.byteLength).set(new Uint8Array(Cb));this._Apply()}};Bb["Load"]=function(Eb){var Fb=this;o["Fetch"](Eb,function(Gb){if(Gb){Fb.SetImageData(Gb)}})};o["Texture2D"]=function(Hb){var Ib=p(Bb._Texture2D());if(Hb){if("string"===typeof Hb){this.Load(Hb)}else{this.SetImageData(Hb)}}return Ib}};r["Material"]=function(Jb){if("Sisyphus"===o["m_pConfig"]["ENGINE"]){o["ShaderLab"].ExpandMaterial(Jb)}Jb["GetTexture"]=function(){return p(this["_GetTexture"]())};Jb["SetTexture"]=function(Kb){this["_SetTexture"](Kb.m_nObject)};o["Material"]=function(Lb){if(Lb===void 0){Lb=undefined}var Mb=null;if(Lb){var Nb=o["ShaderLab"]["Pipeline"]["InternalShader"];var Ob=Nb[0];Nb[0]=Lb;Mb=p(Jb._Material());Nb[0]=Ob}else{Mb=p(Jb._Material())}return Mb}};r["Tile"]=function(Pb){Object.defineProperty(Pb,"scenes",{get:function(){var Qb=this;return new s(function(Rb){return Qb._IterWork(Rb)})}});Object.defineProperty(Pb,"object3D",{get:function(){if(undefined===this._object3D){var Sb=this._GetObject(this.m_nObject);if(0===Sb){this._object3D=null;return null}this._object3D=p(Sb)}return this._object3D}})};r["Scene"]=function(Tb){Tb["GetLayer"]=function(Ub){return p(this["_GetLayer"](Ub))};Object.defineProperty(Tb,"id",{get:function(){if(!this._id){var Vb=this._GetID(0);var Wb=this._GetID(1);this._id=o["WASM"].GetString(Wb,Vb)}return this._id}});Object.defineProperty(Tb,"layers",{get:function(){var Xb=this;return new s(function(Yb){return Xb._IterLayer(Yb)})}});Object.defineProperty(Tb,"object3D",{get:function(){if(undefined===this._object3D){var Zb=this._GetObject(this.m_nObject);if(0===Zb){this._object3D=null;return null}this._object3D=p(Zb)}return this._object3D}});Object.defineProperty(Tb,"viewState",{get:function(){return{m_mTarget:{x:0,y:0,z:0},m_nPitch:45,m_nYaw:0,m_nDistance:60,m_mOrthoTarget:{x:0,y:0,z:0},m_nOrthoScaled:0,m_nOrthoRotate:0}}});Object.defineProperty(Tb,"binding",{get:function(){return p(this._GetBinding())}})};r["Layer"]=function($b){Object.defineProperty($b,"id",{get:function(){if(!this._id){var _b=this._GetID(0);var ac=this._GetID(1);this._id=o["WASM"].GetString(ac,_b)}return this._id}});Object.defineProperty($b,"sites",{get:function(){var bc=this;return new s(function(cc){return bc._IterSite(cc)})}});Object.defineProperty($b,"object3D",{get:function(){if(undefined===this._object3D){var dc=this._GetObject(this.m_nObject);if(0===dc){this._object3D=null;return null}this._object3D=p(dc)}return this._object3D}});Object.defineProperty($b,"viewState",{get:function(){var ec=this["_GetViewState"]();if(0<ec){var fc=o["WASM"]["HEAPF32"](ec,4*11);var gc=0;return{m_mTarget:{x:fc[gc++],y:fc[gc++],z:fc[gc++]},m_nPitch:fc[gc++],m_nYaw:fc[gc++],m_nDistance:fc[gc++],m_mOrthoTarget:{x:fc[gc++],y:fc[gc++],z:fc[gc++]},m_nOrthoScaled:fc[gc++],m_nOrthoRotate:fc[gc++]}}return null}})};r["Attachment"]=function(hc){Object.defineProperty(hc,"entityType",{get:function(){return this._GetEntityType()}});Object.defineProperty(hc,"secondType",{get:function(){return this._GetSecondType()}});Object.defineProperty(hc,"flag",{get:function(){return this._GetFlag()}});Object.defineProperty(hc,"object3D",{get:function(){return p(this._GetObject())}});Object.defineProperty(hc,"viewState",{get:function(){var ic=this["_GetViewState"]();if(0<ic){var jc=o["WASM"]["HEAPF32"](ic,4*11);var kc=0;var lc={m_mTarget:{x:jc[kc++],y:jc[kc++],z:jc[kc++]},m_nPitch:jc[kc++],m_nYaw:jc[kc++],m_nDistance:jc[kc++],m_mOrthoTarget:{x:jc[kc++],y:jc[kc++],z:jc[kc++]},m_nOrthoScaled:jc[kc++],m_nOrthoRotate:jc[kc++]};console.log("attachment view:",lc);return lc}else{console.log("attachment view: null")}return null}})};r["Site"]=function(mc){Object.defineProperty(mc,"id",{get:function(){if(!this._id){var nc=this._GetID(0);var oc=this._GetID(1);this._id=o["WASM"].GetString(oc,nc)}return this._id}});Object.defineProperty(mc,"layer",{get:function(){return p(this["_Layer"]())}});Object.defineProperty(mc,"scene",{get:function(){return p(this["_Scene"]())}});Object.defineProperty(mc,"type",{get:function(){return this["_Type"]()}});Object.defineProperty(mc,"number",{get:function(){return this["_Number"]()}});Object.defineProperty(mc,"position",{get:function(){var pc=this["_Position"]()/4;var qc=o["WASM"].HEAPF32();return{x:qc[pc],y:qc[pc+1],z:qc[pc+2]}}})};r["Prefab"]=function(rc){rc["Instantiate"]=function(){return p(this["_Instantiate"]())};o["LoadPrefab"]=function(sc,tc){o["Fetch"](sc,function(uc){var vc=null;if(uc){var wc=rc._Prefab();var xc=p(wc);var yc=xc.CreateBuffer(uc.byteLength);if(yc){o["WASM"]["HEAPU8"](yc,uc.byteLength).set(new Uint8Array(uc));xc.Apply();vc=xc}}tc(vc)})}};r["Gis"]=function(zc){zc["Update"]=function(Ac,Bc,Cc){return this["_Update"](Ac,Bc,Cc)};zc["AddSvetile"]=function(Dc){var Ec=o["WASM"]["EncodeString"](Dc.m_pUrl);var Fc=this["_CreateSvetileDesc"](Ec.byteLength);var Gc=o["WASM"]["HEAPU32"](Fc,4*8);Gc[0]=Dc.m_nID;Gc[1]=Dc.m_nFlags;o["WASM"]["HEAPU8"](Gc[2],Ec.byteLength).set(Ec,0);Gc[3]=0;Gc[4]=o["WASM"]["RegisterDelegate"](function(Ic,Jc){Dc.OnActive(p(Ic),0<Jc)});var Hc=o["WASM"]["HEAPF32"](Fc+20,16);Hc[0]=Dc.m_mLngLat.x;Hc[1]=Dc.m_mLngLat.y;Hc[2]=Dc.m_mSize.x;Hc[3]=Dc.m_mSize.y;this["_AddSvetile"](Fc)};zc["AddMapbox"]=function(Kc){var Lc=this["_GetMapboxDesc"]();var Mc=o["WASM"]["HEAPF32"](Lc,40);Mc[0]=Kc.m_mOffset.x;Mc[1]=Kc.m_mOffset.y;Mc[2]=Kc.m_mOffset.z;Mc[3]=Kc.m_mScale.x;Mc[4]=Kc.m_mScale.y;Mc[5]=Kc.m_mScale.z;Mc[6]=Kc.m_mLngLat.x;Mc[7]=Kc.m_mLngLat.y;Mc[8]=Kc.m_mSize.x;Mc[9]=Kc.m_mSize.y;this["_AddMapbox"](Lc)};zc["AddGameObject"]=function(Nc,Oc,Pc,Qc){this["_AddGameObject"](Nc.m_nObject,Oc,Pc,Qc)};Object.defineProperty(zc,"terrainServer",{set:function(Rc){if(!Rc){Rc="https://t%d.tianditu.gov.cn/DEM/DataServer?T=ele_c&tk=3d26628c3a0e2694fecfbbb983ff7d87&x=%d&y=%d&l=%d"}var Sc=this["_GetServer"](0);o["WASM"].SetString(Sc,Rc)}});Object.defineProperty(zc,"imageServer",{set:function(Tc){if(!Tc){Tc="http://t%d.tianditu.gov.cn/DataServer?T=img_c&tk=3d26628c3a0e2694fecfbbb983ff7d87&x=%d&y=%d&l=%d"}var Uc=this["_GetServer"](1);o["WASM"].SetString(Uc,Tc)}});Object.defineProperty(zc,"labelServer",{set:function(Vc){if(!Vc){Vc="http://t%d.tianditu.gov.cn/DataServer?T=cia_c&tk=3d26628c3a0e2694fecfbbb983ff7d87&x=%d&y=%d&l=%d"}var Wc=this["_GetServer"](2);o["WASM"].SetString(Wc,Vc)}})};r["Panoramas"]=function(Xc){Xc["Open"]=function(Yc){if(!Yc.m_mGisPos){Yc.m_mGisPos=o.Miaokit.LngLatToGis(Yc.m_mLngLat,Yc.m_nOffset,Yc.m_nHeight)}this["_Open"](Yc.m_mGisPos.x,Yc.m_mGisPos.y,Yc.m_mGisPos.z);var Zc=Yc.m_pPath;var $c=["r","f","l","b","d","u"];for(var _c=0;_c<6;_c++){for(var ad=0;ad<2;ad++){var bd=function(gd){var hd=cd;var id=_c;var jd=1;var kd=ad;var ld=gd;var md=o["GL"]["ImageCache"].CreateImage();var nd=o["GL"]["ImageCache"].Get(md);var od=Zc+"l"+jd+"_"+$c[id]+"_0"+(1+kd)+"_0"+(2-ld)+".jpg";console.log(id,jd,kd,ld,od);nd.crossOrigin="anonymous";nd.src=od;nd.onload=function(pd){console.log(id,jd,kd,ld,99);hd["_SetImage"](id,jd,kd,ld,md)}};var cd=this;for(var dd=0;dd<2;dd++){bd(dd)}}if(4==_c){for(var ad=0;ad<4;ad++){var ed=function(qd){var rd=fd;var sd=_c;var td=2;var ud=ad;var vd=qd;var wd=o["GL"]["ImageCache"].CreateImage();var xd=o["GL"]["ImageCache"].Get(wd);var yd=Zc+"l"+td+"_"+$c[sd]+"_0"+(1+ud)+"_0"+(4-vd)+".jpg";console.log(sd,td,ud,vd,yd);xd.crossOrigin="anonymous";xd.src=yd;xd.onload=function(zd){console.log(sd,td,ud,vd,99);rd["_SetImage"](sd,td,ud,vd,wd)}};var fd=this;for(var dd=0;dd<4;dd++){ed(dd)}}}}};Xc["ScreenPoint"]=function(Ad){if(!Ad.m_mGisPos){Ad.m_mGisPos=o.Miaokit.LngLatToGis(Ad.m_mLngLat,Ad.m_nOffset,Ad.m_nHeight)}var Bd=o.Miaokit.GisToWorld(Ad.m_mGisPos);var Cd=o.Miaokit.WorldToScreenPoint(Bd);return Cd}};r["Dioramas3MX"]=function(Dd){Dd["_Load3MX"]=function(Ed,Fd,Gd){var Hd=this;var Id=Hd.m_pFileLut[Ed];var Jd=Id.m_pPath+Id.m_aFile[Fd];o["Request"]("GET","arraybuffer",Jd,null,null,function(Kd){if(!Kd){return}var Ld=new Uint32Array(Kd,0,2);if(1113083187===Ld[0]){var Md=Ld[1]>>8;var Nd=9+Md;var Od=Kd.byteLength-Nd;var Pd=new Uint8Array(Kd,9,Md);var Qd=Hd.m_pTextDecoder.decode(Pd);var Rd=JSON.parse(Qd);var Sd={m_pPath:Jd.substring(0,Jd.lastIndexOf("/")+1),m_aFile:[]};var Td=[];var Ud=[];var Vd=Rd.resources;var Wd=0;for(var Xd=0;Xd<Vd.length;Xd++){Td.push(Xd);if("textureBuffer"===Vd[Xd].type){Td.push(0);Ud.push(Xd);if("jpg"===Vd[Xd].format){Td.push(0)}else if("png"===Vd[Xd].format){Td.push(1)}else{Td.push(1e4)}}else if("geometryBuffer"===Vd[Xd].type){Td.push(1);if("ctm"===Vd[Xd].format){Td.push(0)}else{Td.push(1e4)}}else{Td.push(1e4);Td.push(1e4)}Td.push(Vd[Xd].size);Td.push(Wd);Wd+=Vd[Xd].size;Td.push(1e4);if(Vd[Xd].texture){for(var Yd=0;Yd<Vd.length;Yd++){if(Vd[Xd].texture===Vd[Yd].id){Td[Td.length-1]=Yd;break}}}}var Zd=[];var $d=Rd.nodes;for(var Xd=0;Xd<$d.length;Xd++){var _d=$d[Xd];var ae=_d.bbMax[0]-_d.bbMin[0];var be=_d.bbMax[1]-_d.bbMin[1];var ce=_d.bbMax[2]-_d.bbMin[2];var de=Math.sqrt(ae*ae+be*be+ce*ce);Zd.push(Math.floor(parseInt(_d.bbMin[0]+_d.bbMax[0])*.5*100));Zd.push(Math.floor(parseInt(_d.bbMin[1]+_d.bbMax[1])*.5*100));Zd.push(Math.floor(parseInt(_d.bbMin[2]+_d.bbMax[2])*.5*100));Zd.push(Math.floor(de*100));Zd.push(Math.floor(_d.maxScreenDiameter));var ee=_d.children?_d.children.length:0;if(0<ee){Zd.push(Sd.m_aFile.length);for(var Yd=0;Yd<ee;Yd++){Sd.m_aFile.push(_d.children[Yd])}Zd.push(Sd.m_aFile.length)}else{Zd.push(-1);Zd.push(-1)}var fe=_d.resources?_d.resources.length:0;if(0<fe){Zd.push(Ud.length);for(var Yd=0;Yd<fe;Yd++){for(var ge=0;ge<Vd.length;ge++){if(_d.resources[Yd]===Vd[ge].id){Ud.push(ge);break}}}Zd.push(Ud.length)}else{Zd.push(-1);Zd.push(-1)}}var he=4+9*$d.length+6*Ud.length;var ie=4*he;var je=ie+Od;var ke=Hd["_CreateBuffer"](je);if(ke){var le=o["WASM"]["HEAP32"](ke,ie);le[0]=ie;le[1]=$d.length;le[2]=Ud.length;le[3]=Hd.m_pFileLut.length;le.set(Zd,4);var me=4+Zd.length;for(var Xd=0;Xd<Ud.length;Xd++){var ne=6*Ud[Xd];for(var Yd=0;Yd<6;Yd++){le[me++]=Td[ne++]}}var oe=o["WASM"]["HEAPU8"](ke+ie,Od);oe.set(new Uint8Array(Kd,Nd,Od));Hd["_Dispose"](Gd)}Hd.m_pFileLut.push(Sd)}})};Dd["Update"]=function(){return this["_Update"]()};Object.defineProperty(Dd,"object3D",{get:function(){return p(this["_GetObject"]())}});o["Dioramas3MX"]=function(pe,qe){var re=p(Dd._Dioramas3MX());re.m_pFileLut=[];re.m_pTextDecoder=new TextDecoder("utf-8");if(qe){if(qe.m_pGis){qe.m_pGis.AddGameObject(re.object3D,qe.m_mLngLat.x,qe.m_mLngLat.y,qe.m_nHeight);re.object3D.transform.Translate(qe.m_mOffset,1);re.object3D.transform.Rotate({x:0,y:0,z:0},1)}}o["Request"]("GET","json",pe,null,null,function(se){re["m_pMeta"]=se;var te={m_pPath:pe.substring(0,pe.lastIndexOf("/")+1),m_aFile:[]};var ue=[0];for(var ve=0;ve<se.layers.length;ve++){if("meshPyramid"===se.layers[ve].type){ue.push(ve);ue.push(te.m_aFile.length);te.m_aFile.push(se.layers[ve].root)}}ue[0]=te.m_aFile.length;var we=re["_CreateBuffer"](4*ue.length);var xe=o["WASM"]["HEAP32"](we,4*ue.length);xe.set(ue);re["_Initialize"](we);re.m_pFileLut.push(te)});return re}};function t(ye,ze,Ae){p=ze;q=Ae;for(var Be=0,Ce=ye;Be<Ce.length;Be++){var De=Ce[Be];if(De){var Ee=De.prototype;if(r[Ee._type_name]){r[Ee._type_name](Ee)}if("Miaokit"===Ee._type_name){o["Miaokit"]=new De(0,0)}else if("Gis"===Ee._type_name){r["Gis"]["g_pIns"]=new De(0,0)}else if("Panoramas"===Ee._type_name){r["Panoramas"]["g_pIns"]=new De(0,0)}}}}o["WASM"]=o["WASM"]||{};o["WASM"]["LoadClass"]=t;return[]});MiaokitMerge(function(Fe){Fe["m_pLogo"]=null;var Ge=undefined;var He=false;var Ie=false;function Je(){Fe["Track"]("Preload");Fe["Request"]("GET","json",Fe["m_pConfigPath"],null,null,function(Me){if(!Me){Fe["Track"]("配置文件错误！",3);return}Fe["m_pConfig"]=Me;Fe["Fetch"](Me.MODULE,function(Pe){if(Ge){Ge(Pe)}else{Ge=Pe}});if(Me.SVE){var Ne=function(Qe){var Re=Me.SVE[Qe];Re.m_pData=null;Re.m_pTile=null;if(true===Re.m_bPreload){Fe["Fetch"](Re.m_pProject,function(Se){Re.m_pData=Se;if(Ie&&Se){Re.m_pTile=Fe["Miaokit"]["LoadTile"](Re.m_pData);Re.m_pData=null;Fe["App"]["ActiveTile"](Re)}})}};for(var Oe=0;Oe<Me.SVE.length;Oe++){Ne(Oe)}}if(Fe["App"]&&Fe["App"].m_pProject){Fe["App"]["Preload"]()}else{He=true}})}function Ke(Te,Ue){Fe["Track"]("LoadEngine");if(He){Fe["App"]["Preload"]();He=false}Fe["WASM"]["LoadEngine"]({OnEngineLoad:function(Ve){Fe["Track"]("LoadEngine End");if(Ge){Fe["Track"]("LoadMiaokit");Fe["WASM"]["LoadMiaokit"](Ge,Ve,function(){Te();Ie=true;Le()})}else{Fe["Track"]("LoadMiaokit Delay");Ge=function(We){Fe["Track"]("LoadMiaokit");Fe["WASM"]["LoadMiaokit"](We,Ve,function(){Te();Ie=true;Le()})}}},OnRenderingEvent:function(Xe){if(Ie){Ue(Xe)}}})}function Le(){Fe["Track"]("LoadMiaokit End");var Ye=Fe["m_pConfig"]["SVE"];if(Ye){for(var Ze=0,$e=Ye;Ze<$e.length;Ze++){var _e=$e[Ze];if(true===_e.m_bPreload){if(null===_e.m_pTile&&null!==_e.m_pData){_e.m_pTile=Fe["Miaokit"]["LoadTile"](_e.m_pData);_e.m_pData=null;Fe["App"]["ActiveTile"](_e)}}}}}Je["_name"]="Preload";Ke["_name"]="Load";return[Je,Ke]});MiaokitMerge(function(af){var bf=function(){function df(){}df.Clamp=function(ef,ff,gf){if(ef>gf){return gf}if(ef<ff){return ff}return ef};return df}();var cf=function(){function hf(jf,kf,lf){this.x=0;this.y=0;this.z=0;this.x=jf;this.y=kf;this.z=lf}hf.Scale=function(mf,nf){return{x:nf.x*mf,y:nf.y*mf,z:nf.z*mf}};return hf}();bf["_name"]="Mathf";cf["_name"]="Vector3";return[bf,cf]});MiaokitMerge(function(of){var pf=null;var qf=null;var rf=null;var sf=[null];var tf=null;var uf=[null];var vf=1;var wf=0;var xf=[undefined];var yf=null;var zf=null;function Af(Kf){Kf["isnanf"]=isNaN;Kf["isinff"]=isFinite;Kf["powf"]=Math.pow;Kf["sqrtf"]=Math.sqrt;Kf["expf"]=Math.exp;Kf["logf"]=Math.log;Kf["floorf"]=Math.floor;Kf["ceilf"]=Math.ceil;Kf["sinf"]=Math.sin;Kf["cosf"]=Math.cos;Kf["tanf"]=Math.tan;Kf["asinf"]=Math.asin;Kf["acosf"]=Math.acos;Kf["atanf"]=Math.atan;Kf["atan2f"]=Math.atan2;Kf["ldexpf"]=function(Lf,Mf){return Lf*Math.pow(2,Mf)}}function Bf(Nf){function Of(Yf){var Zf=of["WASM"].GetString(Yf);if(!Zf.startsWith("http")){Zf="./data/projects/sve/"+Zf}if(Zf.endsWith("assetbundle")){Zf+=".bin"}return Zf}function Pf($f,_f,ag,bg,cg){var dg=Of($f);var eg=pf.get(ag);var fg=pf.get(bg);of["Fetch"](dg,function(gg){if(gg){var hg=eg(_f,gg.byteLength,cg);if(hg){of["WASM"]["HEAPU8"](hg,gg.byteLength).set(new Uint8Array(gg))}}else{console.error("资源丢失:",dg)}fg(_f,cg)})}function Qf(ig,jg,kg,lg,mg){var ng=Of(ig);var og=pf.get(kg);var pg=tf.CreateImage();var qg=tf.Get(pg);qg.crossOrigin="anonymous";qg.src=ng;qg.onload=function(rg){og(jg,pg,mg)}}function Rf(sg,tg,ug,vg,wg){Pf(sg,tg,ug,vg,wg)}function Sf(xg,yg,zg,Ag,Bg){yf["LoadTerrain"](xg,yg,zg,Ag,Bg)}function Tf(Cg,Dg,Eg,Fg,Gg){var Hg=of["WASM"]["HEAP32"](Cg,16);yf["LoadBlockbox"](Dg,Hg[0],Hg[1],Hg[2],Hg[3],Eg,Fg)}function Uf(Ig,Jg){var Kg=of["WASM"]["HEAP32"](Ig,12);yf["Load3MX"](Kg[0],Kg[1],Kg[2],Jg)}function Vf(Lg,Mg,Ng,Og,Pg){Pf(Lg,Mg,Ng,Og,Pg)}function Wf(Qg,Rg,Sg,Tg){var Ug=pf.get(Tg);var Vg=of["WASM"]["HEAP8"](Sg,Rg);var Wg=new Blob([Vg]);var Xg=window.URL.createObjectURL(Wg);var Yg=tf.CreateImage();var Zg=tf.Get(Yg);Zg.src=Xg;Zg.onload=function($g){Ug(Qg,Yg);window.URL.revokeObjectURL(Xg)}}var Xf=[undefined,Pf,Qf,Rf,Sf,Tf,Uf,Vf,Wf];Nf["APP_LOAD"]=function(_g,ah,bh,ch,dh,eh){Xf[_g](ah,bh,ch,dh,eh)}}function Cf(fh){var gh={NaN:NaN,Infinity:Infinity};Af(fh);Bf(fh);fh["APP_DYNAMIC_LINK"]=function(hh,ih){var jh=of["WASM"]["HEAPU32"](hh,ih);var kh=jh[0];var lh=jh[1];for(var mh=0;mh<kh;mh++){var nh=jh[2+mh]-1;var oh=jh[lh++];var ph=jh[lh++];var qh=of["WASM"].GetString(oh,ph);var rh=JSON.parse(qh);var sh=function(wh,xh){this["m_nID"]=wh;this["m_nObject"]=xh};var th=sh.prototype;th["_type_name"]=rh[0];th["_type_id"]=mh+1;th["_ins_count"]=0;xf[mh+1]=sh;var uh=function(yh){var zh=pf.get(jh[lh++]);lh++;var Ah=function(){var Bh=Array.prototype.slice.call(arguments);Bh.unshift(this.m_nObject);return zh.apply(this,Bh)};if(0===yh){th["_"+rh[yh]]=Ah}else{th[rh[yh]]=Ah}};for(var vh=0;vh<nh;vh++){uh(vh)}}of["WASM"]["LoadClass"](xf,Ef,Hf);of["Miaokit"]["ResizeCavans"]=function(Ch,Dh){if(rf.SE_RESIZE){rf.SE_RESIZE(Ch,Dh)}}};fh["APP_PRINT"]=function(Eh,Fh,Gh){var Hh=of["WASM"].GetString(Eh,Fh);of["Track"](Hh,Gh)};fh["APP_DO_ACTION"]=function(Ih,Jh,Kh,Lh){sf[Ih](Jh,Kh,Lh)};fh["APP_CREATE_OBJ"]=function(Mh,Nh){var Oh=Ff();var Ph=new xf[Mh](Oh,Nh);uf[Oh]=Ph;xf[Mh].prototype._ins_count++;return Oh};fh["APP_FREE_OBJ"]=function(Qh){var Rh=uf[Qh];xf[Rh._type_id].prototype._ins_count--;Gf(Qh)};zf=of["ShaderLab"].APP_DO_OPERATORS;zf[7]=function(Sh,Th){if(0===Sh){tf.FreeImage(Th)}else if(1===Sh){tf.FreeBuffer(Th)}return 0};fh["APP_DO"]=function(Uh,Vh,Wh,Xh,Yh){return zf[Uh](Vh,Wh,Xh,Yh)};qf=fh["memory"];of["WASM"]["m_pMemory"]=of["WASM"]["m_pMemory"]||qf;return{env:fh,global:gh}}function Df(Zh,$h,_h){tf=of["GL"]["ImageCache"];$h=Cf($h);WebAssembly.instantiate(Zh,$h).then(function(ai){return ai.instance}).then(function(bi){rf=bi.exports;pf=rf.__indirect_function_table;of["WASM"]["Update"]=bi.exports.SE_UPDATE;of["WASM"]["Malloc"]=bi.exports.Malloc;of["WASM"]["Free"]=bi.exports.Free;of["ShaderLab"]["DrawPass_"]=bi.exports.SE_DRAW_PASS;of["ShaderLab"]["SetSunlight"]=bi.exports.SE_SUNLIGHT;of["ShaderLab"]["CreateUniformsDesc"]=bi.exports.SE_CREATE_UNIFORMS_DESC;of["ShaderLab"]["GetTexture"]=function(ci){return rf.SE_RESOURCE(9,ci)};of["ShaderLab"]["GetObject"]=function(di){var ei=rf.SE_RESOURCE(13,di);if(ei){return Ef(ei)}return null};of["Track"]("Start thread");of["WASM"]["Worker"]=Jf(function(){of["Track"]("Start thread succeed")});rf.Start();_h()})}function Ef(fi){return uf[fi]}function Ff(){var gi=vf;if(uf.length>vf){vf=uf[vf]}else{vf++}wf++;return gi}function Gf(hi){uf[hi]=vf;vf=hi;wf--}function Hf(ii){var ji="'系统运行':{";ji+="'时间':"+(of.Time()/1e3).toFixed(0);ji+=", '帧率':"+ii;ji+=", 'WASM内存':"+of.WASM.m_pMemory.buffer.byteLength/1024/1024;ji+="}";var ki="'JS对象':{";ki+="'工厂':["+uf.length+", "+wf+", "+(uf.length-wf)+"]";ki+=tf.Analyze();for(var li=1;li<xf.length;li++){ki+=", '"+xf[li].prototype._type_name+"':"+xf[li].prototype._ins_count}ki+="}";return[ji,ki]}function If(mi){var ni=sf.length;sf.push(mi);return ni}function Jf(oi){var pi=rf.UTIL_WORKER_CODE();var qi=of["WASM"]["HEAPU32"](pi,16);if(false){yf=new Worker(window.URL.createObjectURL(new Blob([of["WASM"]["HEAPU8"](qi[2],qi[3])])));var ri=of["WASM"]["HEAPU8"]().slice(qi[0],qi[0]+qi[1]);var si=ri.buffer;yf.postMessage({m_nID:1,m_aCode:si},[si])}else{var ti=of["m_pConfig"]["MODULE"].replace(".wasm","");yf=new Worker(ti+"Worker.min.js");fetch(ti+"Worker.wasm").then(function(ui){return ui.arrayBuffer()}).then(function(vi){if(vi){yf.postMessage({m_nID:1,m_aCode:vi},[vi])}else{console.error("fetch error: ./js/Miaokit/MiaokitWorker.wasm",vi)}}).catch(function(wi){console.error("fetch error: ./js/Miaokit/MiaokitWorker.wasm",wi)})}yf.onmessage=function(xi){var yi=xi.data;switch(yi.m_nID){case 1:oi();oi=null;break;case 2:yf["OnLoadTerrain"](yi);break;case 3:yf["OnLoadBlockbox"](yi);break;case 4:yf["OnLoad3MX"](yi);break;default:console.error("子线程消息异常:",yi);break}};yf["LoadTerrain"]=function(zi,Ai,Bi,Ci,Di){yf.postMessage({m_nID:2,m_pPath:of["WASM"].GetString(zi),m_nRequest:Ai,m_nCallback:Bi,m_nTS:Di})};yf["OnLoadTerrain"]=function(Ei){var Fi=pf.get(Ei.m_nCallback);var Gi=Ei.m_pData;var Hi=0;if(Gi){Hi=tf.PushBuffer(Gi)}else{console.warn("Terrain miss:",Ei.m_pPath)}Fi(Ei.m_nRequest,Hi,Ei.m_nTS)};yf["LoadBlockbox"]=function Ii(Ji,Ki,Li,Mi,Ni,Oi,Pi){yf.postMessage({m_nID:3,m_nRequest:Ji,m_nCol:Ki,m_nRow:Li,m_nColOffset:Mi,m_nRowOffset:Ni,m_nAlloc:Oi,m_nCallback:Pi})};yf["OnLoadBlockbox"]=function(Qi){var Ri=pf.get(Qi.m_nAlloc);var Si=pf.get(Qi.m_nCallback);var Ti=Qi.m_pData;var Ui=[0,0,0,0];for(var Vi=0;Vi<4;Vi++){var Wi=Ti[Vi];if(0<Wi.m_nVertexCount&&0<Wi.m_nSubmeshCount){var Xi=new of.Mesh;var Yi=new Int32Array(Wi.m_aIndex);Xi.position=new Float32Array(Wi.m_aPosition);Xi.normal=new Float32Array(Wi.m_aNormal);Xi.uv=new Float32Array(Wi.m_aUV);for(var Zi=0;Zi<Wi.m_nSubmeshCount;Zi++){var $i=Yi[2*Zi];var _i=Yi[2*Zi+1];var aj=[];for(var bj=$i;bj<_i;bj++){aj.push(bj)}Xi.SetIndices(Zi,new Int32Array(aj),4)}Xi.Apply();Ui[Vi]=Xi.m_nObject}else{Ui[Vi]=0}}var cj=Ri(Qi.m_nRequest,16);if(cj){of["WASM"]["HEAPU32"](cj,16).set(new Uint32Array(Ui));Si(Qi.m_nRequest)}};yf["Load3MX"]=function(dj,ej,fj,gj){var hj=Ef(dj);if(hj){var ij=hj.m_pFileLut[ej];var jj=ij.m_pPath+ij.m_aFile[fj];var kj=hj.m_pFileLut.length;hj.m_pFileLut.push(null);yf.postMessage({m_nID:4,m_nDior:dj,m_pPath:jj,m_nRequest:gj,m_nNewFolder:kj})}};yf["OnLoad3MX"]=function(lj){var mj=lj.m_pData;if(mj){var nj=Ef(lj.m_nDior);if(nj){nj.m_pFileLut[lj.m_nNewFolder]=lj.m_pNewFolder;var oj=new Int32Array(mj[0]);var pj=oj[1];var qj=oj[2];var rj=4+9*pj;var sj=0;var tj=[];var uj=function(){if(qj===++sj||0==qj){var xj=mj[0].byteLength;var yj=nj["_CreateBuffer"](xj);var zj=of["WASM"]["HEAP32"](yj,xj);zj.set(oj);nj["_Dispose"](lj.m_nRequest)}};var vj=function(Aj){var Bj=oj[rj+0];var Cj=oj[rj+1];if(0===Cj){var Dj=mj[1+Aj];if(null!==Dj){var Ej=tf.CreateImage();var Fj=tf.Get(Ej);var Gj=new Blob([new Int8Array(Dj)]);var Hj=window.URL.createObjectURL(Gj);Fj.src=Hj;Fj.onload=function(Lj){uj();window.URL.revokeObjectURL(Hj)};tj[Bj]=rf["SE_CREATE_INTERNAL_TEXTURE"]();oj[rj+3]=tj[Bj];oj[rj+4]=Ej}else{tj[Bj]=0;oj[rj+3]=tj[Bj];oj[rj+4]=0;uj()}}else if(1===Cj){oj[rj+4]=tj[oj[rj+5]];var Dj=mj[1+Aj];if(null!==Dj){var Ij=Dj.byteLength;var Jj=nj["_CreateBuffer"](Ij);var Kj=of["WASM"]["HEAP8"](Jj,Ij);Kj.set(new Int8Array(Dj));nj["_MarkBuilding"](Jj);tj[Bj]=rf["SE_CREATE_INTERNAL_MESH"](0,Jj);oj[rj+3]=tj[Bj];uj()}else{tj[Bj]=0;oj[rj+3]=tj[Bj];uj()}}else{tj[Bj]=0;oj[rj+3]=tj[Bj];oj[rj+4]=0;uj()}rj+=6};for(var wj=0;wj<qj;wj++){vj(wj)}if(0===qj){uj()}}}else{console.warn("3mx miss:",lj.m_pPath)}};return yf}of["WASM"]=of["WASM"]||{};of["WASM"]["LoadMiaokit"]=Df;of["WASM"]["GetObject"]=Ef;of["WASM"]["RegisterDelegate"]=If;return[]});MiaokitMerge(function(Mj){var Nj=null;var Oj=null;var Pj=null;var Qj=null;var Rj=null;var Sj=null;var Tj=null;var Uj=null;var Vj=null;var Wj=null;var Xj=null;var Yj=null;var Zj=null;var $j=null;var _j=null;var ak=null;var bk=0;var ck=function(){var ek=Mj.m_pConfig.WEBGL;var fk=Mj.m_pConfig.QUALITY;if(0===fk){Pj="\n                #define LOW_QUALITY\n            ";Qj="\n                #define LOW_QUALITY\n            "}else if(1===fk){Pj="\n                #define MEDIUM_QUALITY\n            ";Qj="\n                #define MEDIUM_QUALITY\n            "}else{Pj="\n                #define HIGH_QUALITY\n            ";Qj="\n                #define HIGH_QUALITY\n            "}if(1===ek){Nj="\n                precision highp float;\n                precision mediump sampler2D;\n\n                uniform lowp vec4 u_Sunlight;\n                uniform lowp vec4 u_Picker;\n                uniform lowp vec4 u_EyePos;\n                uniform lowp vec4 u_Mark;\n                uniform highp mat4 u_MatG;\n                uniform highp mat4 u_MatVP;\n            ";Oj="\n                precision highp float;\n                precision mediump sampler2D;\n\n                uniform lowp vec4 u_Sunlight;\n                uniform lowp vec4 u_Picker;\n                uniform lowp vec4 u_EyePos;\n                uniform lowp vec4 u_Mark;\n                uniform highp mat4 u_MatG;\n                uniform highp mat4 u_MatVP;\n            "}else{Nj="#version 300 es\n                #define attribute in\n                #define varying out\n                #define texture2D texture\n\n                precision highp float;\n                precision mediump sampler2D;\n\n                uniform CommonBlock\n                {\n                    lowp vec4 u_Sunlight;\n                    lowp vec4 u_Picker;\n                    lowp vec4 u_EyePos;\n                    lowp vec4 u_Mark;\n                    highp mat4 u_MatG;\n                    highp mat4 u_MatVP;\n                };\n            ";Oj="#version 300 es\n                #define varying in\n                #define texture2D texture\n                #define gl_FragColor FragColor\n\n                precision highp float;\n                precision mediump sampler2D;\n\n                uniform CommonBlock\n                {\n                    lowp vec4 u_Sunlight;\n                    lowp vec4 u_Picker;\n                    lowp vec4 u_EyePos;\n                    lowp vec4 u_Mark;\n                    highp mat4 u_MatG;\n                    highp mat4 u_MatVP;\n                };\n\n                out vec4 FragColor;\n            "}bk=fk;return{DeclareVS:Nj+Pj+Rj,DeclareFS:Oj+Qj+Sj,ClearVS:Tj,ClearFS:Uj,RenderVS:Vj,RenderFS:Wj,PostprocessVS:Xj,PostprocessFS:Yj,ATOM_VS:$j,ATOM_FS:_j,BRDF_VS:"",BRDF_FS:Zj}};var dk={_name:"Shader",GetSourceCode:function(gk){if(!ak){ak=ck()}var hk=dk[gk];var ik="";var jk="";if(hk.include){var kk=hk.include[bk];if(kk){for(var lk=0,mk=kk;lk<mk.length;lk++){var nk=mk[lk];ik+=ak[nk+"_VS"];jk+=ak[nk+"_FS"]}}}return[ak["DeclareVS"]+ik+hk.vs_src+ak[hk.type+"VS"],ak["DeclareFS"]+jk+hk.fs_src+ak[hk.type+"FS"]]}};Rj="\nattribute mediump vec3 a_Position;\nattribute mediump vec3 a_Normal;\nattribute mediump vec2 a_UV;\nattribute mediump vec4 a_Color;\nattribute mediump vec4 a_Tangent;\nattribute mediump vec4 a_Object;\nattribute highp mat4 a_MatW;\n\nvarying vec4 v_Object;\n\n/// ����ռ�����ת����ռ�����\nvec3 ObjectToWorldPos(vec3 i_Position)\n{\n    return (a_MatW * vec4(i_Position, 1.0)).xyz;\n}\n\n/// ����ռ�����ת�ü��ռ�����\nvec4 ObjectToClipPos(vec3 i_Position)\n{\n    // GIS�ı任����ֵ������ת��Ϣ��δ����λ����Ϣ�����⾫�Ȳ�����ɻ��涶��\n    // return u_MatVP * u_MatG * a_MatW * vec4(i_Position, 1.0);\n    \n    vec4 mPosition = vec4(i_Position, 1.0);\n    mPosition = u_MatG * a_MatW * mPosition;\n    mPosition.y = mPosition.y - 6378137.0;\n\n    return u_MatVP * mPosition;\n}\n\n/// ����ռ䷨��ת����ռ䷨��\nvec3 ObjectToWorldNormal(vec3 i_Normal)\n{\n    return normalize((u_MatG * a_MatW * vec4(i_Normal, 0.0)).xyz);\n}";Sj="\nuniform sampler2D u_MainTex;\nvarying vec4 v_Object;\n\n/// ����2D����\nvec4 Tex2D(sampler2D i_Tex, vec2 i_UV)\n{\n    i_UV.x = fract(i_UV.x);\n    i_UV.y = fract(1.0 - i_UV.y);\n\n    return texture2D(i_Tex, i_UV);\n}";Tj="\nvoid main()\n{\n    gl_Position = vs();\n}";Uj="\nvoid main()\n{\n    gl_FragColor = fs();\n}";Vj="\nvoid main()\n{\n    v_Object = a_Object;\n    \n    gl_Position = vs();\n}";Wj="\nvoid main()\n{\n    gl_FragColor = fs();\n    \n    float nAlpha = u_Mark.x;\n    \n    // ��͸�������https://zhuanlan.zhihu.com/p/49164063\n    if(0.01 < nAlpha)\n    {\n        // ���Σ�0-��͸����1-ȫ͸����Ĭ��ֵ0��׷��0.3��͸����\n        nAlpha = 0.3 + 0.7 * v_Object.b;\n        \n        // Gͨ������ɫ�Ҷ��ۼӡ�����֧�ֲ�ɫ͸����\n        gl_FragColor.g = dot(gl_FragColor.rgb, vec3(0.299, 0.587, 0.114));\n        // Rͨ������ϴ����ۼӣ���ֵ1.0����ֵ0.99��Ǹ�������\n        gl_FragColor.r = 1.0 - (0.01 * v_Object.a);        \n        // Bͨ����OPACITY�ۼ�\n        gl_FragColor.b = 1.0 - nAlpha;\n        gl_FragColor.g *= gl_FragColor.b;\n        // Aͨ����ALPHA�۳ˡ���ϣ�Դ����Ϊ0��Ŀ�����Դ\n        gl_FragColor.a = 1.0 - gl_FragColor.b;\n    }\n    // ��͸�����\n    else\n    {\n        // ����������\n        gl_FragColor.a = 1.0 - (0.01 * v_Object.a);\n    }\n}";Xj="\nvoid main()\n{\n    gl_Position = vs();\n}";Yj="\nvoid main()\n{\n    gl_FragColor = fs();\n}";Zj='\nconst float PI = 3.14159265358979323846;\n\nconst vec3 baseColor = vec3(0.5, 0.5, 0.5);\nconst float metallic = 0.0;\nconst float subsurface = 0.5; // 0.0\nconst float specular = 0.2;\nconst float roughness = 0.7; //0.5;\nconst float specularTint = 0.0;\nconst float anisotropic = 0.0;\nconst float sheen = 0.0;\nconst float sheenTint = 0.5;\nconst float clearcoat = 0.0;\nconst float clearcoatGloss = 1.0;\n\nfloat sqr(float x) { return x * x; }\n\nfloat SchlickFresnel(float u)\n{\n\tfloat m = clamp(1.0 - u, 0.0, 1.0);\n\tfloat m2 = m * m;\n\treturn m2 * m2 * m; // pow(m,5)\n}\n\nfloat GTR1(float NdotH, float a)\n{\n\tif (a >= 1.0) return 1.0 / PI;\n\tfloat a2 = a * a;\n\tfloat t = 1.0 + (a2 - 1.0) * NdotH * NdotH;\n\treturn (a2 - 1.0) / (PI * log(a2) * t);\n}\n\nfloat GTR2(float NdotH, float a)\n{\n\tfloat a2 = a * a;\n\tfloat t = 1.0 + (a2 - 1.0) * NdotH * NdotH;\n\treturn a2 / (PI * t * t);\n}\n\nfloat GTR2_aniso(float NdotH, float HdotX, float HdotY, float ax, float ay)\n{\n\treturn 1.0 / (PI * ax * ay * sqr(sqr(HdotX / ax) + sqr(HdotY / ay) + NdotH * NdotH));\n}\n\nfloat smithG_GGX(float NdotV, float alphaG)\n{\n\tfloat a = alphaG * alphaG;\n\tfloat b = NdotV * NdotV;\n\treturn 1.0 / (NdotV + sqrt(a + b - a * b));\n}\n\nfloat smithG_GGX_aniso(float NdotV, float VdotX, float VdotY, float ax, float ay)\n{\n\treturn 1.0 / (NdotV + sqrt(sqr(VdotX * ax) + sqr(VdotY * ay) + sqr(NdotV)));\n}\n\nvec3 mon2lin(vec3 x)\n{\n\treturn vec3(pow(x[0], 2.2), pow(x[1], 2.2), pow(x[2], 2.2));\n}\n\nvec3 BRDF(vec3 L, vec3 V, vec3 N, vec3 X, vec3 Y)\n{\n    //x��y����ֱ��ʾ�˱�����������͸�������������\n    //https://www.cnblogs.com/starfallen/p/3572352.html\n\n\tfloat NdotL = dot(N, L);\n\tfloat NdotV = dot(N, V);\n\tif (NdotL < 0.0 || NdotV < 0.0) return vec3(0.0);\n\n\tvec3 H = normalize(L + V);\n\tfloat NdotH = dot(N, H);\n\tfloat LdotH = dot(L, H);\n\n\tvec3 Cdlin = mon2lin(baseColor);\n\tfloat Cdlum = 0.3 * Cdlin[0] + 0.6 * Cdlin[1] + 0.1 * Cdlin[2]; // luminance approx.\n\n\tvec3 Ctint = Cdlum > 0.0 ? Cdlin / Cdlum : vec3(1.0); // normalize lum. to isolate hue+sat\n\tvec3 Cspec0 = mix(specular * 0.08 * mix(vec3(1.0), Ctint, specularTint), Cdlin, metallic);\n\tvec3 Csheen = mix(vec3(1.0), Ctint, sheenTint);\n\n\t// Diffuse fresnel - go from 1 at normal incidence to .5 at grazing\n\t// and mix in diffuse retro-reflection based on roughness\n\tfloat FL = SchlickFresnel(NdotL), FV = SchlickFresnel(NdotV);\n\tfloat Fd90 = 0.5 + 2.0 * LdotH * LdotH * roughness;\n\tfloat Fd = mix(1.0, Fd90, FL) * mix(1.0, Fd90, FV);\n\n\t// Based on Hanrahan-Krueger brdf approximation of isotropic bssrdf\n\t// 1.25 scale is used to (roughly) preserve albedo\n\t// Fss90 used to "flatten" retroreflection based on roughness\n\tfloat Fss90 = LdotH * LdotH * roughness;\n\tfloat Fss = mix(1.0, Fss90, FL) * mix(1.0, Fss90, FV);\n\tfloat ss = 1.25 * (Fss * (1.0 / (NdotL + NdotV) - 0.5) + 0.5);\n\n\t// specular\n\tfloat aspect = sqrt(1.0 - anisotropic * 0.9);\n\tfloat ax = max(0.001, sqr(roughness) / aspect);\n\tfloat ay = max(0.001, sqr(roughness) * aspect);\n\tfloat Ds = GTR2_aniso(NdotH, dot(H, X), dot(H, Y), ax, ay);\n\tfloat FH = SchlickFresnel(LdotH);\n\tvec3 Fs = mix(Cspec0, vec3(1.0), FH);\n\tfloat Gs;\n\tGs = smithG_GGX_aniso(NdotL, dot(L, X), dot(L, Y), ax, ay);\n\tGs *= smithG_GGX_aniso(NdotV, dot(V, X), dot(V, Y), ax, ay);\n\n\t// sheen\n\tvec3 Fsheen = FH * sheen * Csheen;\n\n\t// clearcoat (ior = 1.5 -> F0 = 0.04)\n\tfloat Dr = GTR1(NdotH, mix(0.1, 0.001, clearcoatGloss));\n\tfloat Fr = mix(0.04, 1.0, FH);\n\tfloat Gr = smithG_GGX(NdotL, 0.25) * smithG_GGX(NdotV, 0.25);\n\n\treturn ((1.0 / PI) * mix(Fd, ss, subsurface) * Cdlin + Fsheen) * (1.0 - metallic) + Gs * Fs * Ds + 0.25 * clearcoat * Gr * Fr * Dr;\n}';$j="\nvarying vec4 v_ViewDir;\nvarying vec4 v_Scattering;\nvarying vec4 v_Attenuate;\n\n//P and ray define the line; O is the sphere's center point\nvec3 CalculateIntersection(vec3 P, vec3 ray, vec3 O, float r)\n{\n\tvec3 PO = O - P;\n\tfloat lPO = length(PO);\n\tfloat B = 2.0 * dot(PO, ray);\n\n\tfloat C = B * B - 4.0 * (lPO * lPO - r * r);\n\tfloat det = sqrt(max(0.0, C));\n\n\tfloat d = 0.5*(B-det);\n\tvec3 intersect = P + d * ray;\n\n\treturn intersect;\n}\n\nvoid Atmosphere(vec3 mLightDir, vec3 mWorldPos)\n{\n    // ����ɢ�䣬���Ӧ�����㣬�����Ӧ�����ڲ�֮�⣬��������Ϊ���뾶���ڲ�뾶�����뾶ӦԶ�����ڲ�뾶\n    //650 nm for red; 570 nm for green; 475 nm for blue\n    vec3 _Wave = vec3(5.602046, 9.473285, 20.49314);\n    vec3 _ESun = vec3(20.0, 20.0, 20.0);\n    vec3 _PlanetPos = vec3(0.0, -6378137.0, 0.0);\n    float _Sealevel = 6378137.0;\n    float _OuterRadius = 6478137.0;\n    float _SampleNum = 5.0;\n    //Rayleigh scattering constant\n    float _Kr = 0.0025;\n    //Mie scattering constant\n    float _Km = 0.001;\n    //the altitude at which the atmosphere's average density is found\n    float _H0 = 0.25;\n\n    vec3 mRay = mWorldPos - u_EyePos.xyz;\n    float nDepth = length(mRay); mRay = mRay / nDepth;\n\n    float nSampleLength = nDepth / _SampleNum;\n    vec3 mSampleRay = mRay * nSampleLength;\n    vec3 mSamplePoint = u_EyePos.xyz + mSampleRay * 0.5;\n    vec3 mInScattering = vec3(0.0, 0.0, 0.0);\n    vec3 mOutScatteringAB = vec3(0.0, 0.0, 0.0);\n    vec3 mOutGroundScatteringAB = vec3(0.0, 0.0, 0.0);\n    float nInvOuterH = 1.0 / (_OuterRadius-_Sealevel);\n\n    for(int i=0; i</*_SampleNum*/5; i++)\n    {\n\t    vec3 mCrossPoint = CalculateIntersection(mSamplePoint, -mLightDir, _PlanetPos, _OuterRadius);\n\t    //AP out scattering\n\t    vec3 mAPRay = (mSamplePoint - u_EyePos.xyz) / _SampleNum;\n\t    float nAPRayLength = length(mAPRay);\n\t    vec3 mSampleAP = u_EyePos.xyz + mAPRay * 0.5;\n\t    vec3 mOutScatteringAP = vec3(0.0, 0.0, 0.0);\n\n\t    for(int m=0; m</*_SampleNum*/5; m++)\n\t    {\n\t\t    mOutScatteringAP += exp(-(length(mSampleAP - _PlanetPos) - _Sealevel) * nInvOuterH / _H0) * nAPRayLength * nInvOuterH;\n\t\t    mSampleAP += mAPRay;\n\t    }\n\t    mOutScatteringAP = 4.0 * 3.14 * (_Km + _Kr * _Wave) * mOutScatteringAP;\n\n\t    //PC out scattering\n\t    vec3 mPCRay = (mCrossPoint - mSamplePoint) / _SampleNum;\n\t    float nPCRayLength = length(mPCRay);\n\t    vec3 mSamplePC = mSamplePoint + mPCRay*0.5;\n\t    vec3 mOutScatteringPC = vec3(0.0, 0.0, 0.0);\n\n\t    for(int n=0; n</*_SampleNum*/5; n++)\n\t    {\n\t\t    mOutScatteringPC += exp(-(length(mSamplePC - _PlanetPos) - _Sealevel) * nInvOuterH / _H0) * nPCRayLength * nInvOuterH;\n\t\t    mSamplePC += mPCRay;\n\t    }\n\t    mOutScatteringPC = 4.0 * 3.14 * (_Km + _Kr * _Wave) * mOutScatteringPC;\n\n\t    mInScattering += exp(-(length(mSamplePoint - _PlanetPos) - _Sealevel) * nInvOuterH / _H0) * nSampleLength * nInvOuterH * exp(-mOutScatteringAP - mOutScatteringPC);\n\t    mSamplePoint+=mSampleRay;\n\t    mOutScatteringAB = mCrossPoint;\n        mOutGroundScatteringAB = mOutScatteringAP + mOutScatteringPC;\n    }\n\n    vec3 mAttenuateGround = exp(-mOutGroundScatteringAB);\n\n    v_ViewDir.xyz = u_EyePos.xyz - mWorldPos;\n    v_Scattering.xyz = mInScattering * _ESun * _Kr * _Wave;\n    v_Attenuate.xyz = mInScattering * _ESun * _Km;\n\n    v_ViewDir.w = mAttenuateGround.x;\n    v_Scattering.w = mAttenuateGround.y;\n    v_Attenuate.w = mAttenuateGround.z;\n\n    //Ground : v_ScatteringR = v_Scattering; v_ScatteringM = v_Attenuate; v_Attenuate = v_AttenuateGround;\n    //v_ViewDir = u_EyePos.xyz - mWorldPos;\n    //v_ScatteringR = mInScattering * _ESun * _Kr * _Wave;\n    //v_ScatteringM = mInScattering * _ESun * _Km;\n    //v_Attenuate = exp(-mOutGroundScatteringAB);\n}";_j="\nvarying vec4 v_ViewDir;\nvarying vec4 v_Scattering;\nvarying vec4 v_Attenuate;\n\nfloat PhaseRayleigh(float nCostheta)\n{\n\treturn 0.75 * (1.0 + nCostheta * nCostheta);\n}\n\nfloat PhaseMie(float nCostheta, float g, float g2)\n{\n\treturn 1.5 * ((1.0 - g2) / (2.0 + g2)) * (1.0 + nCostheta * nCostheta) / pow(1.0 + g2 - 2.0 * g * nCostheta, 1.5);\n}\n\nvec4 AtmosphereColor(vec4 mColor, vec3 mLightDir)\n{\n    float _G = -0.990;\n    float _G2 = _G * _G;\n    \n    float nCostheta = dot(normalize(v_ViewDir.xyz), mLightDir);\n    float nPhaseMie = PhaseMie(nCostheta, _G, _G2);\n    float nPhaseRayleigh = PhaseRayleigh(nCostheta);\n\t\t\t\t\n    mColor.rgb = v_Scattering.xyz * nPhaseRayleigh + v_Attenuate.xyz * nPhaseMie;\n    mColor.a = mColor.b + 0.35;\n    mColor = clamp(mColor, 0.0, 0.9);\n\n    return mColor;\n}\n\nvec4 AtmosphereLight(vec4 mColor, vec3 mLightDir)\n{\n    // Ground : v_ScatteringR = v_Scattering.xyz; v_ScatteringM = v_Attenuate.xyz; v_Attenuate = v_AttenuateGround;\n    \n    float _G = -0.980;\n    float _G2 = _G * _G;\n    \n    float nCostheta = dot(normalize(v_ViewDir.xyz), mLightDir);\n    float nPhaseMie = PhaseMie(nCostheta, _G, _G2);\n    float nPhaseRayleigh = PhaseRayleigh(nCostheta);\n    \n    mColor.rgb = v_Scattering.xyz * nPhaseRayleigh + v_Attenuate.xyz * nPhaseMie + mColor.rgb * vec3(v_ViewDir.w, v_Scattering.w, v_Attenuate.w)/*v_AttenuateGround*/;\n    \n    return mColor;\n}";return[dk]});MiaokitMerge(function(ok){var pk=undefined;var qk=true;var rk=[];var sk={RGBA32_FLOAT:function(){return true?[pk["RGBA32F"],pk.RGBA,pk.FLOAT]:[pk.RGBA,pk.RGBA,pk.FLOAT]},RGBA16_FLOAT:function(){return true?[pk["RGBA16F"],pk.RGBA,pk["HALF_FLOAT"]]:[pk.RGBA,pk.RGBA,36193]},RGBA8:function(){return true?[pk.RGBA,pk.RGBA,pk.UNSIGNED_BYTE]:[pk.RGBA,pk.RGBA,pk.UNSIGNED_BYTE]},D16_UNORM:function(){return true?[pk["DEPTH_COMPONENT16"],pk.DEPTH_COMPONENT,pk.UNSIGNED_SHORT]:[pk.DEPTH_COMPONENT,pk.DEPTH_COMPONENT,pk.UNSIGNED_SHORT]},D24_UNORM:function(){return true?[pk["DEPTH_COMPONENT24"],pk.DEPTH_COMPONENT,pk.UNSIGNED_INT]:[pk.DEPTH_COMPONENT,pk.DEPTH_COMPONENT,pk.UNSIGNED_INT]},D24S8_UNORM:function(){return true?[pk.DEPTH_STENCIL,pk.DEPTH_STENCIL,34042]:[pk.DEPTH_STENCIL,pk.DEPTH_STENCIL,34042]}};var tk={Opaque:1,Transparent:2,Outline:4,CastShadow:8,ReceiveShadow:16};var uk=null;var vk=["u_Sunlight","u_Picker","u_EyePos","u_MatG","u_MatVP","u_Color","u_MainTex","",""];var wk=[null];var xk=[null];var yk=[null];var zk=[null];var Ak=[new Int32Array([0,0,0,0]),new Float32Array([0,0,0,0]),new Float32Array([1,0,0,0,1,0,0,0,1]),new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),new Int32Array([0,0,0,0]),new Int32Array([0,0,0,0]),new Int32Array([0,0,0,0]),new Int32Array([0,0,0,0])];var Bk=[function(fl,gl,hl){Ok(wk[fl],zk[gl])},function(il,jl,kl){Pk(wk[il],zk[jl])},function(ll,ml,nl){Qk(wk[ll],zk[ml])},function(ol,pl,ql){Rk(wk[ol],zk[pl])},function(rl,sl,tl){var ul=zk[sl];var vl=ul[1];if(ul[0]){vl=dl.GetTexture(vl);if(vl){ul[0]=0;ul[1]=vl}}var wl=rk[vl]||Lk;if(null===wl){console.log("BindTexture null!");return}pk.activeTexture(33984+tl);pk.bindTexture(3553,wl)},function(xl,yl){console.error("Unsupported UniformCubemap!")},null,function(zl,Al,Bl){var Cl=zk[Al];var Dl=Cl[1];if(Cl[0]){Dl=dl.GetTexture(Dl);if(Dl){Cl[0]=0;Cl[1]=Dl}}var El=rk[Dl]||Lk;if(null===El){console.log("BindTexture null!");return}pk.activeTexture(33984+Bl);pk.bindTexture(35866,El)}];var Ck=[null];var Dk=[null];var Ek=1280;var Fk=720;var Gk=1;var Hk=0;var Ik=null;var Jk=new Float32Array(4);var Kk=[0,0,0,0];var Lk=null;var Mk=null;var Nk=0;function Ok(Fl,Gl){if(undefined===Fl.mark){pk.uniform4iv(Fl,Gl)}else if(Gk!==Fl.mark){pk.uniform4iv(Fl,Gl);Fl.mark=Gk}}function Pk(Hl,Il){if(undefined===Hl.mark){pk.uniform4fv(Hl,Il)}else if(Gk!==Hl.mark){pk.uniform4fv(Hl,Il);Hl.mark=Gk}}function Qk(Jl,Kl){if(undefined===Jl.mark){pk.uniformMatrix3fv(Jl,false,Kl)}else if(Gk!==Jl.mark){pk.uniformMatrix3fv(Jl,false,Kl);Jl.mark=Gk}}function Rk(Ll,Ml){if(undefined===Ll.mark){pk.uniformMatrix4fv(Ll,false,Ml)}else if(Gk!==Ll.mark){pk.uniformMatrix4fv(Ll,false,Ml);Ll.mark=Gk}}function Sk(Nl,Ol){var Pl=pk.createShader(Nl);if(!Pl){console.error("Could not create shader object!");return null}pk.shaderSource(Pl,Ol);pk.compileShader(Pl);if(!pk.getShaderParameter(Pl,pk.COMPILE_STATUS)){var Ql=pk.getShaderInfoLog(Pl);pk.deleteShader(Pl);console.error("Could not compile shader! \n\n"+Ql);return null}return Pl}function Tk(Rl){var Sl=Rl.program;var Tl=0;{pk.bindAttribLocation(Sl,0,"a_Position");pk.bindAttribLocation(Sl,1,"a_Normal");pk.bindAttribLocation(Sl,2,"a_UV");pk.bindAttribLocation(Sl,3,"a_Color");pk.bindAttribLocation(Sl,4,"a_Tangent");pk.bindAttribLocation(Sl,5,"a_Object");pk.bindAttribLocation(Sl,6,"a_MatW")}{pk.linkProgram(Sl);if(!pk.getProgramParameter(Sl,pk.LINK_STATUS)){var Ul=pk.getProgramInfoLog(Sl);console.error("Could not compile program! \n\n"+Ul);return 0}}{var Vl=pk.getProgramParameter(Sl,35718);if(qk){Vl-=6;var Wl=pk["getUniformBlockIndex"](Sl,"CommonBlock")}var Xl=dl.CreateUniformsDesc(Vl);var Yl=zk[Xl];var Zl={};var $l=0;Yl[19]=yk.push(Zl)-1;Ck[Yl[19]]=Rl;pk.useProgram(Sl);for(var _l=0;_l<2;_l++){var am=Vl+(qk?6:0);for(var bm=0;bm<am;bm++){var Ul=pk.getActiveUniform(Sl,bm);var cm=Ul.type;if(35678===cm||35680===cm||36289===cm){if(0!==_l){continue}}else{if(1!==_l){continue}}var dm=Ul.name;var em=pk.getUniformLocation(Sl,dm);if(!em){continue}var fm=wk.push(em)-1;for(var gm=0;gm<vk.length;gm++){if(dm===vk[gm]){Yl[gm]=$l;if(5>gm){em.mark=1}break}}switch(cm){case 35669:cm=0;break;case 35666:cm=1;break;case 35675:cm=2;break;case 35676:cm=3;break;case 35678:cm=4;break;case 35680:cm=5;break;case 36289:cm=7;break;default:console.error("Unsupported uniform type:",Ul);break}Yl[20+$l]=fm;Yl[20+Vl+$l]=cm;Zl[dm]=$l;xk[fm]=dm;if(0===_l){pk.uniform1i(em,$l)}$l++}}if($l!==Vl){console.error("Process uniform cout error!",Vl,$l)}Tl=Yl[16]}{var hm=0;if(Rl.mark){for(var im=0,jm=Rl.mark;im<jm.length;im++){var km=jm[im];hm|=tk[km]}}Rl.mode=hm}return Tl}function Uk(lm){if(!lm){return null}var mm=ok.Shader[lm];if(!mm){console.error("Could not find shader:",lm);return null}if(mm.program){return mm}var nm=ok.Shader.GetSourceCode(lm);mm.vs=Sk(pk.VERTEX_SHADER,nm[0]);if(!mm.vs){console.error("Could not create vertex shader:",lm);return null}mm.fs=Sk(pk.FRAGMENT_SHADER,nm[1]);if(!mm.fs){pk.deleteShader(mm.vs);mm.vs=null;console.error("Could not create fragment shader:",lm);return null}mm.program=pk.createProgram();if(!mm.program){pk.deleteShader(mm.vs);pk.deleteShader(mm.fs);mm.vs=null;mm.fs=null;console.error("Could not create program object!");return null}pk.attachShader(mm.program,mm.vs);pk.attachShader(mm.program,mm.fs);mm.id=Tk(mm);if(!mm.id){pk.deleteProgram(mm.program);pk.deleteShader(mm.vs);pk.deleteShader(mm.fs);mm.program=null;mm.vs=null;mm.fs=null}return mm}function Vk(om,pm){var qm=undefined;var rm=undefined;var sm=undefined;var tm=undefined;var um=0;function vm(){var Fm=zk[om];var Gm=zk[pm];var Hm=Ck[Fm[19]];var Im=Fm[20];var Jm=20+Fm[17];qm=Hm.program;rm=yk[Fm[19]];sm=Fm;tm=[];um=Fm[17];var Km=function(Tm){var Um=Tm;var Vm=zk[Gm[Um]];var Wm=wk[Im+Um];var Xm=Fm[Jm+Um];var Ym=[function(){return Vm},function(Zm){Vm.set(Zm)},undefined];switch(Xm){case 0:Ym[2]=function(){Ok(Wm,Vm)};break;case 1:Ym[2]=function(){Pk(Wm,Vm)};break;case 2:Ym[2]=function(){Qk(Wm,Vm)};break;case 3:Ym[2]=function(){Rk(Wm,Vm)};break;case 4:Ym[2]=function(){var $m=Vm[1];if(Vm[0]){$m=dl.GetTexture($m);if($m){Vm[0]=0;Vm[1]=$m}}var _m=rk[$m]||Lk;if(null===_m){console.log("BindTexture null!");return}pk.activeTexture(33984+Um);pk.bindTexture(3553,_m)};break;case 7:Ym[2]=function(){var an=Vm[1];if(Vm[0]){an=dl.GetTexture(an);if(an){Vm[0]=0;Vm[1]=an}}var bn=rk[an]||Lk;if(null===bn){console.log("BindTexture null!");return}pk.activeTexture(33984+Um);pk.bindTexture(35866,bn)};break;default:console.error("Unsupported uniform type!",Xm);break}tm[Um]=Ym};for(var Lm=0;Lm<um;Lm++){Km(Lm)}if(Hm.uniform_values){for(var Mm=0,Nm=Hm.uniform_values;Mm<Nm.length;Mm++){var Om=Nm[Mm];var Pm=rm[Om[0]];if(undefined!==Pm){var Qm=Fm[Jm+Pm];if(4===Qm||5===Qm){var Rm=dl.Pipeline["Resource"][Om[1]];var Sm=[0,Rm.Handle,0,0];tm[Pm][1](Sm)}}}}return Hm.mode}function wm(cn){if(Ik){Ik(Dk[pm],pk)}if(Hk!==om){pk.useProgram(qm);Hk=om;if(Mk){pk["bindBufferBase"](pk["UNIFORM_BUFFER"],0,Mk)}}for(var dn=0,en=tm;dn<en.length;dn++){var fn=en[dn];fn[2]()}}function xm(gn){return rm[gn]}function ym(hn){return tm[hn][0]()}function zm(jn){jn=sm[jn];if(-1<jn){return tm[jn][0]()}return null}function Am(kn){var ln=rm[kn];if(undefined!==ln){return tm[ln][0]()}return null}function Bm(mn,nn){tm[mn][1](nn);if(Hk===om){tm[mn][2]()}}function Cm(on,pn){on=sm[on];if(-1<on){tm[on][1](pn);if(Hk===om){tm[on][2]()}}}function Dm(qn,rn){var sn=rm[qn];if(undefined!==sn){tm[sn][1](rn);if(Hk===om){tm[sn][2]()}}}function Em(tn){tm[tn][2]()}Dk[pm]=[vm,wm,xm,ym,zm,Am,Bm,Cm,Dm,Em];return vm()}function Wk(un){{Object.defineProperty(un,"Attr",{get:function(){if(!this.Attr_){this.Attr_=Dk[this._VarList()]}return this.Attr_}})}{var vn=function(xn){var yn=xn;Object.defineProperty(un,vk[xn],{get:function(){return this.Attr[4](yn)},set:function(zn){if(zn){this.Attr[7](yn,zn)}}})};for(var wn=0;wn<vk.length;wn++){vn(wn)}}{}}function Xk(An){var Bn=pk.createTexture();if(!Bn){console.error("Could not create texture object!");return null}pk.bindTexture(pk.TEXTURE_2D,Bn);pk.texParameteri(pk.TEXTURE_2D,pk.TEXTURE_MIN_FILTER,pk.NEAREST);pk.texParameteri(pk.TEXTURE_2D,pk.TEXTURE_MAG_FILTER,pk.NEAREST);pk.texParameteri(pk.TEXTURE_2D,pk.TEXTURE_WRAP_S,pk.CLAMP_TO_EDGE);pk.texParameteri(pk.TEXTURE_2D,pk.TEXTURE_WRAP_T,pk.CLAMP_TO_EDGE);pk.texImage2D(pk.TEXTURE_2D,0,pk.RGBA,1,1,0,pk.RGBA,pk.UNSIGNED_BYTE,new Uint8Array(4));var Cn=new Image;Cn.crossOrigin="anonymous";Cn.src=An.URL;Cn.onload=function(Dn){pk.bindTexture(pk.TEXTURE_2D,Bn);pk.texImage2D(pk.TEXTURE_2D,0,pk.RGBA,pk.RGBA,pk.UNSIGNED_BYTE,Cn);pk.bindTexture(pk.TEXTURE_2D,null)};pk.bindTexture(pk.TEXTURE_2D,null);return Bn}function Yk(En){var Fn=pk.createTexture();if(!Fn){console.error("Could not create texture object!");return null}pk.bindTexture(pk.TEXTURE_2D,Fn);var Gn=En.Params;pk.texParameteri(pk.TEXTURE_2D,pk.TEXTURE_MAG_FILTER,pk[Gn[1]]);pk.texParameteri(pk.TEXTURE_2D,pk.TEXTURE_MIN_FILTER,pk[Gn[0]]);pk.texParameteri(pk.TEXTURE_2D,pk.TEXTURE_WRAP_S,pk[Gn[2]]);pk.texParameteri(pk.TEXTURE_2D,pk.TEXTURE_WRAP_T,pk[Gn[3]]);var Hn=sk[En.Format]();pk.texImage2D(pk.TEXTURE_2D,En.Levels,Hn[0],En.Width,En.Height,0,Hn[1],Hn[2],null);pk.bindTexture(pk.TEXTURE_2D,null);Fn["_Format"]=Hn;return Fn}function Zk(In,Jn){var Kn=pk.createFramebuffer();if(!Kn){console.error("Could not create framebuffer object!");return null}pk.bindFramebuffer(pk.FRAMEBUFFER,Kn);pk.framebufferTexture2D(pk.FRAMEBUFFER,pk.COLOR_ATTACHMENT0,pk.TEXTURE_2D,In,0);if(Jn&&Jn["_Format"][0]===pk.DEPTH_STENCIL){pk.framebufferTexture2D(pk.FRAMEBUFFER,pk.DEPTH_STENCIL_ATTACHMENT,pk.TEXTURE_2D,Jn,0)}else{pk.framebufferTexture2D(pk.FRAMEBUFFER,pk.DEPTH_ATTACHMENT,pk.TEXTURE_2D,Jn,0)}if(pk.FRAMEBUFFER_COMPLETE!=pk.checkFramebufferStatus(pk.FRAMEBUFFER)){pk.deleteFramebuffer(Kn);console.error("Framebuffer check failed!");return null}return Kn}var $k=function(Ln){if(qk){zk[Nk][12]=Ln;pk.bindBuffer(pk["UNIFORM_BUFFER"],Mk);pk.bufferData(pk["UNIFORM_BUFFER"],zk[Nk],pk.DYNAMIC_DRAW)}};var _k=null;var al=null;var bl=null;var cl=null;var dl={_name:"ShaderLab",Pipeline:null,Init:function(Mn){pk=ok["GL"]["Ctx"];rk=ok["GL"]["_textures"];Ek=pk.canvas.width;Fk=pk.canvas.height;_k=ok["GL"]["BindViewport"];al=ok["GL"]["BindDepth"];bl=ok["GL"]["BindBlend"];cl=ok["GL"]["BindStencil"];if(qk){var Nn=pk.createBuffer();if(Nn){pk.bindBuffer(pk["UNIFORM_BUFFER"],Nn);pk.bufferData(pk["UNIFORM_BUFFER"],64*3,pk.DYNAMIC_DRAW);pk.bindBuffer(pk["UNIFORM_BUFFER"],null);Mk=Nn}}this.Pipeline.Init();for(var On=0,Pn=this.Pipeline.RenderTarget;On<Pn.length;On++){var Qn=Pn[On];if(Qn){Qn.Width=Qn.Width||Ek;Qn.Height=Qn.Height||Fk;Qn.Levels=Qn.Levels||0;Qn.Params=Qn.Params||["NEAREST","NEAREST","CLAMP_TO_EDGE","CLAMP_TO_EDGE"];Qn.Texture=Yk(Qn);Qn.Handle=ok["GL"]["RegisterTexture"](Qn.Texture);Qn.Size=[1/Qn.Width,1/Qn.Height,Qn.Width,Qn.Height]}}for(var Rn=0,Sn=this.Pipeline.Resource;Rn<Sn.length;Rn++){var Tn=Sn[Rn];if(Tn){if("2D"===Tn.TYPE){Tn.Texture=Xk(Tn);Tn.Handle=ok["GL"]["RegisterTexture"](Tn.Texture);if(2===Tn.ID){Lk=Tn.Texture}}}}function Un(co){var eo=co.RenderTarget;if(eo){var fo=dl.Pipeline["RenderTarget"][eo[0]];var go=dl.Pipeline["RenderTarget"][eo[1]];co.Framebuffer=Zk(fo.Texture,go?go.Texture:null);if(!co.Framebuffer){console.log(co)}co.Framebuffer.width=fo.Size[2];co.Framebuffer.height=fo.Size[3]}else{co.Framebuffer=null}}for(var Vn=0,Wn=this.Pipeline.Pass;Vn<Wn.length;Vn++){var Xn=Wn[Vn];if(Xn){if("Clear"===Xn.Type){Xn._Type=2}else{Xn._Type="Render"===Xn.Type?0:1}Xn._Mask=0;for(var Yn=0,Zn=Xn.Mask;Yn<Zn.length;Yn++){var $n=Zn[Yn];Xn._Mask+=tk[$n]}Un(Xn);if(Xn.Pingpong){for(var _n=0,ao=Xn.Pingpong;_n<ao.length;_n++){var bo=ao[_n];Un(bo)}}}}},Draw:function(){Gk++;var ho=0;var io=this.Pipeline.Picker;if(io){Kk[0]=io.x;Kk[1]=pk.canvas.height-io.y}else{Kk[0]=-10;Kk[1]=-10}$k(0);for(var jo=0,ko=this.Pipeline.Pass;jo<ko.length;jo++){var lo=ko[jo];el.BeginDrawPass();if(lo.Pingpong){for(var mo=0;mo<lo.PingpongCount;mo++){for(var no=0;no<lo.Pingpong.length;no++){lo.Framebuffer=lo.Pingpong[no].Framebuffer;lo.SetUniforms=lo.Pingpong[no].SetUniforms;this.DrawPass(lo,dl.DrawPass_)}}}else{this.DrawPass(lo,dl.DrawPass_)}el.EndDrawPass(ho++)}},DrawPass:function(oo,po){pk.bindFramebuffer(pk.FRAMEBUFFER,oo.Framebuffer);_k(oo.Framebuffer,Ek,Fk);al(oo.Depth);bl(oo.Blend,$k);cl(oo.Stencil);var qo=oo.ClearTarget;if(qo){var ro=0;if(qo.Color){pk.clearColor(qo.Color.r,qo.Color.g,qo.Color.b,qo.Color.a);ro+=pk.COLOR_BUFFER_BIT}if(undefined!==qo.Depth){pk.clearDepth(qo.Depth);ro+=pk.DEPTH_BUFFER_BIT}if(undefined!==qo.Stencil){pk.clearStencil(qo.Stencil);ro+=pk.STENCIL_BUFFER_BIT}pk.clear(ro)}Ik=oo.SetUniforms;if(oo.Shader){if(!oo._Material){oo._Material=new ok["Material"](oo.Shader)}oo._Material._Bind()}po(oo._Type,oo._Mask);if(oo.Postprocess){oo.Postprocess(pk)}},PreflushBuffer:function(){var so=zk.length;var to=new Array(so);for(var uo=0;uo<so;uo++){var vo=zk[uo];if(vo){if("Float32Array"===vo.constructor.name){to[uo]=vo.length}else{to[uo]=-vo.length}zk[uo]=vo.byteOffset}}return to},FlushBuffer:function(wo,xo){uk=wo;var yo=zk.length;for(var zo=0;zo<yo;zo++){var Ao=zk[zo];if(Ao){var Bo=xo[zo];if(0<Bo){zk[zo]=new Float32Array(uk,Ao,Bo)}else{zk[zo]=new Int32Array(uk,Ao,-Bo)}}}for(var zo=0;zo<yo;zo++){var Co=Dk[zo];if(Co){Co[0]()}}ok["GL"]["FlushHeap"]()},ResizeCanvas:function(Do,Eo){},PickObject:function(){var Fo=this.Pipeline.Picker;if(Fo){pk.readPixels(Fo.x,pk.canvas.height-Fo.y,1,1,pk.RGBA,pk.FLOAT,Jk);if(0>Jk[3]){var Go=Math.ceil(Jk[0]*1e4)*8192+Math.ceil(Jk[1]*1e4);var Ho=Math.ceil(Jk[2]*1e4);var Io=this["GetObject"](Go);Fo.Feedback(Io,Ho)}else{Fo.Feedback(null,0)}this.Pipeline.Picker=null}},APP_DO_OPERATORS:[function(Jo){var Ko=ok["ShaderLab"]["Pipeline"]["InternalShader"][Jo];var Lo=Uk(Ko);return Lo.id},function(Mo,No,Oo,Po){var Qo=null;switch(No){case 0:Qo=new Int32Array(uk,Po,4);Qo.set(Ak[0]);break;case 1:Qo=new Float32Array(uk,Po,4);Qo.set(Ak[1]);break;case 2:Qo=new Float32Array(uk,Po,9);Qo.set(Ak[2]);break;case 3:Qo=new Float32Array(uk,Po,16);Qo.set(Ak[3]);break;case 4:Qo=new Int32Array(uk,Po,4);Qo.set(Ak[4]);break;case 5:Qo=new Int32Array(uk,Po,4);Qo.set(Ak[5]);break;case 6:Qo=new Int32Array(uk,Po,Oo);break;case 7:Qo=new Int32Array(uk,Po,4);Qo.set(Ak[7]);break;case 8:Qo=new Float32Array(uk,Po,48);Nk=Mo;break;default:console.error("Unsupported uniform type:",No);break}zk[Mo]=Qo;return Mo},function(Ro,So,To,Uo){Bk[Ro](So,To,Uo);return 0},function(Vo,Wo,Xo,Yo){var Zo=ok["WASM"].GetString(Yo);var $o=zk[Vo];var _o=yk[$o[19]];var ap=_o[Zo];return undefined===ap?0:ap},function(bp,cp){Dk[cp][1](bp);return 0},function(){dl.Draw()},Vk,null],ExpandMaterial:Wk,CreateUniformsDesc:undefined,GetTexture:undefined,DrawPass_:undefined,SetSunlight:undefined};var el={_name:"Profiler",m_pMsg:"",m_nCycleStart:0,m_nCycleTick:0,m_nBeginCycle:0,m_nTotalCycle:0,m_nBeginScript:0,m_nTotalScript:0,m_nBeginUpdate:0,m_nTotalUpdate:0,m_nBeginDraw:0,m_nTotalDraw:0,m_nBeginMaterial:0,m_nTotalMaterial:0,m_nBeginDrawPass:0,m_nTotalDrawPass:[],BeginCycle:function(){if(0===el.m_nCycleTick){el.m_nCycleStart=ok["Time"]();el.m_nCycleTick=0;el.m_nBeginCycle=0;el.m_nTotalCycle=0;el.m_nBeginScript=0;el.m_nTotalScript=0;el.m_nBeginUpdate=0;el.m_nTotalUpdate=0;el.m_nBeginDraw=0;el.m_nTotalDraw=0;el.m_nBeginMaterial=0;el.m_nTotalMaterial=0;el.m_nBeginDrawPass=0;el.m_nTotalDrawPass=[]}el.m_nBeginCycle=ok["Time"]()},EndCycle:function(){el.m_nTotalCycle+=ok["Time"]()-el.m_nBeginCycle;if(60===++el.m_nCycleTick){var dp={"总耗时":ok["Time"]()-el.m_nCycleStart,"应用循环":el.m_nTotalCycle,"脚本逻辑":el.m_nTotalScript,"场景更新":el.m_nTotalUpdate,"场景绘制":el.m_nTotalDraw,"通道绘制":el.m_nTotalDrawPass};el.m_pMsg="'开销统计':"+JSON.stringify(dp);el.m_nCycleTick=0}},BeginScript:function(){el.m_nBeginScript=ok["Time"]()},EndScript:function(){el.m_nTotalScript+=ok["Time"]()-el.m_nBeginScript},BeginUpdate:function(){el.m_nBeginUpdate=ok["Time"]()},EndUpdate:function(){el.m_nTotalUpdate+=ok["Time"]()-el.m_nBeginUpdate},BeginDraw:function(){el.m_nBeginDraw=ok["Time"]()},EndDraw:function(){el.m_nTotalDraw+=ok["Time"]()-el.m_nBeginDraw},BeginMaterial:function(){el.m_nBeginMaterial=ok["Time"]()},EndMaterial:function(){el.m_nTotalMaterial+=ok["Time"]()-el.m_nBeginMaterial},BeginDrawPass:function(){el.m_nBeginDrawPass=ok["Time"]()},EndDrawPass:function(ep){el.m_nTotalDrawPass[ep]=(el.m_nTotalDrawPass[ep]?el.m_nTotalDrawPass[ep]:0)+ok["Time"]()-el.m_nBeginDrawPass}};return[dl,el]});MiaokitMerge(function(fp){if("Sisyphus"!==fp["m_pConfig"]["ENGINE"]){return[]}var gp=undefined;var hp=true;function ip(op){jp();gp=op.OnRenderingEvent;kp();var pp={memory:new WebAssembly.Memory({initial:64*16,maximum:32768}),APP_PLUGIN_TYPE:function(){return 2},APP_MEM_TYPE:function(){return 2},APP_MEM_RESERVE:function(){return 1024},APP_MEM_MALLOC:function(qp){alert("SISYPHUS��չ��֧��ʹ�÷������ڴ�!");return 0},APP_MEM_FREE:function(rp){alert("SISYPHUS��չ��֧��ʹ�÷������ڴ�!")},APP_MEM_BASE:function(){return 64*1024*1024},APP_MEM_GROW:function(sp){if(fp["ShaderLab"]){var tp=fp["ShaderLab"]["PreflushBuffer"]();pp["memory"].grow(sp/64/1024);var up=pp["memory"].buffer;fp["ShaderLab"]["FlushBuffer"](up,tp)}else{pp["memory"].grow(sp/64/1024)}},APP_MEM_RECYCLE:function(vp){alert("WAMSģ�鲻֧�ֻ����ڴ�!")},UNITY_CREATE_OBJ:function(){alert("δװ��UNITY��չ!");return 0},UNITY_FREE_OBJ:function(){alert("δװ��UNITY��չ!");return 0},UNITY_GET:function(){alert("δװ��UNITY��չ!");return 0},UNITY_DO:function(){alert("δװ��UNITY��չ!");return 0}};Object["assign"](pp,np.Export);op.OnEngineLoad(pp)}function jp(){var wp=document.getElementById("unityContainer");var xp=document.createElement("canvas");xp.id="3d";xp.width=wp.offsetWidth;xp.height=wp.offsetHeight;xp.style.width="100%";xp.style.height="100%";xp.style.top="0rem";xp.style.bottom="0rem";xp.style.left="0rem";xp.style.right="0rem";xp.style.position="absolute";xp.style.zIndex="1";wp.appendChild(xp);np["CreateContext"](xp,null);fp["ShaderLab"]["Init"](np)}function kp(){if(hp){hp=false;mp()}}function lp(){hp=true}function mp(){if(hp){return}fp.Profiler.BeginCycle();fp.Profiler.BeginScript();gp(0);fp.Profiler.EndScript();if(fp["WASM"]["Update"]){fp.Profiler.BeginUpdate();fp["WASM"]["Update"](0);fp.Profiler.EndUpdate();fp.Profiler.BeginDraw();fp["WASM"]["Update"](1);fp.Profiler.EndDraw()}fp.Profiler.EndCycle();requestAnimationFrame(mp)}var np=function(){var yp=undefined;var zp=[-1,-1,-1,-1];var Ap=[-1,-1,-1];var Bp=[-1,-1,-1,-1,-1,-1,-1];var Cp=[-1,-1,-1,-1,-1,-1,-1];var Dp=[null];var Ep=null;var Fp=null;var Gp=0;var Hp=function(){var Pp=[null];var Qp=[];var Rp=[];var Sp=0;var Tp=0;return{Analyze:function(){return", 'Image':["+Sp+","+Qp.length+","+Tp+","+Rp.length+"]"},Get:function(Up){return Pp[Up]},CreateImage:function(){var Vp=null;if(0<Qp.length){Vp=Qp.pop()}else{Sp++;Vp=Pp.push(new Image)-1}return Vp},FreeImage:function(Wp){Qp.push(Wp)},PushBuffer:function(Xp){var Yp=null;if(0<Rp.length){Yp=Rp.pop()}else{Tp++;Yp=Pp.push(null)-1}Pp[Yp]=Xp;return Yp},FreeBuffer:function(Zp){Pp[Zp]=null;Rp.push(Zp)}}}();var Ip=function($p){var _p=Dp.length;$p.name=_p;Dp[_p]=$p;return _p};var Jp=function(aq){return Dp[aq]};var Kp=function(bq,cq){Dp[bq]=cq};var Lp=function(dq,eq){Fp[dq>>2]=eq};var Mp=function(fq){return Fp[fq>>2]};var Np=function(gq,hq){return Ep.subarray(gq,gq+hq)};var Op={glGenVertexArrays:function(iq,jq){var kq=yp["createVertexArray"]();if(!kq||1!=iq){console.error("gl.createVertexArray error!");return}var lq=Ip(kq);Lp(jq,lq)},glDeleteVertexArrays:function(mq,nq){var oq=Mp(nq);var pq=Jp(oq);if(!pq||1!=mq){console.error("gl.deleteVertexArray error!");return}yp["deleteVertexArray"](pq);Kp(oq,null)},glBindVertexArray:function(qq){yp["bindVertexArray"](Jp(qq))},glVertexAttribPointer:function(rq,sq,tq,uq,vq,wq){yp.vertexAttribPointer(rq,sq,tq,!!uq,vq,wq)},glEnableVertexAttribArray:function(xq){yp.enableVertexAttribArray(xq)},glVertexAttribDivisor:function(yq,zq){yp["vertexAttribDivisor"](yq,zq)},glGenTextures:function(Aq,Bq){var Cq=yp.createTexture();if(!Cq||1!=Aq){console.error("gl.createTexture error!");return}var Dq=Ip(Cq);Lp(Bq,Dq)},glDeleteTextures:function(Eq,Fq){var Gq=Mp(Fq);var Hq=Jp(Gq);if(!Hq||1!=Eq){console.error("gl.deleteTexture error!");return}yp.deleteTexture(Hq);Kp(Gq,null)},glActiveTexture:function(Iq){yp.activeTexture(Iq)},glBindTexture:function(Jq,Kq){yp.bindTexture(Jq,Jp(Kq))},glTexParameteri:function(Lq,Mq,Nq){yp.texParameteri(Lq,Mq,Nq)},glTexImage2DObj:function(Oq,Pq,Qq,Rq,Sq,Tq,Uq,Vq,Wq,Xq){if(0==Xq){var Yq=Hp.Get(Wq);if(Yq){if(Yq instanceof ArrayBuffer){yp.texImage2D(Oq,Pq,Qq,Rq,Sq,Tq,Uq,Vq,new Uint8Array(Yq));Hp.FreeBuffer(Wq)}else{yp.texParameterf(Oq,34046,Gp);yp.texImage2D(Oq,Pq,Qq,Uq,Vq,Yq);Hp.FreeImage(Wq)}}}else{yp.texImage2D(Oq,Pq,Qq,Rq,Sq,Tq,Uq,Vq,0===Wq?new Uint8Array(3):Np(Wq,Xq))}},glGenBuffers:function(Zq,$q){var _q=yp.createBuffer();if(!_q||1!=Zq){console.error("gl.createBuffer error!");return}var ar=Ip(_q);Lp($q,ar)},glDeleteBuffers:function(br,cr){var dr=Mp(cr);var er=Jp(dr);if(!er||1!=br){console.error("gl.deleteBuffer error!");return}yp.deleteBuffer(er);Kp(dr,null)},glBindBuffer:function(fr,gr){yp.bindBuffer(fr,Jp(gr))},glBufferData:function(hr,ir,jr,kr){if(!jr){yp.bufferData(hr,ir,kr)}else{yp.bufferData(hr,Np(jr,ir),kr)}},glBufferSubData:function(lr,mr,nr,or){yp.bufferSubData(lr,mr,Np(or,nr))},glBlendEquationSeparate:function(pr,qr){if(pr!=Bp[1]||qr!=Bp[2]){yp.blendEquationSeparate(pr,qr);Bp[1]=pr;Bp[2]=qr}},glBlendFuncSeparate:function(rr,sr,tr,ur){if(rr!=Bp[3]||sr!=Bp[4]||tr!=Bp[5]||ur!=Bp[6]){yp.blendFuncSeparate(rr,sr,tr,ur);Bp[3]=rr;Bp[4]=sr;Bp[5]=tr;Bp[6]=ur}},glEnable:function(vr){yp.enable(vr)},glDisable:function(wr){yp.disable(wr)},glDepthFunc:function(xr){yp.depthFunc(xr)},glDepthMask:function(yr){yp.depthMask(!!yr)},glCullFace:function(zr){yp.cullFace(zr)},glPolygonOffset:function(Ar,Br){yp.polygonOffset(Ar,Br)},glViewport:function(Cr,Dr,Er,Fr){if(Er!=zp[2]||Fr!=zp[3]){yp.viewport(Cr,Dr,Er,Fr);zp[2]=Er;zp[3]=Fr}},glDrawArrays:function(Gr,Hr,Ir){yp.drawArrays(Gr,Hr,Ir)},glDrawArraysInstanced:function(Jr,Kr,Lr,Mr){yp["drawArraysInstanced"](Jr,Kr,Lr,Mr)},glDrawElements:function(Nr,Or,Pr,Qr){yp.drawElements(Nr,Or,Pr,Qr)},glDrawElementsInstanced:function(Rr,Sr,Tr,Ur,Vr){yp["drawElementsInstanced"](Rr,Sr,Tr,Ur,Vr)}};return{_name:"GL",_textures:Dp,Ctx:null,ImageCache:Hp,Export:Op,FlushHeap:function(){Ep=fp["WASM"]["HEAPU8"]();Fp=fp["WASM"]["HEAP32"]()},CreateContext:function(Wr,Xr){Xr=Xr||{majorVersion:2,minorVersion:0,alpha:0,depth:0,stencil:0,antialias:0,premultipliedAlpha:0,preserveDrawingBuffer:0,preferLowPowerToHighPerformance:0,failIfMajorPerformanceCaveat:0,enableExtensionsByDefault:1,explicitSwapControl:0,proxyContextToMainThread:0,renderViaOffscreenBackBuffer:0};if(Xr["explicitSwapControl"]){return 0}if(Xr["majorVersion"]==1){yp=Wr.getContext("webgl",Xr)||Wr.getContext("experimental-webgl",Xr);if(!yp){console.error("create webgl_1 error!");return}var Yr=yp.getExtension("ANGLE_instanced_arrays");if(Yr){yp["vertexAttribDivisor"]=function(fs,gs){Yr["vertexAttribDivisorANGLE"](fs,gs)};yp["drawArraysInstanced"]=function(hs,is,js,ks){Yr["drawArraysInstancedANGLE"](hs,is,js,ks)};yp["drawElementsInstanced"]=function(ls,ms,ns,os,ps){Yr["drawElementsInstancedANGLE"](ls,ms,ns,os,ps)}}else{console.error("!ANGLE_instanced_arrays")}var Zr=yp.getExtension("OES_vertex_array_object");if(Zr){yp["createVertexArray"]=function(){return Zr["createVertexArrayOES"]()};yp["deleteVertexArray"]=function(qs){Zr["deleteVertexArrayOES"](qs)};yp["bindVertexArray"]=function(rs){Zr["bindVertexArrayOES"](rs)}}else{console.error("!OES_vertex_array_object")}var $r=["EXT_color_buffer_half_float","OES_texture_half_float","EXT_texture_filter_anisotropic","WEBGL_depth_texture","OES_element_index_uint","EXT_frag_depth","EXT_blend_minmax"];for(var _r=0,as=$r;_r<as.length;_r++){var bs=as[_r];var cs=yp.getExtension(bs);if(!cs){console.error("!"+bs)}}}else{yp=Wr.getContext("webgl2",Xr);if(!yp){console.error("create webgl_2 error!");return}var $r=["EXT_color_buffer_float","EXT_texture_filter_anisotropic"];for(var ds=0,es=$r;ds<es.length;ds++){var bs=es[ds];var cs=yp.getExtension(bs);if(!cs){console.error("!"+bs)}}}Gp=yp.getParameter(34047);np.Ctx=yp;return 0},DestroyContext:function(){console.error("!DestroyContext")},GetTextureByHandle:function(ss){return Dp[ss]},RegisterTexture:function(ts){return Ip(ts)},BindViewport:function(us,vs,ws){var xs=us&&us.width||vs;var ys=us&&us.height||ws;if(xs!=zp[2]||ys!=zp[3]){yp.viewport(0,0,xs,ys);zp[2]=xs;zp[3]=ys}},BindDepth:function(zs){if(zs){var As=zs.Write;var Bs=yp[zs.Func];if(1!=Ap[0]){yp.enable(yp.DEPTH_TEST);Ap[0]=1}if(As!=Ap[1]){yp.depthMask(As);Ap[1]=As}if(Bs!=Ap[2]){yp.depthFunc(Bs);Ap[2]=Bs}}else{if(0!=Ap[0]){yp.disable(yp.DEPTH_TEST);Ap[0]=0}}},BindBlend:function(Cs,Ds){if(Cs){var Es=yp[Cs.ColorFunc];var Fs=yp[Cs.AlphaFunc];var Gs=yp[Cs.ColorSrc];var Hs=yp[Cs.ColorDest];var Is=yp[Cs.AlphaSrc];var Js=yp[Cs.AlphaDest];if(1!=Bp[0]){yp.enable(yp.BLEND);Bp[0]=1;Ds(1)}yp.blendEquationSeparate(Es,Fs);Bp[1]=Es;Bp[2]=Fs;yp.blendFuncSeparate(Gs,Hs,Is,Js);Bp[3]=Gs;Bp[4]=Hs;Bp[5]=Is;Bp[6]=Js}else{if(0!=Bp[0]){yp.disable(yp.BLEND);Bp[0]=0;Ds(0)}}},BindStencil:function(Ks){if(Ks){var Ls=yp[Ks.Func];var Ms=Ks.Value;var Ns=Ks.Mask;var Os=yp[Ks.Faild];var Ps=yp[Ks.ZFaild];var Qs=yp[Ks.Pass];if(1!=Cp[0]){yp.enable(yp.STENCIL_TEST);Cp[0]=1}if(Ls!=Cp[1]||Ms!=Cp[2]||Ns!=Cp[3]){yp.stencilFunc(Ls,Ms,Ns);Cp[1]=Ls;Cp[2]=Ms;Cp[3]=Ns}if(Os!=Cp[4]||Ps!=Cp[5]||Qs!=Cp[6]){yp.stencilOp(Os,Ps,Qs);Cp[4]=Os;Cp[5]=Ps;Cp[6]=Qs}}else{if(0!=Cp[0]){yp.disable(yp.STENCIL_TEST);Cp[0]=0}}}}}();fp["WASM"]=fp["WASM"]||{};fp["WASM"]["LoadEngine"]=ip;kp["_name"]="Start";lp["_name"]="Stop";return[np,kp,lp]});MiaokitMerge(function(Rs){var Ss=Date.now();function Ts(){return Date.now()-Ss}function Us(Xs,Ys){if(Ys===void 0){Ys=0}if(2===Ys){console.warn("Track:",Ts(),Xs)}else if(2<Ys){console.error("Track:",Ts(),Xs)}else{console.info("Track:",Ts(),Xs)}}function Vs(Zs,$s,_s){if(_s===void 0){_s=undefined}var at=new XMLHttpRequest;at.open("GET",Zs,true);at.responseType="arraybuffer";at.onprogress=function(bt){if(0<bt.total&&_s){_s(bt.loaded/bt.total)}};at.onload=function(ct){if(at.status==200){$s(at.response)}else{$s(null)}};at.onerror=function(dt){Us(dt,2);$s(null)};at.send(null)}function Ws(et,ft,gt,ht,it,jt){var kt=new XMLHttpRequest;kt.onprogress=function(lt){if(0<lt.total&&it){it(lt.loaded/lt.total)}};kt.onload=function(mt){if(kt.status==200){jt(kt.response)}else{jt(null)}kt=null};kt.onerror=function(nt){Us(nt,2);jt(null)};kt.responseType=ft;kt.open(et,gt,true);kt.send(ht)}Ts["_name"]="Time";Us["_name"]="Track";Vs["_name"]="Fetch";Ws["_name"]="Request";return[Ts,Us,Vs,Ws]});MiaokitMerge(function(ot){if("Unity"!==ot["m_pConfig"]["ENGINE"]){return[]}if(!UnityLoader){return[]}var pt=ot["m_pLogo"]||"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAYAAABccqhmAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAJvNJREFUeNrsnQe4XUXVhufmpveQhIQiNYEYiEASAkiL9CKCGop0AUEUVBRB+KWIYpcuvQqCSpEeEZQqkIQAgohAgBBDgqGmt1v+/f3n2/9dd+7up9wT/N7nmefec/Y+s8vMrFlrzZqZhtbWVieE+O+ki16BEBIAQggJACGEBIAQQgJACCEBIISQABBCSAAIISQAhBASAEIICQAhhASAEEICQAghASCEkAAQQkgACCEkAIQQEgBCCAkAIYQEgBBCAkAIIQEghJAAEEJIAAghJACEEBIAQggJACGEBIAQQgJACCEBIISQABBCSAAIISQAhBASAEIICQAhhASAEEICQAgJACGEBIAQQgJACCEBIISQABBCSAAIISQAhBASAEIICQAhhASAEEICQAghASCEkAAQQkgACCEkAIQQEgBCCAkAIYQEgBBCAkAIIQEghJAAEEJIAAghJACEEBIAQggJACGEBIAQQgJACCEBIISQABBCSAAIISQAhBASAEIICQAhhASAEEICQAghASCEkAAQQgJACCEBIISQABBCSAAIISQAhBASAEIICQAhhASAEEICQAghASCEkAAQQkgACCEkACL5RZD+GaSj9NqFqA8aWltbq32NbYJ0QZAmmO/+GKQTg/S2ikCIj68G8LMgPek1fvD5IL0cpONVBEJ8/DSAHYN0fpC2yHDuHUH6TpBmqjiEWLU1gG609R/J2PjBF4L0Ck0CIcQqqgHsEaSLgjSyjDweDNK3g/QPFY0Qq4YGMDBIlwRpcpmNH+wapBeDdIqKRoj61wAmsddfowr39kSQTg7SFBWTEPWlAQwL0m+CdGuVGj/YLkhPB+mHKiYh6kcDQK9/ZZAG1fA+XwjSV4I0VUUmROcIAPT0GNo7sBPv98dBOjNIzXX4Lnvw/j50pdgHjGx0dqBToyuNzPiFjM8rVP3/nwFBWi9ILeZdNfDvG0FanDO/1YI01nvvKIt5QXq+4D32DdKWzMfm2zVIrwdpRjUFwJGu5OjrUweF9VqQvhqkv9ZZJcKw57P8H0LgpSA9F6SngjTdleIcat3o9gnSoazYzlTs913J0bpYbf//+Czrd5PfPoJ0CE3RPGwfpLuNsA0b6p+pQRdhlCuNkvX1BAAEPCJtzyiSadck4eBKXn1kvmcdFRbu6S8ssB9SqtYDR5r/B9GHgYT4hiUUCNNcybkJx+ZbNdBkNg3SARHfQwB8fxUUAPBZ9XKlkafVg7RWkD4RpPWDtE6Qzg7Svwr2ruvGHOtVUPMaGPF9vzKffXDM/fQtmmnXFJX/lTquDCcEaT+qbp1tEqAy7p9wvDfVN6SvBWkBVUGYCo8G6ZkgvVeF+4rTOBZFmAVgPHuoppjjlaQ7BeJt/L830wBW9CF8r0NYF4cxhd8NYkOz4J3+tMC9JNWflgL5tRa4TpY8myqdb5IAeDdIv+9kmz+NX9aJP+ArLt9oSP8g7cD0PfoK4OB8OEj3BunNTnoOCIBTa3i9WykAvuhK80Z68t30KJgfNNWfe40WPec3g/SAK81GFd7LiWNlkA6qIxXbBzMKL6yTe/kP7bui7wqqLCZIXUQtobOotY9iCf/OoSo/tIzG7/juNvK+gwl7nisFqu2mJp8sAD4Tcc7edXjfC2JU7r2oRtaaq4O0e5A25/v6SZAe433mAR7nP/0X1kOEfr9TgXx6ufZOtgtc2xwT+AjucqVQ81WRhQmmxbJKmQDwrJ/OChwC+xQTfL5bRy9jnwjVH6rzTmU6WsplLtP9/AznFKZCT3Qlh+BGtHeTtJoFFbyfZQl27aI6Kk84JTG6M7zg75cGaT7ffTd2Ar+gv8UCE+NXQRoRpJOCtLxKz9OUwzcAzeeQDL6D4QnaEerWd1JM+rC9z6BpH+sDwFj2R0G6zHx3ClXUEXVQWS5k7+r3wOh5n3f1FSPwJlP4wj/lSguk7EihsIZXyLeWca11qAK3MiG/sTHn9qYGhYaD0Z5GVoyuNX4/1qONUZHtIyp+F9c2Jm8FGOrBdJpd7zB9yMY3nI0iDqxDAa//UTTfygECp4/xO7QmdEJd6eMItW8I6A29DrcIOzJl4bEkAQApCi/speyJfus5WF6rA1XxW953cAQebdSkSrImBWJ3V55XvJUVZAULHQ3vLAraPWmbzqS2VRRoP9dlPBfe9JsjtA84JE9w0Z7vJtroZ7An9cG9X8E61ZCx4Vin3B18H2+zUb/Pz1dG2PUrKQDeiskbwmBX3s9+MefsRU1t/3JUaFdykv+c9xSWdc+YcyHgXuD7wXu6ls9dSxYnmQDWJ3ATK+Xf+HkGG98FnSgAPud9PpGqT0hjha8HYXhEFbWDq9jrD2UvUo720lTm/aAuvMoUxxcS1FDEZdxQxvX/yOQT5ZhsyGDqzWPj/KWLX2sCGtID1HZbXLG5MX1d9hGgXq59vMEQo7E1dEaDSntgDEsN8tTvJzup8Z/g2g+PQcW7qMrXRKVYUqW8rUbxrsu2IhKeedMqPmsax8ZUVKjRk6twTz1deVPWITy+4UpBT3H8icKi6HXKFdoNNW78jXkEANS0h7zvJrnqB4n4PB6kX5vPfdx/n7cc2tefaZYN6ITrb06/RRR3uuoMF7eUKbBCznUlp5/PFdQOOtMh2ky1PCktotkY1+5W8py0fJYwn1gTIE5Nghp1Mj/PpfPkuhq9oBURdtxkV7t5CdVaODWryo6RBHi0v8jPcCReHKTDvfO6l3k/acOnR8eo/81lqv72PbdkbOitEY2hIaVjuoD3GmqNl1GrDDu6zqgffegHGRuhFfrvYATNxSjT5wb6qtLac0OaDyAO2NmI2AonRVzvSkFCu9egAX4pSB+Yz990Hb3F1Wz81fKMb5ThnEkUvn6c+mGuNNHofPPdK6wILaZXQK89ISLfhey1V/AZuzC/ONZhOUSBUOZyF2052JWiKZu9Ro77Wi9GM72GvV4XU7nxPMcFaVbMdS5mo4NQ/XqFNNmV7FlbTGPt5qJj9pt4bjjysoLfvVrAbLR84ApGj+ap3BhnH256LlTOd6rcE2O4wnpJN3C1dUL+25WGPxsLVBZUhNGuFOIaBWIZMMowJ+IYnII/cMnLpkPiY1TkQX7+m2tz2Fq/SZQAwLyDY1z2yD+oyYNjjl3misXLO69cJ+YUzNsU1GR+WuE6cjvfe4tp5Nu49iNoIY/xvTcyfZTjOt0TfAWFnd95BMBg2uHH8fMiagH3VKnxoWEc4n13q6stiyj4ijI34Rga+QERAg3DVwhdTXP2wUF2Cxv4GzHn9EhoQL0yCoCR7J2j+HuFyr9SIchLPWF0LoXw11LKohzmM1nWSLi/ovM8mgtoBhW3X471Kua9MZKuEnzOe+jDXXxgS72SNpX0KNc2ZjyAtv5kl83TD1vuRld8lCKr5/lMF+90hD29vM7eeSgA4Pk/nf6jhxI0hmrQLUd760JB3T0hdeM5rQll2S0ljx5RmkIR+xbOPzth5cgg7eyKh3FGAbt3uteTXew+foxxpcUoEPxySQ4Bdy9NhHICh2zD3YKV6FnvnN0TbH/0/jdV6D00VDCfJfQT2bUkR1OwnuRq57zOyk4U/Gk9fM8Ecxua8g4pHToa/x+cF3VYRABgyui+rjSxIrR59nWVW70Xzix/3gEqe/8aFEZXOp26FKx8zXRA5VFpEVvRz2Wbw/ACK/ZtZT4n7hMhqFvRl7Mzha4VAP1ZMRtjKuTFfOaik6+Wufbhs81eDxdGT8bZvs08bo8tYM8f5TuBFoPIOzhfT6sjAYA4m83LzGN4xg54WiU0gFD1u8t8nuoqN2FonwhbuVZz1Neko2ZAAbuqgRUQMdmv5rxmGggUgsf/0gh7s+hzIrZiYIxGAM6hhhLHKUwNBd5T2GmE7wlm5BOe/d5Mtf38iGtAwB5m7OlG8z20U3jFV4u5PsKdMQHnq6724//NEX6clhpef0WlBACGhRAie4NXIfZ12Ya34kCsgT/f4NwavqAG9ny9y/h9JaO6MMR0PYVrkXkYcfZ5T9cxXt3WBYT8npjynOWUc6tr76B820UvoHpMgjYGE/H1iO+fpTZ6Y4IvBSrzMGoKM6pQj+IaNbS8vahFw3mL4Km7O1P9KCeI4ccRlX2fMvJDof3K+w7e1K/U+J00lfnbSkVJYqLKRFdyvL6Ws0w/ycp9ZE7zB2xMTaOaO0cvz9DzYfThoAQBEgaI3ek6et2fp//ioYT8d3ElJ6FzlY9sjXMCIn7lPpq0e1MIrezM9l5OkAvUyINd+1GAV2kG/KJAflGzturJVqsFqAzP0VFzZ07NA6rvHnQqjXf54zPQIPuy5xxWB+/iuAS/D/wHX6bG2I8q/QGeRjCHmgzCfaMcmVhY9kzz/orSl36jjSl4N0mw6f0GuIRm4xtex7OcdaGby7dCEoTiugn+pI6ORiwLbtKC1ny87P0+TNNz5nNIRB4Dg9SUM5+/xdxP1rR+kJpbi7MwSKNMftvl/P0zQepR4L67BOnR1vL4VZBuaK0NS4O0SUo5vJ/w+6gyejVIYyLy6hqkS7xz7w/SIHPO/gnX2jHl3d8epOUF38PvWXa9g9QrSN2ZJ+rQ74J0cpAaeSwtod6MDNJ/Et7ZLv79lxvmOopq6iPe9/AF/DtjHpNddCzBt1zlp/emgRBZhJj2csmrswx10UulLXLtw5bz8in2VtcX6L2LLGwxn2oyotkmscfMYr/PYi/VkHIe3uPaBXrY7yY48eJMV5gM91KTfM4zy05guX2DKvghFXKmOj5j0XkYK1z7Gadoj1/n86MnR1AYJr1l3S0bw5+rxxxDG3240hoAuCdGMh6W4bcrKb2ifj+nwL2UqwFkTV+Nuf5k77ztUrSnqJ7sg5ieLC2dl+M9oZy/HaR1+duf5PjtiiBtFaSe7LniEo5/hmWcRwPYkseTWBSk12KO/Zvv3c8XPelxQVot4liSBrBDynu/ogxN6Hpzb3sF6amIc6YGqX+G8t8pQRNpCdJuUb+rhKMHgSwbRnx/I6VtEpjhtjTi+0muepuOlkt3DiFFkWe3ot+56ECeQdQAVst5XzNznIu5AOfRToaN/L2c11pMO3xJQlrm8kcpdqX/qGfKeejNj455f2vHOD+b+awfZLKN2/sbQq0D94VFPEabnnZezh5/Gp2s2LHpbH7fg/9vHfGbLXl+khaFe7okQROBZvRgpUcBLMcnNPC4oajbEoZAjqtjRx0805vFeLb/lLMRxk1sGlvAEz83xiSJcxr2oBf82ALvoLHC54Vg6DHL2na9aIbA8TfbO3YFVf2sXvEeLjkI6wzWVcx6nE51HEONx/B4ntWMEWPyaar5vzVCewnvOa68YLL8NEFoXkkHpIupA2fEmbSVmup6oGtbL8BvFPu5jqvFLHbxIaZrcoimHhno4vdgezyHrRZ6jy93pSCnzWLeKXrorMtYzzN2/QPUwOCN/mGMAICHGXEcGJeeUAfvdiyHx7LQyvf3D45E3c/PeNazWK+HsLygUQ12bbsNDacPZzC1LKS1UjTcKIZHaADz6X94l/6Uxoj2EDfM/DTrwq9jjp9Cbfls73sMnX8+4f4hOP6epHJVAqhdu7Pi+aBXvIkqT8gBCS/iy3Xc+//Ixa+MfI3LN57claonKmzckB9i1zFl9JyMJgDWbcDsvDBuYETK9WdSS7uPDsgo52KXGrxXNMarY3rippR6+jg1xonsPP7KBj6I+fVy1VnTYSj/4l1fRifbNL5TqO37F9C4ofWNT2gDZ1HND+MXfpKi7TzqOsbWVNwJGHJdgoMCuxC/x/PuSHFmTCnjHqrpBPxSwnX/HuPMTHIC/o8579aU5zqz4D1/Jya/mRxmtcNur5rjGH69OEgfxTgBN8t4/U9ndAJeG3Offw7StIjv4ezatMJDuHn5U8Jz7xDzm/szvLO+QXok5dqXsXySwHDgRmnXq6R03ztFZTuW9shhCeeNqBN11GfbBNUM/CzGmZmVU6k2xvEDOseqtXjkm9TKwg1Kz+bz9qzR++0Xo32c77JHZr7n4lcCqgZrJjjdyimnRdSWk3Y5hhP6hITjy+mjSJ2TUkkBMDRFCGBln1EueUvqL9Vh4x/nStMoB8Uc/yuPlwMiwdImUsHHcrOLX5mnXJ6nKn0lTZ2erjbqP4haDhymzEMu+9bXaDhvV+n+WtioPqSwhDPwGVe9OJXZ9CEUFWgnuYwLtVS6gNPmAqQV0M511vi3pn0eN2NvMRtuUwWuBYdc2lz1g+hT2aJKz3uHaxuBqeUuQU+49oE5y+nQW5mjjra6jiMCaY16GZ14SUN5/+NKe2ZOoFM13N3pqDK1vjRedqWAun/l+A2e53uu/a5eqY6oSvKZMh1B29dR44cwu5ae4yTV/NkKXhOSe1OXvEMwnEQY08W898vdxwP0dJhSvis/X8deNu9OwW9QaCxgb/0hTQP8xU5Dc9jYP+D3cLBi+BS7M90Yk+eDLmIefY2AVoZl8M7IeD4coufluUClBQCmiGIyxEsFfrtfDVXOLDb5OS45xPPODC8771zv+bT/MFFl7RRhCSm/F+11DPPUck/ERRU+LzSldmUj/WFBW/oSmmP/oRBYnlE7SwpY6t1JdXBPmn075vjNRFeaVXshBceSWgsA8LmCAmDbOmj4iL/GPm8HpJz3ois5NdMaXZGdiuG4wRDS3a5tqClJS1mfBf9+xPFqCAUI6YMzqNtQyUfkEOqP8+9ZLnql5CzMKfjbStvyRacXd2fDxyKmuxX4fTeah9dTm4QGe3uS6V0NATCu4O+26eTGjxd/tUtfoQfqKkKV383Q+I8v6H9BUMiBlOJJTr/3WFnejzk+sArvqdFli0vIywz2XDe4VZ8hOc9fm/b+ESnmXx424/vElPq7WJeecF5kbjUEQJGeHL3YqE4uNDhbnnEdNyC1QJJ+nr00bPFzXVvs+0Kq/M1sJNu45LXe0majYeYWPMGYM7BGjNp6hOk5N6f5BXsXzimstX/MKtRo5rHXal3FGjtWx9qQwngpO5C06E2YNhjd2I7aJjqfPGswNNG8yiLgEbF4HBN8Cthe7h4Kg6oIgOHUAqbn+M1udVCQGN45jNJyYkzPjwYZOv0w3XlCwV52uYuamtmRx2jnI258tHcM48D3m88Ipb3GqKANq1hDWtUafsgmbFBNFP5Zhk/XZtkV2egVHdV3WF8vyNl2Nmd6JxQA1XK67VTl86sFHEeYePFyxEvf2xNqcDQ9UvA659GPkIVweSs7cQp2sj9kCC/6StPDJBHO1hPlM5XaC0Yseqe0qbnmb96RBQw5I6x3BwqPl6k5nODybXoCjfHyLHZouVIxD2PqqEDn0P6eZ1RxNMCoiT5PFcj/WjbgPMym6QGT44oYGxw9wsyM+b0qAVAx4H+ZkkNYhCr8aS77ojl3UCvFqID1PcHkRMQmhs+vcunL0eP46c7EL1Qr2COPPd+bPoB6Ar0zFiMNF46MG856Ooe6jd4ZC6n+oKC6i8L+fkoPgYkpIzPkVc7mGM3UYN526SsCoVxPdPUzvFstoE7vl3IO3tedngZ5ZkJZtLKnh5r/UEreWAvxWOb1bde2n6XPDaHqX20BgKEIeMEXZjh3nKtdzHke7nbpSzZja2cElQzOUEHOKMNkyMobGYTQj1z7PR3iCKcM+zRSC3k9Qx7wRH8z4vvuOXwUXTJ+Vw7l+kumphyHin6M67hsG4KPEPexs2ee3cN3/HDO+4BGiiFkOOIxOoSRhT7mHjpontUSAChgOKUezSgAVmX17wZW9JaISgVnH+Lcf+Nqs/wzNJf51FiaKICXU0jBhAl3ss0Cfj+LdaTVNDyokb1y1IO3XPvdlRv4LlZmbJitERpTpZ2cDSbfIsIBu1lhGHMINbElVNXx7E+yQb8Vo00hdPcxCgfshv3bHP6hOMKdomGKY37NJPoPOvgKME3Xfl7gigWvRHGSy7aVNx744Apd80nXOQFFDa4+vNiQ9oNo4zWz8Te7YrvvouEPiFFNF7hsEXZdWZ8aPAEQ5pEWqASBM55mYov3++kueWJZHhBwtWnE/eBaiLLMso33Wjx/Kd/3Upd9jsi2NN/mVale9OO7aqmVBuBc9o0uR7pVn3oZwlpcwUbR5OIDjPLk8WEZv2/JoF5XgncLqNtRNn45PXY1WZjHvqoUWRv2Gk4I0SlUUwBkiWwaKgEgxMdTAAzP4E/A7MFGFYMQHz8BAE9x2vj+SBWBEB9PAeAyCIANVARCdB7VXvZpvZTj69bRu0AsNzZXwCwtzOzyl2JCdCPGeeHV9tc7wO+wvvxHrm3oC+O6/rbeo3kevOv+fAMMQw1g/rgXDOkhLNkP7hnD8zBk5C/6iOWq+sdcG9oWdrOBZx7zC5ZHmGyY1dbKZ7c76OCdbOPadoBC3hhy9ZfE6s9nhFk3w3UMfOnt2sK+MdYdtWBFA03DDXg+Yhre4jWbeWywSx5CRB6vuPbDdyiTT7NTajbPkDZEimHVcazL3Vk+eD+Iq8gSy4DZgRgRW4sd7rt89hkRzzCO7ycs+ykuen0DvOdN+JwLeS9RI1Gfcm2BQAha6zgDtYLLgsftOJu0LPFfK3y9cpYFxz55L3BJ7Ge4q2x4rDeX/saxGUEaYI71C9I/eWwyd0bG/49xOfTwvAFcehvHXuTeeeEx7Ff3Jo/dG6SX+L+/jPTQIM3msSnePa4RpHd4LGqJ9nPNst5HRxy/m79dHKRx3r55L8bsZLyHl8cXuAx4E5fN7uIdn8jrr+Bedv49HBikh4O0xLsWPt8SpG5cMruZqcnkt9J8j3SUyfdQlpHP09y/MKo+oHxOCdLrMUujH55Sn1YP0kUxu/Vib8MJ5txNuMfmCu+8uUE6LeI97s7nXcn8143ZYXmeOW+fai8LHsXaKccH1pEGMIe9AnqvjT3tZEPTs63PXsiaMRvz2MPsHRopoYd7GsRIHtvItd9P8ZPsYXDsL+Y+NnPtVyMew54kzH9dT4MYxmNRe+Zdyx4A4b3Hu/ZhvugZ9+ZvEbkYznrEeX9g3uhhnmNPEvZWiG23MfCN1IDwFxOo/M0xGnndbp72CY0Hoa9Y+2Ai/UdLqeUs5ef+7DG7MDXE5BceD3tX7DJ9I98xvnvWaHdbudK+eXt69wkNC1GTPzNm6gw+/zu83hspmi/m3Z9IrWsl39vzLANMxJptyhQLvX6W+c5g+a1g/cH8kYsitJKuTMg/ai1OhBcPNecN6AwfwPCU4/3rSACgkJ4wKq+d0LSlV8Hs7MXx/A4NBOvaTTPCzeaxlfm/u2s/FzwMmkIFfci1rTkwLCGPPq79rMtx5jmiAkteZyMLz93DHPs6nwFBROfyO8wbD3eVQWXdlWYAnvdYNkw0XMxGC4dyfTX0TNd+We/WmP/PdW17FMK8OpLq62i+J0zRxjqBLTw2nveHZ1jA393M34xlwgo4E9iIHc2InfgMeP4T2MhgZlzq2q/igz0Y9uL/KNMdeb1wkZedYoRs6Pz+jWvb7u1mlhvueWv+HjH6CMvFHJjL2VGi7LH9F+bRbMtrvmLKx27/5c89iVrExp+cFL28epVNgOkJKlI3qij1YgKEO/m0MK/TzfdXR+zMEh673KhrvanahnzDnHezl8cvzbEb+d2bVOs/Z847xpx3p5fHD8yx2/kdzIceMc/3CbNDU7iV+Siq/eD8iN16oE7vG5GX3VL8VH43KaJMTvW2sA7Zld9NMLsHwcxaM0d5DeN26uCCiOO/M9vQ7x5x/HxzPyfyu63M/WC77j4569ARJs+bUs79ojn36ojj2wdpGY8/Yky+07x3PI8mYPi79YL0oXfOdzvDBEja1GFAnWkAoaMkDOncwvTW49n7/Ns71mj+n06n1kuubYedccb5NY5SPir/sLeYSifdC65tCvJY877GMo853rHerm1vvykufkdm3P9V/H8XahAH8/fhluGOjspwpRmorVGbTFxpet9QhQ5jzd8zZgTmsH8i4Z0f7tomHJ3u8i3q2dO1TdbxHdpruLZZdlOokvtcZRyRYY//RZPXuS5/aHU4rwXOubNTzg179RUueuepx41WuqUxR0LT+T+sJ0Nd+9WDd+Y5s837HNgZJkDfhGsMcvnXfa824ay50DZrZOUdRY/yTTy2MW2v1Y2KHqrd7xo7eYzxIYxgw7jF2OwQgOsYn8ITRuV+2cvjk7wXFOhtxsvbnXmv7+URx695H6jk5xg7/ddGwG1k1PqnXPTy5m+a59zAtW12GnrhL6Uggmp9micg7P8TTH6PVrAsNzKq8pMxXvJXzWjJBhwpGGfK4Mmc1xxiTLvnXPKU6e5GaL/h4rfxetwI+Y29xjyd1wF2U559+fdBU6b9OkMA9Hbxc/0H1enQaDj55BMcwtmcggoV4n5W3IGsYKPYiFtc2+pALcY+3JC96RZ812+anmgoj3+S+aPxPM1jTcYPMIrvMeztX6GjMHSyrm8clMtd+uSZ2UYL+ALzx7TfS8w5w0zdmJWSV1i5+ptG1o8CMVwA48u8xyWeD6Cb8RO95fW2R9N+vpHJ2tVZGGy0g7iVd5q8ZxhCoR46hRflrDtDTUOb5ZInifVn3Qh78jhNw04yWt0TAHYS0/bscIe5thmx9xqhnEkAVLpH7uXiN1boW4XGW4mFRaYY4TXSta3s+3dK3NlmTD+skHOptvt5hOPiWxh1OlxDroGNP+wFZrr28QVPG3V8jBEAz1HYLGT5bWLyeMU4jtK0gLme0+s9z1tvG0kcLTFOvUYe+zHVW5TL9/nMzeb8LmY0otnLA6o45rIfynSYy7fSlDUJmjM+Q1fzu2aXf2OXbubdpU0F7mIEVNJ1ohyn/YyZ8YDpsMZQo1qN5fuYuY9MowDdK9wgexgpVwsBUIl5BWjIHxoP/2amUS81au9YIxymufaBM8+a3m688dZP4TDQy8arP8Y0+CVeHk0soy1d26rAUyn5w4a+jTn2lMsWnPK2qTi47zu84wsyjuSEE74WMTUYE6AP3+UNRtsYb/JuoHCYb3o32wFheSsMf/3RG6nJysKI+/RpMM+3kOW+2GgQvXLWnYXG/5I2GW6JKe8kc9huDvOupwGEmuJs49cJF9h9lEJ9eR4fAFYcvb7CjbJLgopWKfDif+oqs7vwXNPId6RNZ9X66abhjfXsNGfU2X8Zh8xoT60P7bbtjBDxbffXjH26G+38pea34d+JRgN4IsdzrkzoqWaYBrRlQuMfbZ53pSeAw3KHFvA+K/jXzDnh0OkMfh7p2s8NwTAelhO7sGA5zvSEcBTrmGvOYoMJx/f9eI+sdecd459JquOLzLVGJDhKQx/JcvoJupjGjO+WsacPbf/QeXuXuU6oNTSmNc7Haa9twga1qAINql8G1aYosKlPpgPnNNcxvLYIzaaR786KMMsIhWmmgMd4trttXGEDxVj1WmzMr3h5jKVjZ4XruLLsUpodYE/2BC+5tpV/nzGVe32en2ep6S6mF/SXvZpl8traVELLJNM7PZwg7HG/Fxizqb+5LphszMWTK2jWvWbMsh2MkLTsbxrTX4zjLFTnT8p5TTTGcAFPlPlxKec/aLThQyOOjzQ9+gt0KvZzbeG9obZyH/+O4zu2S9YvNu+xR9be+Z9sUBuwUGZWQQCU42+YSkGFF/Qrz36tBE97JsVU0yO+4KnIcDAlLRne1eS53PgClns97ssJ92HzaDYmQrNXZjM8E+siOi63zvn80HiuNBUHG5Gu52mK4Y618136dl4Xu3gv9y1G0zmCPf46MbZ8HqDZXGHexeVeLwvN7Hv8H/Xnt/z/NnOvh1B4+WtWrM22g3eDQCNE8oXReJebRodAqG97baA7hUP47OEyYIhY3Nuch2teamz3K/hM/U3bmW867ve9jvwdY2qE5dhRmGYMbmgM0pFBerJAcM7OMXl+t0BedzJIxlU5bezFo3/LHEMwxlRz7PcxeWzBWPWQr3hx5v8wx65NCEyyHOzNQbBx6pckBKQ85M1LQLqGx94N0loR125gIEvIbM4x+IP3bo43vwkDgRBMNdbL7zDvWXY1x3Y0AUrhPWFOwH1Bes18f0DE/I2PYp4/LKvbzO9n8blvNwE24Mve73YJ0kJz/G3G6t/COR4IvBkRpN3MOdNMoM5XvWfFHJA7GJj0LMt+MM890ptj8EcGBdmyvZ2Bc2HdnM/v7XyH+8z5h5rvf26eYQ3/HRVpHHtHRKQVEQCn58jjqiBtU4OGH6Ye3gSYT3vHr4uJ9rOpjylENIjNveO3mjyOjsljECMMw2i2jb3j95g8DvKOHWCO3R0hAK7nMVT0tROe4dKISSpgDiu6Pf8gc3xcRGN83Bz3I/PGB+nPntBs9QTQDt5v1jPC6IqYZ+jPBhWV7yw2wKjfTeSEqzgQHbmt+fywNznrME4ci8PWh6P5Pn1Wsu73NeduaY4fYr7/mokKtNGU5/D7ZRRa7Z6ziHp1HxPGHY+NsV3KcQ6GvE+17DLXcWputVlOVXRzz2sf8juqVk0uftOGcCun0fS0z/CO/4bq30rjxPH5iCrmCHqAfVPsOpogy1zHXYomU22Ef+CXET6Xu1zbhJsPE57hJPon9nBt04mhsv8h4r5fpLq/wnXcPhy/O4vDeysiTIJn6MTdjQ7W1c07+Cef7wXvNx/wHQ9x7fdJ9Ec0vsHf70a/xQr6Y7AMd1ywD2xobNx5IEdrBtI0+ogm3HSWyYX0Bf3Cc6jeyPcxif6HvizrcCehN82517B+HMiybqQK/wCdoUs9R+N5NAPs8uH3cuh6rjfE+xjb0HxvpKrkiPGWBS/CSDo7DnfR+9nvYhwsFtiQUVtcvUKb8lKXvoOuEKIKQ3R5va1wFCKq7VTjLXfGmxqFH3OAISxEfyHY4ydq/EKsGgIgBF7yn7vSEOIR7PUXuviJKQuZbqV6CZPiWhWJELWjEiaAEEIagBBCAkAIIQEghJAAEEJIAAghJACEEBIAQggJACGEBIAQQgJACCEBIISQABBCSAAIISQAhBASAEIICQAhhASAEEICQAghASCEkAAQQkgACCEkAIQQEgBCCAkAIYQEgBBCAkAIIQEghASAEEICQAghASCEkAAQQkgACCEkAIQQEgBCCAkAIYQEgBBCAkAIIQEghJAAEEJIAAghJACEEBIAQggJACGEBIAQQgJACCEBIISQABBCSAAIISQAhBASAEIICQAhhASAEEICQAghASCEkAAQQkgACCEkAIQQEgBCCAkAIYQEgBBCAkAIIQEghJAAEEJIAAghASCEkAAQQkgACCEkAIQQEgBCCAkAIYQEgBBCAkAIIQEghJAAEEJIAAghJACEEBIAQggJACGEBIAQQgJACCEBIISQABBCSAAIISQAhBASAEIICQAhRNX5XwEGAHVg0DudDdzFAAAAAElFTkSuQmCC";UnityLoader.Progress.Styles.Dark.progressLogoUrl=pt;UnityLoader.Progress.Styles.Light.progressLogoUrl=pt;if(UnityLoader.SystemInfo.mobile){UnityLoader.SystemInfo.mobile=false;UnityLoader.downloadJob=function(xt,yt){var zt=new XMLHttpRequest;zt.open("GET",yt.parameters.url);zt.responseType="arraybuffer";zt.onload=function(){UnityLoader.Compression.decompress(new Uint8Array(zt.response),function(At){yt.complete(At)})};if(yt.parameters.onprogress)zt.addEventListener("progress",yt.parameters.onprogress);if(yt.parameters.onload)zt.addEventListener("load",yt.parameters.onload);zt.send()}}UnityLoader.processWasmFrameworkJob=function(Bt,Ct){var Dt=UnityLoader.Job.result(Bt,"downloadWasmFramework");UnityLoader.loadCode(Bt,Dt,function(Et,Ft){Bt["mainScriptUrlOrBlob"]=Ft;if(Bt.isModularized){UnityLoader[Et]=UnityModule}Bt["instantiateWasm"]=function(Gt,Ht){tt(Bt,Gt["env"]);if(Bt["wasmBinary"]){WebAssembly.instantiate(Bt["wasmBinary"],Gt).then(function(It){Ht(It.instance,It.module)})}else{console.info("MiaokitLoader.InitUnity.instantiateWasm error!")}return{}};UnityLoader[Et](Bt);Ct.complete()},{Module:Bt,url:Bt["wasmFrameworkUrl"],isModularized:Bt.isModularized})};var qt=null;var rt=null;var st={};function tt(Jt,Kt){Object["assign"](Kt,{_Init:function(Lt,Mt){ot["WASM"]["m_pMemory"]=ot["WASM"]["m_pMemory"]||rt.Module.wasmMemory;ut(Jt,st,Lt,Mt);vt(rt,st);qt.OnEngineLoad(st)},_RenderingEvent:function(Nt){qt.OnRenderingEvent(Nt)}});ot["GL"]=Kt}function ut(Ot,Pt,Qt,Rt){var St=ot.WASM.GetString(Qt,Rt);var Tt=JSON.parse(St);var Ut=function(Yt){var Zt=function(){var $t=Array.prototype.slice.call(arguments);$t.unshift(Zt["m_nAddr"]);return Zt["m_pFunc"].apply(this,$t)};Zt["m_pFunc"]=Ot[Yt.Call];Zt["m_nAddr"]=Yt.Addr;Pt[Yt.Name]=Zt};for(var Vt=0,Wt=Tt.List;Vt<Wt.length;Vt++){var Xt=Wt[Vt];Ut(Xt)}}function vt(_t,au){au["APP_PLUGIN_TYPE"]=function(){return 1};au["APP_MEM_TYPE"]=function(){return 1};au["memory"]=function(bu){var cu=32*1024*1024;var du=bu._memalign(16,cu);var eu=cu-du;bu._free(du);var fu=bu._memalign(16,eu+cu);if(fu!==du){console.error("miaokit.prememory: addr error",du,fu);return}if(fu+eu+cu!==67108864){console.error("miaokit.prememory: addr end error",fu+eu+cu);return}au["APP_MEM_RESERVE"]=function(){return fu};return bu.wasmMemory}(rt.Module);au["APP_MEM_MALLOC"]=function(gu){return rt.Module._memalign(16,gu)};au["APP_MEM_FREE"]=function(hu){rt.Module._free(hu)};au["APP_MEM_BASE"]=function(){alert("UNITY��չ��֧��ʹ�������ڴ�!");return 0};au["APP_MEM_GROW"]=function(iu){alert("UNITY��չ��֧��ʹ�������ڴ�!");return 0};au["APP_MEM_RECYCLE"]=function(ju){alert("UNITY��չ��֧��ʹ�������ڴ�!");return 0}}function wt(ku){qt=ku;rt=UnityLoader.instantiate("unityContainer",ot["m_pConfig"]["UNITY"])}ot["WASM"]=ot["WASM"]||{};ot["WASM"]["LoadEngine"]=wt;return[]});MiaokitMerge(function(lu){var mu=undefined;var nu=new TextDecoder("utf-8");var ou=new TextEncoder;function pu(qu){if(!mu||lu["WASM"].m_pMemory.buffer.byteLength!==mu[0].byteLength){if(!mu){mu=[]}mu[0]=new Int8Array(lu["WASM"].m_pMemory.buffer);mu[1]=new Uint8Array(lu["WASM"].m_pMemory.buffer);mu[2]=new Int16Array(lu["WASM"].m_pMemory.buffer);mu[3]=new Uint16Array(lu["WASM"].m_pMemory.buffer);mu[4]=new Int32Array(lu["WASM"].m_pMemory.buffer);mu[5]=new Uint32Array(lu["WASM"].m_pMemory.buffer);mu[6]=new Float32Array(lu["WASM"].m_pMemory.buffer);mu[7]=new Float64Array(lu["WASM"].m_pMemory.buffer)}return mu[qu]}lu["WASM"]=lu["WASM"]||{};lu["WASM"]["HEAP8"]=function(ru,su){if(ru===void 0){ru=0}if(su===void 0){su=0}var tu=pu(0);if(ru&&su){return tu.subarray(ru,ru+su)}else{return tu}};lu["WASM"]["HEAPU8"]=function(uu,vu){if(uu===void 0){uu=0}if(vu===void 0){vu=0}var wu=pu(1);if(uu&&vu){return wu.subarray(uu,uu+vu)}else{return wu}};lu["WASM"]["HEAP16"]=function(xu,yu){if(xu===void 0){xu=0}if(yu===void 0){yu=0}var zu=pu(2);if(xu&&yu){return zu.subarray(xu/2,(xu+yu)/2)}else{return zu}};lu["WASM"]["HEAPU16"]=function(Au,Bu){if(Au===void 0){Au=0}if(Bu===void 0){Bu=0}var Cu=pu(3);if(Au&&Bu){return Cu.subarray(Au/2,(Au+Bu)/2)}else{return Cu}};lu["WASM"]["HEAP32"]=function(Du,Eu,Fu){if(Du===void 0){Du=0}if(Eu===void 0){Eu=0}var Gu=pu(4);if(Du&&Eu){if(Fu){return Gu.slice(Du/4,(Du+Eu)/4)}else{return Gu.subarray(Du/4,(Du+Eu)/4)}}else{return Gu}};lu["WASM"]["HEAPU32"]=function(Hu,Iu){if(Hu===void 0){Hu=0}if(Iu===void 0){Iu=0}var Ju=pu(5);if(Hu&&Iu){return Ju.subarray(Hu/4,(Hu+Iu)/4)}else{return Ju}};lu["WASM"]["HEAPF32"]=function(Ku,Lu,Mu){if(Ku===void 0){Ku=0}if(Lu===void 0){Lu=0}var Nu=pu(6);if(Ku&&Lu){if(Mu){return Nu.slice(Ku/4,(Ku+Lu)/4)}else{return Nu.subarray(Ku/4,(Ku+Lu)/4)}}else{return Nu}};lu["WASM"]["HEAPF64"]=function(Ou,Pu){if(Ou===void 0){Ou=0}if(Pu===void 0){Pu=0}var Qu=pu(7);if(Ou&&Pu){return Qu.subarray(Ou/8,(Ou+Pu)/8)}else{return Qu}};lu["WASM"]["GetString"]=function(Ru,Su){if(!Su){var Tu=lu["WASM"].HEAPU8();var Uu=Ru;while(0!==Tu[Uu++]);Su=Uu-Ru-1}var Vu=lu["WASM"].HEAPU8(Ru,Su);var Wu=nu.decode(Vu);return Wu};lu["WASM"]["SetString"]=function(Xu,Yu){var Zu=ou.encode(Yu);var $u=lu["WASM"].HEAPU8(Xu,Zu.byteLength);$u.set(Zu)};lu["WASM"]["EncodeString"]=function(_u){return ou.encode(_u)};lu["WASM"]["m_pMemory"]=null;return[]});