var MiaokitModule=function(a,b){var c=this;c["m_pConfigPath"]=b;c["m_pConfig"]={ENGINE:a};c["Merge"](c);c["Preload"]()};var MiaokitMerge=function(d){var e=[];d["Merge"]=d["Merge"]||function(f){for(var g=0,h=e;g<h.length;g++){var i=h[g];var j=i(f);if(j){for(var k=0,l=j;k<l.length;k++){var m=l[k];f[m._name]=m}}}};return function(n){e.push(n)}}(MiaokitModule.prototype);MiaokitMerge(function(o){var p=undefined;var q=undefined;var r={};var s=function(u,v){if(v===void 0){v=undefined}var w=0;this.length=u(-1);this[Symbol.iterator]=function(){return{next:function(){var x=u(w);if(x){var y=p(x);w=v?w+1:y.m_nObject;return{value:y,done:false}}return{value:undefined,done:true}}}}};r["Transform"]=function(z){Object.defineProperty(z,"position",{get:function(){var A=this["_GetPosition"]()/4;var B=o["WASM"].HEAPF32();return{x:B[A],y:B[A+1],z:B[A+2]}},set:function(C){this["_SetPosition"](C.x,C.y,C.z)}});Object.defineProperty(z,"euler",{get:function(){var D=this["_GetEuler"]()/4;var E=o["WASM"].HEAPF32();return{x:E[D],y:E[D+1],z:E[D+2]}},set:function(F){this["_SetEuler"](F.x,F.y,F.z)}});Object.defineProperty(z,"rotation",{get:function(){var G=this["_GetRotation"]()/4;var H=o["WASM"].HEAPF32();return{x:H[G],y:H[G+1],z:H[G+2],w:H[G+3]}},set:function(I){this["_SetRotation"](I.x,I.y,I.z,I.w)}});Object.defineProperty(z,"scale",{get:function(){var J=this["_GetScale"]()/4;var K=o["WASM"].HEAPF32();return{x:K[J],y:K[J+1],z:K[J+2]}},set:function(L){this["_SetScale"](L.x,L.y,L.z)}});Object.defineProperty(z,"localPosition",{get:function(){var M=this["_GetLocalPosition"]()/4;var N=o["WASM"].HEAPF32();return{x:N[M],y:N[M+1],z:N[M+2]}},set:function(O){this["_SetLocalPosition"](O.x,O.y,O.z)}});Object.defineProperty(z,"localEuler",{get:function(){var P=this["_GetLocalEuler"]()/4;var Q=o["WASM"].HEAPF32();return{x:Q[P],y:Q[P+1],z:Q[P+2]}},set:function(R){this["_SetLocalEuler"](R.x,R.y,R.z)}});Object.defineProperty(z,"localRotation",{get:function(){var S=this["_GetLocalRotation"]()/4;var T=o["WASM"].HEAPF32();return{x:T[S],y:T[S+1],z:T[S+2],w:T[S+3]}},set:function(U){this["_SetLocalRotation"](U.x,U.y,U.z,U.w)}});Object.defineProperty(z,"localScale",{get:function(){var V=this["_GetLocalScale"]()/4;var W=o["WASM"].HEAPF32();return{x:W[V],y:W[V+1],z:W[V+2]}},set:function(X){this["_SetLocalScale"](X.x,X.y,X.z)}});Object.defineProperty(z,"right",{get:function(){var Y=this["_GetRight"]()/4;var Z=o["WASM"].HEAPF32();return{x:Z[Y],y:Z[Y+1],z:Z[Y+2]}},set:function($){this["_SetRight"]($.x,$.y,$.z)}});Object.defineProperty(z,"up",{get:function(){var _=this["_GetUp"]()/4;var aa=o["WASM"].HEAPF32();return{x:aa[_],y:aa[_+1],z:aa[_+2]}},set:function(){var ba=this["_SetUp"]()/4;var ca=o["WASM"].HEAPF32();return{x:ca[ba],y:ca[ba+1],z:ca[ba+2]}}});Object.defineProperty(z,"forward",{get:function(){var da=this["_GetForward"]()/4;var ea=o["WASM"].HEAPF32();return{x:ea[da],y:ea[da+1],z:ea[da+2]}},set:function(){var fa=this["_SetForward"]()/4;var ga=o["WASM"].HEAPF32();return{x:ga[fa],y:ga[fa+1],z:ga[fa+2]}}});z["Rotate"]=function(ha,ia){this["_Rotate"](ha.x,ha.y,ha.z,ia)};z["Rotate2"]=function(ja,ka,la){this["_Rotate2"](ja.x,ja.y,ja.z,ka,la)};z["Translate"]=function(ma,na){this["_Translate"](ma.x,ma.y,ma.z,na)};z["TransformPoint"]=function(oa){var pa=this["_TransformPoint"](oa.x,oa.y,oa.z)/4;var qa=o["WASM"].HEAPF32();return{x:qa[pa],y:qa[pa+1],z:qa[pa+2]}}};r["GameObject"]=function(ra){Object.defineProperty(ra,"name",{get:function(){if(!this._name){var sa=this._GetName(0);var ta=this._GetName(1);this._name=o["WASM"].GetString(ta,sa)}return this._name}});Object.defineProperty(ra,"transform",{get:function(){return p(this["_GetTransform"]())}});Object.defineProperty(ra,"mesh",{get:function(){return p(this["_GetMesh"]())},set:function(ua){this["_SetMesh"](ua.m_nObject)}});Object.defineProperty(ra,"children",{get:function(){var va=this;return new s(function(wa){return va._IterChild(wa)},true)}});Object.defineProperty(ra,"parent",{get:function(){return p(this["_GetParent"]())}});Object.defineProperty(ra,"data",{get:function(){return p(this["_GetUserData"]())},set:function(xa){}});Object.defineProperty(ra,"enableCollider",{set:function(ya){this["_EnableCollider"](ya)}});Object.defineProperty(ra,"active",{set:function(za){this["_Active"](za)}});Object.defineProperty(ra,"highlight",{set:function(Aa){this["_Highlight"](Aa)}});Object.defineProperty(ra,"transparent",{set:function(Ba){this["_Transparent"](Ba)}});ra["Destory"]=function(){this["_Destory"]()};o["GameObject"]=function(){return p(ra._GameObject())}};r["Miaokit"]=function(Ca){Ca["LoadTile"]=function(Da){var Ea=this["_Malloc"](Da.byteLength);if(Ea){o["WASM"]["HEAPU8"](Ea,Da.byteLength).set(new Uint8Array(Da));var Fa=this["_LoadTile"](Ea,Da.byteLength);var Ga=p(Fa);return Ga}return null};Ca["Analyze"]=function(Ha){var Ia=this["_Analyze"]();var Ja=o["WASM"].HEAP32()[Ia/4];var Ka=o["WASM"].GetString(Ia+4,Ja);try{var La=JSON.parse(Ka);var Ma=q(Ha).concat(La);return Ma}catch(Na){console.log(Ka)}return null};Ca["PickEntity"]=function(Oa){return p(this["_PickEntity"](Oa))};Ca["GetScene"]=function(Pa){return p(this["_GetScene"](Pa))};Ca["WorldToScreenPoint"]=function(Qa){var Ra=this["_WorldToScreenPoint"](Qa.x,Qa.y,Qa.z)/4;var Sa=o["WASM"].HEAPF32();return{x:Sa[Ra],y:Sa[Ra+1],z:Sa[Ra+2]}};Ca["ScreenPointToRay"]=function(Ta){var Ua=this["_ScreenPointToRay"](Ta.x,Ta.y,Ta.z)/4;var Va=o["WASM"].HEAPF32();return{m_mOrigin:{x:Va[Ua],y:Va[Ua+1],z:Va[Ua+2]},m_mDirection:{x:Va[Ua+4],y:Va[Ua+5],z:Va[Ua+6]}}};Object.defineProperty(Ca,"camera",{get:function(){return p(this["_GetCamera"]())}});Object.defineProperty(Ca,"cameraMode",{set:function(Wa){this["_SetCameraMode"](Wa)}});Object.defineProperty(Ca,"gis",{get:function(){if(!this._gis){this._gis=r["Gis"]["g_pIns"]}return this._gis}});Object.defineProperty(Ca,"progress",{get:function(){return this["_GetProgress"]()}})};r["Mesh"]=function(Xa){Xa["SetVertices"]=function(Ya,Za){this["m_aVertex"]=this["m_aVertex"]||[];this["m_aVertex"].push({m_pArray:Za,m_nSlot:this["_SlotLut"][Ya],m_nItemSize:this["_SizeLut"][Ya]})};Xa["SetIndices"]=function($a,_a,ab){this["m_aIndex"]=this["m_aIndex"]||[];this["m_aIndex"][$a]={m_pArray:_a,m_nItemSize:ab}};Xa["Apply"]=function(){var bb=this["m_aVertex"];var cb=this["m_aIndex"];if(!bb||!cb){return}var db=2+2*bb.length+3*cb.length;var eb=this._CreateBuffer(db);var fb=o["WASM"]["HEAP32"](eb,db*4);var gb=0;fb[gb++]=bb.length;fb[gb++]=cb.length;for(var hb=0;hb<bb.length;hb++){fb[gb++]=bb[hb].m_nSlot;fb[gb++]=bb[hb].m_pArray.length/bb[hb].m_nItemSize}for(var hb=0;hb<cb.length;hb++){fb[gb++]=0;fb[gb++]=0;fb[gb++]=cb[hb].m_pArray.length}this._CreateBuffer(0);for(var hb=0;hb<bb.length;hb++){var ib=bb[hb].m_pArray;var jb=this._GetVertexBuffer(hb);var kb=o["WASM"]["HEAPF32"](jb,ib.length*4);kb.set(ib)}for(var hb=0;hb<cb.length;hb++){var ib=cb[hb].m_pArray;var jb=this._GetIndexBuffer(hb);var kb=o["WASM"]["HEAP32"](jb,ib.length*4);kb.set(ib)}this._Apply();this["m_aVertex"]=undefined;this["m_aIndex"]=undefined};Xa["_SlotLut"]={position:0,normal:1,uv:2,color:3,tangent:4,uv2:9,uv3:10,uv4:11,uv5:12,uv6:13,uv7:14,uv8:15};Xa["_SizeLut"]={position:3,normal:3,uv:2,color:4,tangent:4,uv2:2,uv3:2,uv4:2,uv5:2,uv6:2,uv7:2,uv8:2};Object.defineProperty(Xa,"position",{set:function(lb){this.SetVertices("position",lb)}});Object.defineProperty(Xa,"normal",{set:function(mb){this.SetVertices("normal",mb)}});Object.defineProperty(Xa,"uv",{set:function(nb){this.SetVertices("uv",nb)}});Object.defineProperty(Xa,"triangles",{set:function(ob){this.SetIndices(0,ob)}});Object.defineProperty(Xa,"material",{set:function(pb){this.SetMaterial(0,pb)}});o["Mesh"]=function(){return p(Xa._Mesh())}};r["Texture2D"]=function(qb){qb["SetImageData"]=function(rb){var sb=this._CreateBuffer(rb.byteLength);if(sb){o["WASM"]["HEAPU8"](sb,rb.byteLength).set(new Uint8Array(rb));this._Apply()}};qb["Load"]=function(tb){var ub=this;o["Fetch"](tb,function(vb){if(vb){ub.SetImageData(vb)}})};o["Texture2D"]=function(wb){var xb=p(qb._Texture2D());if(wb){if("string"===typeof wb){this.Load(wb)}else{this.SetImageData(wb)}}return xb}};r["Material"]=function(yb){if("Sisyphus"===o["m_pConfig"]["ENGINE"]){o["ShaderLab"].ExpandMaterial(yb)}yb["GetTexture"]=function(){return p(this["_GetTexture"]())};yb["SetTexture"]=function(zb){this["_SetTexture"](zb.m_nObject)};o["Material"]=function(Ab){if(Ab===void 0){Ab=undefined}var Bb=null;if(Ab){var Cb=o["ShaderLab"]["Pipeline"]["InternalShader"];var Db=Cb[0];Cb[0]=Ab;Bb=p(yb._Material());Cb[0]=Db}else{Bb=p(yb._Material())}return Bb}};r["Tile"]=function(Eb){Object.defineProperty(Eb,"scenes",{get:function(){var Fb=this;return new s(function(Gb){return Fb._IterWork(Gb)})}})};r["Scene"]=function(Hb){Hb["GetLayer"]=function(Ib){return p(this["_GetLayer"](Ib))};Object.defineProperty(Hb,"id",{get:function(){if(!this._id){var Jb=this._GetID(0);var Kb=this._GetID(1);this._id=o["WASM"].GetString(Kb,Jb)}return this._id}});Object.defineProperty(Hb,"layers",{get:function(){var Lb=this;return new s(function(Mb){return Lb._IterLayer(Mb)})}});Object.defineProperty(Hb,"object3D",{get:function(){if(undefined===this._object3D){var Nb=this._GetObject(this.m_nObject);if(0===Nb){this._object3D=null;return null}this._object3D=p(Nb)}return this._object3D}});Object.defineProperty(Hb,"viewState",{get:function(){return{m_mTarget:{x:0,y:0,z:0},m_nPitch:45,m_nYaw:0,m_nDistance:60,m_mOrthoTarget:{x:0,y:0,z:0},m_nOrthoScaled:0,m_nOrthoRotate:0}}});Object.defineProperty(Hb,"binding",{get:function(){return p(this._GetBinding())}})};r["Layer"]=function(Ob){Object.defineProperty(Ob,"id",{get:function(){if(!this._id){var Pb=this._GetID(0);var Qb=this._GetID(1);this._id=o["WASM"].GetString(Qb,Pb)}return this._id}});Object.defineProperty(Ob,"sites",{get:function(){var Rb=this;return new s(function(Sb){return Rb._IterSite(Sb)})}});Object.defineProperty(Ob,"object3D",{get:function(){if(undefined===this._object3D){var Tb=this._GetObject(this.m_nObject);if(0===Tb){this._object3D=null;return null}this._object3D=p(Tb)}return this._object3D}});Object.defineProperty(Ob,"viewState",{get:function(){var Ub=this["_GetViewState"]();if(0<Ub){var Vb=o["WASM"]["HEAPF32"](Ub,4*11);var Wb=0;return{m_mTarget:{x:Vb[Wb++],y:Vb[Wb++],z:Vb[Wb++]},m_nPitch:Vb[Wb++],m_nYaw:Vb[Wb++],m_nDistance:Vb[Wb++],m_mOrthoTarget:{x:Vb[Wb++],y:Vb[Wb++],z:Vb[Wb++]},m_nOrthoScaled:Vb[Wb++],m_nOrthoRotate:Vb[Wb++]}}return null}})};r["Attachment"]=function(Xb){Object.defineProperty(Xb,"entityType",{get:function(){return this._GetEntityType()}});Object.defineProperty(Xb,"secondType",{get:function(){return this._GetSecondType()}});Object.defineProperty(Xb,"flag",{get:function(){return this._GetFlag()}});Object.defineProperty(Xb,"object3D",{get:function(){return p(this._GetObject())}});Object.defineProperty(Xb,"viewState",{get:function(){var Yb=this["_GetViewState"]();if(0<Yb){var Zb=o["WASM"]["HEAPF32"](Yb,4*11);var $b=0;var _b={m_mTarget:{x:Zb[$b++],y:Zb[$b++],z:Zb[$b++]},m_nPitch:Zb[$b++],m_nYaw:Zb[$b++],m_nDistance:Zb[$b++],m_mOrthoTarget:{x:Zb[$b++],y:Zb[$b++],z:Zb[$b++]},m_nOrthoScaled:Zb[$b++],m_nOrthoRotate:Zb[$b++]};console.log("attachment view:",_b);return _b}else{console.log("attachment view: null")}return null}})};r["Site"]=function(ac){Object.defineProperty(ac,"id",{get:function(){if(!this._id){var bc=this._GetID(0);var cc=this._GetID(1);this._id=o["WASM"].GetString(cc,bc)}return this._id}});Object.defineProperty(ac,"layer",{get:function(){return p(this["_Layer"]())}});Object.defineProperty(ac,"scene",{get:function(){return p(this["_Scene"]())}});Object.defineProperty(ac,"type",{get:function(){return this["_Type"]()}});Object.defineProperty(ac,"number",{get:function(){return this["_Number"]()}});Object.defineProperty(ac,"position",{get:function(){var dc=this["_Position"]()/4;var ec=o["WASM"].HEAPF32();return{x:ec[dc],y:ec[dc+1],z:ec[dc+2]}}})};r["Prefab"]=function(fc){fc["Instantiate"]=function(){return p(this["_Instantiate"]())};o["LoadPrefab"]=function(gc,hc){o["Fetch"](gc,function(ic){var jc=null;if(ic){var kc=fc._Prefab();var lc=p(kc);var mc=lc.CreateBuffer(ic.byteLength);if(mc){o["WASM"]["HEAPU8"](mc,ic.byteLength).set(new Uint8Array(ic));lc.Apply();jc=lc}}hc(jc)})}};r["Gis"]=function(nc){nc["Update"]=function(oc,pc,qc){return this["_Update"](oc,pc,qc)};nc["AddSvetile"]=function(rc){var sc=o["WASM"]["EncodeString"](rc.m_pUrl);var tc=this["_CreateSvetileDesc"](sc.byteLength);var uc=o["WASM"]["HEAPU32"](tc,4*8);uc[0]=rc.m_nID;uc[1]=rc.m_nFlags;o["WASM"]["HEAPU8"](uc[2],sc.byteLength).set(sc,0);uc[3]=0;uc[4]=o["WASM"]["RegisterDelegate"](function(wc,xc){rc.OnActive(p(wc),0<xc)});var vc=o["WASM"]["HEAPF32"](tc+20,16);vc[0]=rc.m_mLngLat.x;vc[1]=rc.m_mLngLat.y;vc[2]=rc.m_mSize.x;vc[3]=rc.m_mSize.y;this["_AddSvetile"](tc)};nc["AddMapbox"]=function(yc){var zc=this["_GetMapboxDesc"]();var Ac=o["WASM"]["HEAPF32"](zc,40);Ac[0]=yc.m_mOffset.x;Ac[1]=yc.m_mOffset.y;Ac[2]=yc.m_mOffset.z;Ac[3]=yc.m_mScale.x;Ac[4]=yc.m_mScale.y;Ac[5]=yc.m_mScale.z;Ac[6]=yc.m_mLngLat.x;Ac[7]=yc.m_mLngLat.y;Ac[8]=yc.m_mSize.x;Ac[9]=yc.m_mSize.y;this["_AddMapbox"](zc)};nc["AddGameObject"]=function(Bc,Cc,Dc){this["_AddGameObject"](Bc.m_nObject,Cc,Dc)};Object.defineProperty(nc,"imageServer",{set:function(Ec){if(!Ec){Ec="http://t%d.tianditu.gov.cn/DataServer?T=vec_c&tk=fb14b0853d59b619e18c259898bd0d4d&x=%d&y=%d&l=%d"}var Fc=this["_GetServer"](0);o["WASM"].SetString(Fc,Ec)}});Object.defineProperty(nc,"terrainServer",{set:function(Gc){if(!Gc){Gc="https://t%d.tianditu.gov.cn/dem_sjk/DataServer?T=ele_c&tk=fb14b0853d59b619e18c259898bd0d4d&x=%d&y=%d&l=%d"}var Hc=this["_GetServer"](1);o["WASM"].SetString(Hc,Gc)}})};r["Dioramas3MX"]=function(Ic){Ic["_Load3MX"]=function(Jc,Kc,Lc){var Mc=this;var Nc=Mc.m_pFileLut[Jc];var Oc=Nc.m_pPath+Nc.m_aFile[Kc];o["Request"]("GET","arraybuffer",Oc,null,null,function(Pc){if(!Pc){return}var Qc=new Uint32Array(Pc,0,2);if(1113083187===Qc[0]){var Rc=Qc[1]>>8;var Sc=9+Rc;var Tc=Pc.byteLength-Sc;var Uc=new Uint8Array(Pc,9,Rc);var Vc=Mc.m_pTextDecoder.decode(Uc);var Wc=JSON.parse(Vc);var Xc={m_pPath:Oc.substring(0,Oc.lastIndexOf("/")+1),m_aFile:[]};var Yc=[];var Zc=[];var $c=Wc.resources;var _c=0;for(var ad=0;ad<$c.length;ad++){Yc.push(ad);if("textureBuffer"===$c[ad].type){Yc.push(0);Zc.push(ad);if("jpg"===$c[ad].format){Yc.push(0)}else if("png"===$c[ad].format){Yc.push(1)}else{Yc.push(1e4)}}else if("geometryBuffer"===$c[ad].type){Yc.push(1);if("ctm"===$c[ad].format){Yc.push(0)}else{Yc.push(1e4)}}else{Yc.push(1e4);Yc.push(1e4)}Yc.push($c[ad].size);Yc.push(_c);_c+=$c[ad].size;Yc.push(1e4);if($c[ad].texture){for(var bd=0;bd<$c.length;bd++){if($c[ad].texture===$c[bd].id){Yc[Yc.length-1]=bd;break}}}}var cd=[];var dd=Wc.nodes;for(var ad=0;ad<dd.length;ad++){var ed=dd[ad];var fd=ed.bbMax[0]-ed.bbMin[0];var gd=ed.bbMax[1]-ed.bbMin[1];var hd=ed.bbMax[2]-ed.bbMin[2];var id=Math.sqrt(fd*fd+gd*gd+hd*hd);cd.push(Math.floor(parseInt(ed.bbMin[0]+ed.bbMax[0])*.5*100));cd.push(Math.floor(parseInt(ed.bbMin[1]+ed.bbMax[1])*.5*100));cd.push(Math.floor(parseInt(ed.bbMin[2]+ed.bbMax[2])*.5*100));cd.push(Math.floor(id*100));cd.push(Math.floor(ed.maxScreenDiameter));var jd=ed.children?ed.children.length:0;if(0<jd){cd.push(Xc.m_aFile.length);for(var bd=0;bd<jd;bd++){Xc.m_aFile.push(ed.children[bd])}cd.push(Xc.m_aFile.length)}else{cd.push(-1);cd.push(-1)}var kd=ed.resources?ed.resources.length:0;if(0<kd){cd.push(Zc.length);for(var bd=0;bd<kd;bd++){for(var ld=0;ld<$c.length;ld++){if(ed.resources[bd]===$c[ld].id){Zc.push(ld);break}}}cd.push(Zc.length)}else{cd.push(-1);cd.push(-1)}}var md=4+9*dd.length+6*Zc.length;var nd=4*md;var od=nd+Tc;var pd=Mc["_CreateBuffer"](od);if(pd){var qd=o["WASM"]["HEAP32"](pd,nd);qd[0]=nd;qd[1]=dd.length;qd[2]=Zc.length;qd[3]=Mc.m_pFileLut.length;qd.set(cd,4);var rd=4+cd.length;for(var ad=0;ad<Zc.length;ad++){var sd=6*Zc[ad];for(var bd=0;bd<6;bd++){qd[rd++]=Yc[sd++]}}var td=o["WASM"]["HEAPU8"](pd+nd,Tc);td.set(new Uint8Array(Pc,Sc,Tc));Mc["_Dispose"](Lc)}Mc.m_pFileLut.push(Xc)}})};Ic["Update"]=function(){return this["_Update"]()};Object.defineProperty(Ic,"object3D",{get:function(){return p(this["_GetObject"]())}});o["Dioramas3MX"]=function(ud,vd){var wd=p(Ic._Dioramas3MX());wd.m_pFileLut=[];wd.m_pTextDecoder=new TextDecoder("utf-8");if(vd){if(vd.m_pGis){vd.m_pGis.AddGameObject(wd.object3D,vd.m_mLngLat.x,vd.m_mLngLat.y);wd.object3D.transform.Translate(vd.m_mOffset,1);wd.object3D.transform.Rotate({x:0,y:0,z:0},1)}}o["Request"]("GET","json",ud,null,null,function(xd){wd["m_pMeta"]=xd;var yd={m_pPath:ud.substring(0,ud.lastIndexOf("/")+1),m_aFile:[]};var zd=[0];for(var Ad=0;Ad<xd.layers.length;Ad++){if("meshPyramid"===xd.layers[Ad].type){zd.push(Ad);zd.push(yd.m_aFile.length);yd.m_aFile.push(xd.layers[Ad].root)}}zd[0]=yd.m_aFile.length;var Bd=wd["_CreateBuffer"](4*zd.length);var Cd=o["WASM"]["HEAP32"](Bd,4*zd.length);Cd.set(zd);wd["_Initialize"](Bd);wd.m_pFileLut.push(yd)});return wd}};function t(Dd,Ed,Fd){p=Ed;q=Fd;for(var Gd=0,Hd=Dd;Gd<Hd.length;Gd++){var Id=Hd[Gd];if(Id){var Jd=Id.prototype;if(r[Jd._type_name]){r[Jd._type_name](Jd)}if("Miaokit"===Jd._type_name){o["Miaokit"]=new Id(0,0)}else if("Gis"===Jd._type_name){r["Gis"]["g_pIns"]=new Id(0,0)}}}}o["WASM"]=o["WASM"]||{};o["WASM"]["LoadClass"]=t;return[]});MiaokitMerge(function(Kd){Kd["m_pLogo"]=null;var Ld=undefined;var Md=false;var Nd=false;function Od(){Kd["Track"]("Preload");Kd["Request"]("GET","json",Kd["m_pConfigPath"],null,null,function(Rd){Kd["m_pConfig"]=Rd;Kd["Fetch"](Rd.MODULE,function(Ud){if(Ld){Ld(Ud)}else{Ld=Ud}});if(Rd.SVE){var Sd=function(Vd){var Wd=Rd.SVE[Vd];Wd.m_pData=null;Wd.m_pTile=null;if(true===Wd.m_bPreload){Kd["Fetch"](Wd.m_pProject,function(Xd){Wd.m_pData=Xd;if(Nd&&Xd){Wd.m_pTile=Kd["Miaokit"]["LoadTile"](Wd.m_pData);Wd.m_pData=null;Kd["App"]["ActiveTile"](Wd)}})}};for(var Td=0;Td<Rd.SVE.length;Td++){Sd(Td)}}if(Kd["App"]){Kd["App"]["Preload"]()}else{Md=true}})}function Pd(Yd,Zd){Kd["Track"]("LoadEngine");if(Md){Kd["App"]["Preload"]();Md=false}Kd["WASM"]["LoadEngine"]({OnEngineLoad:function($d){Kd["Track"]("LoadEngine End");if(Ld){Kd["Track"]("LoadMiaokit");Kd["WASM"]["LoadMiaokit"](Ld,$d,function(){Yd();Nd=true;Qd()})}else{Kd["Track"]("LoadMiaokit Delay");Ld=function(_d){Kd["Track"]("LoadMiaokit");Kd["WASM"]["LoadMiaokit"](_d,$d,function(){Yd();Nd=true;Qd()})}}},OnRenderingEvent:function(ae){if(Nd){Zd(ae)}}})}function Qd(){Kd["Track"]("LoadMiaokit End");var be=Kd["m_pConfig"]["SVE"];if(be){for(var ce=0,de=be;ce<de.length;ce++){var ee=de[ce];if(true===ee.m_bPreload){if(null===ee.m_pTile&&null!==ee.m_pData){ee.m_pTile=Kd["Miaokit"]["LoadTile"](ee.m_pData);ee.m_pData=null;Kd["App"]["ActiveTile"](ee)}}}}}Od["_name"]="Preload";Pd["_name"]="Load";return[Od,Pd]});MiaokitMerge(function(fe){var ge=function(){function ie(){}ie.Clamp=function(je,ke,le){if(je>le){return le}if(je<ke){return ke}return je};return ie}();var he=function(){function me(ne,oe,pe){this.x=0;this.y=0;this.z=0;this.x=ne;this.y=oe;this.z=pe}me.Scale=function(qe,re){return{x:re.x*qe,y:re.y*qe,z:re.z*qe}};return me}();ge["_name"]="Mathf";he["_name"]="Vector3";return[ge,he]});MiaokitMerge(function(se){var te=null;var ue=null;var ve=null;var we=[null];var xe=[null];var ye=[null];var ze=1;var Ae=0;var Be=[undefined];var Ce=null;function De(Oe){Oe["isnanf"]=isNaN;Oe["isinff"]=isFinite;Oe["powf"]=Math.pow;Oe["sqrtf"]=Math.sqrt;Oe["expf"]=Math.exp;Oe["logf"]=Math.log;Oe["floorf"]=Math.floor;Oe["ceilf"]=Math.ceil;Oe["sinf"]=Math.sin;Oe["cosf"]=Math.cos;Oe["tanf"]=Math.tan;Oe["asinf"]=Math.asin;Oe["acosf"]=Math.acos;Oe["atanf"]=Math.atan;Oe["atan2f"]=Math.atan2;Oe["ldexpf"]=function(Pe,Qe){return Pe*Math.pow(2,Qe)}}function Ee(Re){var Se=se["GL"];var Te=Se.Ctx.getParameter(34047);Re["glTexImage2DExt"]=function(Ue,Ve){var We=xe[Ve];if(We){Se.Ctx.texParameterf(Ue,34046,Te);Se.Ctx.texImage2D(Ue,0,Se.Ctx.RGB,Se.Ctx.RGB,Se.Ctx.UNSIGNED_BYTE,We);xe[Ve]=null}};Re["glCreateShader"]=Se._glCreateShader;Re["glDeleteShader"]=Se._glDeleteShader;Re["glShaderSource"]=Se._glShaderSource;Re["glCompileShader"]=Se._glCompileShader;Re["glGetShaderiv"]=Se._glGetShaderiv;Re["glGetShaderInfoLog"]=Se._glGetShaderInfoLog;Re["glCreateProgram"]=Se._glCreateProgram;Re["glDeleteProgram"]=Se._glDeleteProgram;Re["glAttachShader"]=Se._glAttachShader;Re["glLinkProgram"]=Se._glLinkProgram;Re["glUseProgram"]=Se._glUseProgram;Re["glGetProgramiv"]=Se._glGetProgramiv;Re["glGetProgramInfoLog"]=Se._glGetProgramInfoLog;Re["glBindAttribLocation"]=Se._glBindAttribLocation;Re["glGenVertexArrays"]=Se._glGenVertexArrays;Re["glDeleteVertexArrays"]=Se._glDeleteVertexArrays;Re["glBindVertexArray"]=Se._glBindVertexArray;Re["glVertexAttribPointer"]=Se._glVertexAttribPointer;Re["glEnableVertexAttribArray"]=Se._glEnableVertexAttribArray;Re["glGetActiveUniform"]=Se._glGetActiveUniform;Re["glGetUniformLocation"]=Se._glGetUniformLocation;Re["glUniform1i"]=Se._glUniform1i;Re["glUniform1fv"]=Se._glUniform1fv;Re["glUniform2fv"]=Se._glUniform2fv;Re["glUniform3fv"]=Se._glUniform3fv;Re["glUniform4fv"]=Se._glUniform4fv;Re["glUniform1iv"]=Se._glUniform1iv;Re["glUniform2iv"]=Se._glUniform2iv;Re["glUniform3iv"]=Se._glUniform3iv;Re["glUniform4iv"]=Se._glUniform4iv;Re["glUniformMatrix3fv"]=Se._glUniformMatrix3fv;Re["glUniformMatrix4fv"]=Se._glUniformMatrix4fv;Re["glGenTextures"]=Se._glGenTextures;Re["glDeleteTextures"]=Se._glDeleteTextures;Re["glActiveTexture"]=Se._glActiveTexture;Re["glBindTexture"]=Se._glBindTexture;Re["glTexStorage2D"]=Se._glTexStorage2D;Re["glTexParameteri"]=Se._glTexParameteri;Re["glTexImage2D"]=Se._glTexImage2D;Re["glGenerateMipmap"]=Se._glGenerateMipmap;Re["glGenBuffers"]=Se._glGenBuffers;Re["glDeleteBuffers"]=Se._glDeleteBuffers;Re["glBindBuffer"]=Se._glBindBuffer;Re["glBufferData"]=Se._glBufferData;Re["glMapBufferRange"]=Se._glMapBufferRange;Re["glUnmapBuffer"]=Se._glUnmapBuffer;Re["glGenFramebuffers"]=Se._glGenFramebuffers;Re["glDeleteFramebuffers"]=Se._glDeleteFramebuffers;Re["glBindFramebuffer"]=Se._glBindFramebuffer;Re["glFramebufferTexture2D"]=Se._glFramebufferTexture2D;Re["glCheckFramebufferStatus"]=Se._glCheckFramebufferStatus;Re["glClearColor"]=Se._glClearColor;Re["glClear"]=Se._glClear;Re["glBlendFuncSeparate"]=Se._glBlendFuncSeparate;Re["glBlendEquationSeparate"]=Se._glBlendEquationSeparate;Re["glEnable"]=Se._glEnable;Re["glDisable"]=Se._glDisable;Re["glDepthFunc"]=Se._glDepthFunc;Re["glDepthMask"]=Se._glDepthMask;Re["glClearDepthf"]=Se._glClearDepthf;Re["glClearStencil"]=Se._glClearStencil;Re["glCullFace"]=Se._glCullFace;Re["glPolygonOffset"]=Se._glPolygonOffset;Re["glViewport"]=Se._glViewport;Re["glDrawArrays"]=Se._glDrawArrays;Re["glDrawArraysInstanced"]=Se._glDrawArraysInstanced;Re["glDrawElements"]=Se._glDrawElements;Re["glDrawElementsInstanced"]=Se._glDrawElementsInstanced;Re["glFlush"]=Se._glFlush;Re["glFinish"]=Se._glFinish}function Fe(Xe){function Ye(ff){var gf=se["WASM"].GetString(ff);if(!gf.startsWith("http")){gf="./data/projects/sve/"+gf}if(gf.endsWith("assetbundle")){gf+=".bin"}return gf}function Ze(hf,jf,kf,lf){var mf=Ye(hf);var nf=te.get(kf);var of=te.get(lf);se["Fetch"](mf,function(pf){if(pf){var qf=nf(jf,pf.byteLength);if(qf){se["WASM"]["HEAPU8"](qf,pf.byteLength).set(new Uint8Array(pf))}}else{console.error("资源丢失:",mf)}of(jf)})}function $e(rf,sf,tf){var uf=Ye(rf);var vf=te.get(tf);var wf=new Image;wf.crossOrigin="anonymous";wf.src=uf;wf.onload=function(xf){vf(sf,xe.push(wf)-1)}}function _e(yf,zf,Af,Bf){Ze(yf,zf,Af,Bf)}function af(Cf,Df,Ef,Ff){Ce["LoadTerrain"](Cf,Df,Ef,Ff)}function bf(Gf,Hf,If,Jf){var Kf=se["WASM"]["HEAP32"](Gf,16);Ce["LoadBlockbox"](Hf,Kf[0],Kf[1],Kf[2],Kf[3],If,Jf)}function cf(Lf,Mf){var Nf=se["WASM"]["HEAP32"](Lf,12);var Of=Ie(Nf[0]);if(Of){Of["_Load3MX"](Nf[1],Nf[2],Mf)}}function df(Pf,Qf,Rf,Sf){Ze(Pf,Qf,Rf,Sf)}var ef=[undefined,Ze,$e,_e,af,bf,cf,df];Xe["APP_LOAD"]=function(Tf,Uf,Vf,Wf,Xf){ef[Tf](Uf,Vf,Wf,Xf)}}function Ge(Yf){var Zf={NaN:NaN,Infinity:Infinity};De(Yf);Ee(Yf);Fe(Yf);Yf["APP_DYNAMIC_LINK"]=function($f,_f){var ag=se["WASM"]["HEAPU32"]($f,_f);var bg=ag[0];var cg=ag[1];for(var dg=0;dg<bg;dg++){var eg=ag[2+dg]-1;var fg=ag[cg++];var gg=ag[cg++];var hg=se["WASM"].GetString(fg,gg);var ig=JSON.parse(hg);var jg=function(ng,og){this["m_nID"]=ng;this["m_nObject"]=og};var kg=jg.prototype;kg["_type_name"]=ig[0];kg["_type_id"]=dg+1;kg["_ins_count"]=0;Be[dg+1]=jg;var lg=function(pg){var qg=te.get(ag[cg++]);cg++;var rg=function(){var sg=Array.prototype.slice.call(arguments);sg.unshift(this.m_nObject);return qg.apply(this,sg)};if(0===pg){kg["_"+ig[pg]]=rg}else{kg[ig[pg]]=rg}};for(var mg=0;mg<eg;mg++){lg(mg)}}se["WASM"]["LoadClass"](Be,Ie,Le);se["Miaokit"]["ResizeCavans"]=function(tg,ug){if(ve.SE_RESIZE){ve.SE_RESIZE(tg,ug)}}};Yf["APP_PRINT"]=function(vg,wg,xg){var yg=se["WASM"].GetString(vg,wg);se["Track"](yg,xg)};Yf["APP_DO_ACTION"]=function(zg,Ag,Bg,Cg){we[zg](Ag,Bg,Cg)};Yf["APP_CREATE_OBJ"]=function(Dg,Eg){if(0<Dg){var Fg=Je();var Gg=new Be[Dg](Fg,Eg);ye[Fg]=Gg;Be[Dg].prototype._ins_count++;return Fg}else{if(-21==Dg){var Hg=se["WASM"]["HEAP32"](Eg,16);var Ig=Hg[0];var Jg=Hg[1];var Kg=Hg[2];var Lg=Hg[3];var Mg=se["WASM"]["HEAP8"](Kg,Jg);var Ng=new Blob([Mg]);var Og=window.URL.createObjectURL(Ng);var Pg=te.get(Lg);var Qg=new Image;Qg.src=Og;Qg.onload=function(Rg){Pg(Ig,xe.push(Qg)-1);window.URL.revokeObjectURL(Og)}}}return 0};Yf["APP_FREE_OBJ"]=function(Sg){var Tg=ye[Sg];Be[Tg._type_id].prototype._ins_count--;Ke(Sg)};Yf["APP_DO"]=se["ShaderLab"].OperateMaterial;ue=Yf["memory"];se["WASM"]["m_pMemory"]=se["WASM"]["m_pMemory"]||ue;return{env:Yf,global:Zf}}function He(Ug,Vg,Wg){Vg=Ge(Vg);WebAssembly.instantiate(Ug,Vg).then(function(Xg){return Xg.instance}).then(function(Yg){ve=Yg.exports;te=ve.__indirect_function_table;se["WASM"]["Update"]=Yg.exports.SE_UPDATE;se["WASM"]["Malloc"]=Yg.exports.Malloc;se["WASM"]["Free"]=Yg.exports.Free;se["ShaderLab"]["DrawPass_"]=Yg.exports.SE_DRAW_PASS;se["ShaderLab"]["SetSunlight"]=Yg.exports.SE_SUNLIGHT;se["ShaderLab"]["CreateUniformsDesc"]=Yg.exports.SE_CREATE_UNIFORMS_DESC;se["ShaderLab"]["GetTexture"]=function(Zg){return ve.SE_GL_RESOURCE(9,Zg)};se["Track"]("Start thread");se["WASM"]["Worker"]=Ne(function(){se["Track"]("Start thread succeed")});ve.Start();Wg()})}function Ie($g){return ye[$g]}function Je(){var _g=ze;if(ye.length>ze){ze=ye[ze]}else{ze++}Ae++;return _g}function Ke(ah){ye[ah]=ze;ze=ah;Ae--}function Le(bh){var ch="'系统运行':{";ch+="'时间':"+(se.Time()/1e3).toFixed(0);ch+=", '帧率':"+bh;ch+=", 'WASM内存':"+se.WASM.m_pMemory.buffer.byteLength/1024/1024;ch+="}";var dh="'JS对象':{";dh+="'工厂':["+ye.length+", "+Ae+", "+(ye.length-Ae)+"]";for(var eh=1;eh<Be.length;eh++){dh+=", '"+Be[eh].prototype._type_name+"':"+Be[eh].prototype._ins_count}dh+="}";return[ch,dh]}function Me(fh){var gh=we.length;we.push(fh);return gh}function Ne(hh){var ih=ve.UTIL_WORKER_CODE();var jh=se["WASM"]["HEAPU32"](ih,16);if(false){Ce=new Worker(window.URL.createObjectURL(new Blob([se["WASM"]["HEAPU8"](jh[2],jh[3])])));var kh=se["WASM"]["HEAPU8"]().slice(jh[0],jh[0]+jh[1]);var lh=kh.buffer;Ce.postMessage({m_nID:1,m_aCode:lh},[lh])}else{var mh=se["m_pConfig"]["MODULE"].replace(".wasm","");Ce=new Worker(mh+"Worker.min.js");fetch(mh+"Worker.wasm").then(function(nh){return nh.arrayBuffer()}).then(function(oh){if(oh){Ce.postMessage({m_nID:1,m_aCode:oh},[oh])}else{console.error("fetch error: ./js/Miaokit/MiaokitWorker.wasm",oh)}}).catch(function(ph){console.error("fetch error: ./js/Miaokit/MiaokitWorker.wasm",ph)})}Ce.onmessage=function(qh){var rh=qh.data;switch(rh.m_nID){case 1:hh();hh=null;break;case 2:Ce["OnLoadTerrain"](rh);break;case 3:Ce["OnLoadBlockbox"](rh);break;default:console.error("子线程消息异常:",rh);break}};Ce["LoadTerrain"]=function(sh,th,uh,vh){Ce.postMessage({m_nID:2,m_pPath:se["WASM"].GetString(sh),m_nRequest:th,m_nAlloc:uh,m_nCallback:vh})};Ce["OnLoadTerrain"]=function(wh){var xh=te.get(wh.m_nAlloc);var yh=te.get(wh.m_nCallback);var zh=wh.m_pData;if(zh){var Ah=xh(wh.m_nRequest,zh.byteLength);if(Ah){se["WASM"]["HEAPU8"](Ah,zh.byteLength).set(new Uint8Array(zh))}}else{console.warn("Terrain miss:",wh.m_pPath)}yh(wh.m_nRequest)};Ce["LoadBlockbox"]=function Bh(Ch,Dh,Eh,Fh,Gh,Hh,Ih){Ce.postMessage({m_nID:3,m_nRequest:Ch,m_nCol:Dh,m_nRow:Eh,m_nColOffset:Fh,m_nRowOffset:Gh,m_nAlloc:Hh,m_nCallback:Ih})};Ce["OnLoadBlockbox"]=function(Jh){var Kh=te.get(Jh.m_nAlloc);var Lh=te.get(Jh.m_nCallback);var Mh=Jh.m_pData;var Nh=[0,0,0,0];for(var Oh=0;Oh<4;Oh++){var Ph=Mh[Oh];if(0<Ph.m_nVertexCount&&0<Ph.m_nSubmeshCount){var Qh=new se.Mesh;var Rh=new Int32Array(Ph.m_aIndex);Qh.position=new Float32Array(Ph.m_aPosition);Qh.normal=new Float32Array(Ph.m_aNormal);Qh.uv=new Float32Array(Ph.m_aUV);for(var Sh=0;Sh<Ph.m_nSubmeshCount;Sh++){var Th=Rh[2*Sh];var Uh=Rh[2*Sh+1];var Vh=[];for(var Wh=Th;Wh<Uh;Wh++){Vh.push(Wh)}Qh.SetIndices(Sh,new Int32Array(Vh),4)}Qh.Apply();Nh[Oh]=Qh.m_nObject}else{Nh[Oh]=0}}var Xh=Kh(Jh.m_nRequest,16);if(Xh){se["WASM"]["HEAPU32"](Xh,16).set(new Uint32Array(Nh));Lh(Jh.m_nRequest)}};return Ce}se["WASM"]=se["WASM"]||{};se["WASM"]["LoadMiaokit"]=He;se["WASM"]["GetObject"]=Ie;se["WASM"]["RegisterDelegate"]=Me;return[]});MiaokitMerge(function(Yh){var Zh=undefined;var $h={};var _h=[];var ai={RGBA32_FLOAT:function(){return[Zh.RGBA,Zh.RGBA,Zh.FLOAT]},RGBA16_FLOAT:function(){return[Zh.RGBA,Zh.RGBA,36193]},RGBA8:function(){return[Zh.RGBA,Zh.RGBA,Zh.UNSIGNED_BYTE]},D16_UNORM:function(){return[Zh.DEPTH_COMPONENT,Zh.DEPTH_COMPONENT,Zh.UNSIGNED_SHORT]},D24_UNORM:function(){return[Zh.DEPTH_COMPONENT,Zh.DEPTH_COMPONENT,Zh.UNSIGNED_INT]},D24S8_UNORM:function(){return[Zh.DEPTH_STENCIL,Zh.DEPTH_STENCIL,34042]}};var bi={Opaque:1,Transparent:2,Outline:4,CastShadow:8,ReceiveShadow:16};var ci=null;var di=["u_Object","u_Color","u_EyePos","u_MatW","u_MatVP","u_MatWVP","u_MainTex","u_Sunlight"];var ei=[null];var fi=[null];var gi=[null];var hi=[null];var ii=[new Int32Array([0,0,0,0]),new Float32Array([0,0,0,0]),new Float32Array([1,0,0,0,1,0,0,0,1]),new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),new Int32Array([0,0,0,0]),new Int32Array([0,0,0,0])];var ji=[function(Di,Ei,Fi){Zh.uniform4iv(ei[Di],hi[Ei])},function(Gi,Hi,Ii){Zh.uniform4fv(ei[Gi],hi[Hi])},function(Ji,Ki,Li){Zh.uniformMatrix3fv(ei[Ji],false,hi[Ki])},function(Mi,Ni,Oi){Zh.uniformMatrix4fv(ei[Mi],false,hi[Ni])},function(Pi,Qi,Ri){var Si=hi[Qi];var Ti=Si[1];if(Si[0]){Ti=Bi.GetTexture(Ti);if(Ti){Si[0]=0;Si[1]=Ti}}Zh.uniform1i(ei[Pi],Ri);Zh.activeTexture(33984+Ri);Zh.bindTexture(3553,_h[Ti])},function(Ui,Vi){console.error("Unsupported UniformCubemap!")}];var ki=[null];var li=[null];var mi=[function(Wi){var Xi=Yh["ShaderLab"]["Pipeline"]["InternalShader"][Wi];var Yi=ui(Xi);return Yi.id},ri,function(Zi,$i,_i,aj){ji[Zi]($i,_i,aj);return 0},function(bj,cj,dj,ej){var fj=Yh["WASM"].GetString(ej);var gj=hi[bj];var hj=gi[gj[19]];var ij=hj[fj];return undefined===ij?0:ij},function(jj,kj){li[kj][1]();return 0},function(){Bi.Draw()},vi];var ni=1280;var oi=720;var pi=0;var qi=null;function ri(lj,mj,nj,oj){var pj=null;switch(mj){case 0:pj=new Int32Array(ci,oj,4);pj.set(ii[0]);break;case 1:pj=new Float32Array(ci,oj,4);pj.set(ii[1]);break;case 2:pj=new Float32Array(ci,oj,9);pj.set(ii[2]);break;case 3:pj=new Float32Array(ci,oj,16);pj.set(ii[3]);break;case 4:pj=new Int32Array(ci,oj,4);pj.set(ii[4]);break;case 5:pj=new Int32Array(ci,oj,4);pj.set(ii[5]);break;case 6:pj=new Int32Array(ci,oj,nj);break;default:console.error("Unsupported uniform type:",mj);break}hi[lj]=pj;return lj}function si(qj,rj){var sj=Zh.createShader(qj);if(!sj){console.error("Could not create shader object!");return null}Zh.shaderSource(sj,rj);Zh.compileShader(sj);if(!Zh.getShaderParameter(sj,Zh.COMPILE_STATUS)){var tj=Zh.getShaderInfoLog(sj);Zh.deleteShader(sj);console.error("Could not compile shader! \n\n"+tj);return null}return sj}function ti(uj){var vj=uj.program;var wj=0;{Zh.bindAttribLocation(vj,0,"a_Position");Zh.bindAttribLocation(vj,1,"a_Normal");Zh.bindAttribLocation(vj,2,"a_UV");Zh.bindAttribLocation(vj,3,"a_Color");Zh.bindAttribLocation(vj,4,"a_Tangent");Zh.bindAttribLocation(vj,5,"a_Binormal");Zh.bindAttribLocation(vj,9,"a_UV2");if(7<Zh.getProgramParameter(vj,Zh.ACTIVE_ATTRIBUTES)){Zh.bindAttribLocation(vj,10,"a_UV3");Zh.bindAttribLocation(vj,11,"a_UV4");Zh.bindAttribLocation(vj,12,"a_UV5");Zh.bindAttribLocation(vj,13,"a_UV6");Zh.bindAttribLocation(vj,14,"a_UV7");Zh.bindAttribLocation(vj,15,"a_UV8")}}{Zh.linkProgram(vj);if(!Zh.getProgramParameter(vj,Zh.LINK_STATUS)){var xj=Zh.getProgramInfoLog(vj);console.error("Could not compile program! \n\n"+xj);return 0}}{var yj=Zh.getProgramParameter(vj,35718);var zj=Bi.CreateUniformsDesc(yj);var Aj=hi[zj];var Bj={};var Cj=0;Aj[19]=gi.push(Bj)-1;ki[Aj[19]]=uj;for(var Dj=0;Dj<2;Dj++){for(var Ej=0;Ej<yj;Ej++){var xj=Zh.getActiveUniform(vj,Ej);var Fj=xj.type;if(35678===Fj||35680===Fj){if(0!==Dj){continue}}else{if(1!==Dj){continue}}var Gj=xj.name;var Hj=Zh.getUniformLocation(vj,Gj);var Ij=ei.push(Hj)-1;for(var Jj=0;Jj<di.length;Jj++){if(Gj===di[Jj]){Aj[Jj]=Cj;break}}switch(Fj){case 35669:Fj=0;break;case 35666:Fj=1;break;case 35675:Fj=2;break;case 35676:Fj=3;break;case 35678:Fj=4;break;case 35680:Fj=5;break;default:console.error("Unsupported uniform type:",xj);break}Aj[20+Cj]=Ij;Aj[20+yj+Cj]=Fj;Bj[Gj]=Cj;fi[Ij]=Gj;Cj++}}wj=Aj[16]}{var Kj=0;if(uj.mark){for(var Lj=0,Mj=uj.mark;Lj<Mj.length;Lj++){var Nj=Mj[Lj];Kj|=bi[Nj]}}uj.mode=Kj}return wj}function ui(Oj){if(!Oj){return null}var Pj=$h[Oj];if(!Pj){console.error("Could not find shader:",Oj);return null}if(Pj.program){return Pj}Pj.vs=si(Zh.VERTEX_SHADER,$h["Common"]["DeclareVS"]+Pj.vs_src+$h["Common"][Pj.type+"VS"]);if(!Pj.vs){console.error("Could not create vertex shader:",Oj);return null}Pj.fs=si(Zh.FRAGMENT_SHADER,$h["Common"]["DeclareFS"]+Pj.fs_src+$h["Common"][Pj.type+"FS"]);if(!Pj.fs){Zh.deleteShader(Pj.vs);Pj.vs=null;console.error("Could not create fragment shader:",Oj);return null}Pj.program=Zh.createProgram();if(!Pj.program){Zh.deleteShader(Pj.vs);Zh.deleteShader(Pj.fs);Pj.vs=null;Pj.fs=null;console.error("Could not create program object!");return null}Zh.attachShader(Pj.program,Pj.vs);Zh.attachShader(Pj.program,Pj.fs);Pj.id=ti(Pj);if(!Pj.id){Zh.deleteProgram(Pj.program);Zh.deleteShader(Pj.vs);Zh.deleteShader(Pj.fs);Pj.program=null;Pj.vs=null;Pj.fs=null}return Pj}function vi(Qj,Rj){var Sj=undefined;var Tj=undefined;var Uj=undefined;var Vj=undefined;var Wj=0;function Xj(){var fk=hi[Qj];var gk=hi[Rj];var hk=ki[fk[19]];var ik=fk[20];var jk=20+fk[17];Sj=hk.program;Tj=gi[fk[19]];Uj=fk;Vj=[];Wj=fk[17];var kk=function(tk){var uk=tk;var vk=hi[gk[uk]];var wk=ei[ik+uk];var xk=fk[jk+uk];var yk=[function(){return vk},function(zk){vk.set(zk)},undefined];switch(xk){case 0:yk[2]=function(){Zh.uniform4iv(wk,vk)};break;case 1:yk[2]=function(){Zh.uniform4fv(wk,vk)};break;case 2:yk[2]=function(){Zh.uniformMatrix3fv(wk,false,vk)};break;case 3:yk[2]=function(){Zh.uniformMatrix4fv(wk,false,vk)};break;case 4:yk[2]=function(){var Ak=vk[1];if(vk[0]){Ak=Bi.GetTexture(Ak);if(Ak){vk[0]=0;vk[1]=Ak}}Zh.uniform1i(wk,uk);Zh.activeTexture(33984+uk);Zh.bindTexture(3553,_h[Ak])};break;default:console.error("Unsupported uniform type!",xk);break}Vj[uk]=yk};for(var lk=0;lk<Wj;lk++){kk(lk)}if(hk.uniform_values){for(var mk=0,nk=hk.uniform_values;mk<nk.length;mk++){var ok=nk[mk];var pk=Tj[ok[0]];if(undefined!==pk){var qk=fk[jk+pk];if(4===qk||5===qk){var rk=Bi.Pipeline["Resource"][ok[1]];var sk=[0,rk.Handle,0,0];Vj[pk][1](sk)}}}}return hk.mode}function Yj(){if(qi){qi(li[Rj],Zh)}Zh.useProgram(Sj);pi=Qj;for(var Bk=0,Ck=Vj;Bk<Ck.length;Bk++){var Dk=Ck[Bk];Dk[2]()}}function Zj(Ek){return Tj[Ek]}function $j(Fk){return Vj[Fk][0]()}function _j(Gk){Gk=Uj[Gk];if(-1<Gk){return Vj[Gk][0]()}return null}function ak(Hk){var Ik=Tj[Hk];if(undefined!==Ik){return Vj[Ik][0]()}return null}function bk(Jk,Kk){Vj[Jk][1](Kk);if(pi===Qj){Vj[Jk][2]()}}function ck(Lk,Mk){Lk=Uj[Lk];if(-1<Lk){Vj[Lk][1](Mk);if(pi===Qj){Vj[Lk][2]()}}}function dk(Nk,Ok){var Pk=Tj[Nk];if(undefined!==Pk){Vj[Pk][1](Ok);if(pi===Qj){Vj[Pk][2]()}}}function ek(Qk){Vj[Qk][2]()}li[Rj]=[Xj,Yj,Zj,$j,_j,ak,bk,ck,dk,ek];return Xj()}function wi(Rk){{Object.defineProperty(Rk,"Attr",{get:function(){if(!this.Attr_){this.Attr_=li[this._VarList()]}return this.Attr_}})}{var Sk=function(Uk){var Vk=Uk;Object.defineProperty(Rk,di[Uk],{get:function(){return this.Attr[4](Vk)},set:function(Wk){if(Wk){this.Attr[7](Vk,Wk)}}})};for(var Tk=0;Tk<di.length;Tk++){Sk(Tk)}}{}}function xi(Xk,Yk,Zk,$k,_k){return mi[Xk](Yk,Zk,$k,_k)}function yi(al){var bl=Zh.createTexture();if(!bl){console.error("Could not create texture object!");return null}Zh.bindTexture(Zh.TEXTURE_2D,bl);Zh.texParameteri(Zh.TEXTURE_2D,Zh.TEXTURE_MIN_FILTER,Zh.LINEAR);Zh.texParameteri(Zh.TEXTURE_2D,Zh.TEXTURE_MAG_FILTER,Zh.LINEAR);Zh.texParameteri(Zh.TEXTURE_2D,Zh.TEXTURE_WRAP_S,Zh.CLAMP_TO_EDGE);Zh.texParameteri(Zh.TEXTURE_2D,Zh.TEXTURE_WRAP_T,Zh.CLAMP_TO_EDGE);var cl=new Image;cl.crossOrigin="anonymous";cl.src=al.URL;cl.onload=function(dl){Zh.bindTexture(Zh.TEXTURE_2D,bl);Zh.texImage2D(Zh.TEXTURE_2D,0,Zh.RGB,Zh.RGB,Zh.UNSIGNED_BYTE,cl);Zh.bindTexture(Zh.TEXTURE_2D,null)};Zh.bindTexture(Zh.TEXTURE_2D,null);return bl}function zi(el,fl,gl,hl){if(hl===void 0){hl=null}var il=Zh.createTexture();if(!il){console.error("Could not create texture object!");return null}Zh.bindTexture(Zh.TEXTURE_2D,il);Zh.texParameteri(Zh.TEXTURE_2D,Zh.TEXTURE_MIN_FILTER,Zh.NEAREST);Zh.texParameteri(Zh.TEXTURE_2D,Zh.TEXTURE_MAG_FILTER,Zh.NEAREST);Zh.texParameteri(Zh.TEXTURE_2D,Zh.TEXTURE_WRAP_S,Zh.CLAMP_TO_EDGE);Zh.texParameteri(Zh.TEXTURE_2D,Zh.TEXTURE_WRAP_T,Zh.CLAMP_TO_EDGE);var jl=ai[el]();Zh.texImage2D(Zh.TEXTURE_2D,0,jl[0],fl,gl,0,jl[1],jl[2],hl);Zh.bindTexture(Zh.TEXTURE_2D,null);il["_Format"]=jl;return il}function Ai(kl,ll){var ml=Zh.createFramebuffer();if(!ml){console.error("Could not create framebuffer object!");return null}Zh.bindFramebuffer(Zh.FRAMEBUFFER,ml);Zh.framebufferTexture2D(Zh.FRAMEBUFFER,Zh.COLOR_ATTACHMENT0,Zh.TEXTURE_2D,kl,0);if(ll&&ll["_Format"][0]===Zh.DEPTH_STENCIL){Zh.framebufferTexture2D(Zh.FRAMEBUFFER,Zh.DEPTH_STENCIL_ATTACHMENT,Zh.TEXTURE_2D,ll,0)}else{Zh.framebufferTexture2D(Zh.FRAMEBUFFER,Zh.DEPTH_ATTACHMENT,Zh.TEXTURE_2D,ll,0)}if(Zh.FRAMEBUFFER_COMPLETE!=Zh.checkFramebufferStatus(Zh.FRAMEBUFFER)){Zh.deleteFramebuffer(ml);console.error("Framebuffer check failed!");return null}return ml}var Bi={_name:"ShaderLab",Shader:$h,Pipeline:{},Init:function(nl){Zh=Yh["GL"]["Ctx"];_h=Yh["GL"]["_textures"];ni=Zh.canvas.width;oi=Zh.canvas.height;for(var ol=0,pl=this.Pipeline.RenderTarget;ol<pl.length;ol++){var ql=pl[ol];if(ql){var rl=ql.Width||ni;var sl=ql.Height||oi;ql.Texture=zi(ql.Format,rl,sl);ql.Handle=Yh["GL"]["RegisterTexture"](ql.Texture);ql.Size=[1/rl,1/sl,rl,sl]}}for(var tl=0,ul=this.Pipeline.Resource;tl<ul.length;tl++){var vl=ul[tl];if(vl){if("2D"===vl.TYPE){vl.Texture=yi(vl);vl.Handle=Yh["GL"]["RegisterTexture"](vl.Texture)}}}function wl(Gl){var Hl=Gl.RenderTarget;if(Hl){var Il=Bi.Pipeline["RenderTarget"][Hl[0]];var Jl=Bi.Pipeline["RenderTarget"][Hl[1]];Gl.Framebuffer=Ai(Il.Texture,Jl?Jl.Texture:null);Gl.Framebuffer.width=Il.Size[2];Gl.Framebuffer.height=Il.Size[3]}else{Gl.Framebuffer=null}}for(var xl=0,yl=this.Pipeline.Pass;xl<yl.length;xl++){var zl=yl[xl];if(zl){if("Clear"===zl.Type){zl._Type=2}else{zl._Type="Render"===zl.Type?0:1}zl._Mask=0;for(var Al=0,Bl=zl.Mask;Al<Bl.length;Al++){var Cl=Bl[Al];zl._Mask+=bi[Cl]}wl(zl);if(zl.Pingpong){for(var Dl=0,El=zl.Pingpong;Dl<El.length;Dl++){var Fl=El[Dl];wl(Fl)}}}}},Draw:function(){var Kl=0;for(var Ll=0,Ml=this.Pipeline.Pass;Ll<Ml.length;Ll++){var Nl=Ml[Ll];Ci.BeginDrawPass();if(Nl.Pingpong){for(var Ol=0;Ol<Nl.PingpongCount;Ol++){for(var Pl=0;Pl<Nl.Pingpong.length;Pl++){Nl.Framebuffer=Nl.Pingpong[Pl].Framebuffer;Nl.SetUniforms=Nl.Pingpong[Pl].SetUniforms;this.DrawPass(Nl,Bi.DrawPass_)}}}else{this.DrawPass(Nl,Bi.DrawPass_)}Ci.EndDrawPass(Kl++)}},DrawPass:function(Ql,Rl){Zh.bindFramebuffer(Zh.FRAMEBUFFER,Ql.Framebuffer);if(Ql.Framebuffer){Zh.viewport(0,0,Ql.Framebuffer.width,Ql.Framebuffer.height)}else{Zh.viewport(0,0,ni,oi)}var Sl=Ql.Depth;if(Sl){Zh.enable(Zh.DEPTH_TEST);Zh.depthMask(Sl.Write);Zh.depthFunc(Zh[Sl.Func])}else{Zh.disable(Zh.DEPTH_TEST)}var Tl=Ql.Blend;if(Tl){Zh.enable(Zh.BLEND);Zh.blendEquationSeparate(Zh[Tl.ColorFunc],Zh[Tl.AlphaFunc]);Zh.blendFuncSeparate(Zh[Tl.ColorSrc],Zh[Tl.ColorDest],Zh[Tl.AlphaSrc],Zh[Tl.AlphaDest])}else{Zh.disable(Zh.BLEND)}var Ul=Ql.Stencil;if(Ul){Zh.enable(Zh.STENCIL_TEST);Zh.stencilFunc(Zh[Ul.Func],Ul.Value,Ul.Mask);Zh.stencilOp(Zh[Ul.Faild],Zh[Ul.ZFaild],Zh[Ul.Pass])}else{Zh.disable(Zh.STENCIL_TEST)}var Vl=Ql.ClearTarget;if(Vl){var Wl=0;if(Vl.Color){Zh.clearColor(Vl.Color.r,Vl.Color.g,Vl.Color.b,Vl.Color.a);Wl+=Zh.COLOR_BUFFER_BIT}if(undefined!==Vl.Depth){Zh.clearDepth(Vl.Depth);Wl+=Zh.DEPTH_BUFFER_BIT}if(undefined!==Vl.Stencil){Zh.clearStencil(Vl.Stencil);Wl+=Zh.STENCIL_BUFFER_BIT}Zh.clear(Wl)}qi=Ql.SetUniforms;if(Ql.Shader){if(!Ql._Material){Ql._Material=new Yh["Material"](Ql.Shader)}Ql._Material._Bind()}Rl(Ql._Type,Ql._Mask)},PreflushBuffer:function(){var Xl=hi.length;var Yl=new Array(Xl);for(var Zl=0;Zl<Xl;Zl++){var $l=hi[Zl];if($l){if("Float32Array"===$l.constructor.name){Yl[Zl]=$l.length}else{Yl[Zl]=-$l.length}hi[Zl]=$l.byteOffset}}return Yl},FlushBuffer:function(_l,am){ci=_l;var bm=hi.length;for(var cm=0;cm<bm;cm++){var dm=hi[cm];if(dm){var em=am[cm];if(0<em){hi[cm]=new Float32Array(ci,dm,em)}else{hi[cm]=new Int32Array(ci,dm,-em)}}}for(var cm=0;cm<bm;cm++){var fm=li[cm];if(fm){fm[0]()}}Yh["GL"]["FlushHeap"]()},ResizeCanvas:function(gm,hm){},ExpandMaterial:wi,OperateMaterial:xi,CreateUniformsDesc:undefined,GetTexture:undefined,DrawPass_:undefined,SetSunlight:undefined};var Ci={_name:"Profiler",m_pMsg:"",m_nCycleStart:0,m_nCycleTick:0,m_nBeginCycle:0,m_nTotalCycle:0,m_nBeginScript:0,m_nTotalScript:0,m_nBeginUpdate:0,m_nTotalUpdate:0,m_nBeginDraw:0,m_nTotalDraw:0,m_nBeginMaterial:0,m_nTotalMaterial:0,m_nBeginDrawPass:0,m_nTotalDrawPass:[],BeginCycle:function(){if(0===Ci.m_nCycleTick){Ci.m_nCycleStart=Yh["Time"]();Ci.m_nCycleTick=0;Ci.m_nBeginCycle=0;Ci.m_nTotalCycle=0;Ci.m_nBeginScript=0;Ci.m_nTotalScript=0;Ci.m_nBeginUpdate=0;Ci.m_nTotalUpdate=0;Ci.m_nBeginDraw=0;Ci.m_nTotalDraw=0;Ci.m_nBeginMaterial=0;Ci.m_nTotalMaterial=0;Ci.m_nBeginDrawPass=0;Ci.m_nTotalDrawPass=[]}Ci.m_nBeginCycle=Yh["Time"]()},EndCycle:function(){Ci.m_nTotalCycle+=Yh["Time"]()-Ci.m_nBeginCycle;if(60===++Ci.m_nCycleTick){var im={"总耗时":Yh["Time"]()-Ci.m_nCycleStart,"应用循环":Ci.m_nTotalCycle,"脚本逻辑":Ci.m_nTotalScript,"场景更新":Ci.m_nTotalUpdate,"场景绘制":Ci.m_nTotalDraw,"通道绘制":Ci.m_nTotalDrawPass};Ci.m_pMsg="'开销统计':"+JSON.stringify(im);Ci.m_nCycleTick=0}},BeginScript:function(){Ci.m_nBeginScript=Yh["Time"]()},EndScript:function(){Ci.m_nTotalScript+=Yh["Time"]()-Ci.m_nBeginScript},BeginUpdate:function(){Ci.m_nBeginUpdate=Yh["Time"]()},EndUpdate:function(){Ci.m_nTotalUpdate+=Yh["Time"]()-Ci.m_nBeginUpdate},BeginDraw:function(){Ci.m_nBeginDraw=Yh["Time"]()},EndDraw:function(){Ci.m_nTotalDraw+=Yh["Time"]()-Ci.m_nBeginDraw},BeginMaterial:function(){Ci.m_nBeginMaterial=Yh["Time"]()},EndMaterial:function(){Ci.m_nTotalMaterial+=Yh["Time"]()-Ci.m_nBeginMaterial},BeginDrawPass:function(){Ci.m_nBeginDrawPass=Yh["Time"]()},EndDrawPass:function(jm){Ci.m_nTotalDrawPass[jm]=(Ci.m_nTotalDrawPass[jm]?Ci.m_nTotalDrawPass[jm]:0)+Yh["Time"]()-Ci.m_nBeginDrawPass}};Bi.Shader["Common"]={DeclareVS:"\nprecision highp float;\n\nattribute vec3 a_Position;\nattribute vec3 a_Normal;\nattribute vec2 a_UV;\nattribute vec4 a_Color;\nattribute vec4 a_Tangent;\nattribute vec4 a_Binormal;\nattribute vec2 a_UV2;\n\n/// ID、透明标记\nuniform vec4 u_Object;\nuniform vec4 u_EyePos;\nuniform vec4 u_Sunlight;\n\nuniform mat4 u_MatW;\nuniform mat4 u_MatVP;\nuniform mat4 u_MatWVP;\n\nvarying vec3 v_Position;\nvarying vec3 v_Normal;\nvarying vec3 v_Tangent;\nvarying vec3 v_Binormal;\nvarying vec2 v_UV;\nvarying vec4 v_Color;\n\n/// 对象空间坐标转世界空间坐标\nvec3 ObjectToWorldPos(vec3 i_Position)\n{\n    return (u_MatW * vec4(i_Position, 1.0)).xyz;\n}\n\n/// 对象空间坐标转裁剪空间坐标\nvec4 ObjectToClipPos(vec3 i_Position)\n{\n    return u_MatWVP * vec4(i_Position, 1.0);\n}\n\n/// 对象空间法线转世界空间法线\nvec3 ObjectToWorldNormal(vec3 i_Normal)\n{\n    return normalize((u_MatW * vec4(i_Normal, 0.0)).xyz);\n}\n       ",DeclareFS:"\nprecision highp float;\n\n/// ID、透明标记\nuniform vec4 u_Object;\nuniform vec4 u_EyePos;\nuniform vec4 u_Sunlight;\n\nuniform mat4 u_MatW;\nuniform mat4 u_MatVP;\nuniform mat4 u_MatWVP;\nuniform sampler2D u_MainTex;\nuniform sampler2D u_DepthTex;\n\nvarying vec3 v_Position;\nvarying vec3 v_Normal;\nvarying vec3 v_Tangent;\nvarying vec3 v_Binormal;\nvarying vec2 v_UV;\nvarying vec4 v_Color;\n\n/// 对象空间坐标转世界空间坐标\nvec3 ObjectToWorldPos(vec3 i_Position)\n{\n    return (u_MatW * vec4(i_Position, 1.0)).xyz;\n}\n\n/// 对象空间坐标转裁剪空间坐标\nvec4 ObjectToClipPos(vec3 i_Position)\n{\n    return u_MatWVP * vec4(i_Position, 1.0);\n}\n\n/// 采样2D纹理\nvec4 Tex2D(sampler2D i_Tex, vec2 i_UV)\n{\n    i_UV.x = fract(i_UV.x);\n    i_UV.y = fract(1.0 - i_UV.y);\n\n    return texture2D(i_Tex, i_UV);\n}\n\n/// 默认光照函数\nfloat DefaultLight(vec3 v_Normal)\n{\n    vec3 _Normal = normalize(v_Normal);\n    vec3 _Light = normalize(vec3(2.0, 3.0, 1.0));\n\n    return clamp(dot(_Normal, _Light), 0.0, 1.0) + 0.2;\n}\n        ",ClearVS:"\nvoid main()\n{\n    gl_Position = vs();\n}\n        ",ClearFS:"\nvoid main()\n{\n    gl_FragColor = fs();\n}\n        ",RenderVS:"\nvoid main()\n{\n    gl_Position = vs();\n}\n        ",RenderFS:"\nvoid main()\n{\n    gl_FragColor = fs();\n    \n    /// 轮廓显示区域标记\n    {\n        gl_FragColor.a = 0.99;\n    }\n}\n        ",PostprocessVS:"\nvoid main()\n{\n    gl_Position = vs();\n}\n        ",PostprocessFS:"\nvoid main()\n{\n    gl_FragColor = fs();\n}\n        ",BRDF:'\nconst float PI = 3.14159265358979323846;\n\nconst vec3 baseColor = vec3(0.5, 0.5, 0.5);\nconst float metallic = 0.0;\nconst float subsurface = 0.5; // 0.0\nconst float specular = 0.2;\nconst float roughness = 0.7;//0.5;\nconst float specularTint = 0.0;\nconst float anisotropic = 0.0;\nconst float sheen = 0.0;\nconst float sheenTint = 0.5;\nconst float clearcoat = 0.0;\nconst float clearcoatGloss = 1.0;\n\nfloat sqr(float x) { return x * x; }\n\nfloat SchlickFresnel(float u)\n{\n\tfloat m = clamp(1.0 - u, 0.0, 1.0);\n\tfloat m2 = m * m;\n\treturn m2 * m2 * m; // pow(m,5)\n}\n\nfloat GTR1(float NdotH, float a)\n{\n\tif (a >= 1.0) return 1.0 / PI;\n\tfloat a2 = a * a;\n\tfloat t = 1.0 + (a2 - 1.0) * NdotH * NdotH;\n\treturn (a2 - 1.0) / (PI * log(a2) * t);\n}\n\nfloat GTR2(float NdotH, float a)\n{\n\tfloat a2 = a * a;\n\tfloat t = 1.0 + (a2 - 1.0) * NdotH * NdotH;\n\treturn a2 / (PI * t * t);\n}\n\nfloat GTR2_aniso(float NdotH, float HdotX, float HdotY, float ax, float ay)\n{\n\treturn 1.0 / (PI * ax * ay * sqr(sqr(HdotX / ax) + sqr(HdotY / ay) + NdotH * NdotH));\n}\n\nfloat smithG_GGX(float NdotV, float alphaG)\n{\n\tfloat a = alphaG * alphaG;\n\tfloat b = NdotV * NdotV;\n\treturn 1.0 / (NdotV + sqrt(a + b - a * b));\n}\n\nfloat smithG_GGX_aniso(float NdotV, float VdotX, float VdotY, float ax, float ay)\n{\n\treturn 1.0 / (NdotV + sqrt(sqr(VdotX * ax) + sqr(VdotY * ay) + sqr(NdotV)));\n}\n\nvec3 mon2lin(vec3 x)\n{\n\treturn vec3(pow(x[0], 2.2), pow(x[1], 2.2), pow(x[2], 2.2));\n}\n\nvec3 BRDF(vec3 L, vec3 V, vec3 N, vec3 X, vec3 Y)\n{\n    //x和y方向分别表示了表面的切向量和副法线向量方向\n    //https://www.cnblogs.com/starfallen/p/3572352.html\n\n\tfloat NdotL = dot(N, L);\n\tfloat NdotV = dot(N, V);\n\tif (NdotL < 0.0 || NdotV < 0.0) return vec3(0.0);\n\n\tvec3 H = normalize(L + V);\n\tfloat NdotH = dot(N, H);\n\tfloat LdotH = dot(L, H);\n\n\tvec3 Cdlin = mon2lin(baseColor);\n\tfloat Cdlum = 0.3 * Cdlin[0] + 0.6 * Cdlin[1] + 0.1 * Cdlin[2]; // luminance approx.\n\n\tvec3 Ctint = Cdlum > 0.0 ? Cdlin / Cdlum : vec3(1.0); // normalize lum. to isolate hue+sat\n\tvec3 Cspec0 = mix(specular * 0.08 * mix(vec3(1.0), Ctint, specularTint), Cdlin, metallic);\n\tvec3 Csheen = mix(vec3(1.0), Ctint, sheenTint);\n\n\t// Diffuse fresnel - go from 1 at normal incidence to .5 at grazing\n\t// and mix in diffuse retro-reflection based on roughness\n\tfloat FL = SchlickFresnel(NdotL), FV = SchlickFresnel(NdotV);\n\tfloat Fd90 = 0.5 + 2.0 * LdotH * LdotH * roughness;\n\tfloat Fd = mix(1.0, Fd90, FL) * mix(1.0, Fd90, FV);\n\n\t// Based on Hanrahan-Krueger brdf approximation of isotropic bssrdf\n\t// 1.25 scale is used to (roughly) preserve albedo\n\t// Fss90 used to "flatten" retroreflection based on roughness\n\tfloat Fss90 = LdotH * LdotH * roughness;\n\tfloat Fss = mix(1.0, Fss90, FL) * mix(1.0, Fss90, FV);\n\tfloat ss = 1.25 * (Fss * (1.0 / (NdotL + NdotV) - 0.5) + 0.5);\n\n\t// specular\n\tfloat aspect = sqrt(1.0 - anisotropic * 0.9);\n\tfloat ax = max(0.001, sqr(roughness) / aspect);\n\tfloat ay = max(0.001, sqr(roughness) * aspect);\n\tfloat Ds = GTR2_aniso(NdotH, dot(H, X), dot(H, Y), ax, ay);\n\tfloat FH = SchlickFresnel(LdotH);\n\tvec3 Fs = mix(Cspec0, vec3(1.0), FH);\n\tfloat Gs;\n\tGs = smithG_GGX_aniso(NdotL, dot(L, X), dot(L, Y), ax, ay);\n\tGs *= smithG_GGX_aniso(NdotV, dot(V, X), dot(V, Y), ax, ay);\n\n\t// sheen\n\tvec3 Fsheen = FH * sheen * Csheen;\n\n\t// clearcoat (ior = 1.5 -> F0 = 0.04)\n\tfloat Dr = GTR1(NdotH, mix(0.1, 0.001, clearcoatGloss));\n\tfloat Fr = mix(0.04, 1.0, FH);\n\tfloat Gr = smithG_GGX(NdotL, 0.25) * smithG_GGX(NdotV, 0.25);\n\n\treturn ((1.0 / PI) * mix(Fd, ss, subsurface) * Cdlin + Fsheen) * (1.0 - metallic) + Gs * Fs * Ds + 0.25 * clearcoat * Gr * Fr * Dr;\n}\n        ',AtmosphereVS:"\nvarying vec3 v_ViewDir;\nvarying vec3 v_Scattering;\nvarying vec3 v_Attenuate;\nvarying vec3 v_AttenuateGround;\n\n//P and ray define the line; O is the sphere's center point\nvec3 CalculateIntersection(vec3 P, vec3 ray, vec3 O, float r)\n{\n\tvec3 PO = O - P;\n\tfloat lPO = length(PO);\n\tfloat B = 2.0 * dot(PO, ray);\n\n\tfloat C = B * B - 4.0 * (lPO * lPO - r * r);\n\tfloat det = sqrt(max(0.0, C));\n\n\tfloat d = 0.5*(B-det);\n\tvec3 intersect = P + d * ray;\n\n\treturn intersect;\n}\n\nvoid Atmosphere(vec3 mLightDir, vec3 mWorldPos)\n{\n    // 大气散射，天空应分两层，摄像机应该在内层之外，大气层厚度为外层半径减内层半径，外层半径应远大于内层半径\n    //650 nm for red; 570 nm for green; 475 nm for blue\n    vec3 _Wave = vec3(5.602046, 9.473285, 20.49314);\n    vec3 _ESun = vec3(20.0, 20.0, 20.0);\n    vec3 _PlanetPos = vec3(0.0, -6378137.0, 0.0);\n    float _Sealevel = 6378137.0;\n    float _OuterRadius = 6478137.0;\n    float _SampleNum = 5.0;\n    //Rayleigh scattering constant\n    float _Kr = 0.0025;\n    //Mie scattering constant\n    float _Km = 0.001;\n    //the altitude at which the atmosphere's average density is found\n    float _H0 = 0.25;\n\n    vec3 mRay = mWorldPos - u_EyePos.xyz;\n    float nDepth = length(mRay); mRay = mRay / nDepth;\n\n    float nSampleLength = nDepth / _SampleNum;\n    vec3 mSampleRay = mRay * nSampleLength;\n    vec3 mSamplePoint = u_EyePos.xyz + mSampleRay * 0.5;\n    vec3 mInScattering = vec3(0.0, 0.0, 0.0);\n    vec3 mOutScatteringAB = vec3(0.0, 0.0, 0.0);\n    vec3 mOutGroundScatteringAB = vec3(0.0, 0.0, 0.0);\n    float nInvOuterH = 1.0 / (_OuterRadius-_Sealevel);\n\n    for(int i=0; i</*_SampleNum*/5; i++)\n    {\n\t    vec3 mCrossPoint = CalculateIntersection(mSamplePoint, -mLightDir, _PlanetPos, _OuterRadius);\n\t    //AP out scattering\n\t    vec3 mAPRay = (mSamplePoint - u_EyePos.xyz) / _SampleNum;\n\t    float nAPRayLength = length(mAPRay);\n\t    vec3 mSampleAP = u_EyePos.xyz + mAPRay * 0.5;\n\t    vec3 mOutScatteringAP = vec3(0.0, 0.0, 0.0);\n\n\t    for(int m=0; m</*_SampleNum*/5; m++)\n\t    {\n\t\t    mOutScatteringAP += exp(-(length(mSampleAP - _PlanetPos) - _Sealevel) * nInvOuterH / _H0) * nAPRayLength * nInvOuterH;\n\t\t    mSampleAP += mAPRay;\n\t    }\n\t    mOutScatteringAP = 4.0 * 3.14 * (_Km + _Kr * _Wave) * mOutScatteringAP;\n\n\t    //PC out scattering\n\t    vec3 mPCRay = (mCrossPoint - mSamplePoint) / _SampleNum;\n\t    float nPCRayLength = length(mPCRay);\n\t    vec3 mSamplePC = mSamplePoint + mPCRay*0.5;\n\t    vec3 mOutScatteringPC = vec3(0.0, 0.0, 0.0);\n\n\t    for(int n=0; n</*_SampleNum*/5; n++)\n\t    {\n\t\t    mOutScatteringPC += exp(-(length(mSamplePC - _PlanetPos) - _Sealevel) * nInvOuterH / _H0) * nPCRayLength * nInvOuterH;\n\t\t    mSamplePC += mPCRay;\n\t    }\n\t    mOutScatteringPC = 4.0 * 3.14 * (_Km + _Kr * _Wave) * mOutScatteringPC;\n\n\t    mInScattering += exp(-(length(mSamplePoint - _PlanetPos) - _Sealevel) * nInvOuterH / _H0) * nSampleLength * nInvOuterH * exp(-mOutScatteringAP - mOutScatteringPC);\n\t    mSamplePoint+=mSampleRay;\n\t    mOutScatteringAB = mCrossPoint;\n        mOutGroundScatteringAB = mOutScatteringAP + mOutScatteringPC;\n    }\n\n    v_ViewDir = u_EyePos.xyz - mWorldPos;\t\n    v_Scattering = mInScattering * _ESun * _Kr * _Wave;\n    v_Attenuate = mInScattering * _ESun * _Km;\n    v_AttenuateGround = exp(-mOutGroundScatteringAB);\n    \n    // Ground : v_ScatteringR = v_Scattering; v_ScatteringM = v_Attenuate; v_Attenuate = v_AttenuateGround;\n    //v_ViewDir = u_EyePos.xyz - mWorldPos;\n    //v_ScatteringR = mInScattering * _ESun * _Kr * _Wave;\n    //v_ScatteringM = mInScattering * _ESun * _Km;\n    //v_Attenuate = exp(-mOutGroundScatteringAB);\n}\n        ",AtmosphereFS:"\nvarying vec3 v_ViewDir;\nvarying vec3 v_Scattering;\nvarying vec3 v_Attenuate;\nvarying vec3 v_AttenuateGround;\n\nfloat PhaseRayleigh(float nCostheta)\n{\n\treturn 0.75 * (1.0 + nCostheta * nCostheta);\n}\n\nfloat PhaseMie(float nCostheta, float g, float g2)\n{\n\treturn 1.5 * ((1.0 - g2) / (2.0 + g2)) * (1.0 + nCostheta * nCostheta) / pow(1.0 + g2 - 2.0 * g * nCostheta, 1.5);\n}\n\nvec4 AtmosphereColor(vec3 mLightDir)\n{\n    vec4 mColor = vec4(1.0, 0.7, 0.7, 1.0);\n    \n    float _G = -0.990;\n    float _G2 = _G * _G;\n    \n    float nCostheta = dot(normalize(v_ViewDir), mLightDir);\n    float nPhaseMie = PhaseMie(nCostheta, _G, _G2);\n    float nPhaseRayleigh = PhaseRayleigh(nCostheta);\n\t\t\t\t\n    mColor.rgb = v_Scattering * nPhaseRayleigh + v_Attenuate * nPhaseMie;\n    mColor.a = mColor.b + 0.2;\n    mColor = clamp(mColor, 0.0, 0.9);\n\n    return mColor;\n}\n\nvec4 AtmosphereLight(vec4 mColor, vec3 mLightDir)\n{\n    // Ground : v_ScatteringR = v_Scattering; v_ScatteringM = v_Attenuate; v_Attenuate = v_AttenuateGround;\n    \n    float _G = -0.980;\n    float _G2 = _G * _G;\n    \n    float nCostheta = dot(normalize(v_ViewDir), mLightDir);\n    float nPhaseMie = PhaseMie(nCostheta, _G, _G2);\n    float nPhaseRayleigh = PhaseRayleigh(nCostheta);\n    \n    mColor.rgb = v_Scattering * nPhaseRayleigh + v_Attenuate * nPhaseMie + mColor.rgb * v_AttenuateGround;\n    \n    return mColor;\n}\n        "};return[Bi,Ci]});MiaokitMerge(function(km){if("Sisyphus"!==km["m_pConfig"]["ENGINE"]){return[]}var lm=undefined;var mm=true;function nm(sm){om();lm=sm.OnRenderingEvent;pm();var tm={memory:new WebAssembly.Memory({initial:64*16,maximum:32768}),APP_PLUGIN_TYPE:function(){return 2},APP_MEM_TYPE:function(){return 2},APP_MEM_RESERVE:function(){return 1024},APP_MEM_MALLOC:function(um){alert("SISYPHUS��չ��֧��ʹ�÷������ڴ�!");return 0},APP_MEM_FREE:function(vm){alert("SISYPHUS��չ��֧��ʹ�÷������ڴ�!")},APP_MEM_BASE:function(){return 64*1024*1024},APP_MEM_GROW:function(wm){if(km["ShaderLab"]){var xm=km["ShaderLab"]["PreflushBuffer"]();tm["memory"].grow(wm/64/1024);var ym=tm["memory"].buffer;km["ShaderLab"]["FlushBuffer"](ym,xm)}else{tm["memory"].grow(wm/64/1024)}},APP_MEM_RECYCLE:function(zm){alert("WAMSģ�鲻֧�ֻ����ڴ�!")},UNITY_CREATE_OBJ:function(){alert("δװ��UNITY��չ!");return 0},UNITY_FREE_OBJ:function(){alert("δװ��UNITY��չ!");return 0},UNITY_GET:function(){alert("δװ��UNITY��չ!");return 0},UNITY_DO:function(){alert("δװ��UNITY��չ!");return 0}};sm.OnEngineLoad(tm)}function om(){var Am=document.getElementById("unityContainer");var Bm=document.createElement("canvas");Bm.id="3d";Bm.width=Am.offsetWidth;Bm.height=Am.offsetHeight;Bm.style.width="100%";Bm.style.height="100%";Bm.style.top="0rem";Bm.style.bottom="0rem";Bm.style.left="0rem";Bm.style.right="0rem";Bm.style.position="absolute";Bm.style.zIndex="1";Am.appendChild(Bm);km["GL"]["CreateContext"](Bm);km["ShaderLab"]["Init"](km["GL"])}function pm(){if(mm){mm=false;rm()}}function qm(){mm=true}function rm(){if(mm){return}km.Profiler.BeginCycle();km.Profiler.BeginScript();lm(0);km.Profiler.EndScript();if(km["WASM"]["Update"]){km.Profiler.BeginUpdate();km["WASM"]["Update"](0);km.Profiler.EndUpdate();km.Profiler.BeginDraw();km["WASM"]["Update"](1);km.Profiler.EndDraw()}km.Profiler.EndCycle();requestAnimationFrame(rm)}km["WASM"]=km["WASM"]||{};km["WASM"]["LoadEngine"]=nm;pm["_name"]="Start";qm["_name"]="Stop";return[pm,qm]});MiaokitMerge(function(Cm){var Dm=Date.now();function Em(){return Date.now()-Dm}function Fm(Im,Jm){if(Jm===void 0){Jm=0}if(2===Jm){console.warn("Track:",Em(),Im)}else if(2<Jm){console.error("Track:",Em(),Im)}else{console.info("Track:",Em(),Im)}}function Gm(Km,Lm,Mm){if(Mm===void 0){Mm=undefined}var Nm=new XMLHttpRequest;Nm.open("GET",Km,true);Nm.responseType="arraybuffer";Nm.onprogress=function(Om){if(0<Om.total&&Mm){Mm(Om.loaded/Om.total)}};Nm.onload=function(Pm){if(Nm.status==200){Lm(Nm.response)}else{Lm(null)}};Nm.onerror=function(Qm){Fm(Qm,2);Lm(null)};Nm.send(null)}function Hm(Rm,Sm,Tm,Um,Vm,Wm){var Xm=new XMLHttpRequest;Xm.onprogress=function(Ym){if(0<Ym.total&&Vm){Vm(Ym.loaded/Ym.total)}};Xm.onload=function(Zm){if(Xm.status==200){Wm(Xm.response)}else{Wm(null)}Xm=null};Xm.onerror=function($m){Fm($m,2);Wm(null)};Xm.responseType=Sm;Xm.open(Rm,Tm,true);Xm.send(Um)}Em["_name"]="Time";Fm["_name"]="Track";Gm["_name"]="Fetch";Hm["_name"]="Request";return[Em,Fm,Gm,Hm]});MiaokitMerge(function(_m){if("Unity"!==_m["m_pConfig"]["ENGINE"]){return[]}if(!UnityLoader){return[]}var an=_m["m_pLogo"]||"data:image/png;base64,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";UnityLoader.Progress.Styles.Dark.progressLogoUrl=an;UnityLoader.Progress.Styles.Light.progressLogoUrl=an;if(UnityLoader.SystemInfo.mobile){UnityLoader.SystemInfo.mobile=false;UnityLoader.downloadJob=function(jn,kn){var ln=new XMLHttpRequest;ln.open("GET",kn.parameters.url);ln.responseType="arraybuffer";ln.onload=function(){UnityLoader.Compression.decompress(new Uint8Array(ln.response),function(mn){kn.complete(mn)})};if(kn.parameters.onprogress)ln.addEventListener("progress",kn.parameters.onprogress);if(kn.parameters.onload)ln.addEventListener("load",kn.parameters.onload);ln.send()}}UnityLoader.processWasmFrameworkJob=function(nn,on){var pn=UnityLoader.Job.result(nn,"downloadWasmFramework");UnityLoader.loadCode(nn,pn,function(qn,rn){nn["mainScriptUrlOrBlob"]=rn;if(nn.isModularized){UnityLoader[qn]=UnityModule}nn["instantiateWasm"]=function(sn,tn){en(nn,sn["env"]);if(nn["wasmBinary"]){WebAssembly.instantiate(nn["wasmBinary"],sn).then(function(un){tn(un.instance,un.module)})}else{console.info("MiaokitLoader.InitUnity.instantiateWasm error!")}return{}};UnityLoader[qn](nn);on.complete()},{Module:nn,url:nn["wasmFrameworkUrl"],isModularized:nn.isModularized})};var bn=null;var cn=null;var dn={};function en(vn,wn){Object["assign"](wn,{_Init:function(xn,yn){_m["WASM"]["m_pMemory"]=_m["WASM"]["m_pMemory"]||cn.Module.wasmMemory;fn(vn,dn,xn,yn);gn(cn,dn);bn.OnEngineLoad(dn)},_RenderingEvent:function(zn){bn.OnRenderingEvent(zn)}});_m["GL"]=wn}function fn(An,Bn,Cn,Dn){var En=_m.WASM.GetString(Cn,Dn);var Fn=JSON.parse(En);var Gn=function(Kn){var Ln=function(){var Mn=Array.prototype.slice.call(arguments);Mn.unshift(Ln["m_nAddr"]);return Ln["m_pFunc"].apply(this,Mn)};Ln["m_pFunc"]=An[Kn.Call];Ln["m_nAddr"]=Kn.Addr;Bn[Kn.Name]=Ln};for(var Hn=0,In=Fn.List;Hn<In.length;Hn++){var Jn=In[Hn];Gn(Jn)}}function gn(Nn,On){On["APP_PLUGIN_TYPE"]=function(){return 1};On["APP_MEM_TYPE"]=function(){return 1};On["memory"]=function(Pn){var Qn=32*1024*1024;var Rn=Pn._memalign(16,Qn);var Sn=Qn-Rn;Pn._free(Rn);var Tn=Pn._memalign(16,Sn+Qn);if(Tn!==Rn){console.error("miaokit.prememory: addr error",Rn,Tn);return}if(Tn+Sn+Qn!==67108864){console.error("miaokit.prememory: addr end error",Tn+Sn+Qn);return}On["APP_MEM_RESERVE"]=function(){return Tn};return Pn.wasmMemory}(cn.Module);On["APP_MEM_MALLOC"]=function(Un){return cn.Module._memalign(16,Un)};On["APP_MEM_FREE"]=function(Vn){cn.Module._free(Vn)};On["APP_MEM_BASE"]=function(){alert("UNITY��չ��֧��ʹ�������ڴ�!");return 0};On["APP_MEM_GROW"]=function(Wn){alert("UNITY��չ��֧��ʹ�������ڴ�!");return 0};On["APP_MEM_RECYCLE"]=function(Xn){alert("UNITY��չ��֧��ʹ�������ڴ�!");return 0}}function hn(Yn){bn=Yn;cn=UnityLoader.instantiate("unityContainer",_m["m_pConfig"]["UNITY"])}_m["WASM"]=_m["WASM"]||{};_m["WASM"]["LoadEngine"]=hn;return[]});MiaokitMerge(function(Zn){var $n=undefined;var _n=new TextDecoder("utf-8");var ao=new TextEncoder;function bo(co){if(!$n||Zn["WASM"].m_pMemory.buffer.byteLength!==$n[0].byteLength){if(!$n){$n=[]}$n[0]=new Int8Array(Zn["WASM"].m_pMemory.buffer);$n[1]=new Uint8Array(Zn["WASM"].m_pMemory.buffer);$n[2]=new Int16Array(Zn["WASM"].m_pMemory.buffer);$n[3]=new Uint16Array(Zn["WASM"].m_pMemory.buffer);$n[4]=new Int32Array(Zn["WASM"].m_pMemory.buffer);$n[5]=new Uint32Array(Zn["WASM"].m_pMemory.buffer);$n[6]=new Float32Array(Zn["WASM"].m_pMemory.buffer);$n[7]=new Float64Array(Zn["WASM"].m_pMemory.buffer)}return $n[co]}Zn["WASM"]=Zn["WASM"]||{};Zn["WASM"]["HEAP8"]=function(eo,fo){if(eo===void 0){eo=0}if(fo===void 0){fo=0}var go=bo(0);if(eo&&fo){return go.subarray(eo,eo+fo)}else{return go}};Zn["WASM"]["HEAPU8"]=function(ho,io){if(ho===void 0){ho=0}if(io===void 0){io=0}var jo=bo(1);if(ho&&io){return jo.subarray(ho,ho+io)}else{return jo}};Zn["WASM"]["HEAP16"]=function(ko,lo){if(ko===void 0){ko=0}if(lo===void 0){lo=0}var mo=bo(2);if(ko&&lo){return mo.subarray(ko/2,(ko+lo)/2)}else{return mo}};Zn["WASM"]["HEAPU16"]=function(no,oo){if(no===void 0){no=0}if(oo===void 0){oo=0}var po=bo(3);if(no&&oo){return po.subarray(no/2,(no+oo)/2)}else{return po}};Zn["WASM"]["HEAP32"]=function(qo,ro,so){if(qo===void 0){qo=0}if(ro===void 0){ro=0}var to=bo(4);if(qo&&ro){if(so){return to.slice(qo/4,(qo+ro)/4)}else{return to.subarray(qo/4,(qo+ro)/4)}}else{return to}};Zn["WASM"]["HEAPU32"]=function(uo,vo){if(uo===void 0){uo=0}if(vo===void 0){vo=0}var wo=bo(5);if(uo&&vo){return wo.subarray(uo/4,(uo+vo)/4)}else{return wo}};Zn["WASM"]["HEAPF32"]=function(xo,yo,zo){if(xo===void 0){xo=0}if(yo===void 0){yo=0}var Ao=bo(6);if(xo&&yo){if(zo){return Ao.slice(xo/4,(xo+yo)/4)}else{return Ao.subarray(xo/4,(xo+yo)/4)}}else{return Ao}};Zn["WASM"]["HEAPF64"]=function(Bo,Co){if(Bo===void 0){Bo=0}if(Co===void 0){Co=0}var Do=bo(7);if(Bo&&Co){return Do.subarray(Bo/8,(Bo+Co)/8)}else{return Do}};Zn["WASM"]["GetString"]=function(Eo,Fo){if(!Fo){var Go=Zn["WASM"].HEAPU8();var Ho=Eo;while(0!==Go[Ho++]);Fo=Ho-Eo-1}var Io=Zn["WASM"].HEAPU8(Eo,Fo);var Jo=_n.decode(Io);return Jo};Zn["WASM"]["SetString"]=function(Ko,Lo){var Mo=ao.encode(Lo);var No=Zn["WASM"].HEAPU8(Ko,Mo.byteLength);No.set(Mo)};Zn["WASM"]["EncodeString"]=function(Oo){return ao.encode(Oo)};Zn["WASM"]["m_pMemory"]=null;return[]});MiaokitMerge(function(Po){if("Sisyphus"!==Po["m_pConfig"]["ENGINE"]){return[]}var Qo={instance:undefined,counter:1,lastError:0,buffers:[],mappedBuffers:{},programs:[],framebuffers:[],renderbuffers:[],textures:[],uniforms:[],shaders:[],vaos:[],contexts:[],currentContext:null,currArrayBuffer:0,currElementArrayBuffer:0,offscreenCanvases:{},timerQueriesEXT:[],queries:[],samplers:[],transformFeedbacks:[],syncs:[],byteSizeByTypeRoot:5120,byteSizeByType:[1,1,2,2,4,4,4,2,3,4,8],programInfos:{},stringCache:{},stringiCache:{},tempFixedLengthArray:[],packAlignment:4,unpackAlignment:4,init:function(){Qo.miniTempBuffer=new Float32Array(Qo.MINI_TEMP_BUFFER_SIZE);for(var op=0;op<Qo.MINI_TEMP_BUFFER_SIZE;op++){Qo.miniTempBufferViews[op]=Qo.miniTempBuffer.subarray(0,op+1)}for(var op=0;op<32;op++){Qo.tempFixedLengthArray.push(new Array(op))}},recordError:function pp(qp){if(!Qo.lastError){Qo.lastError=qp}},getNewId:function(rp){var sp=Qo.counter++;for(var tp=rp.length;tp<sp;tp++){rp[tp]=null}return sp},MINI_TEMP_BUFFER_SIZE:256,miniTempBuffer:null,miniTempBufferViews:[0],getSource:function(up,vp,wp,xp){var yp="";for(var zp=0;zp<vp;++zp){var Ap;if(xp){var Bp=Zo[xp+zp*4>>2];if(Bp<0){Ap=To(Zo[wp+zp*4>>2])}else{Ap=To(Zo[wp+zp*4>>2],Bp)}}else{Ap=To(Zo[wp+zp*4>>2])}yp+=Ap}return yp},createContext:function(Cp,Dp){if(typeof Dp["majorVersion"]==="undefined"&&typeof Dp["minorVersion"]==="undefined"){if(typeof WebGL2RenderingContext!=="undefined")Dp["majorVersion"]=2;else Dp["majorVersion"]=1;Dp["minorVersion"]=0}var Ep;var Fp="?";function Gp(Ip){Fp=Ip.statusMessage||Fp}try{Cp.addEventListener("webglcontextcreationerror",Gp,false);try{if(Dp["majorVersion"]==1&&Dp["minorVersion"]==0){Ep=Cp.getContext("webgl",Dp)||Cp.getContext("experimental-webgl",Dp)}else if(Dp["majorVersion"]==2&&Dp["minorVersion"]==0){Ep=Cp.getContext("webgl2",Dp)}else{throw"Unsupported WebGL context version "+Dp["majorVersion"]+"."+Dp["minorVersion"]+"!"}}finally{Cp.removeEventListener("webglcontextcreationerror",Gp,false)}if(!Ep)throw":("}catch(Jp){So("Could not create canvas: "+[Fp,Jp,JSON.stringify(Dp)]);return 0}if(!Ep)return 0;var Hp=Qo.registerContext(Ep,Dp);return Hp},registerContext:function(Kp,Lp){var Mp=1;var Np={handle:Mp,attributes:Lp,version:Lp["majorVersion"],GLctx:Kp};function Op(){var Pp=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);return Pp?parseInt(Pp[2],10):false}Np["supportsWebGL2EntryPoints"]=Np.version>=2&&(Op()===false||Op()>=58);if(Kp.canvas)Kp.canvas.GLctxObject=Np;Qo.contexts[Mp]=Np;if(typeof Lp["enableExtensionsByDefault"]==="undefined"||Lp["enableExtensionsByDefault"]){Qo.initExtensions(Np)}if(Lp["renderViaOffscreenBackBuffer"]){return 0}return Mp},makeContextCurrent:function(Qp){if(!Qp){Ro=Qo.currentContext=null;return true}var Rp=Qo.contexts[Qp];if(!Rp){return false}Ro=Rp.GLctx;Qo.currentContext=Rp;return true},getContext:function(Sp){return Qo.contexts[Sp]},deleteContext:function(Tp){if(!Tp)return;if(Qo.currentContext===Qo.contexts[Tp])Qo.currentContext=null;if(typeof JSEvents==="object")JSEvents.removeAllHandlersOnTarget(Qo.contexts[Tp].GLctx.canvas);if(Qo.contexts[Tp]&&Qo.contexts[Tp].GLctx.canvas)Qo.contexts[Tp].GLctx.canvas.GLctxObject=undefined;bp(Qo.contexts[Tp]);Qo.contexts[Tp]=null},initExtensions:function(Up){if(!Up)Up=Qo.currentContext;if(Up.initExtensionsDone)return;Up.initExtensionsDone=true;Ro=Up.GLctx;Up.maxVertexAttribs=Ro.getParameter(Ro.MAX_VERTEX_ATTRIBS);if(Up.version<2){var Vp=Ro.getExtension("ANGLE_instanced_arrays");if(Vp){Ro["vertexAttribDivisor"]=function($p,_p){Vp["vertexAttribDivisorANGLE"]($p,_p)};Ro["drawArraysInstanced"]=function(aq,bq,cq,dq){Vp["drawArraysInstancedANGLE"](aq,bq,cq,dq)};Ro["drawElementsInstanced"]=function(eq,fq,gq,hq,iq){Vp["drawElementsInstancedANGLE"](eq,fq,gq,hq,iq)}}var Wp=Ro.getExtension("OES_vertex_array_object");if(Wp){Ro["createVertexArray"]=function(){return Wp["createVertexArrayOES"]()};Ro["deleteVertexArray"]=function(jq){Wp["deleteVertexArrayOES"](jq)};Ro["bindVertexArray"]=function(kq){Wp["bindVertexArrayOES"](kq)};Ro["isVertexArray"]=function(lq){return Wp["isVertexArrayOES"](lq)}}var Xp=Ro.getExtension("WEBGL_draw_buffers");if(Xp){Ro["drawBuffers"]=function(mq,nq){Xp["drawBuffersWEBGL"](mq,nq)}}}Ro.disjointTimerQueryExt=Ro.getExtension("EXT_disjoint_timer_query");var Yp=["OES_texture_float","OES_texture_half_float","OES_standard_derivatives","OES_vertex_array_object","WEBGL_compressed_texture_s3tc","WEBGL_depth_texture","OES_element_index_uint","EXT_texture_filter_anisotropic","EXT_frag_depth","WEBGL_draw_buffers","ANGLE_instanced_arrays","OES_texture_float_linear","OES_texture_half_float_linear","EXT_blend_minmax","EXT_shader_texture_lod","WEBGL_compressed_texture_pvrtc","EXT_color_buffer_half_float","WEBGL_color_buffer_float","EXT_sRGB","WEBGL_compressed_texture_etc1","EXT_disjoint_timer_query","WEBGL_compressed_texture_etc","WEBGL_compressed_texture_astc","EXT_color_buffer_float","WEBGL_compressed_texture_s3tc_srgb","EXT_disjoint_timer_query_webgl2"];var Zp=Ro.getSupportedExtensions();if(Zp&&Zp.length>0){Ro.getSupportedExtensions().forEach(function(oq){if(Yp.indexOf(oq)!=-1){Ro.getExtension(oq)}})}},populateUniformTable:function(pq){var qq=Qo.programs[pq];Qo.programInfos[pq]={uniforms:{},maxUniformLength:0,maxAttributeLength:-1,maxUniformBlockNameLength:-1};var rq=Qo.programInfos[pq];var sq=rq.uniforms;var tq=Ro.getProgramParameter(qq,Ro.ACTIVE_UNIFORMS);for(var uq=0;uq<tq;++uq){var vq=Ro.getActiveUniform(qq,uq);var wq=vq.name;rq.maxUniformLength=Math.max(rq.maxUniformLength,wq.length+1);if(wq.indexOf("]",wq.length-1)!==-1){var xq=wq.lastIndexOf("[");wq=wq.slice(0,xq)}var yq=Ro.getUniformLocation(qq,wq);if(yq!=null){var zq=Qo.getNewId(Qo.uniforms);sq[wq]=[vq.size,zq];Qo.uniforms[zq]=yq;for(var Aq=1;Aq<vq.size;++Aq){var Bq=wq+"["+Aq+"]";yq=Ro.getUniformLocation(qq,Bq);zq=Qo.getNewId(Qo.uniforms);Qo.uniforms[zq]=yq}}}}};var Ro=undefined;var So=console.error;var To=Po["WASM"]["GetString"];var Uo=function(Cq,Dq,Eq){Po["WASM"]["SetString"](Dq,Cq)};var Vo=undefined;var Wo=undefined;var Xo=undefined;var Yo=undefined;var Zo=undefined;var $o=undefined;var _o=undefined;function ap(Fq){return Po["WASM"]["Malloc"](Fq)}function bp(Gq){Po["WASM"]["Free"](Gq)}function cp(Hq,Iq,Jq){return Jq?+(Hq>>>0)+ +(Iq>>>0)*4294967296:+(Hq>>>0)+ +(Iq|0)*4294967296}function dp(Kq){switch(Kq){case 34962:Kq=34964;break;case 34963:Kq=34965;break;case 35051:Kq=35053;break;case 35052:Kq=35055;break;case 35982:Kq=35983;break;case 36662:Kq=36662;break;case 36663:Kq=36663;break;case 35345:Kq=35368;break}var Lq=Ro.getParameter(Kq);if(Lq)return Lq.name|0;else return 0}function ep(Mq){switch(Mq){case 34962:case 34963:case 36662:case 36663:case 35051:case 35052:case 35882:case 35982:case 35345:return true;default:return false}}function fp(Nq,Oq,Pq,Qq){if(!Pq){Qo.recordError(1281);return}var Rq=Ro["getIndexedParameter"](Nq,Oq);var Sq;switch(typeof Rq){case"boolean":Sq=Rq?1:0;break;case"number":Sq=Rq;break;case"object":if(Rq===null){switch(Nq){case 35983:case 35368:Sq=0;break;default:{Qo.recordError(1280);return}}}else if(Rq instanceof WebGLBuffer){Sq=Rq["name"]|0}else{Qo.recordError(1280);return}break;default:Qo.recordError(1280);return}switch(Qq){case"Integer64":var Tq=0;var Uq=[Sq>>>0,(Tq=Sq,+Math.abs(Tq)>=1?Tq>0?(Math.min(+Math.floor(Tq/4294967296),4294967295)|0)>>>0:~~+Math.ceil((Tq-+(~~Tq>>>0))/4294967296)>>>0:0)];Zo[Pq>>2]=Uq[0];Zo[Pq+4>>2]=Uq[1];break;case"Integer":Zo[Pq>>2]=Sq;break;case"Float":_o[Pq>>2]=Sq;break;case"Boolean":Vo[Pq>>0]=Sq?1:0;break;default:throw"internal emscriptenWebGLGetIndexed() error, bad type: "+Qq}}function gp(Vq,Wq,Xq){if(!Wq){Qo.recordError(1281);return}var Yq=undefined;switch(Vq){case 36346:Yq=1;break;case 36344:if(Xq!=="Integer"&&Xq!=="Integer64"){Qo.recordError(1280)}return;case 34814:case 36345:Yq=0;break;case 34466:var Zq=Ro.getParameter(34467);Yq=Zq.length;break;case 33309:if(Ro.canvas.GLctxObject.version<2){Qo.recordError(1282);return}var $q=Ro.getSupportedExtensions();Yq=2*$q.length;break;case 33307:case 33308:if(Ro.canvas.GLctxObject.version<2){Qo.recordError(1280);return}Yq=Vq==33307?3:0;break}if(Yq===undefined){var _q=Ro.getParameter(Vq);switch(typeof _q){case"number":Yq=_q;break;case"boolean":Yq=_q?1:0;break;case"string":Qo.recordError(1280);return;case"object":if(_q===null){switch(Vq){case 34964:case 35725:case 34965:case 36006:case 36007:case 32873:case 34229:case 35097:case 36389:case 34068:{Yq=0;break};default:{Qo.recordError(1280);return}}}else if(_q instanceof Float32Array||_q instanceof Uint32Array||_q instanceof Int32Array||_q instanceof Array){for(var ar=0;ar<_q.length;++ar){switch(Xq){case"Integer":Zo[Wq+ar*4>>2]=_q[ar];break;case"Float":_o[Wq+ar*4>>2]=_q[ar];break;case"Boolean":Vo[Wq+ar>>0]=_q[ar]?1:0;break;default:throw"internal glGet error, bad type: "+Xq}}return}else if(_q instanceof WebGLBuffer||_q instanceof WebGLProgram||_q instanceof WebGLFramebuffer||_q instanceof WebGLRenderbuffer||_q instanceof WebGLQuery||_q instanceof WebGLSampler||_q instanceof WebGLSync||_q instanceof WebGLTransformFeedback||_q instanceof WebGLVertexArrayObject||_q instanceof WebGLTexture){Yq=_q["name"]|0}else{Qo.recordError(1280);return}break;default:Qo.recordError(1280);return}}switch(Xq){case"Integer64":var br=0;var cr=[Yq>>>0,(br=Yq,+Math.abs(br)>=1?br>0?(Math.min(+Math.floor(br/4294967296),4294967295)|0)>>>0:~~+Math.ceil((br-+(~~br>>>0))/4294967296)>>>0:0)];Zo[Wq>>2]=cr[0];Zo[Wq+4>>2]=cr[1];break;case"Integer":Zo[Wq>>2]=Yq;break;case"Float":_o[Wq>>2]=Yq;break;case"Boolean":Vo[Wq>>0]=Yq?1:0;break;default:throw"internal glGet error, bad type: "+Xq}}function hp(dr,er,fr,gr){if(!fr){Qo.recordError(1281);return}var hr=Ro.getUniform(Qo.programs[dr],Qo.uniforms[er]);if(typeof hr=="number"||typeof hr=="boolean"){switch(gr){case"Integer":Zo[fr>>2]=hr;break;case"Float":_o[fr>>2]=hr;break;default:throw"internal emscriptenWebGLGetUniform() error, bad type: "+gr}}else{for(var ir=0;ir<hr.length;ir++){switch(gr){case"Integer":Zo[fr+ir*4>>2]=hr[ir];break;case"Float":_o[fr+ir*4>>2]=hr[ir];break;default:throw"internal emscriptenWebGLGetUniform() error, bad type: "+gr}}}}function ip(jr,kr,lr,mr){if(!lr){Qo.recordError(1281);return}var nr=Ro.getVertexAttrib(jr,kr);if(kr==34975){Zo[lr>>2]=nr["name"]}else if(typeof nr=="number"||typeof nr=="boolean"){switch(mr){case"Integer":Zo[lr>>2]=nr;break;case"Float":_o[lr>>2]=nr;break;case"FloatToInteger":Zo[lr>>2]=Math["fround"](nr);break;default:throw"internal emscriptenWebGLGetVertexAttrib() error, bad type: "+mr}}else{for(var or=0;or<nr.length;or++){switch(mr){case"Integer":Zo[lr+or*4>>2]=nr[or];break;case"Float":_o[lr+or*4>>2]=nr[or];break;case"FloatToInteger":Zo[lr+or*4>>2]=Math["fround"](nr[or]);break;default:throw"internal emscriptenWebGLGetVertexAttrib() error, bad type: "+mr}}}}function jp(pr,qr,rr,sr){function tr(wr,xr){return Math.floor((wr+xr-1)/xr)*xr}var ur=pr*rr;var vr=tr(ur,sr);return qr<=0?0:(qr-1)*vr+ur}function kp(yr,zr,Ar,Br,Cr,Dr){var Er;var Fr;switch(zr){case 6406:case 6409:case 6402:case 6403:case 36244:Fr=1;break;case 6410:case 33319:case 33320:Fr=2;break;case 6407:case 35904:case 36248:Fr=3;break;case 6408:case 35906:case 36249:Fr=4;break;default:Qo.recordError(1280);return null}switch(yr){case 5121:case 5120:Er=Fr*1;break;case 5123:case 36193:case 5131:case 5122:Er=Fr*2;break;case 5125:case 5126:case 5124:Er=Fr*4;break;case 34042:case 35902:case 33640:case 35899:case 34042:Er=4;break;case 33635:case 32819:case 32820:Er=2;break;default:Qo.recordError(1280);return null}var Gr=jp(Ar,Br,Er,Qo.unpackAlignment);switch(yr){case 5120:return Vo.subarray(Cr,Cr+Gr);case 5121:return Wo.subarray(Cr,Cr+Gr);case 5122:return Xo.subarray(Cr>>1,Cr+Gr>>1);case 5124:return Zo.subarray(Cr>>2,Cr+Gr>>2);case 5126:return _o.subarray(Cr>>2,Cr+Gr>>2);case 5125:case 34042:case 35902:case 33640:case 35899:case 34042:return $o.subarray(Cr>>2,Cr+Gr>>2);case 5123:case 33635:case 32819:case 32820:case 36193:case 5131:return Yo.subarray(Cr>>1,Cr+Gr>>1);default:Qo.recordError(1280);return null}}function lp(Hr){switch(Hr){case 5120:return Vo;case 5121:return Wo;case 5122:return Xo;case 5123:case 33635:case 32819:case 32820:case 36193:case 5131:return Yo;case 5124:return Zo;case 5125:case 34042:case 35902:case 33640:case 35899:case 34042:return $o;case 5126:return _o;default:return null}}function mp(Ir){switch(Ir){case 5120:case 5121:return 0;case 5122:case 5123:case 33635:case 32819:case 32820:case 36193:case 5131:return 1;case 5124:case 5126:case 5125:case 34042:case 35902:case 33640:case 35899:case 34042:return 2;default:return 0}}var np=function(){function Jr(){this.Ctx=undefined}Jr.prototype.FlushHeap=function(){Vo=Po["WASM"]["HEAP8"]();Wo=Po["WASM"]["HEAPU8"]();Xo=Po["WASM"]["HEAP16"]();Yo=Po["WASM"]["HEAPU16"]();Zo=Po["WASM"]["HEAP32"]();$o=Po["WASM"]["HEAPU32"]();_o=Po["WASM"]["HEAPF32"]()};Jr.prototype.CreateContext=function(Kr,Lr){Lr=Lr||{majorVersion:1,minorVersion:0,alpha:0,depth:1,stencil:0,antialias:1,premultipliedAlpha:0,preserveDrawingBuffer:0,preferLowPowerToHighPerformance:0,failIfMajorPerformanceCaveat:0,enableExtensionsByDefault:1,explicitSwapControl:0,proxyContextToMainThread:0,renderViaOffscreenBackBuffer:0};if(Lr["explicitSwapControl"]){return 0}Qo.init();var Mr=Qo.createContext(Kr,Lr);var Nr=Qo.makeContextCurrent(Mr);this.Ctx=Ro;return Nr?0:-5};Jr.prototype.DestroyContext=function(){Qo.deleteContext(Qo.currentContext?Qo.currentContext.handle:0)};Jr.prototype.GetTextureByHandle=function(Or){return Or?Qo.textures[Or]:null};Jr.prototype.RegisterTexture=function(Pr){var Qr=Qo.getNewId(Qo.textures);Pr.name=Qr;Qo.textures[Qr]=Pr;return Qr};Jr.prototype._glActiveTexture=function(Rr){Ro["activeTexture"](Rr)};Jr.prototype._glAttachShader=function(Sr,Tr){Ro.attachShader(Qo.programs[Sr],Qo.shaders[Tr])};Jr.prototype._glBeginQuery=function(Ur,Vr){Ro["beginQuery"](Ur,Vr?Qo.queries[Vr]:null)};Jr.prototype._glBeginTransformFeedback=function(Wr){Ro["beginTransformFeedback"](Wr)};Jr.prototype._glBindAttribLocation=function(Xr,Yr,Zr){Zr=To(Zr);Ro.bindAttribLocation(Qo.programs[Xr],Yr,Zr)};Jr.prototype._glBindBuffer=function($r,_r){var as=_r?Qo.buffers[_r]:null;if($r==35051){Ro.currentPixelPackBufferBinding=_r}else if($r==35052){Ro.currentPixelUnpackBufferBinding=_r}Ro.bindBuffer($r,as)};Jr.prototype._glBindBufferBase=function(bs,cs,ds){var es=ds?Qo.buffers[ds]:null;Ro["bindBufferBase"](bs,cs,es)};Jr.prototype._glBindBufferRange=function(fs,gs,hs,is,js){var ks=hs?Qo.buffers[hs]:null;Ro["bindBufferRange"](fs,gs,ks,is,js)};Jr.prototype._glBindFramebuffer=function(ls,ms){Ro.bindFramebuffer(ls,ms?Qo.framebuffers[ms]:null)};Jr.prototype._glBindRenderbuffer=function(ns,os){Ro.bindRenderbuffer(ns,os?Qo.renderbuffers[os]:null)};Jr.prototype._glBindSampler=function(ps,qs){Ro["bindSampler"](ps,qs?Qo.samplers[qs]:null)};Jr.prototype._glBindTexture=function(rs,ss){Ro.bindTexture(rs,ss?Qo.textures[ss]:null)};Jr.prototype._glBindTransformFeedback=function(ts,us){var vs=us?Qo.transformFeedbacks[us]:null;if(us&&!vs){Qo.recordError(1282);return}Ro["bindTransformFeedback"](ts,vs)};Jr.prototype._glBindVertexArray=function(ws){Ro["bindVertexArray"](Qo.vaos[ws])};Jr.prototype._glBlendEquation=function(xs){Ro["blendEquation"](xs)};Jr.prototype._glBlendEquationSeparate=function(ys,zs){Ro["blendEquationSeparate"](ys,zs)};Jr.prototype._glBlendFuncSeparate=function(As,Bs,Cs,Ds){Ro["blendFuncSeparate"](As,Bs,Cs,Ds)};Jr.prototype._glBlitFramebuffer=function(Es,Fs,Gs,Hs,Is,Js,Ks,Ls,Ms,Ns){Ro["blitFramebuffer"](Es,Fs,Gs,Hs,Is,Js,Ks,Ls,Ms,Ns)};Jr.prototype._glBufferData=function(Os,Ps,Qs,Rs){if(!Qs){Ro.bufferData(Os,Ps,Rs)}else{if(Qo.currentContext.supportsWebGL2EntryPoints){Ro.bufferData(Os,Wo,Rs,Qs,Ps);return}Ro.bufferData(Os,Wo.subarray(Qs,Qs+Ps),Rs)}};Jr.prototype._glBufferSubData=function(Ss,Ts,Us,Vs){if(Qo.currentContext.supportsWebGL2EntryPoints){Ro.bufferSubData(Ss,Ts,Wo,Vs,Us);return}Ro.bufferSubData(Ss,Ts,Wo.subarray(Vs,Vs+Us))};Jr.prototype._glCheckFramebufferStatus=function(Ws){return Ro["checkFramebufferStatus"](Ws)};Jr.prototype._glClear=function(Xs){Ro["clear"](Xs)};Jr.prototype._glClearColor=function(Ys,Zs,$s,_s){Ro["clearColor"](Ys,Zs,$s,_s)};Jr.prototype._glClearDepthf=function(at){Ro["clearDepth"](at)};Jr.prototype._glClearStencil=function(bt){Ro["clearStencil"](bt)};Jr.prototype._glClientWaitSync=function(ct,dt,et,ft){et=et>>>0;ft=ft>>>0;var gt=et==4294967295&&ft==4294967295?-1:cp(et,ft,true);return Ro.clientWaitSync(Qo.syncs[ct],dt,gt)};Jr.prototype._glColorMask=function(ht,it,jt,kt){Ro.colorMask(!!ht,!!it,!!jt,!!kt)};Jr.prototype._glCompileShader=function(lt){Ro.compileShader(Qo.shaders[lt])};Jr.prototype._glCompressedTexImage2D=function(mt,nt,ot,pt,qt,rt,st,tt){if(Qo.currentContext.supportsWebGL2EntryPoints){Ro["compressedTexImage2D"](mt,nt,ot,pt,qt,rt,Wo,tt,st);return}Ro["compressedTexImage2D"](mt,nt,ot,pt,qt,rt,tt?Wo.subarray(tt,tt+st):null)};Jr.prototype._glCompressedTexSubImage2D=function(ut,vt,wt,xt,yt,zt,At,Bt,Ct){if(Qo.currentContext.supportsWebGL2EntryPoints){Ro["compressedTexSubImage2D"](ut,vt,wt,xt,yt,zt,At,Wo,Ct,Bt);return}Ro["compressedTexSubImage2D"](ut,vt,wt,xt,yt,zt,At,Ct?Wo.subarray(Ct,Ct+Bt):null)};Jr.prototype._glCompressedTexSubImage3D=function(Dt,Et,Ft,Gt,Ht,It,Jt,Kt,Lt,Mt,Nt){if(Qo.currentContext.supportsWebGL2EntryPoints){Ro["compressedTexSubImage3D"](Dt,Et,Ft,Gt,Ht,It,Jt,Kt,Lt,Wo,Nt,Mt)}else{Ro["compressedTexSubImage3D"](Dt,Et,Ft,Gt,Ht,It,Jt,Kt,Lt,Nt?Wo.subarray(Nt,Nt+Mt):null)}};Jr.prototype._glCopyBufferSubData=function(Ot,Pt,Qt,Rt,St){Ro["copyBufferSubData"](Ot,Pt,Qt,Rt,St)};Jr.prototype._glCopyTexImage2D=function(Tt,Ut,Vt,Wt,Xt,Yt,Zt,$t){Ro["copyTexImage2D"](Tt,Ut,Vt,Wt,Xt,Yt,Zt,$t)};Jr.prototype._glCopyTexSubImage2D=function(_t,au,bu,cu,du,eu,fu,gu){Ro["copyTexSubImage2D"](_t,au,bu,cu,du,eu,fu,gu)};Jr.prototype._glCreateProgram=function(){var hu=Qo.getNewId(Qo.programs);var iu=Ro.createProgram();iu.name=hu;Qo.programs[hu]=iu;return hu};Jr.prototype._glCreateShader=function(ju){var ku=Qo.getNewId(Qo.shaders);Qo.shaders[ku]=Ro.createShader(ju);return ku};Jr.prototype._glCullFace=function(lu){Ro["cullFace"](lu)};Jr.prototype._glDeleteBuffers=function(mu,nu){for(var ou=0;ou<mu;ou++){var pu=Zo[nu+ou*4>>2];var qu=Qo.buffers[pu];if(!qu)continue;Ro.deleteBuffer(qu);qu.name=0;Qo.buffers[pu]=null;if(pu==Qo.currArrayBuffer)Qo.currArrayBuffer=0;if(pu==Qo.currElementArrayBuffer)Qo.currElementArrayBuffer=0}};Jr.prototype._glDeleteFramebuffers=function(ru,su){for(var tu=0;tu<ru;++tu){var uu=Zo[su+tu*4>>2];var vu=Qo.framebuffers[uu];if(!vu)continue;Ro.deleteFramebuffer(vu);vu.name=0;Qo.framebuffers[uu]=null}};Jr.prototype._glDeleteProgram=function(wu){if(!wu)return;var xu=Qo.programs[wu];if(!xu){Qo.recordError(1281);return}Ro.deleteProgram(xu);xu.name=0;Qo.programs[wu]=null;Qo.programInfos[wu]=null};Jr.prototype._glDeleteQueries=function(yu,zu){for(var Au=0;Au<yu;Au++){var Bu=Zo[zu+Au*4>>2];var Cu=Qo.queries[Bu];if(!Cu)continue;Ro["deleteQuery"](Cu);Qo.queries[Bu]=null}};Jr.prototype._glDeleteRenderbuffers=function(Du,Eu){for(var Fu=0;Fu<Du;Fu++){var Gu=Zo[Eu+Fu*4>>2];var Hu=Qo.renderbuffers[Gu];if(!Hu)continue;Ro.deleteRenderbuffer(Hu);Hu.name=0;Qo.renderbuffers[Gu]=null}};Jr.prototype._glDeleteSamplers=function(Iu,Ju){for(var Ku=0;Ku<Iu;Ku++){var Lu=Zo[Ju+Ku*4>>2];var Mu=Qo.samplers[Lu];if(!Mu)continue;Ro["deleteSampler"](Mu);Mu.name=0;Qo.samplers[Lu]=null}};Jr.prototype._glDeleteShader=function(Nu){if(!Nu)return;var Ou=Qo.shaders[Nu];if(!Ou){Qo.recordError(1281);return}Ro.deleteShader(Ou);Qo.shaders[Nu]=null};Jr.prototype._glDeleteSync=function(Pu){if(!Pu)return;var Qu=Qo.syncs[Pu];if(!Qu){Qo.recordError(1281);return}Ro.deleteSync(Qu);Qu.name=0;Qo.syncs[Pu]=null};Jr.prototype._glDeleteTextures=function(Ru,Su){for(var Tu=0;Tu<Ru;Tu++){var Uu=Zo[Su+Tu*4>>2];var Vu=Qo.textures[Uu];if(!Vu)continue;Ro.deleteTexture(Vu);Vu.name=0;Qo.textures[Uu]=null}};Jr.prototype._glDeleteTransformFeedbacks=function(Wu,Xu){for(var Yu=0;Yu<Wu;Yu++){var Zu=Zo[Xu+Yu*4>>2];var $u=Qo.transformFeedbacks[Zu];if(!$u)continue;Ro["deleteTransformFeedback"]($u);$u.name=0;Qo.transformFeedbacks[Zu]=null}};Jr.prototype._glDeleteVertexArrays=function(_u,av){for(var bv=0;bv<_u;bv++){var cv=Zo[av+bv*4>>2];Ro["deleteVertexArray"](Qo.vaos[cv]);Qo.vaos[cv]=null}};Jr.prototype._glDepthFunc=function(dv){Ro["depthFunc"](dv)};Jr.prototype._glDepthMask=function(ev){Ro.depthMask(!!ev)};Jr.prototype._glDetachShader=function(fv,gv){Ro.detachShader(Qo.programs[fv],Qo.shaders[gv])};Jr.prototype._glDisable=function(hv){Ro["disable"](hv)};Jr.prototype._glDisableVertexAttribArray=function(iv){Ro.disableVertexAttribArray(iv)};Jr.prototype._glDrawArrays=function(jv,kv,lv){Ro.drawArrays(jv,kv,lv)};Jr.prototype._glDrawArraysInstanced=function(mv,nv,ov,pv){Ro["drawArraysInstanced"](mv,nv,ov,pv)};Jr.prototype._glDrawBuffers=function(qv,rv){var sv=Qo.tempFixedLengthArray[qv];for(var tv=0;tv<qv;tv++){sv[tv]=Zo[rv+tv*4>>2]}Ro["drawBuffers"](sv)};Jr.prototype._glDrawElements=function(uv,vv,wv,xv){Ro.drawElements(uv,vv,wv,xv)};Jr.prototype._glDrawElementsInstanced=function(yv,zv,Av,Bv,Cv){Ro["drawElementsInstanced"](yv,zv,Av,Bv,Cv)};Jr.prototype._glEnable=function(Dv){Ro["enable"](Dv)};Jr.prototype._glEnableVertexAttribArray=function(Ev){Ro.enableVertexAttribArray(Ev)};Jr.prototype._glEndQuery=function(Fv){Ro["endQuery"](Fv)};Jr.prototype._glEndTransformFeedback=function(){Ro["endTransformFeedback"]()};Jr.prototype._glFenceSync=function(Gv,Hv){var Iv=Ro.fenceSync(Gv,Hv);if(Iv){var Jv=Qo.getNewId(Qo.syncs);Iv.name=Jv;Qo.syncs[Jv]=Iv;return Jv}else{return 0}};Jr.prototype._glFinish=function(){Ro["finish"]()};Jr.prototype._glFlush=function(){Ro["flush"]()};Jr.prototype._glFlushMappedBufferRange=function(Kv,Lv,Mv){if(!ep(Kv)){Qo.recordError(1280);So("GL_INVALID_ENUM in glFlushMappedBufferRange");return}var Nv=Qo.mappedBuffers[dp(Kv)];if(!Nv){Qo.recordError(1282);So("buffer was never mapped in glFlushMappedBufferRange");return}if(!(Nv.access&16)){Qo.recordError(1282);So("buffer was not mapped with GL_MAP_FLUSH_EXPLICIT_BIT in glFlushMappedBufferRange");return}if(Lv<0||Mv<0||Lv+Mv>Nv.length){Qo.recordError(1281);So("invalid range in glFlushMappedBufferRange");return}Ro.bufferSubData(Kv,Nv.offset,Wo.subarray(Nv.mem+Lv,Nv.mem+Lv+Mv))};Jr.prototype._glFramebufferRenderbuffer=function(Ov,Pv,Qv,Rv){Ro.framebufferRenderbuffer(Ov,Pv,Qv,Qo.renderbuffers[Rv])};Jr.prototype._glFramebufferTexture2D=function(Sv,Tv,Uv,Vv,Wv){Ro.framebufferTexture2D(Sv,Tv,Uv,Qo.textures[Vv],Wv)};Jr.prototype._glFramebufferTextureLayer=function(Xv,Yv,Zv,$v,_v){Ro.framebufferTextureLayer(Xv,Yv,Qo.textures[Zv],$v,_v)};Jr.prototype._glFrontFace=function(aw){Ro["frontFace"](aw)};Jr.prototype._glGenBuffers=function(bw,cw){for(var dw=0;dw<bw;dw++){var ew=Ro.createBuffer();if(!ew){Qo.recordError(1282);while(dw<bw)Zo[cw+dw++*4>>2]=0;return}var fw=Qo.getNewId(Qo.buffers);ew.name=fw;Qo.buffers[fw]=ew;Zo[cw+dw*4>>2]=fw}};Jr.prototype._glGenFramebuffers=function(gw,hw){for(var iw=0;iw<gw;++iw){var jw=Ro.createFramebuffer();if(!jw){Qo.recordError(1282);while(iw<gw)Zo[hw+iw++*4>>2]=0;return}var kw=Qo.getNewId(Qo.framebuffers);jw.name=kw;Qo.framebuffers[kw]=jw;Zo[hw+iw*4>>2]=kw}};Jr.prototype._glGenQueries=function(lw,mw){for(var nw=0;nw<lw;nw++){var ow=Ro["createQuery"]();if(!ow){Qo.recordError(1282);while(nw<lw)Zo[mw+nw++*4>>2]=0;return}var pw=Qo.getNewId(Qo.queries);ow.name=pw;Qo.queries[pw]=ow;Zo[mw+nw*4>>2]=pw}};Jr.prototype._glGenRenderbuffers=function(qw,rw){for(var sw=0;sw<qw;sw++){var tw=Ro.createRenderbuffer();if(!tw){Qo.recordError(1282);while(sw<qw)Zo[rw+sw++*4>>2]=0;return}var uw=Qo.getNewId(Qo.renderbuffers);tw.name=uw;Qo.renderbuffers[uw]=tw;Zo[rw+sw*4>>2]=uw}};Jr.prototype._glGenSamplers=function(vw,ww){for(var xw=0;xw<vw;xw++){var yw=Ro["createSampler"]();if(!yw){Qo.recordError(1282);while(xw<vw)Zo[ww+xw++*4>>2]=0;return}var zw=Qo.getNewId(Qo.samplers);yw.name=zw;Qo.samplers[zw]=yw;Zo[ww+xw*4>>2]=zw}};Jr.prototype._glGenTextures=function(Aw,Bw){for(var Cw=0;Cw<Aw;Cw++){var Dw=Ro.createTexture();if(!Dw){Qo.recordError(1282);while(Cw<Aw)Zo[Bw+Cw++*4>>2]=0;return}var Ew=Qo.getNewId(Qo.textures);Dw.name=Ew;Qo.textures[Ew]=Dw;Zo[Bw+Cw*4>>2]=Ew}};Jr.prototype._glGenTransformFeedbacks=function(Fw,Gw){for(var Hw=0;Hw<Fw;Hw++){var Iw=Ro["createTransformFeedback"]();if(!Iw){Qo.recordError(1282);while(Hw<Fw)Zo[Gw+Hw++*4>>2]=0;return}var Jw=Qo.getNewId(Qo.transformFeedbacks);Iw.name=Jw;Qo.transformFeedbacks[Jw]=Iw;Zo[Gw+Hw*4>>2]=Jw}};Jr.prototype._glGenVertexArrays=function(Kw,Lw){for(var Mw=0;Mw<Kw;Mw++){var Nw=Ro["createVertexArray"]();if(!Nw){Qo.recordError(1282);while(Mw<Kw)Zo[Lw+Mw++*4>>2]=0;return}var Ow=Qo.getNewId(Qo.vaos);Nw.name=Ow;Qo.vaos[Ow]=Nw;Zo[Lw+Mw*4>>2]=Ow}};Jr.prototype._glGenerateMipmap=function(Pw){Ro["generateMipmap"](Pw)};Jr.prototype._glGetActiveAttrib=function(Qw,Rw,Sw,Tw,Uw,Vw,Ww){Qw=Qo.programs[Qw];var Xw=Ro.getActiveAttrib(Qw,Rw);if(!Xw)return;if(Sw>0&&Ww){var Yw=Uo(Xw.name,Ww,Sw);if(Tw)Zo[Tw>>2]=Yw}else{if(Tw)Zo[Tw>>2]=0}if(Uw)Zo[Uw>>2]=Xw.size;if(Vw)Zo[Vw>>2]=Xw.type};Jr.prototype._glGetActiveUniform=function(Zw,$w,_w,ax,bx,cx,dx){Zw=Qo.programs[Zw];var ex=Ro.getActiveUniform(Zw,$w);if(!ex)return;if(_w>0&&dx){var fx=Uo(ex.name,dx,_w);if(ax)Zo[ax>>2]=fx}else{if(ax)Zo[ax>>2]=0}if(bx)Zo[bx>>2]=ex.size;if(cx)Zo[cx>>2]=ex.type};Jr.prototype._glGetActiveUniformBlockName=function(gx,hx,ix,jx,kx){gx=Qo.programs[gx];var lx=Ro["getActiveUniformBlockName"](gx,hx);if(!lx)return;if(kx&&ix>0){var mx=Uo(lx,kx,ix);if(jx)Zo[jx>>2]=mx}else{if(jx)Zo[jx>>2]=0}};Jr.prototype._glGetActiveUniformBlockiv=function(nx,ox,px,qx){if(!qx){Qo.recordError(1281);return}nx=Qo.programs[nx];switch(px){case 35393:var rx=Ro["getActiveUniformBlockName"](nx,ox);Zo[qx>>2]=rx.length+1;return;default:var sx=Ro["getActiveUniformBlockParameter"](nx,ox,px);if(!sx)return;if(typeof sx=="number"){Zo[qx>>2]=sx}else{for(var tx=0;tx<sx.length;tx++){Zo[qx+tx*4>>2]=sx[tx]}}}};Jr.prototype._glGetActiveUniformsiv=function(ux,vx,wx,xx,yx){if(!yx){Qo.recordError(1281);return}if(vx>0&&wx==0){Qo.recordError(1281);return}ux=Qo.programs[ux];var zx=[];for(var Ax=0;Ax<vx;Ax++){zx.push(Zo[wx+Ax*4>>2])}var Bx=Ro["getActiveUniforms"](ux,zx,xx);if(!Bx)return;var Cx=Bx.length;for(var Ax=0;Ax<Cx;Ax++){Zo[yx+Ax*4>>2]=Bx[Ax]}};Jr.prototype._glGetAttribLocation=function(Dx,Ex){return Ro.getAttribLocation(Qo.programs[Dx],To(Ex))};Jr.prototype._glGetError=function(){if(Qo.lastError){var Fx=Qo.lastError;Qo.lastError=0;return Fx}else{return Ro.getError()}};Jr.prototype._glGetFramebufferAttachmentParameteriv=function(Gx,Hx,Ix,Jx){var Kx=Ro.getFramebufferAttachmentParameter(Gx,Hx,Ix);if(Kx instanceof WebGLRenderbuffer||Kx instanceof WebGLTexture){Kx=Kx["name"]|0}Zo[Jx>>2]=Kx};Jr.prototype._glGetIntegeri_v=function(Lx,Mx,Nx){fp(Lx,Mx,Nx,"Integer")};Jr.prototype._glGetIntegerv=function(Ox,Px){gp(Ox,Px,"Integer")};Jr.prototype._glGetInternalformativ=function(Qx,Rx,Sx,Tx,Ux){if(Tx<0){Qo.recordError(1281);return}var Vx=Ro["getInternalformatParameter"](Qx,Rx,32937);if(!Vx){Qo.recordError(1280);return}switch(Sx){case 32937:var Wx=Math.min(Tx,Vx.length);for(var Xx=0;Xx<Wx;Xx++){var Yx=Vx[Xx];Zo[Ux+Xx*4>>2]=Yx}break;case 37760:if(Tx>1){var Yx=Vx.length;Zo[Ux>>2]=Yx}break;default:Qo.recordError(1280)}};Jr.prototype._glGetProgramBinary=function(Zx,$x,_x,ay,by){Qo.recordError(1282)};Jr.prototype._glGetProgramInfoLog=function(cy,dy,ey,fy){var gy=Ro.getProgramInfoLog(Qo.programs[cy]);if(gy===null)gy="(unknown error)";if(dy>0&&fy){var hy=Uo(gy,fy,dy);if(ey)Zo[ey>>2]=hy}else{if(ey)Zo[ey>>2]=0}};Jr.prototype._glGetProgramiv=function(iy,jy,ky){if(!ky){Qo.recordError(1281);return}if(iy>=Qo.counter){Qo.recordError(1281);return}var ly=Qo.programInfos[iy];if(!ly){Qo.recordError(1282);return}if(jy==35716){var my=Ro.getProgramInfoLog(Qo.programs[iy]);if(my===null)my="(unknown error)";Zo[ky>>2]=my.length+1}else if(jy==35719){Zo[ky>>2]=ly.maxUniformLength}else if(jy==35722){if(ly.maxAttributeLength==-1){iy=Qo.programs[iy];var ny=Ro.getProgramParameter(iy,Ro.ACTIVE_ATTRIBUTES);ly.maxAttributeLength=0;for(var oy=0;oy<ny;++oy){var py=Ro.getActiveAttrib(iy,oy);ly.maxAttributeLength=Math.max(ly.maxAttributeLength,py.name.length+1)}}Zo[ky>>2]=ly.maxAttributeLength}else if(jy==35381){if(ly.maxUniformBlockNameLength==-1){iy=Qo.programs[iy];var qy=Ro.getProgramParameter(iy,Ro.ACTIVE_UNIFORM_BLOCKS);ly.maxUniformBlockNameLength=0;for(var oy=0;oy<qy;++oy){var ry=Ro.getActiveUniformBlockName(iy,oy);ly.maxUniformBlockNameLength=Math.max(ly.maxUniformBlockNameLength,ry.length+1)}}Zo[ky>>2]=ly.maxUniformBlockNameLength}else{Zo[ky>>2]=Ro.getProgramParameter(Qo.programs[iy],jy)}};Jr.prototype._glGetRenderbufferParameteriv=function(sy,ty,uy){if(!uy){Qo.recordError(1281);return}Zo[uy>>2]=Ro.getRenderbufferParameter(sy,ty)};Jr.prototype._glGetShaderInfoLog=function(vy,wy,xy,yy){var zy=Ro.getShaderInfoLog(Qo.shaders[vy]);if(zy===null)zy="(unknown error)";if(wy>0&&yy){var Ay=Uo(zy,yy,wy);if(xy)Zo[xy>>2]=Ay}else{if(xy)Zo[xy>>2]=0}};Jr.prototype._glGetShaderPrecisionFormat=function(By,Cy,Dy,Ey){var Fy=Ro.getShaderPrecisionFormat(By,Cy);Zo[Dy>>2]=Fy.rangeMin;Zo[Dy+4>>2]=Fy.rangeMax;Zo[Ey>>2]=Fy.precision};Jr.prototype._glGetShaderSource=function(Gy,Hy,Iy,Jy){var Ky=Ro.getShaderSource(Qo.shaders[Gy]);if(!Ky)return;if(Hy>0&&Jy){var Ly=Uo(Ky,Jy,Hy);if(Iy)Zo[Iy>>2]=Ly}else{if(Iy)Zo[Iy>>2]=0}};Jr.prototype._glGetShaderiv=function(My,Ny,Oy){if(!Oy){Qo.recordError(1281);return}if(Ny==35716){var Py=Ro.getShaderInfoLog(Qo.shaders[My]);if(Py===null)Py="(unknown error)";Zo[Oy>>2]=Py.length+1}else if(Ny==35720){var Qy=Ro.getShaderSource(Qo.shaders[My]);var Ry=Qy===null||Qy.length==0?0:Qy.length+1;Zo[Oy>>2]=Ry}else{Zo[Oy>>2]=Ro.getShaderParameter(Qo.shaders[My],Ny)}};Jr.prototype._glGetString=function(Sy){So("unsupported glGetString");return 0};Jr.prototype._glGetStringi=function(Ty,Uy){So("unsupported glGetStringi");return 0};Jr.prototype._glGetTexParameteriv=function(Vy,Wy,Xy){if(!Xy){Qo.recordError(1281);return}Zo[Xy>>2]=Ro.getTexParameter(Vy,Wy)};Jr.prototype._glGetUniformBlockIndex=function(Yy,Zy){Yy=Qo.programs[Yy];Zy=To(Zy);return Ro["getUniformBlockIndex"](Yy,Zy)};Jr.prototype._glGetUniformIndices=function($y,_y,az,bz){if(!bz){Qo.recordError(1281);return}if(_y>0&&(az==0||bz==0)){Qo.recordError(1281);return}$y=Qo.programs[$y];var cz=[];for(var dz=0;dz<_y;dz++)cz.push(To(Zo[az+dz*4>>2]));var ez=Ro["getUniformIndices"]($y,cz);if(!ez)return;var fz=ez.length;for(var dz=0;dz<fz;dz++){Zo[bz+dz*4>>2]=ez[dz]}};Jr.prototype._glGetUniformLocation=function(gz,hz){hz=To(hz);var iz=0;if(hz.indexOf("]",hz.length-1)!==-1){var jz=hz.lastIndexOf("[");var kz=hz.slice(jz+1,-1);if(kz.length>0){iz=parseInt(kz);if(iz<0){return-1}}hz=hz.slice(0,jz)}var lz=Qo.programInfos[gz];if(!lz){return-1}var mz=lz.uniforms;var nz=mz[hz];if(nz&&iz<nz[0]){return nz[1]+iz}else{return-1}};Jr.prototype._glGetUniformiv=function(oz,pz,qz){hp(oz,pz,qz,"Integer")};Jr.prototype._glGetVertexAttribiv=function(rz,sz,tz){ip(rz,sz,tz,"FloatToInteger")};Jr.prototype._glInvalidateFramebuffer=function(uz,vz,wz){var xz=Qo.tempFixedLengthArray[vz];for(var yz=0;yz<vz;yz++){xz[yz]=Zo[wz+yz*4>>2]}Ro["invalidateFramebuffer"](uz,xz)};Jr.prototype._glIsEnabled=function(zz){return Ro["isEnabled"](zz)};Jr.prototype._glIsVertexArray=function(Az){var Bz=Qo.vaos[Az];if(!Bz)return 0;return Ro["isVertexArray"](Bz)};Jr.prototype._glLinkProgram=function(Cz){Ro.linkProgram(Qo.programs[Cz]);Qo.programInfos[Cz]=null;Qo.populateUniformTable(Cz)};Jr.prototype._glMapBufferRange=function(Dz,Ez,Fz,Gz){if(Gz!=26&&Gz!=10){So("glMapBufferRange is only supported when access is MAP_WRITE|INVALIDATE_BUFFER");return 0}if(!ep(Dz)){Qo.recordError(1280);So("GL_INVALID_ENUM in glMapBufferRange");return 0}var Hz=ap(Fz);if(!Hz)return 0;Qo.mappedBuffers[dp(Dz)]={offset:Ez,length:Fz,mem:Hz,access:Gz};return Hz};Jr.prototype._glPixelStorei=function(Iz,Jz){if(Iz==3333){Qo.packAlignment=Jz}else if(Iz==3317){Qo.unpackAlignment=Jz}Ro.pixelStorei(Iz,Jz)};Jr.prototype._glPolygonOffset=function(Kz,Lz){Ro["polygonOffset"](Kz,Lz)};Jr.prototype._glProgramBinary=function(Mz,Nz,Oz,Pz){Qo.recordError(1280)};Jr.prototype._glProgramParameteri=function(Qz,Rz,Sz){Qo.recordError(1280)};Jr.prototype._glReadBuffer=function(Tz){Ro["readBuffer"](Tz)};Jr.prototype._glReadPixels=function(Uz,Vz,Wz,Xz,Yz,Zz,$z){if(Qo.currentContext.supportsWebGL2EntryPoints){if(Ro.currentPixelPackBufferBinding){Ro.readPixels(Uz,Vz,Wz,Xz,Yz,Zz,$z)}else{Ro.readPixels(Uz,Vz,Wz,Xz,Yz,Zz,lp(Zz),$z>>mp(Zz))}return}var _z=kp(Zz,Yz,Wz,Xz,$z,Yz);if(!_z){Qo.recordError(1280);return}Ro.readPixels(Uz,Vz,Wz,Xz,Yz,Zz,_z)};Jr.prototype._glRenderbufferStorage=function(aA,bA,cA,dA){Ro["renderbufferStorage"](aA,bA,cA,dA)};Jr.prototype._glRenderbufferStorageMultisample=function(eA,fA,gA,hA,iA){Ro["renderbufferStorageMultisample"](eA,fA,gA,hA,iA)};Jr.prototype._glSamplerParameteri=function(jA,kA,lA){Ro["samplerParameteri"](jA?Qo.samplers[jA]:null,kA,lA)};Jr.prototype._glScissor=function(mA,nA,oA,pA){Ro["scissor"](mA,nA,oA,pA)};Jr.prototype._glShaderSource=function(qA,rA,sA,tA){var uA=Qo.getSource(qA,rA,sA,tA);Ro.shaderSource(Qo.shaders[qA],uA)};Jr.prototype._glStencilFuncSeparate=function(vA,wA,xA,yA){Ro["stencilFuncSeparate"](vA,wA,xA,yA)};Jr.prototype._glStencilMask=function(zA){Ro["stencilMask"](zA)};Jr.prototype._glStencilOpSeparate=function(AA,BA,CA,DA){Ro["stencilOpSeparate"](AA,BA,CA,DA)};Jr.prototype._glTexImage2D=function(EA,FA,GA,HA,IA,JA,KA,LA,MA){if(Qo.currentContext.supportsWebGL2EntryPoints){if(Ro.currentPixelUnpackBufferBinding){Ro.texImage2D(EA,FA,GA,HA,IA,JA,KA,LA,MA)}else if(MA!=0){Ro.texImage2D(EA,FA,GA,HA,IA,JA,KA,LA,lp(LA),MA>>mp(LA))}else{Ro.texImage2D(EA,FA,GA,HA,IA,JA,KA,LA,null)}return}var NA=null;if(MA)NA=kp(LA,KA,HA,IA,MA,GA);Ro.texImage2D(EA,FA,GA,HA,IA,JA,KA,LA,NA)};Jr.prototype._glTexImage3D=function(OA,PA,QA,RA,SA,TA,UA,VA,WA,XA){if(Ro.currentPixelUnpackBufferBinding){Ro["texImage3D"](OA,PA,QA,RA,SA,TA,UA,VA,WA,XA)}else if(XA!=0){Ro["texImage3D"](OA,PA,QA,RA,SA,TA,UA,VA,WA,lp(WA),XA>>mp(WA))}else{Ro["texImage3D"](OA,PA,QA,RA,SA,TA,UA,VA,WA,null)}};Jr.prototype._glTexParameterf=function(YA,ZA,$A){Ro["texParameterf"](YA,ZA,$A)};Jr.prototype._glTexParameteri=function(_A,aB,bB){Ro["texParameteri"](_A,aB,bB)};Jr.prototype._glTexParameteriv=function(cB,dB,eB){var fB=Zo[eB>>2];Ro.texParameteri(cB,dB,fB)};Jr.prototype._glTexStorage2D=function(gB,hB,iB,jB,kB){Ro["texStorage2D"](gB,hB,iB,jB,kB)};Jr.prototype._glTexStorage3D=function(lB,mB,nB,oB,pB,qB){Ro["texStorage3D"](lB,mB,nB,oB,pB,qB)};Jr.prototype._glTexSubImage2D=function(rB,sB,tB,uB,vB,wB,xB,yB,zB){if(Qo.currentContext.supportsWebGL2EntryPoints){if(Ro.currentPixelUnpackBufferBinding){Ro.texSubImage2D(rB,sB,tB,uB,vB,wB,xB,yB,zB)}else if(zB!=0){Ro.texSubImage2D(rB,sB,tB,uB,vB,wB,xB,yB,lp(yB),zB>>mp(yB))}else{Ro.texSubImage2D(rB,sB,tB,uB,vB,wB,xB,yB,null)}return}var AB=null;if(zB)AB=kp(yB,xB,vB,wB,zB,0);Ro.texSubImage2D(rB,sB,tB,uB,vB,wB,xB,yB,AB)};Jr.prototype._glTexSubImage3D=function(BB,CB,DB,EB,FB,GB,HB,IB,JB,KB,LB){if(Ro.currentPixelUnpackBufferBinding){Ro["texSubImage3D"](BB,CB,DB,EB,FB,GB,HB,IB,JB,KB,LB)}else if(LB!=0){Ro["texSubImage3D"](BB,CB,DB,EB,FB,GB,HB,IB,JB,KB,lp(KB),LB>>mp(KB))}else{Ro["texSubImage3D"](BB,CB,DB,EB,FB,GB,HB,IB,JB,KB,null)}};Jr.prototype._glTransformFeedbackVaryings=function(MB,NB,OB,PB){MB=Qo.programs[MB];var QB=[];for(var RB=0;RB<NB;RB++)QB.push(To(Zo[OB+RB*4>>2]));Ro["transformFeedbackVaryings"](MB,QB,PB)};Jr.prototype._glUniform1fv=function(SB,TB,UB){if(Qo.currentContext.supportsWebGL2EntryPoints){Ro.uniform1fv(Qo.uniforms[SB],_o,UB>>2,TB);return}var VB;if(TB<=Qo.MINI_TEMP_BUFFER_SIZE){VB=Qo.miniTempBufferViews[TB-1];for(var WB=0;WB<TB;++WB){VB[WB]=_o[UB+4*WB>>2]}}else{VB=_o.subarray(UB>>2,UB+TB*4>>2)}Ro.uniform1fv(Qo.uniforms[SB],VB)};Jr.prototype._glUniform1i=function(XB,YB){Ro.uniform1i(Qo.uniforms[XB],YB)};Jr.prototype._glUniform1iv=function(ZB,$B,_B){if(Qo.currentContext.supportsWebGL2EntryPoints){Ro.uniform1iv(Qo.uniforms[ZB],Zo,_B>>2,$B);return}Ro.uniform1iv(Qo.uniforms[ZB],Zo.subarray(_B>>2,_B+$B*4>>2))};Jr.prototype._glUniform1uiv=function(aC,bC,cC){if(Qo.currentContext.supportsWebGL2EntryPoints){Ro.uniform1uiv(Qo.uniforms[aC],$o,cC>>2,bC)}else{Ro.uniform1uiv(Qo.uniforms[aC],$o.subarray(cC>>2,cC+bC*4>>2))}};Jr.prototype._glUniform2fv=function(dC,eC,fC){if(Qo.currentContext.supportsWebGL2EntryPoints){Ro.uniform2fv(Qo.uniforms[dC],_o,fC>>2,eC*2);return}var gC;if(2*eC<=Qo.MINI_TEMP_BUFFER_SIZE){gC=Qo.miniTempBufferViews[2*eC-1];for(var hC=0;hC<2*eC;hC+=2){gC[hC]=_o[fC+4*hC>>2];gC[hC+1]=_o[fC+(4*hC+4)>>2]}}else{gC=_o.subarray(fC>>2,fC+eC*8>>2)}Ro.uniform2fv(Qo.uniforms[dC],gC)};Jr.prototype._glUniform2iv=function(iC,jC,kC){if(Qo.currentContext.supportsWebGL2EntryPoints){Ro.uniform2iv(Qo.uniforms[iC],Zo,kC>>2,jC*2);return}Ro.uniform2iv(Qo.uniforms[iC],Zo.subarray(kC>>2,kC+jC*8>>2))};Jr.prototype._glUniform2uiv=function(lC,mC,nC){if(Qo.currentContext.supportsWebGL2EntryPoints){Ro.uniform2uiv(Qo.uniforms[lC],$o,nC>>2,mC*2)}else{Ro.uniform2uiv(Qo.uniforms[lC],$o.subarray(nC>>2,nC+mC*8>>2))}};Jr.prototype._glUniform3fv=function(oC,pC,qC){if(Qo.currentContext.supportsWebGL2EntryPoints){Ro.uniform3fv(Qo.uniforms[oC],_o,qC>>2,pC*3);return}var rC;if(3*pC<=Qo.MINI_TEMP_BUFFER_SIZE){rC=Qo.miniTempBufferViews[3*pC-1];for(var sC=0;sC<3*pC;sC+=3){rC[sC]=_o[qC+4*sC>>2];rC[sC+1]=_o[qC+(4*sC+4)>>2];rC[sC+2]=_o[qC+(4*sC+8)>>2]}}else{rC=_o.subarray(qC>>2,qC+pC*12>>2)}Ro.uniform3fv(Qo.uniforms[oC],rC)};Jr.prototype._glUniform3iv=function(tC,uC,vC){if(Qo.currentContext.supportsWebGL2EntryPoints){Ro.uniform3iv(Qo.uniforms[tC],Zo,vC>>2,uC*3);return}Ro.uniform3iv(Qo.uniforms[tC],Zo.subarray(vC>>2,vC+uC*12>>2))};Jr.prototype._glUniform3uiv=function(wC,xC,yC){if(Qo.currentContext.supportsWebGL2EntryPoints){Ro.uniform3uiv(Qo.uniforms[wC],$o,yC>>2,xC*3)}else{Ro.uniform3uiv(Qo.uniforms[wC],$o.subarray(yC>>2,yC+xC*12>>2))}};Jr.prototype._glUniform4fv=function(zC,AC,BC){if(Qo.currentContext.supportsWebGL2EntryPoints){Ro.uniform4fv(Qo.uniforms[zC],_o,BC>>2,AC*4);return}var CC;if(4*AC<=Qo.MINI_TEMP_BUFFER_SIZE){CC=Qo.miniTempBufferViews[4*AC-1];for(var DC=0;DC<4*AC;DC+=4){CC[DC]=_o[BC+4*DC>>2];CC[DC+1]=_o[BC+(4*DC+4)>>2];CC[DC+2]=_o[BC+(4*DC+8)>>2];CC[DC+3]=_o[BC+(4*DC+12)>>2]}}else{CC=_o.subarray(BC>>2,BC+AC*16>>2)}Ro.uniform4fv(Qo.uniforms[zC],CC)};Jr.prototype._glUniform4iv=function(EC,FC,GC){if(Qo.currentContext.supportsWebGL2EntryPoints){Ro.uniform4iv(Qo.uniforms[EC],Zo,GC>>2,FC*4);return}Ro.uniform4iv(Qo.uniforms[EC],Zo.subarray(GC>>2,GC+FC*16>>2))};Jr.prototype._glUniform4uiv=function(HC,IC,JC){if(Qo.currentContext.supportsWebGL2EntryPoints){Ro.uniform4uiv(Qo.uniforms[HC],$o,JC>>2,IC*4)}else{Ro.uniform4uiv(Qo.uniforms[HC],$o.subarray(JC>>2,JC+IC*16>>2))}};Jr.prototype._glUniformBlockBinding=function(KC,LC,MC){KC=Qo.programs[KC];Ro["uniformBlockBinding"](KC,LC,MC)};Jr.prototype._glUniformMatrix3fv=function(NC,OC,PC,QC){if(Qo.currentContext.supportsWebGL2EntryPoints){Ro.uniformMatrix3fv(Qo.uniforms[NC],!!PC,_o,QC>>2,OC*9);return}var RC;if(9*OC<=Qo.MINI_TEMP_BUFFER_SIZE){RC=Qo.miniTempBufferViews[9*OC-1];for(var SC=0;SC<9*OC;SC+=9){RC[SC]=_o[QC+4*SC>>2];RC[SC+1]=_o[QC+(4*SC+4)>>2];RC[SC+2]=_o[QC+(4*SC+8)>>2];RC[SC+3]=_o[QC+(4*SC+12)>>2];RC[SC+4]=_o[QC+(4*SC+16)>>2];RC[SC+5]=_o[QC+(4*SC+20)>>2];RC[SC+6]=_o[QC+(4*SC+24)>>2];RC[SC+7]=_o[QC+(4*SC+28)>>2];RC[SC+8]=_o[QC+(4*SC+32)>>2]}}else{RC=_o.subarray(QC>>2,QC+OC*36>>2)}Ro.uniformMatrix3fv(Qo.uniforms[NC],!!PC,RC)};Jr.prototype._glUniformMatrix4fv=function(TC,UC,VC,WC){if(Qo.currentContext.supportsWebGL2EntryPoints){Ro.uniformMatrix4fv(Qo.uniforms[TC],!!VC,_o,WC>>2,UC*16);return}var XC;if(16*UC<=Qo.MINI_TEMP_BUFFER_SIZE){XC=Qo.miniTempBufferViews[16*UC-1];for(var YC=0;YC<16*UC;YC+=16){XC[YC]=_o[WC+4*YC>>2];XC[YC+1]=_o[WC+(4*YC+4)>>2];XC[YC+2]=_o[WC+(4*YC+8)>>2];XC[YC+3]=_o[WC+(4*YC+12)>>2];XC[YC+4]=_o[WC+(4*YC+16)>>2];XC[YC+5]=_o[WC+(4*YC+20)>>2];XC[YC+6]=_o[WC+(4*YC+24)>>2];XC[YC+7]=_o[WC+(4*YC+28)>>2];XC[YC+8]=_o[WC+(4*YC+32)>>2];XC[YC+9]=_o[WC+(4*YC+36)>>2];XC[YC+10]=_o[WC+(4*YC+40)>>2];XC[YC+11]=_o[WC+(4*YC+44)>>2];XC[YC+12]=_o[WC+(4*YC+48)>>2];XC[YC+13]=_o[WC+(4*YC+52)>>2];XC[YC+14]=_o[WC+(4*YC+56)>>2];XC[YC+15]=_o[WC+(4*YC+60)>>2]}}else{XC=_o.subarray(WC>>2,WC+UC*64>>2)}Ro.uniformMatrix4fv(Qo.uniforms[TC],!!VC,XC)};Jr.prototype._glUnmapBuffer=function(ZC){if(!ep(ZC)){Qo.recordError(1280);So("GL_INVALID_ENUM in glUnmapBuffer");return 0}var $C=dp(ZC);var _C=Qo.mappedBuffers[$C];if(!_C){Qo.recordError(1282);So("buffer was never mapped in glUnmapBuffer");return 0}Qo.mappedBuffers[$C]=null;if(!(_C.access&16))if(Qo.currentContext.supportsWebGL2EntryPoints){Ro.bufferSubData(ZC,_C.offset,Wo,_C.mem,_C.length)}else{Ro.bufferSubData(ZC,_C.offset,Wo.subarray(_C.mem,_C.mem+_C.length))}bp(_C.mem);return 1};Jr.prototype._glUseProgram=function(aD){Ro.useProgram(aD?Qo.programs[aD]:null)};Jr.prototype._glValidateProgram=function(bD){Ro.validateProgram(Qo.programs[bD])};Jr.prototype._glVertexAttrib4f=function(cD,dD,eD,fD,gD){Ro["vertexAttrib4f"](cD,dD,eD,fD,gD)};Jr.prototype._glVertexAttrib4fv=function(hD,iD){Ro.vertexAttrib4f(hD,_o[iD>>2],_o[iD+4>>2],_o[iD+8>>2],_o[iD+12>>2])};Jr.prototype._glVertexAttribIPointer=function(jD,kD,lD,mD,nD){var oD=Qo.currentContext.clientBuffers[jD];if(!Qo.currArrayBuffer){oD.size=kD;oD.type=lD;oD.normalized=false;oD.stride=mD;oD.ptr=nD;oD.clientside=true;return}oD.clientside=false;Ro.vertexAttribIPointer(jD,kD,lD,mD,nD)};Jr.prototype._glVertexAttribPointer=function(pD,qD,rD,sD,tD,uD){Ro.vertexAttribPointer(pD,qD,rD,!!sD,tD,uD)};Jr.prototype._glViewport=function(vD,wD,xD,yD){Ro["viewport"](vD,wD,xD,yD)};return Jr}();Qo.instance=new np;Qo.instance["_name"]="GL";Qo.instance["_textures"]=Qo.textures;return[Qo.instance]});